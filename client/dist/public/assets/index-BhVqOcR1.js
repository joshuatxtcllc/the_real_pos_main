const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CustomerPortal-gtXnmLuJ.js","assets/ui-O3Y4hNsB.js","assets/vendor--0RGCJ5T.js","assets/icons-DNNJj53b.js","assets/query-DSGfYlti.js","assets/utils-CJ8RBMVN.js","assets/charts-zhNjaY9P.js","assets/forms-BphQ7k6W.js","assets/CustomerDashboardPage-Dw3GG0jh.js"])))=>i.map(i=>d[i]);
var c2=Object.defineProperty;var d2=(s,t,r)=>t in s?c2(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var R=(s,t,r)=>d2(s,typeof t!="symbol"?t+"":t,r);import{j as e,V as Ry,R as My,A as Oy,C as Fy,T as Ly,D as $y,P as u2,S as gl,c as Vi,a as fs,u as Ge,b as Ln,d as ms,e as Se,f as hr,g as as,h as ge,i as By,k as ds,l as Ss,m as vl,n as m2,o as ph,p as yl,q as jl,r as Vy,I as Uy,s as Ea,t as bl,v as Hy,w as qy,x as zy,F as Wy,y as iu,z as ou,B as Ky,E as lu,O as Ui,G as Hi,H as Da,J as qi,K as zi,L as cu,M as du,N as uu,Q as h2,U as Gy,W as Qy,X as p2,Y as Zy,Z as Yy,_ as Xy,$ as Jy,a0 as ej,a1 as tj,a2 as sj,a3 as f2,a4 as x2,a5 as rj,a6 as g2,a7 as nj}from"./ui-O3Y4hNsB.js";import{a as mu,r as p,c as v2,b as y2,R as De,g as j2}from"./vendor--0RGCJ5T.js";import{Q as b2,u as me,a as Ce,b as Zt,c as w2}from"./query-DSGfYlti.js";import{t as N2,c as S2,f as dr,s as oo,i as fh}from"./utils-CJ8RBMVN.js";import{X as $n,C as ns,S as Kc,M as aj,a as wl,b as ij,c as ls,L as Xe,d as Zr,R as ir,e as oj,E as C2,f as pi,Z as k2,g as T2,h as lj,i as xh,U as Or,j as cj,I as fi,A as gh,k as P2,l as Fo,D as Nl,W as E2,H as D2,m as hu,n as A2,o as vt,G as pu,p as Gs,q as Ht,B as dj,P as Vr,r as Gc,T as Sl,s as uj,t as xi,u as Dn,v as Bn,F as Cl,w as ai,x as Lo,y as Sr,z as ha,J as $o,K as _2,N as mj,O as kl,Q as Aa,V as Fr,Y as hj,_ as I2,$ as R2,a0 as Ur,a1 as Qs,a2 as Yr,a3 as gi,a4 as M2,a5 as O2,a6 as F2,a7 as fu,a8 as Hs,a9 as vi,aa as xn,ab as pj,ac as L2,ad as At,ae as yi,af as fj,ag as $2,ah as B2,ai as Qc,aj as qs,ak as V2,al as vh,am as pa,an as U2,ao as xj,ap as Zc,aq as H2,ar as q2,as as No,at as z2,au as gj,av as vj,aw as za,ax as W2,ay as yj,az as K2,aA as G2,aB as Q2,aC as Z2,aD as lo,aE as Y2,aF as X2,aG as Yc,aH as J2,aI as eP,aJ as tP,aK as un,aL as Bo,aM as sP,aN as rP,aO as nP,aP as gn,aQ as yh,aR as aP}from"./icons-DNNJj53b.js";import{p as jj,R as Ir,L as bj,C as ii,X as oi,Y as Yn,T as Rr,a as wj,b as li,B as Xc,c as Jc,P as ed,d as td,e as Vo,f as jt}from"./charts-zhNjaY9P.js";import{o as iP,r as oP,a as lP,u as cP,F as dP,C as uP,b as Nj}from"./forms-BphQ7k6W.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var sd={},jh=mu;sd.createRoot=jh.createRoot,sd.hydrateRoot=jh.hydrateRoot;const mP="modulepreload",hP=function(s){return"/"+s},bh={},wh=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=hP(c),c in bh)return;bh[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":mP,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,x)=>{h.addEventListener("load",m),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function pP(s,t){if(s instanceof RegExp)return{keys:!1,pattern:s};var r,n,a,i,o=[],l="",c=s.split("/");for(c[0]||c.shift();a=c.shift();)r=a[0],r==="*"?(o.push(r),l+=a[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(n=a.indexOf("?",1),i=a.indexOf(".",1),o.push(a.substring(1,~n?n:~i?i:a.length)),l+=~n&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(l+=(~n?"?":"")+"\\"+a.substring(i))):l+="/"+a;return{keys:o,pattern:new RegExp("^"+l+(t?"(?=$|/)":"/?$"),"i")}}var Sj={exports:{}},Cj={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fa=p;function fP(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var xP=typeof Object.is=="function"?Object.is:fP,gP=fa.useState,vP=fa.useEffect,yP=fa.useLayoutEffect,jP=fa.useDebugValue;function bP(s,t){var r=t(),n=gP({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return yP(function(){a.value=r,a.getSnapshot=t,xc(a)&&i({inst:a})},[s,r,t]),vP(function(){return xc(a)&&i({inst:a}),s(function(){xc(a)&&i({inst:a})})},[s]),jP(r),r}function xc(s){var t=s.getSnapshot;s=s.value;try{var r=t();return!xP(s,r)}catch{return!0}}function wP(s,t){return t()}var NP=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?wP:bP;Cj.useSyncExternalStore=fa.useSyncExternalStore!==void 0?fa.useSyncExternalStore:NP;Sj.exports=Cj;var SP=Sj.exports;const CP=v2.useInsertionEffect,kP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",TP=kP?p.useLayoutEffect:p.useEffect,PP=CP||TP,kj=s=>{const t=p.useRef([s,(...r)=>t[0](...r)]).current;return PP(()=>{t[0]=s}),t[1]},EP="popstate",xu="pushState",gu="replaceState",DP="hashchange",Nh=[EP,xu,gu,DP],AP=s=>{for(const t of Nh)addEventListener(t,s);return()=>{for(const t of Nh)removeEventListener(t,s)}},Tj=(s,t)=>SP.useSyncExternalStore(AP,s,t),_P=()=>location.search,IP=({ssrSearch:s=""}={})=>Tj(_P,()=>s),Sh=()=>location.pathname,RP=({ssrPath:s}={})=>Tj(Sh,s?()=>s:Sh),MP=(s,{replace:t=!1,state:r=null}={})=>history[t?gu:xu](r,"",s),OP=(s={})=>[RP(s),MP],Ch=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Ch]>"u"){for(const s of[xu,gu]){const t=history[s];history[s]=function(){const r=t.apply(this,arguments),n=new Event(s);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,Ch,{value:!0})}const FP=(s,t)=>t.toLowerCase().indexOf(s.toLowerCase())?"~"+t:t.slice(s.length)||"/",Pj=(s="")=>s==="/"?"":s,LP=(s,t)=>s[0]==="~"?s.slice(1):Pj(t)+s,$P=(s="",t)=>FP(kh(Pj(s)),kh(t)),kh=s=>{try{return decodeURI(s)}catch{return s}},Ej={hook:OP,searchHook:IP,parser:pP,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:s=>s},Dj=p.createContext(Ej),_a=()=>p.useContext(Dj),Aj={},_j=p.createContext(Aj),Tl=()=>p.useContext(_j),Pl=s=>{const[t,r]=s.hook(s);return[$P(s.base,t),kj((n,a)=>r(LP(n,s.base),a))]},Cs=()=>Pl(_a()),vu=(s,t,r,n)=>{const{pattern:a,keys:i}=t instanceof RegExp?{keys:!1,pattern:t}:s(t||"*",n),o=a.exec(r)||[],[l,...c]=o;return l!==void 0?[!0,(()=>{const d=i!==!1?Object.fromEntries(i.map((h,m)=>[h,c[m]])):o.groups;let u={...c};return d&&Object.assign(u,d),u})(),...n?[l]:[]]:[!1,null]},BP=s=>vu(_a().parser,s,Cs()[0]),VP=({children:s,...t})=>{var u,h;const r=_a(),n=t.hook?Ej:r;let a=n;const[i,o]=((u=t.ssrPath)==null?void 0:u.split("?"))??[];o&&(t.ssrSearch=o,t.ssrPath=i),t.hrefs=t.hrefs??((h=t.hook)==null?void 0:h.hrefs);let l=p.useRef({}),c=l.current,d=c;for(let m in n){const x=m==="base"?n[m]+(t[m]||""):t[m]||n[m];c===d&&x!==d[m]&&(l.current=d={...d}),d[m]=x,x!==n[m]&&(a=d)}return p.createElement(Dj.Provider,{value:a,children:s})},Th=({children:s,component:t},r)=>t?p.createElement(t,{params:r}):typeof s=="function"?s(r):s,UP=s=>{let t=p.useRef(Aj),r=t.current;for(const n in s)s[n]!==r[n]&&(r=s);return Object.keys(s).length===0&&(r=s),t.current=r},Ye=({path:s,nest:t,match:r,...n})=>{const a=_a(),[i]=Pl(a),[o,l,c]=r??vu(a.parser,s,i,t),d=UP({...Tl(),...l});if(!o)return null;const u=c?p.createElement(VP,{base:c},Th(n,d)):Th(n,d);return p.createElement(_j.Provider,{value:d,children:u})},Mt=p.forwardRef((s,t)=>{const r=_a(),[n,a]=Pl(r),{to:i="",href:o=i,onClick:l,asChild:c,children:d,className:u,replace:h,state:m,...x}=s,g=kj(v=>{v.ctrlKey||v.metaKey||v.altKey||v.shiftKey||v.button!==0||(l==null||l(v),v.defaultPrevented||(v.preventDefault(),a(o,s)))}),f=r.hrefs(o[0]==="~"?o.slice(1):r.base+o,r);return c&&p.isValidElement(d)?p.cloneElement(d,{onClick:g,href:f}):p.createElement("a",{...x,onClick:g,href:f,className:u!=null&&u.call?u(n===o):u,children:d,ref:t})}),Ij=s=>Array.isArray(s)?s.flatMap(t=>Ij(t&&t.type===p.Fragment?t.props.children:t)):[s],HP=({children:s,location:t})=>{const r=_a(),[n]=Pl(r);for(const a of Ij(s)){let i=0;if(p.isValidElement(a)&&(i=vu(r.parser,a.props.path,t||n,a.props.nest))[0])return p.cloneElement(a,{match:i})}return null};async function qP(s){if(!s.ok){const t=await s.text()||s.statusText;throw new Error(`${s.status}: ${t}`)}}async function ce(s,t,r){const a={method:s,headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"};r&&(a.body=JSON.stringify(r));const i=await fetch(t,a),o=i.headers.get("content-type");if(o&&o.includes("application/json"))return i;if(!i.ok){const l=await i.text();return console.error("Non-JSON response:",l.substring(0,500)),new Response(JSON.stringify({message:`Server returned non-JSON response with status ${i.status}`}),{status:i.status,headers:{"Content-Type":"application/json"}})}return i}const zP=({on401:s})=>async({queryKey:t})=>{const r=await fetch(t[0],{credentials:"include"});return s==="returnNull"&&r.status===401?null:(await qP(r),await r.json())},ut=new b2({defaultOptions:{queries:{queryFn:zP({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:1,retryDelay:1e3,onError:s=>{console.error("Query error:",s)}},mutations:{retry:1,retryDelay:1e3,onError:s=>{console.error("Mutation error:",s)}}}}),WP=5,KP=1e3,yr={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"};let gc=0;function GP(){return gc=(gc+1)%Number.MAX_VALUE,gc.toString()}const vc=new Map,QP=(s,t)=>{switch(t.type){case yr.ADD_TOAST:return{...s,toasts:[t.toast,...s.toasts].slice(0,WP)};case yr.UPDATE_TOAST:return{...s,toasts:s.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case yr.DISMISS_TOAST:{const{toastId:r}=t;return r?Ph(r):s.toasts.forEach(n=>{Ph(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case yr.REMOVE_TOAST:return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(r=>r.id!==t.toastId)}}},So=[];let Co={toasts:[]};function Ya(s){Co=QP(Co,s),So.forEach(t=>{t(Co)})}function Ph(s){if(vc.has(s))return;const t=setTimeout(()=>{vc.delete(s),Ya({type:yr.REMOVE_TOAST,toastId:s})},KP);vc.set(s,t)}function yu(){const[s,t]=p.useState(Co);return p.useEffect(()=>(So.push(t),()=>{const r=So.indexOf(t);r>-1&&So.splice(r,1)}),[s]),{...s,toast:r=>{const n=GP(),a=o=>Ya({type:yr.UPDATE_TOAST,toast:{...o,id:n}}),i=()=>Ya({type:yr.DISMISS_TOAST,toastId:n});return Ya({type:yr.ADD_TOAST,toast:{...r,id:n,open:!0,onOpenChange:o=>{o||i()}}}),{id:n,dismiss:i,update:a}},dismiss:r=>Ya({type:yr.DISMISS_TOAST,toastId:r})}}const Be=yu,js=s=>{const{toast:t}=yu();return t(s)};function Rj(s){var t,r,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s))for(t=0;t<s.length;t++)s[t]&&(r=Rj(s[t]))&&(n&&(n+=" "),n+=r);else for(t in s)s[t]&&(n&&(n+=" "),n+=t);return n}function ZP(){for(var s,t,r=0,n="";r<arguments.length;)(s=arguments[r++])&&(t=Rj(s))&&(n&&(n+=" "),n+=t);return n}const Eh=s=>typeof s=="boolean"?"".concat(s):s===0?"0":s,Dh=ZP,Vn=(s,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return Dh(s,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,o=Object.keys(a).map(d=>{const u=r==null?void 0:r[d],h=i==null?void 0:i[d];if(u===null)return null;const m=Eh(u)||Eh(h);return a[d][m]}),l=r&&Object.entries(r).reduce((d,u)=>{let[h,m]=u;return m===void 0||(d[h]=m),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,u)=>{let{class:h,className:m,...x}=u;return Object.entries(x).every(g=>{let[f,v]=g;return Array.isArray(v)?v.includes({...i,...l}[f]):{...i,...l}[f]===v})?[...d,h,m]:d},[]);return Dh(s,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};function J(...s){return N2(S2(s))}function An(s){const t=typeof s=="string"?parseFloat(s):s;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)}function YP(s){return`order-${s}`}const XP=u2,Mj=p.forwardRef(({className:s,...t},r)=>e.jsx(Ry,{ref:r,className:J("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));Mj.displayName=Ry.displayName;const JP=Vn("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Oj=p.forwardRef(({className:s,variant:t,...r},n)=>e.jsx(My,{ref:n,className:J(JP({variant:t}),s),...r}));Oj.displayName=My.displayName;const eE=p.forwardRef(({className:s,...t},r)=>e.jsx(Oy,{ref:r,className:J("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));eE.displayName=Oy.displayName;const Fj=p.forwardRef(({className:s,...t},r)=>e.jsx(Fy,{ref:r,className:J("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx($n,{className:"h-4 w-4"})}));Fj.displayName=Fy.displayName;const Lj=p.forwardRef(({className:s,...t},r)=>e.jsx(Ly,{ref:r,className:J("text-sm font-semibold",s),...t}));Lj.displayName=Ly.displayName;const $j=p.forwardRef(({className:s,...t},r)=>e.jsx($y,{ref:r,className:J("text-sm opacity-90",s),...t}));$j.displayName=$y.displayName;function tE(){const{toasts:s}=Be();return e.jsxs(XP,{children:[s.map(function({id:t,title:r,description:n,action:a,...i}){return e.jsxs(Oj,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(Lj,{children:r}),n&&e.jsx($j,{children:n})]}),a,e.jsx(Fj,{})]},t)}),e.jsx(Mj,{})]})}const ju=Vn("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),P=p.forwardRef(({className:s,variant:t,size:r,asChild:n=!1,...a},i)=>{const o=n?gl:"button";return e.jsx(o,{className:J(ju({variant:t,size:r,className:s})),ref:i,...a})});P.displayName="Button";function Ia(s){const t=p.useRef({value:s,previous:s});return p.useMemo(()=>(t.current.value!==s&&(t.current.previous=t.current.value,t.current.value=s),t.current.previous),[s])}var Ra="NavigationMenu",[bu,Bj,sE]=Vi(Ra),[rd,rE,nE]=Vi(Ra),[wu,eU]=fs(Ra,[sE,nE]),[aE,Fs]=wu(Ra),[iE,oE]=wu(Ra),Vj=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,value:n,onValueChange:a,defaultValue:i,delayDuration:o=200,skipDelayDuration:l=300,orientation:c="horizontal",dir:d,...u}=s,[h,m]=p.useState(null),x=Ge(t,E=>m(E)),g=Ln(d),f=p.useRef(0),v=p.useRef(0),y=p.useRef(0),[j,b]=p.useState(!0),[k="",S]=ms({prop:n,onChange:E=>{const D=E!=="",w=l>0;D?(window.clearTimeout(y.current),w&&b(!1)):(window.clearTimeout(y.current),y.current=window.setTimeout(()=>b(!0),l)),a==null||a(E)},defaultProp:i}),A=p.useCallback(()=>{window.clearTimeout(v.current),v.current=window.setTimeout(()=>S(""),150)},[S]),T=p.useCallback(E=>{window.clearTimeout(v.current),S(E)},[S]),C=p.useCallback(E=>{k===E?window.clearTimeout(v.current):f.current=window.setTimeout(()=>{window.clearTimeout(v.current),S(E)},o)},[k,S,o]);return p.useEffect(()=>()=>{window.clearTimeout(f.current),window.clearTimeout(v.current),window.clearTimeout(y.current)},[]),e.jsx(Hj,{scope:r,isRootMenu:!0,value:k,dir:g,orientation:c,rootNavigationMenu:h,onTriggerEnter:E=>{window.clearTimeout(f.current),j?C(E):T(E)},onTriggerLeave:()=>{window.clearTimeout(f.current),A()},onContentEnter:()=>window.clearTimeout(v.current),onContentLeave:A,onItemSelect:E=>{S(D=>D===E?"":E)},onItemDismiss:()=>S(""),children:e.jsx(Se.nav,{"aria-label":"Main","data-orientation":c,dir:g,...u,ref:x})})});Vj.displayName=Ra;var Uj="NavigationMenuSub",lE=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,value:n,onValueChange:a,defaultValue:i,orientation:o="horizontal",...l}=s,c=Fs(Uj,r),[d="",u]=ms({prop:n,onChange:a,defaultProp:i});return e.jsx(Hj,{scope:r,isRootMenu:!1,value:d,dir:c.dir,orientation:o,rootNavigationMenu:c.rootNavigationMenu,onTriggerEnter:h=>u(h),onItemSelect:h=>u(h),onItemDismiss:()=>u(""),children:e.jsx(Se.div,{"data-orientation":o,...l,ref:t})})});lE.displayName=Uj;var Hj=s=>{const{scope:t,isRootMenu:r,rootNavigationMenu:n,dir:a,orientation:i,children:o,value:l,onItemSelect:c,onItemDismiss:d,onTriggerEnter:u,onTriggerLeave:h,onContentEnter:m,onContentLeave:x}=s,[g,f]=p.useState(null),[v,y]=p.useState(new Map),[j,b]=p.useState(null);return e.jsx(aE,{scope:t,isRootMenu:r,rootNavigationMenu:n,value:l,previousValue:Ia(l),baseId:hr(),dir:a,orientation:i,viewport:g,onViewportChange:f,indicatorTrack:j,onIndicatorTrackChange:b,onTriggerEnter:as(u),onTriggerLeave:as(h),onContentEnter:as(m),onContentLeave:as(x),onItemSelect:as(c),onItemDismiss:as(d),onViewportContentChange:p.useCallback((k,S)=>{y(A=>(A.set(k,S),new Map(A)))},[]),onViewportContentRemove:p.useCallback(k=>{y(S=>S.has(k)?(S.delete(k),new Map(S)):S)},[]),children:e.jsx(bu.Provider,{scope:t,children:e.jsx(iE,{scope:t,items:v,children:o})})})},qj="NavigationMenuList",zj=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,...n}=s,a=Fs(qj,r),i=e.jsx(Se.ul,{"data-orientation":a.orientation,...n,ref:t});return e.jsx(Se.div,{style:{position:"relative"},ref:a.onIndicatorTrackChange,children:e.jsx(bu.Slot,{scope:r,children:a.isRootMenu?e.jsx(eb,{asChild:!0,children:i}):i})})});zj.displayName=qj;var Wj="NavigationMenuItem",[cE,Kj]=wu(Wj),Gj=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,value:n,...a}=s,i=hr(),o=n||i||"LEGACY_REACT_AUTO_VALUE",l=p.useRef(null),c=p.useRef(null),d=p.useRef(null),u=p.useRef(()=>{}),h=p.useRef(!1),m=p.useCallback((g="start")=>{if(l.current){u.current();const f=ad(l.current);f.length&&Cu(g==="start"?f:f.reverse())}},[]),x=p.useCallback(()=>{if(l.current){const g=ad(l.current);g.length&&(u.current=gE(g))}},[]);return e.jsx(cE,{scope:r,value:o,triggerRef:c,contentRef:l,focusProxyRef:d,wasEscapeCloseRef:h,onEntryKeyDown:m,onFocusProxyEnter:m,onRootContentClose:x,onContentFocusOutside:x,children:e.jsx(Se.li,{...a,ref:t})})});Gj.displayName=Wj;var nd="NavigationMenuTrigger",Qj=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,disabled:n,...a}=s,i=Fs(nd,s.__scopeNavigationMenu),o=Kj(nd,s.__scopeNavigationMenu),l=p.useRef(null),c=Ge(l,o.triggerRef,t),d=sb(i.baseId,o.value),u=rb(i.baseId,o.value),h=p.useRef(!1),m=p.useRef(!1),x=o.value===i.value;return e.jsxs(e.Fragment,{children:[e.jsx(bu.ItemSlot,{scope:r,value:o.value,children:e.jsx(tb,{asChild:!0,children:e.jsx(Se.button,{id:d,disabled:n,"data-disabled":n?"":void 0,"data-state":ku(x),"aria-expanded":x,"aria-controls":u,...a,ref:c,onPointerEnter:ge(s.onPointerEnter,()=>{m.current=!1,o.wasEscapeCloseRef.current=!1}),onPointerMove:ge(s.onPointerMove,Uo(()=>{n||m.current||o.wasEscapeCloseRef.current||h.current||(i.onTriggerEnter(o.value),h.current=!0)})),onPointerLeave:ge(s.onPointerLeave,Uo(()=>{n||(i.onTriggerLeave(),h.current=!1)})),onClick:ge(s.onClick,()=>{i.onItemSelect(o.value),m.current=x}),onKeyDown:ge(s.onKeyDown,g=>{const v={horizontal:"ArrowDown",vertical:i.dir==="rtl"?"ArrowLeft":"ArrowRight"}[i.orientation];x&&g.key===v&&(o.onEntryKeyDown(),g.preventDefault())})})})}),x&&e.jsxs(e.Fragment,{children:[e.jsx(By,{"aria-hidden":!0,tabIndex:0,ref:o.focusProxyRef,onFocus:g=>{const f=o.contentRef.current,v=g.relatedTarget,y=v===l.current,j=f==null?void 0:f.contains(v);(y||!j)&&o.onFocusProxyEnter(y?"start":"end")}}),i.viewport&&e.jsx("span",{"aria-owns":u})]})]})});Qj.displayName=nd;var dE="NavigationMenuLink",Ah="navigationMenu.linkSelect",uE=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,active:n,onSelect:a,...i}=s;return e.jsx(tb,{asChild:!0,children:e.jsx(Se.a,{"data-active":n?"":void 0,"aria-current":n?"page":void 0,...i,ref:t,onClick:ge(s.onClick,o=>{const l=o.target,c=new CustomEvent(Ah,{bubbles:!0,cancelable:!0});if(l.addEventListener(Ah,d=>a==null?void 0:a(d),{once:!0}),ph(l,c),!c.defaultPrevented&&!o.metaKey){const d=new CustomEvent(ko,{bubbles:!0,cancelable:!0});ph(l,d)}},{checkForDefaultPrevented:!1})})})});uE.displayName=dE;var Nu="NavigationMenuIndicator",Zj=p.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=Fs(Nu,s.__scopeNavigationMenu),i=!!a.value;return a.indicatorTrack?y2.createPortal(e.jsx(ds,{present:r||i,children:e.jsx(mE,{...n,ref:t})}),a.indicatorTrack):null});Zj.displayName=Nu;var mE=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,...n}=s,a=Fs(Nu,r),i=Bj(r),[o,l]=p.useState(null),[c,d]=p.useState(null),u=a.orientation==="horizontal",h=!!a.value;p.useEffect(()=>{var f;const g=(f=i().find(v=>v.value===a.value))==null?void 0:f.ref.current;g&&l(g)},[i,a.value]);const m=()=>{o&&d({size:u?o.offsetWidth:o.offsetHeight,offset:u?o.offsetLeft:o.offsetTop})};return id(o,m),id(a.indicatorTrack,m),c?e.jsx(Se.div,{"aria-hidden":!0,"data-state":h?"visible":"hidden","data-orientation":a.orientation,...n,ref:t,style:{position:"absolute",...u?{left:0,width:c.size+"px",transform:`translateX(${c.offset}px)`}:{top:0,height:c.size+"px",transform:`translateY(${c.offset}px)`},...n.style}}):null}),xa="NavigationMenuContent",Yj=p.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=Fs(xa,s.__scopeNavigationMenu),i=Kj(xa,s.__scopeNavigationMenu),o=Ge(i.contentRef,t),l=i.value===a.value,c={value:i.value,triggerRef:i.triggerRef,focusProxyRef:i.focusProxyRef,wasEscapeCloseRef:i.wasEscapeCloseRef,onContentFocusOutside:i.onContentFocusOutside,onRootContentClose:i.onRootContentClose,...n};return a.viewport?e.jsx(hE,{forceMount:r,...c,ref:o}):e.jsx(ds,{present:r||l,children:e.jsx(Xj,{"data-state":ku(l),...c,ref:o,onPointerEnter:ge(s.onPointerEnter,a.onContentEnter),onPointerLeave:ge(s.onPointerLeave,Uo(a.onContentLeave)),style:{pointerEvents:!l&&a.isRootMenu?"none":void 0,...c.style}})})});Yj.displayName=xa;var hE=p.forwardRef((s,t)=>{const r=Fs(xa,s.__scopeNavigationMenu),{onViewportContentChange:n,onViewportContentRemove:a}=r;return Ss(()=>{n(s.value,{ref:t,...s})},[s,t,n]),Ss(()=>()=>a(s.value),[s.value,a]),null}),ko="navigationMenu.rootContentDismiss",Xj=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,value:n,triggerRef:a,focusProxyRef:i,wasEscapeCloseRef:o,onRootContentClose:l,onContentFocusOutside:c,...d}=s,u=Fs(xa,r),h=p.useRef(null),m=Ge(h,t),x=sb(u.baseId,n),g=rb(u.baseId,n),f=Bj(r),v=p.useRef(null),{onItemDismiss:y}=u;p.useEffect(()=>{const b=h.current;if(u.isRootMenu&&b){const k=()=>{var S;y(),l(),b.contains(document.activeElement)&&((S=a.current)==null||S.focus())};return b.addEventListener(ko,k),()=>b.removeEventListener(ko,k)}},[u.isRootMenu,s.value,a,y,l]);const j=p.useMemo(()=>{const k=f().map(D=>D.value);u.dir==="rtl"&&k.reverse();const S=k.indexOf(u.value),A=k.indexOf(u.previousValue),T=n===u.value,C=A===k.indexOf(n);if(!T&&!C)return v.current;const E=(()=>{if(S!==A){if(T&&A!==-1)return S>A?"from-end":"from-start";if(C&&S!==-1)return S>A?"to-start":"to-end"}return null})();return v.current=E,E},[u.previousValue,u.value,u.dir,f,n]);return e.jsx(eb,{asChild:!0,children:e.jsx(vl,{id:g,"aria-labelledby":x,"data-motion":j,"data-orientation":u.orientation,...d,ref:m,disableOutsidePointerEvents:!1,onDismiss:()=>{var k;const b=new Event(ko,{bubbles:!0,cancelable:!0});(k=h.current)==null||k.dispatchEvent(b)},onFocusOutside:ge(s.onFocusOutside,b=>{var S;c();const k=b.target;(S=u.rootNavigationMenu)!=null&&S.contains(k)&&b.preventDefault()}),onPointerDownOutside:ge(s.onPointerDownOutside,b=>{var T;const k=b.target,S=f().some(C=>{var E;return(E=C.ref.current)==null?void 0:E.contains(k)}),A=u.isRootMenu&&((T=u.viewport)==null?void 0:T.contains(k));(S||A||!u.isRootMenu)&&b.preventDefault()}),onKeyDown:ge(s.onKeyDown,b=>{var A;const k=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!k){const T=ad(b.currentTarget),C=document.activeElement,E=T.findIndex(N=>N===C),w=b.shiftKey?T.slice(0,E).reverse():T.slice(E+1,T.length);Cu(w)?b.preventDefault():(A=i.current)==null||A.focus()}}),onEscapeKeyDown:ge(s.onEscapeKeyDown,b=>{o.current=!0})})})}),Su="NavigationMenuViewport",Jj=p.forwardRef((s,t)=>{const{forceMount:r,...n}=s,i=!!Fs(Su,s.__scopeNavigationMenu).value;return e.jsx(ds,{present:r||i,children:e.jsx(pE,{...n,ref:t})})});Jj.displayName=Su;var pE=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,children:n,...a}=s,i=Fs(Su,r),o=Ge(t,i.onViewportChange),l=oE(xa,s.__scopeNavigationMenu),[c,d]=p.useState(null),[u,h]=p.useState(null),m=c?(c==null?void 0:c.width)+"px":void 0,x=c?(c==null?void 0:c.height)+"px":void 0,g=!!i.value,f=g?i.value:i.previousValue;return id(u,()=>{u&&d({width:u.offsetWidth,height:u.offsetHeight})}),e.jsx(Se.div,{"data-state":ku(g),"data-orientation":i.orientation,...a,ref:o,style:{pointerEvents:!g&&i.isRootMenu?"none":void 0,"--radix-navigation-menu-viewport-width":m,"--radix-navigation-menu-viewport-height":x,...a.style},onPointerEnter:ge(s.onPointerEnter,i.onContentEnter),onPointerLeave:ge(s.onPointerLeave,Uo(i.onContentLeave)),children:Array.from(l.items).map(([y,{ref:j,forceMount:b,...k}])=>{const S=f===y;return e.jsx(ds,{present:b||S,children:e.jsx(Xj,{...k,ref:m2(j,A=>{S&&A&&h(A)})})},y)})})}),fE="FocusGroup",eb=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,...n}=s,a=Fs(fE,r);return e.jsx(rd.Provider,{scope:r,children:e.jsx(rd.Slot,{scope:r,children:e.jsx(Se.div,{dir:a.dir,...n,ref:t})})})}),_h=["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"],xE="FocusGroupItem",tb=p.forwardRef((s,t)=>{const{__scopeNavigationMenu:r,...n}=s,a=rE(r),i=Fs(xE,r);return e.jsx(rd.ItemSlot,{scope:r,children:e.jsx(Se.button,{...n,ref:t,onKeyDown:ge(s.onKeyDown,o=>{if(["Home","End",..._h].includes(o.key)){let c=a().map(h=>h.ref.current);if([i.dir==="rtl"?"ArrowRight":"ArrowLeft","ArrowUp","End"].includes(o.key)&&c.reverse(),_h.includes(o.key)){const h=c.indexOf(o.currentTarget);c=c.slice(h+1)}setTimeout(()=>Cu(c)),o.preventDefault()}})})})});function ad(s){const t=[],r=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Cu(s){const t=document.activeElement;return s.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}function gE(s){return s.forEach(t=>{t.dataset.tabindex=t.getAttribute("tabindex")||"",t.setAttribute("tabindex","-1")}),()=>{s.forEach(t=>{const r=t.dataset.tabindex;t.setAttribute("tabindex",r)})}}function id(s,t){const r=as(t);Ss(()=>{let n=0;if(s){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return a.observe(s),()=>{window.cancelAnimationFrame(n),a.unobserve(s)}}},[s,r])}function ku(s){return s?"open":"closed"}function sb(s,t){return`${s}-trigger-${t}`}function rb(s,t){return`${s}-content-${t}`}function Uo(s){return t=>t.pointerType==="mouse"?s(t):void 0}var nb=Vj,ab=zj,vE=Gj,ib=Qj,ob=Zj,lb=Yj,cb=Jj;const db=p.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(nb,{ref:n,className:J("relative z-10 flex max-w-max flex-1 items-center justify-center",s),...r,children:[t,e.jsx(pb,{})]}));db.displayName=nb.displayName;const ub=p.forwardRef(({className:s,...t},r)=>e.jsx(ab,{ref:r,className:J("group flex flex-1 list-none items-center justify-center space-x-1",s),...t}));ub.displayName=ab.displayName;const yE=vE,jE=Vn("group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"),mb=p.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(ib,{ref:n,className:J(jE(),"group",s),...r,children:[t," ",e.jsx(ns,{className:"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180","aria-hidden":"true"})]}));mb.displayName=ib.displayName;const hb=p.forwardRef(({className:s,...t},r)=>e.jsx(lb,{ref:r,className:J("left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",s),...t}));hb.displayName=lb.displayName;const pb=p.forwardRef(({className:s,...t},r)=>e.jsx("div",{className:J("absolute left-0 top-full flex justify-center"),children:e.jsx(cb,{className:J("origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",s),ref:r,...t})}));pb.displayName=cb.displayName;const bE=p.forwardRef(({className:s,...t},r)=>e.jsx(ob,{ref:r,className:J("top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",s),...t,children:e.jsx("div",{className:"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md"})}));bE.displayName=ob.displayName;const wE=Vn("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-600"}},defaultVariants:{variant:"default"}});function ue({className:s,variant:t,...r}){return e.jsx("div",{className:J(wE({variant:t}),s),...r})}const NE=()=>{const[s,t]=p.useState({authenticated:!1,user:null,loading:!0}),r=async()=>{try{const o=await(await fetch("/api/auth/status")).json();t({authenticated:o.authenticated,user:o.authenticated?o.user:null,loading:!1})}catch(i){console.error("Error checking authentication status:",i),t({authenticated:!1,user:null,loading:!1})}};p.useEffect(()=>{r()},[]);const n=()=>{window.addEventListener("message",u);const i=500,o=350,l=window.screen.width/2-o/2,c=window.screen.height/2-i/2,d=window.open(`https://replit.com/auth_with_repl_site?domain=${location.host}`,"_blank",`modal=yes,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,width=${o},height=${i},top=${c},left=${l}`);function u(h){h.data==="auth_complete"&&(window.removeEventListener("message",u),d==null||d.close(),r())}},a=async()=>{window.location.href="/__replauthlogout"};return{authenticated:s.authenticated,user:s.user,loading:s.loading,login:n,logout:a,checkAuthStatus:r}},fb=p.createContext(void 0),SE=({children:s})=>{const t=NE();return e.jsx(fb.Provider,{value:t,children:s})},CE=()=>{const s=p.useContext(fb);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},yc=768;function kE(){const[s,t]=p.useState(void 0);return p.useEffect(()=>{const r=window.matchMedia(`(max-width: ${yc-1}px)`),n=()=>{t(window.innerWidth<yc)};return r.addEventListener("change",n),t(window.innerWidth<yc),()=>r.removeEventListener("change",n)},[]),!!s}const TE=kE,Ih=[{title:"Dashboard",path:"/dashboard",subItems:[{title:"Overview",path:"/dashboard"},{title:"Inventory",path:"/inventory"},{title:"Inventory Tracking",path:"/inventory-tracking"}]},{title:"Orders",path:"/orders",subItems:[{title:"Orders List",path:"/orders"},{title:"Order Progress",path:"/order-progress/1"},{title:"Payment Links",path:"/payment-links"}]},{title:"Production",path:"/production",subItems:[{title:"Kanban Board",path:"/production"},{title:"Materials Orders",path:"/materials"},{title:"Materials Pick List",path:"/materials-pick-list"},{title:"Kanban Test",path:"/kanban-test"}]},{title:"POS",path:"/",subItems:[{title:"New Order",path:"/"},{title:"Cost Estimator",path:"/cost-estimator"},{title:"Mat Options",path:"/mat-test"},{title:"Mat Border Demo",path:"/mat-border-demo"},{title:"Pricing",path:"/pricing"},{title:"Pricing Monitor",path:"/pricing-monitor"},{title:"Larson Optimizer",path:"/larson-optimizer"},{title:"Frame Education",path:"/frame-education"}]},{title:"Integration",path:"/hub",subItems:[{title:"Hub",path:"/hub"},{title:"Webhook",path:"/webhook-integration"},{title:"Vendor Settings",path:"/vendor-settings"},{title:"System Health",path:"/system-health"}]},{title:"Communications",path:"/voice-calls",subItems:[{title:"Voice Calls",path:"/voice-calls"},{title:"Automated Notifications",path:"/automated-notifications"},{title:"Notifications",path:"/notifications"},{title:"Customers",path:"/customers"},{title:"Customer Portal",path:"/customer-portal"}]}];function PE({darkMode:s,toggleTheme:t}){const[r]=Cs();TE();const[n,a]=p.useState(!1),[i,o]=p.useState(0),{authenticated:l,user:c}=CE(),d=()=>{a(!n)};return p.useEffect(()=>{a(!1)},[r]),p.useEffect(()=>{const u=localStorage.getItem("cart");if(u)try{const m=JSON.parse(u);o(Array.isArray(m)?m.length:0)}catch(m){console.error("Error parsing cart from localStorage:",m),o(0)}const h=m=>{if(m.key==="cart")try{const x=m.newValue?JSON.parse(m.newValue):[];o(Array.isArray(x)?x.length:0)}catch(x){console.error("Error parsing cart from storage event:",x)}};return window.addEventListener("storage",h),()=>{window.removeEventListener("storage",h)}},[]),e.jsxs("header",{className:"bg-background border-b dark:border-gray-800 fixed top-0 left-0 w-full z-50",children:[e.jsxs("div",{className:"container mx-auto px-3 lg:px-4 h-14 lg:h-16 flex items-center justify-between",children:[e.jsx(Mt,{href:"/dashboard",className:"flex items-center space-x-2 cursor-pointer",children:e.jsx("span",{className:"font-bold text-xl text-foreground",children:"Jay's Frames"})}),e.jsx("div",{className:"hidden md:flex",children:e.jsx(db,{children:e.jsx(ub,{children:Ih.map((u,h)=>e.jsxs(yE,{children:[e.jsx(mb,{className:"text-foreground font-semibold",children:u.title}),e.jsx(hb,{children:e.jsx("ul",{className:"grid w-[200px] gap-2 p-2",children:u.subItems.map((m,x)=>e.jsx("li",{children:e.jsx(Mt,{href:m.path,children:e.jsx("a",{className:J("block select-none rounded-md p-2 hover:bg-accent hover:text-accent-foreground cursor-pointer",r===m.path&&"bg-accent/50 text-accent-foreground"),children:m.title})})},x))})})]},h))})})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{variant:"ghost",size:"icon",onClick:t,"aria-label":"Toggle theme",className:"text-foreground hover:text-foreground",children:s?e.jsx(Kc,{className:"h-5 w-5 text-foreground"}):e.jsx(aj,{className:"h-5 w-5 text-foreground"})}),e.jsx(P,{variant:"ghost",size:"icon",onClick:()=>window.location.href="/checkout/cart",className:"text-foreground hover:text-foreground",children:e.jsxs("div",{className:"relative",children:[e.jsx(wl,{className:"h-5 w-5 text-foreground"}),i>0&&e.jsx(ue,{className:"absolute -top-2 -right-2 h-5 w-5 flex items-center justify-center p-0 text-[0.7rem]",children:i})]})}),l&&c&&e.jsx("span",{className:"text-sm hidden md:inline-block text-foreground",children:c.name||c.username||"User"}),e.jsx(P,{className:"md:hidden text-foreground hover:text-foreground hover:bg-accent",variant:"ghost",size:"icon",onClick:d,"aria-label":"Toggle menu",children:n?e.jsx($n,{className:"h-6 w-6 text-foreground"}):e.jsx(ij,{className:"h-6 w-6 text-foreground"})})]})]}),n&&e.jsx("div",{className:"md:hidden absolute top-14 lg:top-16 left-0 w-full bg-background dark:bg-background border-b border-border shadow-lg z-40",children:e.jsxs("nav",{className:"container mx-auto px-4 py-4 max-h-[calc(100vh-4rem)] overflow-y-auto",children:[Ih.map((u,h)=>e.jsxs("div",{className:"mb-4",children:[e.jsx(Mt,{href:u.path,children:e.jsx("div",{className:"font-semibold text-lg mb-2 text-foreground hover:text-primary cursor-pointer py-2 border-b border-border",children:u.title})}),e.jsx("div",{className:"pl-4 space-y-1",children:u.subItems.map((m,x)=>e.jsx(Mt,{href:m.path,children:e.jsx("div",{className:J("py-2 text-sm font-medium hover:text-primary transition-colors cursor-pointer rounded-md px-2 hover:bg-accent",r===m.path?"text-primary bg-accent":"text-foreground"),children:m.title})},x))})]},h)),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 space-y-2",children:[e.jsx(Mt,{href:"/customers",className:"text-foreground hover:text-primary px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Customers"}),e.jsx(Mt,{href:"/frame-education",children:e.jsx("div",{className:J("py-2 px-2 font-medium hover:text-primary transition-colors cursor-pointer rounded-md hover:bg-accent",r==="/frame-education"?"text-primary bg-accent":"text-foreground"),children:"Frame Education"})}),e.jsx(Mt,{href:"/notifications",className:"text-foreground hover:text-primary px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Notifications"}),e.jsxs("div",{className:"py-3 px-2 flex items-center justify-between bg-muted rounded-md",children:[e.jsx("span",{className:"font-medium text-foreground",children:"Cart Items:"}),e.jsx("span",{className:"px-3 py-1 bg-primary/10 text-primary rounded-full text-sm font-semibold",children:i})]}),l&&c&&e.jsx("div",{className:"py-3 px-2 bg-muted rounded-md",children:e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Welcome, ",c.name||c.username||"User"]})})]})]})})]})}async function xb(){try{return console.log("Loading static matboard data to prevent application freezing..."),[]}catch(s){return console.error("Error fetching Crescent matboards:",s),[]}}function EE(s){return console.log("Converting Larson matboards to MatColor format:"),s.map(t=>{t.hex_color||console.warn(`Missing hex_color for matboard ${t.id}: ${t.name}`);const r={id:t.id,name:t.name,color:t.hex_color||"#FFFFFF",price:t.price,manufacturer:t.manufacturer,code:t.code||null,description:t.description||null,category:t.category||null};return s.indexOf(t)<3&&console.log(`Matboard ${t.id} converted:`,{original:t,converted:r}),r})}const ci=[{id:"white",name:"White",color:"#FFFFFF",price:"0.02",manufacturer:"Basic",code:"WHT",description:"Pure white mat board",category:"Standard"},{id:"black",name:"Black",color:"#2C2C2C",price:"0.025",manufacturer:"Basic",code:"BLK",description:"Deep black mat board",category:"Standard"},{id:"grey",name:"Grey",color:"#ADADAD",price:"0.02",manufacturer:"Basic",code:"GRY",description:"Neutral grey mat board",category:"Standard"},{id:"beige",name:"Beige",color:"#F5F5DC",price:"0.02",manufacturer:"Basic",code:"BGE",description:"Soft beige mat board",category:"Standard"}],Xa=[{id:"crescent-white",name:"Bright White",color:"#FFFFFF",price:"0.025",manufacturer:"Crescent",code:"S100",description:"Bright white conservation mat board",category:"Whites"},{id:"crescent-cream",name:"Cream",color:"#FFF8E1",price:"0.025",manufacturer:"Crescent",code:"S101",description:"Cream white conservation mat board",category:"Whites"},{id:"crescent-antique",name:"Antique White",color:"#F5F1E6",price:"0.025",manufacturer:"Crescent",code:"S102",description:"Subtle antique white tone",category:"Whites"},{id:"crescent-stone",name:"Stone",color:"#E0DCCC",price:"0.027",manufacturer:"Crescent",code:"S200",description:"Light stone grey conservation mat",category:"Neutrals"},{id:"crescent-fog",name:"Fog",color:"#D6D6D6",price:"0.027",manufacturer:"Crescent",code:"S201",description:"Subtle fog grey conservation mat",category:"Neutrals"},{id:"crescent-granite",name:"Granite",color:"#A9A9A9",price:"0.027",manufacturer:"Crescent",code:"S202",description:"Darker granite grey tone",category:"Neutrals"},{id:"crescent-colonial-blue",name:"Colonial Blue",color:"#B5C7D3",price:"0.029",manufacturer:"Crescent",code:"S300",description:"Subtle colonial blue conservation mat",category:"Blues"},{id:"crescent-wedgewood",name:"Wedgewood",color:"#6E99C0",price:"0.029",manufacturer:"Crescent",code:"S301",description:"Classic wedgewood blue conservation mat",category:"Blues"},{id:"crescent-ultramarine",name:"Ultramarine",color:"#4166B0",price:"0.029",manufacturer:"Crescent",code:"S302",description:"Deep ultramarine blue conservation mat",category:"Blues"},{id:"crescent-sage",name:"Sage",color:"#BCCCBA",price:"0.029",manufacturer:"Crescent",code:"S400",description:"Soft sage green conservation mat",category:"Greens"},{id:"crescent-celadon",name:"Celadon",color:"#9CB084",price:"0.029",manufacturer:"Crescent",code:"S401",description:"Classic celadon green conservation mat",category:"Greens"},{id:"crescent-forest",name:"Forest",color:"#4A6741",price:"0.029",manufacturer:"Crescent",code:"S402",description:"Deep forest green conservation mat",category:"Greens"},{id:"crescent-sand",name:"Sand",color:"#E6D7B8",price:"0.027",manufacturer:"Crescent",code:"S500",description:"Light sand beige conservation mat",category:"Earth Tones"},{id:"crescent-chamois",name:"Chamois",color:"#D9BC8C",price:"0.027",manufacturer:"Crescent",code:"S501",description:"Warm chamois tan conservation mat",category:"Earth Tones"},{id:"crescent-chestnut",name:"Chestnut",color:"#A67B5B",price:"0.027",manufacturer:"Crescent",code:"S502",description:"Rich chestnut brown conservation mat",category:"Earth Tones"},{id:"crescent-pale-rose",name:"Pale Rose",color:"#F0D4D4",price:"0.029",manufacturer:"Crescent",code:"S600",description:"Subtle pale rose conservation mat",category:"Warm Tones"},{id:"crescent-dusty-rose",name:"Dusty Rose",color:"#D4A9A9",price:"0.029",manufacturer:"Crescent",code:"S601",description:"Classic dusty rose conservation mat",category:"Warm Tones"},{id:"crescent-rust",name:"Rust",color:"#B56A55",price:"0.029",manufacturer:"Crescent",code:"S602",description:"Deep rust red conservation mat",category:"Warm Tones"},{id:"crescent-black",name:"Raven Black",color:"#1A1A1A",price:"0.03",manufacturer:"Crescent",code:"S700",description:"Deep black conservation mat board",category:"Black"}];let El=[...ci,...Xa];const DE=async()=>{if(typeof window>"u"){console.log("Skipping Supabase fetch on server-side");return}try{console.log("Fetching Crescent matboards from Larson Juhl catalog...");const s=await xb();if(s&&s.length>0){console.log("Converting API matboards to MatColor format");const t=s.map(n=>({id:n.id,name:n.name,color:n.hex_color||"#FFFFFF",price:n.price,manufacturer:n.manufacturer,code:n.code||null,description:n.description||null,category:n.category||null}));El=[...ci,...t],console.log(`Loaded and converted ${s.length} Crescent matboards from Larson Juhl catalog`)}else console.log("No Crescent matboards found in Larson Juhl catalog or empty response. Using static fallback data.")}catch(s){console.error("Failed to load Crescent matboards:",s),console.log("Using static Crescent matboard catalog as fallback.")}};typeof window<"u"&&DE();const AE=s=>El.find(t=>t.id===s),_E=s=>El.filter(t=>t.category===s),IE=()=>{const s=new Set;return El.forEach(t=>{t.category&&s.add(t.category)}),Array.from(s)},To=[{id:"none",name:"No Glass",description:"No glass protection",price:"0.00"},{id:"regular",name:"Regular Glass",description:"Standard protection",price:"0.08"},{id:"uv",name:"Museum Glass",description:"Museum non-glare",price:"0.45"},{id:"museum",name:"Conservation Glass",description:"Premium UV protection",price:"0.25"},{id:"regular-acrylic",name:"Regular Acrylic",description:"Standard acrylic glazing",price:"0.12"},{id:"conservation-clear-acrylic",name:"Conservation Clear Acrylic",description:"UV filtering acrylic glazing",price:"0.35"},{id:"optium-acrylic",name:"Optium Acrylic",description:"Premium non-glare acrylic",price:"0.45"}],Rh=s=>To.find(t=>t.id===s),Mh=[{id:"float-mount",name:"Float Mount",description:"Artwork appears to float",price:"50.00"},{id:"glass-float",name:"Glass Float",description:"Suspended between glass",price:"55.00"},{id:"shadowbox",name:"Shadowbox",description:"For 3D objects",price:"65.00"},{id:"labor-30min",name:"Additional Labor (30 min)",description:"Custom work",price:"30.00"},{id:"labor-1hour",name:"Additional Labor (1 hour)",description:"Custom work",price:"55.00"}];function RE(s){return s>=40?2.2:s>=25?2.4:s>=15?2.6:s>=10?2.8:s>=6?3:s>=4?3.2:s>=2?3.5:4}function od(s,t,r,n){const a=s+r*2,i=t+r*2,c=(a+i)/12*n,d=RE(c);return c*d}function ld(s,t,r,n){const a=s+r*2,i=t+r*2,o=a+i,l=o*n*2.5;let c=5.5;o<=24?c=5.5:o<=36?c=5:o<=50?c=4.5:o<=68?c=4.2:o<=88?c=3.8:o<=108?c=3.5:c=3.2;const d=ME(o);return l*c+d}function cd(s,t,r,n){const a=s+r*2,i=t+r*2,o=a+i,l=o*n;let c=4;return o<=24?c=4:o<=36?c=3.8:o<=50?c=3.5:o<=68?c=3.2:o<=88?c=3:o<=108?c=2.8:c=2.5,l*c}function ME(s){let t=15;return s<=24?t=15:s<=36?t=20:s<=50?t=25:s<=68?t=35:s<=88?t=45:s<=108?t=55:t=65,t}function OE(s,t,r){const n=s+r*2,a=t+r*2,i=n+a;let o=25;return i<=24?o=25:i<=36?o=30:i<=50?o=35:i<=68?o=45:i<=88?o=55:i<=108?o=65:o=80,o}function dd(s,t,r,n){const a=s+r*2,i=t+r*2,d=a*i*n*.3*2.5;return Math.max(d,5)}function FE(s){let t=.15;return s<100?t=.2:s<250?t=.15:s<500?t=.12:t=.1,s*t}const LE=({selectedServices:s,onChange:t})=>{var i;const r=o=>{const l=Mh.find(d=>d.id===o);if(!l)return;const c=s.some(d=>d.id===o);t(c?s.filter(d=>d.id!==o):[...s,l])},n=o=>{const l=o.target.value,c=s.filter(d=>d.id!=="labor-30min"&&d.id!=="labor-1hour");if(l==="0")t(c);else{const d=Mh.find(u=>u.id===l);d&&t([...c,d])}},a=((i=s.find(o=>o.id==="labor-30min"||o.id==="labor-1hour"))==null?void 0:i.id)||"0";return e.jsxs("div",{className:"bg-white dark:bg-dark-cardBg rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 header-underline",children:"Special Services"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border border-light-border dark:border-dark-border rounded-lg p-3 cursor-pointer hover:border-primary transition-colors",onClick:()=>r("float-mount"),children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Float Mount"}),e.jsx("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:"Artwork appears to float"})]}),e.jsx("div",{children:e.jsx("input",{type:"checkbox",id:"float-mount",className:"h-4 w-4 text-primary border-gray-300 rounded",checked:s.some(o=>o.id==="float-mount"),onChange:()=>r("float-mount")})})]}),e.jsx("div",{className:"mt-2 text-sm text-light-textSecondary dark:text-dark-textSecondary",children:"+$35.00"})]}),e.jsxs("div",{className:"border border-light-border dark:border-dark-border rounded-lg p-3 cursor-pointer hover:border-primary transition-colors",onClick:()=>r("glass-float"),children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Glass Float"}),e.jsx("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:"Suspended between glass"})]}),e.jsx("div",{children:e.jsx("input",{type:"checkbox",id:"glass-float",className:"h-4 w-4 text-primary border-gray-300 rounded",checked:s.some(o=>o.id==="glass-float"),onChange:()=>r("glass-float")})})]}),e.jsx("div",{className:"mt-2 text-sm text-light-textSecondary dark:text-dark-textSecondary",children:"+$55.00"})]}),e.jsxs("div",{className:"border border-light-border dark:border-dark-border rounded-lg p-3 cursor-pointer hover:border-primary transition-colors",onClick:()=>r("shadowbox"),children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Shadowbox"}),e.jsx("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:"For 3D objects"})]}),e.jsx("div",{children:e.jsx("input",{type:"checkbox",id:"shadowbox",className:"h-4 w-4 text-primary border-gray-300 rounded",checked:s.some(o=>o.id==="shadowbox"),onChange:()=>r("shadowbox")})})]}),e.jsx("div",{className:"mt-2 text-sm text-light-textSecondary dark:text-dark-textSecondary",children:"+$65.00"})]}),e.jsx("div",{className:"border border-light-border dark:border-dark-border rounded-lg p-3 cursor-pointer hover:border-primary transition-colors",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Additional Labor"}),e.jsx("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:"Custom work"})]}),e.jsx("div",{children:e.jsxs("select",{className:"text-sm border border-light-border dark:border-dark-border rounded bg-light-bg dark:bg-dark-bg p-1",value:a,onChange:n,children:[e.jsx("option",{value:"0",children:"None"}),e.jsx("option",{value:"labor-30min",children:"30 min (+$30)"}),e.jsx("option",{value:"labor-1hour",children:"1 hour (+$55)"})]})})]})})]})]})};var Tu="Checkbox",[$E,tU]=fs(Tu),[BE,VE]=$E(Tu),gb=p.forwardRef((s,t)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:d,form:u,...h}=s,[m,x]=p.useState(null),g=Ge(t,k=>x(k)),f=p.useRef(!1),v=m?u||!!m.closest("form"):!0,[y=!1,j]=ms({prop:a,defaultProp:i,onChange:d}),b=p.useRef(y);return p.useEffect(()=>{const k=m==null?void 0:m.form;if(k){const S=()=>j(b.current);return k.addEventListener("reset",S),()=>k.removeEventListener("reset",S)}},[m,j]),e.jsxs(BE,{scope:r,state:y,disabled:l,children:[e.jsx(Se.button,{type:"button",role:"checkbox","aria-checked":Lr(y)?"mixed":y,"aria-required":o,"data-state":jb(y),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:g,onKeyDown:ge(s.onKeyDown,k=>{k.key==="Enter"&&k.preventDefault()}),onClick:ge(s.onClick,k=>{j(S=>Lr(S)?!0:!S),v&&(f.current=k.isPropagationStopped(),f.current||k.stopPropagation())})}),v&&e.jsx(UE,{control:m,bubbles:!f.current,name:n,value:c,checked:y,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"},defaultChecked:Lr(i)?!1:i})]})});gb.displayName=Tu;var vb="CheckboxIndicator",yb=p.forwardRef((s,t)=>{const{__scopeCheckbox:r,forceMount:n,...a}=s,i=VE(vb,r);return e.jsx(ds,{present:n||Lr(i.state)||i.state===!0,children:e.jsx(Se.span,{"data-state":jb(i.state),"data-disabled":i.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...s.style}})})});yb.displayName=vb;var UE=s=>{const{control:t,checked:r,bubbles:n=!0,defaultChecked:a,...i}=s,o=p.useRef(null),l=Ia(r),c=yl(t);p.useEffect(()=>{const u=o.current,h=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==r&&x){const g=new Event("click",{bubbles:n});u.indeterminate=Lr(r),x.call(u,Lr(r)?!1:r),u.dispatchEvent(g)}},[l,r,n]);const d=p.useRef(Lr(r)?!1:r);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??d.current,...i,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Lr(s){return s==="indeterminate"}function jb(s){return Lr(s)?"indeterminate":s?"checked":"unchecked"}var bb=gb,HE=yb;const os=p.forwardRef(({className:s,...t},r)=>e.jsx(bb,{ref:r,className:J("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(HE,{className:J("flex items-center justify-center text-current"),children:e.jsx(ls,{className:"h-4 w-4"})})}));os.displayName=bb.displayName;const U=p.forwardRef(({className:s,type:t,...r},n)=>e.jsx("input",{type:t,className:J("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:n,...r}));U.displayName="Input";var Dl={},wb={L:1,M:0,Q:3,H:2},Nb={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},qE=Nb;function Sb(s){this.mode=qE.MODE_8BIT_BYTE,this.data=s}Sb.prototype={getLength:function(s){return this.data.length},write:function(s){for(var t=0;t<this.data.length;t++)s.put(this.data.charCodeAt(t),8)}};var zE=Sb,co=wb;function nr(s,t){this.totalCount=s,this.dataCount=t}nr.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];nr.getRSBlocks=function(s,t){var r=nr.getRsBlockTable(s,t);if(r==null)throw new Error("bad rs block @ typeNumber:"+s+"/errorCorrectLevel:"+t);for(var n=r.length/3,a=new Array,i=0;i<n;i++)for(var o=r[i*3+0],l=r[i*3+1],c=r[i*3+2],d=0;d<o;d++)a.push(new nr(l,c));return a};nr.getRsBlockTable=function(s,t){switch(t){case co.L:return nr.RS_BLOCK_TABLE[(s-1)*4+0];case co.M:return nr.RS_BLOCK_TABLE[(s-1)*4+1];case co.Q:return nr.RS_BLOCK_TABLE[(s-1)*4+2];case co.H:return nr.RS_BLOCK_TABLE[(s-1)*4+3];default:return}};var WE=nr;function Cb(){this.buffer=new Array,this.length=0}Cb.prototype={get:function(s){var t=Math.floor(s/8);return(this.buffer[t]>>>7-s%8&1)==1},put:function(s,t){for(var r=0;r<t;r++)this.putBit((s>>>t-r-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(s){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),s&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var KE=Cb,zs={glog:function(s){if(s<1)throw new Error("glog("+s+")");return zs.LOG_TABLE[s]},gexp:function(s){for(;s<0;)s+=255;for(;s>=256;)s-=255;return zs.EXP_TABLE[s]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var Qt=0;Qt<8;Qt++)zs.EXP_TABLE[Qt]=1<<Qt;for(var Qt=8;Qt<256;Qt++)zs.EXP_TABLE[Qt]=zs.EXP_TABLE[Qt-4]^zs.EXP_TABLE[Qt-5]^zs.EXP_TABLE[Qt-6]^zs.EXP_TABLE[Qt-8];for(var Qt=0;Qt<255;Qt++)zs.LOG_TABLE[zs.EXP_TABLE[Qt]]=Qt;var kb=zs,ln=kb;function Po(s,t){if(s.length==null)throw new Error(s.length+"/"+t);for(var r=0;r<s.length&&s[r]==0;)r++;this.num=new Array(s.length-r+t);for(var n=0;n<s.length-r;n++)this.num[n]=s[n+r]}Po.prototype={get:function(s){return this.num[s]},getLength:function(){return this.num.length},multiply:function(s){for(var t=new Array(this.getLength()+s.getLength()-1),r=0;r<this.getLength();r++)for(var n=0;n<s.getLength();n++)t[r+n]^=ln.gexp(ln.glog(this.get(r))+ln.glog(s.get(n)));return new Po(t,0)},mod:function(s){if(this.getLength()-s.getLength()<0)return this;for(var t=ln.glog(this.get(0))-ln.glog(s.get(0)),r=new Array(this.getLength()),n=0;n<this.getLength();n++)r[n]=this.get(n);for(var n=0;n<s.getLength();n++)r[n]^=ln.gexp(ln.glog(s.get(n))+t);return new Po(r,0).mod(s)}};var Tb=Po,Es=Nb,Oh=Tb,GE=kb,Er={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},Wt={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(s){for(var t=s<<10;Wt.getBCHDigit(t)-Wt.getBCHDigit(Wt.G15)>=0;)t^=Wt.G15<<Wt.getBCHDigit(t)-Wt.getBCHDigit(Wt.G15);return(s<<10|t)^Wt.G15_MASK},getBCHTypeNumber:function(s){for(var t=s<<12;Wt.getBCHDigit(t)-Wt.getBCHDigit(Wt.G18)>=0;)t^=Wt.G18<<Wt.getBCHDigit(t)-Wt.getBCHDigit(Wt.G18);return s<<12|t},getBCHDigit:function(s){for(var t=0;s!=0;)t++,s>>>=1;return t},getPatternPosition:function(s){return Wt.PATTERN_POSITION_TABLE[s-1]},getMask:function(s,t,r){switch(s){case Er.PATTERN000:return(t+r)%2==0;case Er.PATTERN001:return t%2==0;case Er.PATTERN010:return r%3==0;case Er.PATTERN011:return(t+r)%3==0;case Er.PATTERN100:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case Er.PATTERN101:return t*r%2+t*r%3==0;case Er.PATTERN110:return(t*r%2+t*r%3)%2==0;case Er.PATTERN111:return(t*r%3+(t+r)%2)%2==0;default:throw new Error("bad maskPattern:"+s)}},getErrorCorrectPolynomial:function(s){for(var t=new Oh([1],0),r=0;r<s;r++)t=t.multiply(new Oh([1,GE.gexp(r)],0));return t},getLengthInBits:function(s,t){if(1<=t&&t<10)switch(s){case Es.MODE_NUMBER:return 10;case Es.MODE_ALPHA_NUM:return 9;case Es.MODE_8BIT_BYTE:return 8;case Es.MODE_KANJI:return 8;default:throw new Error("mode:"+s)}else if(t<27)switch(s){case Es.MODE_NUMBER:return 12;case Es.MODE_ALPHA_NUM:return 11;case Es.MODE_8BIT_BYTE:return 16;case Es.MODE_KANJI:return 10;default:throw new Error("mode:"+s)}else if(t<41)switch(s){case Es.MODE_NUMBER:return 14;case Es.MODE_ALPHA_NUM:return 13;case Es.MODE_8BIT_BYTE:return 16;case Es.MODE_KANJI:return 12;default:throw new Error("mode:"+s)}else throw new Error("type:"+t)},getLostPoint:function(s){for(var t=s.getModuleCount(),r=0,n=0;n<t;n++)for(var a=0;a<t;a++){for(var i=0,o=s.isDark(n,a),l=-1;l<=1;l++)if(!(n+l<0||t<=n+l))for(var c=-1;c<=1;c++)a+c<0||t<=a+c||l==0&&c==0||o==s.isDark(n+l,a+c)&&i++;i>5&&(r+=3+i-5)}for(var n=0;n<t-1;n++)for(var a=0;a<t-1;a++){var d=0;s.isDark(n,a)&&d++,s.isDark(n+1,a)&&d++,s.isDark(n,a+1)&&d++,s.isDark(n+1,a+1)&&d++,(d==0||d==4)&&(r+=3)}for(var n=0;n<t;n++)for(var a=0;a<t-6;a++)s.isDark(n,a)&&!s.isDark(n,a+1)&&s.isDark(n,a+2)&&s.isDark(n,a+3)&&s.isDark(n,a+4)&&!s.isDark(n,a+5)&&s.isDark(n,a+6)&&(r+=40);for(var a=0;a<t;a++)for(var n=0;n<t-6;n++)s.isDark(n,a)&&!s.isDark(n+1,a)&&s.isDark(n+2,a)&&s.isDark(n+3,a)&&s.isDark(n+4,a)&&!s.isDark(n+5,a)&&s.isDark(n+6,a)&&(r+=40);for(var u=0,a=0;a<t;a++)for(var n=0;n<t;n++)s.isDark(n,a)&&u++;var h=Math.abs(100*u/t/t-50)/5;return r+=h*10,r}},QE=Wt,ZE=zE,Pb=WE,Eb=KE,Xr=QE,YE=Tb;function ar(s,t){this.typeNumber=s,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var Ts=ar.prototype;Ts.addData=function(s){var t=new ZE(s);this.dataList.push(t),this.dataCache=null};Ts.isDark=function(s,t){if(s<0||this.moduleCount<=s||t<0||this.moduleCount<=t)throw new Error(s+","+t);return this.modules[s][t]};Ts.getModuleCount=function(){return this.moduleCount};Ts.make=function(){if(this.typeNumber<1){var s=1;for(s=1;s<40;s++){for(var t=Pb.getRSBlocks(s,this.errorCorrectLevel),r=new Eb,n=0,a=0;a<t.length;a++)n+=t[a].dataCount;for(var a=0;a<this.dataList.length;a++){var i=this.dataList[a];r.put(i.mode,4),r.put(i.getLength(),Xr.getLengthInBits(i.mode,s)),i.write(r)}if(r.getLengthInBits()<=n*8)break}this.typeNumber=s}this.makeImpl(!1,this.getBestMaskPattern())};Ts.makeImpl=function(s,t){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[r][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(s,t),this.typeNumber>=7&&this.setupTypeNumber(s),this.dataCache==null&&(this.dataCache=ar.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)};Ts.setupPositionProbePattern=function(s,t){for(var r=-1;r<=7;r++)if(!(s+r<=-1||this.moduleCount<=s+r))for(var n=-1;n<=7;n++)t+n<=-1||this.moduleCount<=t+n||(0<=r&&r<=6&&(n==0||n==6)||0<=n&&n<=6&&(r==0||r==6)||2<=r&&r<=4&&2<=n&&n<=4?this.modules[s+r][t+n]=!0:this.modules[s+r][t+n]=!1)};Ts.getBestMaskPattern=function(){for(var s=0,t=0,r=0;r<8;r++){this.makeImpl(!0,r);var n=Xr.getLostPoint(this);(r==0||s>n)&&(s=n,t=r)}return t};Ts.createMovieClip=function(s,t,r){var n=s.createEmptyMovieClip(t,r),a=1;this.make();for(var i=0;i<this.modules.length;i++)for(var o=i*a,l=0;l<this.modules[i].length;l++){var c=l*a,d=this.modules[i][l];d&&(n.beginFill(0,100),n.moveTo(c,o),n.lineTo(c+a,o),n.lineTo(c+a,o+a),n.lineTo(c,o+a),n.endFill())}return n};Ts.setupTimingPattern=function(){for(var s=8;s<this.moduleCount-8;s++)this.modules[s][6]==null&&(this.modules[s][6]=s%2==0);for(var t=8;t<this.moduleCount-8;t++)this.modules[6][t]==null&&(this.modules[6][t]=t%2==0)};Ts.setupPositionAdjustPattern=function(){for(var s=Xr.getPatternPosition(this.typeNumber),t=0;t<s.length;t++)for(var r=0;r<s.length;r++){var n=s[t],a=s[r];if(this.modules[n][a]==null)for(var i=-2;i<=2;i++)for(var o=-2;o<=2;o++)i==-2||i==2||o==-2||o==2||i==0&&o==0?this.modules[n+i][a+o]=!0:this.modules[n+i][a+o]=!1}};Ts.setupTypeNumber=function(s){for(var t=Xr.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var n=!s&&(t>>r&1)==1;this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=n}for(var r=0;r<18;r++){var n=!s&&(t>>r&1)==1;this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=n}};Ts.setupTypeInfo=function(s,t){for(var r=this.errorCorrectLevel<<3|t,n=Xr.getBCHTypeInfo(r),a=0;a<15;a++){var i=!s&&(n>>a&1)==1;a<6?this.modules[a][8]=i:a<8?this.modules[a+1][8]=i:this.modules[this.moduleCount-15+a][8]=i}for(var a=0;a<15;a++){var i=!s&&(n>>a&1)==1;a<8?this.modules[8][this.moduleCount-a-1]=i:a<9?this.modules[8][15-a-1+1]=i:this.modules[8][15-a-1]=i}this.modules[this.moduleCount-8][8]=!s};Ts.mapData=function(s,t){for(var r=-1,n=this.moduleCount-1,a=7,i=0,o=this.moduleCount-1;o>0;o-=2)for(o==6&&o--;;){for(var l=0;l<2;l++)if(this.modules[n][o-l]==null){var c=!1;i<s.length&&(c=(s[i]>>>a&1)==1);var d=Xr.getMask(t,n,o-l);d&&(c=!c),this.modules[n][o-l]=c,a--,a==-1&&(i++,a=7)}if(n+=r,n<0||this.moduleCount<=n){n-=r,r=-r;break}}};ar.PAD0=236;ar.PAD1=17;ar.createData=function(s,t,r){for(var n=Pb.getRSBlocks(s,t),a=new Eb,i=0;i<r.length;i++){var o=r[i];a.put(o.mode,4),a.put(o.getLength(),Xr.getLengthInBits(o.mode,s)),o.write(a)}for(var l=0,i=0;i<n.length;i++)l+=n[i].dataCount;if(a.getLengthInBits()>l*8)throw new Error("code length overflow. ("+a.getLengthInBits()+">"+l*8+")");for(a.getLengthInBits()+4<=l*8&&a.put(0,4);a.getLengthInBits()%8!=0;)a.putBit(!1);for(;!(a.getLengthInBits()>=l*8||(a.put(ar.PAD0,8),a.getLengthInBits()>=l*8));)a.put(ar.PAD1,8);return ar.createBytes(a,n)};ar.createBytes=function(s,t){for(var r=0,n=0,a=0,i=new Array(t.length),o=new Array(t.length),l=0;l<t.length;l++){var c=t[l].dataCount,d=t[l].totalCount-c;n=Math.max(n,c),a=Math.max(a,d),i[l]=new Array(c);for(var u=0;u<i[l].length;u++)i[l][u]=255&s.buffer[u+r];r+=c;var h=Xr.getErrorCorrectPolynomial(d),m=new YE(i[l],h.getLength()-1),x=m.mod(h);o[l]=new Array(h.getLength()-1);for(var u=0;u<o[l].length;u++){var g=u+x.getLength()-o[l].length;o[l][u]=g>=0?x.get(g):0}}for(var f=0,u=0;u<t.length;u++)f+=t[u].totalCount;for(var v=new Array(f),y=0,u=0;u<n;u++)for(var l=0;l<t.length;l++)u<i[l].length&&(v[y++]=i[l][u]);for(var u=0;u<a;u++)for(var l=0;l<t.length;l++)u<o[l].length&&(v[y++]=o[l][u]);return v};var XE=ar,Pu={};Object.defineProperty(Pu,"__esModule",{value:!0});var JE=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},eD=jj,Ds=Ab(eD),Db=p,uo=Ab(Db);function Ab(s){return s&&s.__esModule?s:{default:s}}function tD(s,t){var r={};for(var n in s)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n]);return r}var sD={bgColor:Ds.default.oneOfType([Ds.default.object,Ds.default.string]).isRequired,bgD:Ds.default.string.isRequired,fgColor:Ds.default.oneOfType([Ds.default.object,Ds.default.string]).isRequired,fgD:Ds.default.string.isRequired,size:Ds.default.number.isRequired,title:Ds.default.string,viewBoxSize:Ds.default.number.isRequired,xmlns:Ds.default.string},Eu=(0,Db.forwardRef)(function(s,t){var r=s.bgColor,n=s.bgD,a=s.fgD,i=s.fgColor,o=s.size,l=s.title,c=s.viewBoxSize,d=s.xmlns,u=d===void 0?"http://www.w3.org/2000/svg":d,h=tD(s,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return uo.default.createElement("svg",JE({},h,{height:o,ref:t,viewBox:"0 0 "+c+" "+c,width:o,xmlns:u}),l?uo.default.createElement("title",null,l):null,uo.default.createElement("path",{d:n,fill:r}),uo.default.createElement("path",{d:a,fill:i}))});Eu.displayName="QRCodeSvg";Eu.propTypes=sD;Pu.default=Eu;Object.defineProperty(Dl,"__esModule",{value:!0});Dl.QRCode=void 0;var rD=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},nD=jj,xr=Wi(nD),aD=wb,iD=Wi(aD),oD=XE,lD=Wi(oD),_b=p,cD=Wi(_b),dD=Pu,uD=Wi(dD);function Wi(s){return s&&s.__esModule?s:{default:s}}function mD(s,t){var r={};for(var n in s)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n]);return r}var hD={bgColor:xr.default.oneOfType([xr.default.object,xr.default.string]),fgColor:xr.default.oneOfType([xr.default.object,xr.default.string]),level:xr.default.string,size:xr.default.number,value:xr.default.string.isRequired},Al=(0,_b.forwardRef)(function(s,t){var r=s.bgColor,n=r===void 0?"#FFFFFF":r,a=s.fgColor,i=a===void 0?"#000000":a,o=s.level,l=o===void 0?"L":o,c=s.size,d=c===void 0?256:c,u=s.value,h=mD(s,["bgColor","fgColor","level","size","value"]),m=new lD.default(-1,iD.default[l]);m.addData(u),m.make();var x=m.modules;return cD.default.createElement(uD.default,rD({},h,{bgColor:n,bgD:x.map(function(g,f){return g.map(function(v,y){return v?"":"M "+y+" "+f+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:i,fgD:x.map(function(g,f){return g.map(function(v,y){return v?"M "+y+" "+f+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:t,size:d,viewBoxSize:x.length}))});Dl.QRCode=Al;Al.displayName="QRCode";Al.propTypes=hD;var Du=Dl.default=Al;const pD=({frames:s,mats:t,glassOption:r,artworkWidth:n,artworkHeight:a,artworkLocation:i,primaryMatWidth:o,specialServices:l,onCreateOrder:c,onSaveQuote:d,onCreateWholesaleOrder:u,onProceedToCheckout:h,orderGroupId:m,showCheckoutButton:x=!1,useMultipleMats:g=!1,useMultipleFrames:f=!1,addToWholesaleOrder:v=!1,setAddToWholesaleOrder:y,orderId:j,sizeSurcharge:b=0,useManualFrame:k=!1,manualFrameName:S="",manualFrameCost:A=0,miscCharges:T=[],initialDiscountPercentage:C=0,onDiscountChange:E,initialQuantity:D=1,onQuantityChange:w})=>{const[N,_]=p.useState(!1),[F,W]=p.useState(C),[Z,$]=p.useState(D),ae=fe=>{W(fe);const Pt=(Ne+Qe)*(fe/100);E&&E(fe,Pt)},O=fe=>{fe<1||($(fe),w&&w(fe))},ne=typeof v<"u"?v:N,Pe=fe=>{y?y(fe):_(fe)},st=s.map(fe=>od(Number(n),Number(a),o,Number(fe.frame.price))),rt=st.reduce((fe,Pt)=>fe+Pt,0),B=t.map(fe=>ld(Number(n),Number(a),Number(fe.width),Number(fe.matboard.price))),oe=B.reduce((fe,Pt)=>fe+Pt,0),Y=r?cd(Number(n),Number(a),o,Number(r.price)):0,z=dd(Number(n),Number(a),o,.02),le=OE(Number(n),Number(a),o),ye=l.reduce((fe,Pt)=>fe+Number(Pt.price),0),he=b||0,je=(T==null?void 0:T.reduce((fe,Pt)=>fe+Number(Pt.amount),0))||0,Ne=rt+oe+Y+z+le+ye+he+je,Qe=FE(Ne),ke=(Ne+Qe)*Z,xt=ke*(F/100),yt=ke-xt,be=yt*.08,nt=yt+be,gt=j?YP(j):null;return p.useState(!1),p.useState(!1),p.useState(!1),p.useState(!1),e.jsxs("div",{className:"bg-white dark:bg-dark-cardBg rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 header-underline",children:"Order Summary"}),e.jsxs("div",{className:"mb-4 border-b pb-3 border-gray-200",children:[e.jsx("div",{className:"flex justify-between font-medium",children:e.jsx("span",{children:"Artwork Details"})}),e.jsxs("div",{className:"text-sm mt-1",children:[e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Dimensions:"}),e.jsxs("span",{children:[n,'" × ',a,'"']})]}),i&&i.trim()!==""&&e.jsxs("div",{className:"flex justify-between text-gray-700 mt-1",children:[e.jsx("span",{children:"Storage Location:"}),e.jsx("span",{className:"font-medium text-primary",children:i})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[s.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Frames"}),e.jsxs("span",{children:["$",rt.toFixed(2)]})]}),s.map((fe,Pt)=>e.jsxs("div",{className:"flex justify-between text-sm text-light-textSecondary dark:text-dark-textSecondary pl-3",children:[e.jsxs("span",{children:[fe.position===1?"Inner":"Outer"," (",fe.frame.name,")"]}),e.jsxs("span",{children:["$",st[Pt].toFixed(2)]})]},fe.frame.id+"-"+fe.position))]}),t.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Mats"}),e.jsxs("span",{children:["$",oe.toFixed(2)]})]}),t.map((fe,Pt)=>e.jsxs("div",{className:"flex justify-between text-sm text-light-textSecondary dark:text-dark-textSecondary pl-3",children:[e.jsxs("span",{children:[fe.position===1?"Top":fe.position===2?"Middle":"Bottom"," (",fe.matboard.name,", ",fe.width,'")']}),e.jsxs("span",{children:["$",B[Pt].toFixed(2)]})]},fe.matboard.id+"-"+fe.position))]}),r&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-light-textSecondary dark:text-dark-textSecondary",children:["Glass (",r.name,")"]}),e.jsxs("span",{children:["$",Y.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-light-textSecondary dark:text-dark-textSecondary",children:"Backing"}),e.jsxs("span",{children:["$",z.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-light-textSecondary dark:text-dark-textSecondary",children:"Assembly Labor"}),e.jsxs("span",{children:["$",le.toFixed(2)]})]}),l.length>0&&e.jsxs("div",{className:"border-t border-light-border dark:border-dark-border pt-2",children:[e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Special Services"}),e.jsxs("span",{children:["$",ye.toFixed(2)]})]}),l.map(fe=>e.jsxs("div",{className:"flex justify-between text-sm text-light-textSecondary dark:text-dark-textSecondary",children:[e.jsx("span",{children:fe.name}),e.jsxs("span",{children:["$",Number(fe.price).toFixed(2)]})]},fe.id))]}),b>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-light-textSecondary dark:text-dark-textSecondary",children:["Size Surcharge (",n>40||a>60?"Extra Large":"Large",")"]}),e.jsxs("span",{className:"text-light-textSecondary dark:text-dark-textSecondary",children:["$",b.toFixed(2)]})]}),T&&T.length>0&&e.jsxs("div",{className:"border-t border-light-border dark:border-dark-border pt-2",children:[e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Miscellaneous Charges"}),e.jsxs("span",{children:["$",je.toFixed(2)]})]}),T.map((fe,Pt)=>e.jsxs("div",{className:"flex justify-between text-sm text-light-textSecondary dark:text-dark-textSecondary pl-3",children:[e.jsx("span",{children:fe.description}),e.jsxs("span",{children:["$",Number(fe.amount).toFixed(2)]})]},Pt))]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-light-textSecondary dark:text-dark-textSecondary",children:"Overhead & Shop Fees"}),e.jsxs("span",{children:["$",Qe.toFixed(2)]})]}),e.jsxs("div",{className:"border-t border-light-border dark:border-dark-border pt-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Quantity"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{type:"button",onClick:()=>O(Z-1),disabled:Z<=1,className:"w-8 h-8 rounded-l border border-gray-300 bg-gray-50 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center text-sm font-medium",children:"-"}),e.jsx(U,{type:"number",min:"1",className:"w-16 h-8 rounded-none text-center border-l-0 border-r-0",value:Z,onChange:fe=>O(parseInt(fe.target.value)||1)}),e.jsx("button",{type:"button",onClick:()=>O(Z+1),className:"w-8 h-8 rounded-r border border-gray-300 bg-gray-50 hover:bg-gray-100 flex items-center justify-center text-sm font-medium",children:"+"})]})]}),e.jsxs("span",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:["$",((Ne+Qe)*Z).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["$",ke.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:"Discount"}),e.jsx("input",{type:"number",min:"0",max:"100",step:"0.1",value:F||"",onChange:fe=>ae(parseFloat(fe.target.value)||0),className:"w-16 px-2 py-1 text-xs border border-gray-300 rounded text-center",placeholder:"0"}),e.jsx("span",{className:"text-xs text-light-textSecondary dark:text-dark-textSecondary",children:"%"})]}),e.jsxs("span",{className:"text-sm text-red-600",children:["-$",xt.toFixed(2)]})]}),F>0&&e.jsxs("div",{className:"flex justify-between font-medium text-green-600",children:[e.jsx("span",{children:"Discounted Subtotal"}),e.jsxs("span",{children:["$",yt.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-light-textSecondary dark:text-dark-textSecondary",children:[e.jsx("span",{children:"Tax (8%)"}),e.jsxs("span",{children:["$",be.toFixed(2)]})]})]}),e.jsx("div",{className:"border-t border-light-border dark:border-dark-border pt-2",children:e.jsxs("div",{className:"flex justify-between text-lg font-semibold text-primary",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",nt.toFixed(2)]})]})}),e.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[e.jsx(os,{id:"add-to-wholesale",checked:ne,onCheckedChange:fe=>Pe(fe)}),e.jsx("label",{htmlFor:"add-to-wholesale",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Add To Wholesale Order"})]})]}),e.jsx("div",{className:"mt-6 space-y-3",children:x?e.jsxs("button",{className:"w-full py-4 text-base bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center touch-manipulation",onClick:()=>{m&&h&&h(m)},disabled:!m,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"Proceed to Checkout"]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:`w-full py-4 text-base ${s.length===0||t.length===0||!r?"bg-gray-400 cursor-not-allowed":"bg-primary hover:bg-primary/90"} text-white rounded-lg font-medium transition-colors flex items-center justify-center touch-manipulation`,onClick:async()=>{console.log("Save Order button clicked in OrderSummary"),console.log("Button disabled state:",s.length===0||t.length===0||!r),console.log("Add to wholesale order:",ne),c(),ne&&setTimeout(()=>{u()},500)},disabled:s.length===0||t.length===0||!r,children:[e.jsx(wl,{className:"h-5 w-5 mr-2"}),"Save Order (No Payment Required)"]}),e.jsxs("button",{className:"w-full py-4 text-base border border-light-border dark:border-dark-border bg-white dark:bg-dark-bg text-light-text dark:text-dark-text rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-dark-bg/80 transition-colors flex items-center justify-center touch-manipulation",onClick:d,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Save as Quote"]})]})}),s.length>0&&t.length>0&&e.jsxs("div",{className:"mt-6 border border-light-border dark:border-dark-border rounded-lg p-3 bg-gray-50 dark:bg-dark-bg/30",children:[e.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Wholesale Order"]}),e.jsx("p",{className:"text-xs text-light-textSecondary dark:text-dark-textSecondary mb-2",children:"This order will require these materials from your wholesalers:"}),e.jsxs("ul",{className:"text-xs space-y-1",children:[s.map(fe=>e.jsxs("li",{className:"flex justify-between",children:[e.jsxs("span",{children:[fe.frame.manufacturer||"Frame"," (",fe.frame.id,")"]}),e.jsxs("span",{children:[Math.ceil(2*(n+a)/12+1)," ft"]})]},fe.frame.id+"-"+fe.position)),r&&e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:r.name}),e.jsxs("span",{children:[n+2*o,'" × ',a+2*o,'"']})]}),t.map(fe=>e.jsxs("li",{className:"flex justify-between",children:[e.jsxs("span",{children:[fe.matboard.name," Mat Board"]}),e.jsxs("span",{children:[n+2*fe.width+(fe.position===1?4:0),'" ×',a+2*fe.width+(fe.position===1?4:0),'"']})]},fe.matboard.id+"-"+fe.position))]}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(os,{id:"wholesale-order-add",checked:ne,onCheckedChange:fe=>Pe(fe)}),e.jsx("label",{htmlFor:"wholesale-order-add",className:"text-xs ml-2",children:"Add to Wholesale Order"})]})]}),gt&&e.jsx("div",{className:"mt-4",children:e.jsx(Du,{value:gt,size:128,level:"H"})})]})};async function fD(){try{const s=await ce("GET","/api/vendor-api/frames/larson");if(!s.ok)throw new Error(`Failed to fetch Larson frames: ${s.status}`);const t=await s.json();return Array.isArray(t)?t.map(r=>({id:r.id,name:r.name,manufacturer:r.vendor,material:r.material,width:r.width,depth:r.depth,price:r.price,catalogImage:r.imageUrl||"",color:r.color,edgeTexture:"",corner:""})):[]}catch(s){return console.error("Error fetching Larson-Juhl frames:",s),[]}}async function xD(){try{const s=await ce("GET","/api/vendor-api/frames/bella");if(!s.ok)throw new Error(`Failed to fetch Nielsen frames: ${s.status}`);const t=await s.json();return Array.isArray(t)?t.map(r=>({id:r.id,name:r.name,manufacturer:r.vendor,material:r.material,width:r.width,depth:r.depth,price:r.price,catalogImage:r.imageUrl||"",color:r.color,edgeTexture:"",corner:""})):[]}catch(s){return console.error("Error fetching Nielsen frames:",s),[]}}async function gD(){try{const s=await ce("GET","/api/vendor-api/frames/roma");if(!s.ok)throw new Error(`Failed to fetch Roma frames: ${s.status}`);const t=await s.json();return Array.isArray(t)?t.map(r=>({id:r.id,name:r.name,manufacturer:r.vendor,material:r.material,width:r.width,depth:r.depth,price:r.price,catalogImage:r.imageUrl||"",color:r.color,edgeTexture:"",corner:""})):[]}catch(s){return console.error("Error fetching Roma frames:",s),[]}}async function vD(){try{const s=await ce("GET","/api/vendor-catalog/all");if(!s.ok)throw new Error(`Failed to fetch vendor frames: ${s.status}`);const t=await s.json();return Array.isArray(t)?t:[]}catch(s){throw console.error("Error fetching all vendor frames:",s),s}}async function yD(s){try{const t=await ce("GET",`/api/vendor-catalog/search/${s}`);if(!t.ok){if(t.status===404)return console.log(`No frames found for item number: ${s}`),[];throw new Error(`Search failed with status: ${t.status}`)}const r=await t.json();return Array.isArray(r)?r:[]}catch(t){throw console.error(`Error searching for frames with item number ${s}:`,t),new Error(`Failed to search for frames: ${t.message}`)}}async function jD(){try{return await(await ce("POST","/api/vendor-catalog/sync")).json()}catch(s){throw console.error("Error syncing frames with database:",s),s}}function bD(){const{data:s,isLoading:t,error:r,refetch:n}=me({queryKey:["/api/vendor-catalog/all"],queryFn:vD}),{data:a,isLoading:i,error:o,refetch:l}=me({queryKey:["/api/vendor-catalog/larson"],queryFn:fD}),{data:c,isLoading:d,error:u,refetch:h}=me({queryKey:["/api/vendor-catalog/nielsen"],queryFn:xD}),{data:m,isLoading:x,error:g,refetch:f}=me({queryKey:["/api/vendor-catalog/roma"],queryFn:gD}),{mutate:v,data:y,isPending:j,error:b}=Ce({mutationFn:T=>yD(T)}),{mutate:k,isPending:S,error:A}=Ce({mutationFn:jD});return{vendorFrames:s||[],isLoadingVendorFrames:t,vendorFramesError:r,refetchVendorFrames:n,larsonFrames:a||[],isLoadingLarsonFrames:i,larsonFramesError:o,refetchLarsonFrames:l,nielsenFrames:c||[],isLoadingNielsenFrames:d,nielsenFramesError:u,refetchNielsenFrames:h,romaFrames:m||[],isLoadingRomaFrames:x,romaFramesError:g,refetchRomaFrames:f,searchByItemNumber:v,searchResults:y||[],isSearching:j,searchError:b,syncFrames:k,isSyncing:S,syncError:A}}const V=p.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:J("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));V.displayName="Card";const G=p.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:J("flex flex-col space-y-1.5 p-6",s),...t}));G.displayName="CardHeader";const Q=p.forwardRef(({className:s,...t},r)=>e.jsx("h3",{ref:r,className:J("text-2xl font-semibold leading-none tracking-tight",s),...t}));Q.displayName="CardTitle";const te=p.forwardRef(({className:s,...t},r)=>e.jsx("p",{ref:r,className:J("text-sm text-muted-foreground",s),...t}));te.displayName="CardDescription";const q=p.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:J("p-6 pt-0",s),...t}));q.displayName="CardContent";const ht=p.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:J("flex items-center p-6 pt-0",s),...t}));ht.displayName="CardFooter";var wD="Label",Ib=p.forwardRef((s,t)=>e.jsx(Se.label,{...s,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=s.onMouseDown)==null||a.call(s,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Ib.displayName=wD;var Rb=Ib;const ND=Vn("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),M=p.forwardRef(({className:s,...t},r)=>e.jsx(Rb,{ref:r,className:J(ND(),s),...t}));M.displayName=Rb.displayName;const SD=({onSelectFrame:s,position:t=1})=>{const{toast:r}=Be(),[n,a]=p.useState(""),[i,o]=p.useState([]),[l,c]=p.useState(!1),d=p.useRef(null),{searchByItemNumber:u,searchResults:h,isSearching:m,searchError:x,syncFrames:g,isSyncing:f}=bD();p.useEffect(()=>{h&&JSON.stringify(h)!==JSON.stringify(d.current)&&(d.current=h,o(h),l&&c(!1))},[h,l]),p.useEffect(()=>{x&&(console.error("Vendor search error:",x),r({title:"Search Error",description:"Unable to search vendor catalogs right now. Please try again in a moment.",variant:"destructive"}),l&&c(!1),o([]))},[x,r,l]);const v=async()=>{if(!n.trim()){r({title:"Search Error",description:"Please enter an item number to search for",variant:"destructive"});return}c(!0);try{await u(n.trim())}catch(b){console.error("Search error:",b),r({title:"Search Error",description:"Failed to search for frames. Please try again.",variant:"destructive"})}finally{c(!1)}},y=()=>{g(),r({title:"Syncing Frames",description:"Frame database sync has been initiated"})},j=b=>{s(b,t),r({title:"Frame Selected",description:`${b.name} (${b.id}) has been selected for position ${t}`})};return e.jsxs(V,{className:"w-full",children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Vendor Catalog Search"}),e.jsx(te,{children:"Search for frames by item number across all vendor catalogs"})]}),e.jsx(q,{children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(M,{htmlFor:"item-number",children:"Item Number"}),e.jsx(U,{id:"item-number",value:n,onChange:b=>a(b.target.value),placeholder:"Enter frame item number (e.g., 210286)",onKeyDown:b=>b.key==="Enter"&&v()})]}),e.jsxs(P,{onClick:v,disabled:m||l,className:"mb-px",children:[m||l?e.jsx(Xe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Zr,{className:"h-4 w-4 mr-2"}),"Search"]})]}),e.jsxs(P,{variant:"outline",onClick:y,disabled:f,className:"self-end",children:[f?e.jsx(Xe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ir,{className:"h-4 w-4 mr-2"}),"Sync Frames with Database"]}),i.length>0?e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Search Results:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(b=>e.jsxs(V,{className:"overflow-hidden",children:[e.jsx("div",{className:"relative h-40 overflow-hidden",children:b.catalogImage?e.jsx("img",{src:b.catalogImage,alt:b.name,className:"w-full h-full object-cover",onError:k=>{const S=k.target;S.onerror=null,S.src=`https://via.placeholder.com/200x150/f0f0f0/2d2d2d?text=${b.id}`}}):e.jsx("div",{className:"flex items-center justify-center w-full h-full bg-muted",children:e.jsx("span",{className:"text-xs text-muted-foreground",children:"No Image Available"})})}),e.jsxs(q,{className:"p-3",children:[e.jsx("h4",{className:"font-semibold text-sm truncate",children:b.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Item #: ",b.id.split("-")[1]]}),e.jsxs("div",{className:"flex justify-between items-center text-xs mt-1",children:[e.jsx("span",{children:b.manufacturer}),e.jsx("span",{children:b.material})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs mt-1",children:[e.jsxs("span",{children:["Width: ",b.width,'"']}),e.jsxs("span",{className:"font-medium",children:["$",parseFloat(String(b.price)).toFixed(2),"/ft"]})]})]}),e.jsx(ht,{className:"p-3 pt-0",children:e.jsx(P,{size:"sm",className:"w-full",onClick:()=>j(b),children:"Select Frame"})})]},b.id))})]}):i.length===0&&!m&&!l&&n.trim()!==""?e.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:['No frames found with item number "',n,'". Try searching for a different item number.']}):null]})})]})};var Au="Tabs",[CD,sU]=fs(Au,[jl]),Mb=jl(),[kD,_u]=CD(Au),Ob=p.forwardRef((s,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...d}=s,u=Ln(l),[h,m]=ms({prop:n,onChange:a,defaultProp:i});return e.jsx(kD,{scope:r,baseId:hr(),value:h,onValueChange:m,orientation:o,dir:u,activationMode:c,children:e.jsx(Se.div,{dir:u,"data-orientation":o,...d,ref:t})})});Ob.displayName=Au;var Fb="TabsList",Lb=p.forwardRef((s,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=s,i=_u(Fb,r),o=Mb(r);return e.jsx(Vy,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:n,children:e.jsx(Se.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:t})})});Lb.displayName=Fb;var $b="TabsTrigger",Bb=p.forwardRef((s,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...i}=s,o=_u($b,r),l=Mb(r),c=Hb(o.baseId,n),d=qb(o.baseId,n),u=n===o.value;return e.jsx(Uy,{asChild:!0,...l,focusable:!a,active:u,children:e.jsx(Se.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...i,ref:t,onMouseDown:ge(s.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?o.onValueChange(n):h.preventDefault()}),onKeyDown:ge(s.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(n)}),onFocus:ge(s.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!a&&h&&o.onValueChange(n)})})})});Bb.displayName=$b;var Vb="TabsContent",Ub=p.forwardRef((s,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:i,...o}=s,l=_u(Vb,r),c=Hb(l.baseId,n),d=qb(l.baseId,n),u=n===l.value,h=p.useRef(u);return p.useEffect(()=>{const m=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(m)},[]),e.jsx(ds,{present:a||u,children:({present:m})=>e.jsx(Se.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!m,id:d,tabIndex:0,...o,ref:t,style:{...s.style,animationDuration:h.current?"0s":void 0},children:m&&i})})});Ub.displayName=Vb;function Hb(s,t){return`${s}-trigger-${t}`}function qb(s,t){return`${s}-content-${t}`}var TD=Ob,zb=Lb,Wb=Bb,Kb=Ub;const qt=TD,$t=p.forwardRef(({className:s,...t},r)=>e.jsx(zb,{ref:r,className:J("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t}));$t.displayName=zb.displayName;const ve=p.forwardRef(({className:s,...t},r)=>e.jsx(Wb,{ref:r,className:J("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t}));ve.displayName=Wb.displayName;const Ae=p.forwardRef(({className:s,...t},r)=>e.jsx(Kb,{ref:r,className:J("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));Ae.displayName=Kb.displayName;function PD({onFrameAdd:s,useManualFrame:t,onToggleManualFrame:r,frameName:n,onFrameNameChange:a,frameCost:i,onFrameCostChange:o,selectedFrames:l=[],onFrameRemove:c,onFrameEdit:d}){const[u,h]=p.useState({name:"",manufacturer:"",material:"wood",width:"",depth:"",price:"",color:"#8B4513"}),[m,x]=p.useState({itemNumber:"",pricePerFoot:"",name:"",manufacturer:"",material:"wood",width:"",depth:"",color:"#8B4513"}),g=v=>{if(v.preventDefault(),!u.name||!u.price||!u.width){alert("Please fill in all required fields");return}const y={id:`manual-${Date.now()}`,...u,catalogImage:"",edgeTexture:"",corner:""};s==null||s(y),h({name:"",manufacturer:"",material:"wood",width:"",depth:"",price:"",color:"#8B4513"})},f=v=>{if(v.preventDefault(),!m.itemNumber||!m.pricePerFoot){alert("Please enter both item number and price per foot");return}const y={id:`moulding-${m.itemNumber}`,name:m.name||`Moulding ${m.itemNumber}`,manufacturer:m.manufacturer||"Custom",material:m.material,width:m.width||"2.25",depth:m.depth||"1.25",price:m.pricePerFoot,color:m.color,itemNumber:m.itemNumber,catalogImage:"",edgeTexture:"",corner:""};s==null||s(y),x({itemNumber:"",pricePerFoot:"",name:"",manufacturer:"",material:"wood",width:"",depth:"",color:"#8B4513"})};return e.jsxs(V,{className:"w-full max-w-md",children:[e.jsx(G,{children:e.jsx(Q,{children:"Frame Management"})}),e.jsxs(q,{children:[l.length>0&&e.jsxs("div",{className:"mb-4 p-3 border rounded-md",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Selected Frames"}),l.map((v,y)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:v.frame.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",v.frame.price,"/ft"]})]}),e.jsxs("div",{className:"flex space-x-1",children:[v.frame.id.startsWith("manual")&&d&&e.jsx(P,{size:"sm",variant:"outline",onClick:()=>{h({name:v.frame.name,manufacturer:v.frame.manufacturer,material:v.frame.material,width:v.frame.width,depth:v.frame.depth,price:v.frame.price,color:v.frame.color||"#8B4513"})},children:"Edit"}),c&&e.jsx(P,{size:"sm",variant:"destructive",onClick:()=>c(v.frame.id),children:"×"})]})]},v.frame.id+"-"+v.position))]}),e.jsxs(qt,{defaultValue:"frame",className:"w-full",children:[e.jsxs($t,{className:"grid w-full grid-cols-2",children:[e.jsx(ve,{value:"frame",children:"Custom Frame"}),e.jsx(ve,{value:"moulding",children:"Moulding Entry"})]}),e.jsx(Ae,{value:"frame",children:e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"name",children:"Frame Name *"}),e.jsx(U,{id:"name",value:u.name,onChange:v=>h({...u,name:v.target.value}),placeholder:"Enter frame name",required:!0})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"manufacturer",children:"Manufacturer"}),e.jsx(U,{id:"manufacturer",value:u.manufacturer,onChange:v=>h({...u,manufacturer:v.target.value}),placeholder:"Enter manufacturer"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"material",children:"Material"}),e.jsxs("select",{id:"material",value:u.material,onChange:v=>h({...u,material:v.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"wood",children:"Wood"}),e.jsx("option",{value:"metal",children:"Metal"}),e.jsx("option",{value:"plastic",children:"Plastic"}),e.jsx("option",{value:"composite",children:"Composite"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"width",children:"Width (inches) *"}),e.jsx(U,{id:"width",type:"number",step:"0.125",value:u.width,onChange:v=>h({...u,width:v.target.value}),placeholder:"2.25",required:!0})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"depth",children:"Depth (inches)"}),e.jsx(U,{id:"depth",type:"number",step:"0.125",value:u.depth,onChange:v=>h({...u,depth:v.target.value}),placeholder:"1.25"})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"price",children:"Price per Foot *"}),e.jsx(U,{id:"price",type:"number",step:"0.01",value:u.price,onChange:v=>h({...u,price:v.target.value}),placeholder:"12.99",required:!0})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"color",children:"Color"}),e.jsx(U,{id:"color",type:"color",value:u.color,onChange:v=>h({...u,color:v.target.value})})]}),e.jsx(P,{type:"submit",className:"w-full",children:"Add Frame"})]})}),e.jsx(Ae,{value:"moulding",children:e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"itemNumber",children:"Moulding Item Number *"}),e.jsx(U,{id:"itemNumber",value:m.itemNumber,onChange:v=>x({...m,itemNumber:v.target.value}),placeholder:"e.g., 4512, 210286, L-100",required:!0})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"pricePerFoot",children:"Price per Foot *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx(U,{id:"pricePerFoot",type:"number",step:"0.01",min:"0",value:m.pricePerFoot,onChange:v=>x({...m,pricePerFoot:v.target.value}),placeholder:"12.99",className:"pl-7",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"mouldingName",children:"Name (Optional)"}),e.jsx(U,{id:"mouldingName",value:m.name,onChange:v=>x({...m,name:v.target.value}),placeholder:"Auto-generated if left blank"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"mouldingManufacturer",children:"Manufacturer (Optional)"}),e.jsx(U,{id:"mouldingManufacturer",value:m.manufacturer,onChange:v=>x({...m,manufacturer:v.target.value}),placeholder:"e.g., Larson-Juhl, Nielsen"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"mouldingMaterial",children:"Material"}),e.jsxs("select",{id:"mouldingMaterial",value:m.material,onChange:v=>x({...m,material:v.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"wood",children:"Wood"}),e.jsx("option",{value:"metal",children:"Metal"}),e.jsx("option",{value:"plastic",children:"Plastic"}),e.jsx("option",{value:"composite",children:"Composite"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"mouldingWidth",children:"Width (inches)"}),e.jsx(U,{id:"mouldingWidth",type:"number",step:"0.125",value:m.width,onChange:v=>x({...m,width:v.target.value}),placeholder:"2.25"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"mouldingDepth",children:"Depth (inches)"}),e.jsx(U,{id:"mouldingDepth",type:"number",step:"0.125",value:m.depth,onChange:v=>x({...m,depth:v.target.value}),placeholder:"1.25"})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"mouldingColor",children:"Color"}),e.jsx(U,{id:"mouldingColor",type:"color",value:m.color,onChange:v=>x({...m,color:v.target.value})})]}),e.jsx(P,{type:"submit",className:"w-full",children:"Add Moulding"})]})})]})]})]})}const ED=({charges:s,onChange:t})=>{const r=()=>{const o={id:Date.now().toString(),description:"",amount:0};t([...s,o])},n=(o,l,c)=>{const d=s.map(u=>u.id===o?{...u,[l]:c}:u);t(d)},a=o=>{t(s.filter(l=>l.id!==o))},i=s.reduce((o,l)=>o+l.amount,0);return e.jsxs("div",{className:"bg-white dark:bg-dark-cardBg rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold header-underline",children:"Miscellaneous Charges"}),e.jsx("button",{type:"button",onClick:r,className:"px-3 py-1 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors",children:"Add Charge"})]}),s.length===0?e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx("p",{children:"No miscellaneous charges added."}),e.jsx("p",{className:"text-sm",children:'Click "Add Charge" to include custom fees or add-ons.'})]}):e.jsxs("div",{className:"space-y-3",children:[s.map(o=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 p-3 border border-light-border dark:border-dark-border rounded-md",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Description"}),e.jsx("input",{type:"text",className:"w-full p-2 border border-light-border dark:border-dark-border rounded-md bg-light-bg dark:bg-dark-bg",placeholder:"Enter description (e.g., Rush delivery, Custom hardware)",value:o.description,onChange:l=>n(o.id,"description",l.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Amount ($)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",className:"w-full p-2 border border-light-border dark:border-dark-border rounded-md bg-light-bg dark:bg-dark-bg",placeholder:"0.00",value:o.amount||"",onChange:l=>n(o.id,"amount",parseFloat(l.target.value)||0)})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"button",onClick:()=>a(o.id),className:"p-2 text-red-600 hover:text-red-800 transition-colors",title:"Remove charge",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 8.142A2 2 0 0116.138 17H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})]},o.id)),s.length>0&&e.jsx("div",{className:"border-t border-light-border dark:border-dark-border pt-3",children:e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Total Miscellaneous Charges:"}),e.jsxs("span",{children:["$",i.toFixed(2)]})]})})]})]})};function DD(){const[s,t]=p.useState(!0),[r,n]=p.useState(null),[a,i]=p.useState([]),[o,l]=p.useState([]);return p.useEffect(()=>{async function c(){try{t(!0);const d=await xb();if(d&&d.length>0){console.log("Loaded Crescent matboards from API:",d.length);const u=EE(d);l(u),i([...ci,...u])}else console.log("No Crescent matboards found in Larson Juhl catalog or empty response. Using static fallback data."),l(Xa),i([...ci,...Xa]);n(null)}catch(d){console.error("Error in useMatboards hook:",d),n("Failed to load matboard data"),l(Xa),i([...ci,...Xa])}finally{t(!1)}}c()},[]),{loading:s,error:r,matboards:a,crescentMatboards:o,getMatboardById:c=>a.find(d=>d.id===c),getMatboardsByManufacturer:c=>a.filter(d=>d.manufacturer===c),getMatboardsByCategory:c=>a.filter(d=>d.category===c),getUniqueCategories:()=>Array.from(new Set(a.map(c=>c.category).filter(Boolean))),getUniqueManufacturers:()=>Array.from(new Set(a.map(c=>c.manufacturer).filter(Boolean)))}}async function AD(){try{const s=new AbortController,t=setTimeout(()=>s.abort(),1e4),r=await fetch("/api/frames",{signal:s.signal,headers:{"Content-Type":"application/json"}});if(clearTimeout(t),!r.ok){const a=await r.json().catch(()=>({}));throw new Error(`HTTP ${r.status}: ${a.message||r.statusText}`)}const n=await r.json();return Array.isArray(n.frames)?n.frames:[]}catch(s){return s.name==="AbortError"?console.error("Frame fetch timeout - using fallback data"):console.error("Error fetching frames:",(s==null?void 0:s.message)||s),[{id:"fallback-1",name:"Basic Black Frame",color:"#000000",width:1.5,material:"Wood",price:25,image:"/images/black-frame.jpg",description:"Classic black wood frame"}]}}const _D=[{id:"studio-SM1001",name:"Studio Classic Oak Profile",manufacturer:"Studio Moulding",material:"wood",width:"2.0",depth:"1.5",price:"15.99",catalogImage:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",edgeTexture:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",corner:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",color:"#D2B48C",description:"Traditional oak frame with natural finish"},{id:"studio-SM1002",name:"Studio Modern Black Metal",manufacturer:"Studio Moulding",material:"metal",width:"1.5",depth:"0.75",price:"12.50",catalogImage:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",edgeTexture:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",corner:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",color:"#000000",description:"Sleek black metal frame with matte finish"},{id:"studio-SM2001",name:"Studio Antique Gold Ornate",manufacturer:"Studio Moulding",material:"wood",width:"3.0",depth:"2.0",price:"28.75",catalogImage:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",edgeTexture:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",corner:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",color:"#FFD700",description:"Ornate gold leaf frame for traditional artwork"},{id:"studio-SM2002",name:"Studio Silver Leaf Contemporary",manufacturer:"Studio Moulding",material:"wood",width:"2.5",depth:"1.25",price:"22.99",catalogImage:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",edgeTexture:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",corner:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",color:"#C0C0C0",description:"Contemporary silver leaf frame"},{id:"studio-SM3001",name:"Studio Rustic Barnwood",manufacturer:"Studio Moulding",material:"wood",width:"2.75",depth:"1.75",price:"18.50",catalogImage:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",edgeTexture:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",corner:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60",color:"#8B4513",description:"Distressed barnwood frame for rustic appeal"}],zn=[{id:"larson-4512",name:"Larson Gold Leaf 4512",manufacturer:"Larson-Juhl",material:"wood",width:"2.5",depth:"1.75",price:"12.99",catalogImage:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",edgeTexture:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",corner:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",color:"#D4AF37"},{id:"larson-210286",name:"Larson Academie Black 210286",manufacturer:"Larson-Juhl",material:"wood",width:"1.25",depth:"0.75",price:"8.50",catalogImage:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",edgeTexture:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",corner:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",color:"#000000"},{id:"larson-655320",name:"Larson Biltmore Gold 655320",manufacturer:"Larson-Juhl",material:"wood",width:"1.5",depth:"0.875",price:"10.75",catalogImage:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",edgeTexture:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",corner:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",color:"#FFD700"},{id:"larson-460530",name:"Larson Ventura Silver 460530",manufacturer:"Larson-Juhl",material:"metal",width:"0.75",depth:"1.125",price:"9.25",catalogImage:"https://images.unsplash.com/photo-1510172951991-856a654063f9?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",edgeTexture:"https://images.unsplash.com/photo-1510172951991-856a654063f9?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",corner:"https://images.unsplash.com/photo-1510172951991-856a654063f9?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",color:"#C0C0C0"},{id:"larson-310445",name:"Larson Classic Walnut 310445",manufacturer:"Larson-Juhl",material:"wood",width:"2.0",depth:"1.25",price:"14.50",catalogImage:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",edgeTexture:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",corner:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",color:"#8B4513"},{id:"larson-220158",name:"Larson Heritage Cherry 220158",manufacturer:"Larson-Juhl",material:"wood",width:"1.75",depth:"1.0",price:"11.25",catalogImage:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",edgeTexture:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",corner:"https://images.unsplash.com/photo-1582131503261-fca1d1c0589f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",color:"#722F37"},{id:"nielsen-71",name:"Nielsen Florentine",manufacturer:"Nielsen",material:"metal",width:"1.25",depth:"0.75",price:"8.99",catalogImage:"https://images.unsplash.com/photo-1510172951991-856a654063f9?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",edgeTexture:"https://images.unsplash.com/photo-1510172951991-856a654063f9?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",corner:"https://images.unsplash.com/photo-1510172951991-856a654063f9?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8cGljdHVyZSUyMGZyYW1lfGVufDB8fDB8fHww",color:"#C0C0C0"},{id:"roma-250",name:"Roma Dark Walnut",manufacturer:"Roma Moulding",material:"wood",width:"3.0",depth:"2.0",price:"14.50",catalogImage:"https://images.unsplash.com/photo-1579541591661-567c1ea5dc56?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjB8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",edgeTexture:"https://images.unsplash.com/photo-1579541591661-567c1ea5dc56?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjB8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",corner:"https://images.unsplash.com/photo-1579541591661-567c1ea5dc56?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjB8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",color:"#5C4033"},{id:"omega-102",name:"Omega Black Satin",manufacturer:"Omega Moulding",material:"wood",width:"2.0",depth:"1.5",price:"9.75",catalogImage:"https://images.unsplash.com/photo-1594194208961-0fdf358251d3?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",edgeTexture:"https://images.unsplash.com/photo-1594194208961-0fdf358251d3?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",corner:"https://images.unsplash.com/photo-1594194208961-0fdf358251d3?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",color:"#2D2D2D"},{id:"bella-35",name:"Bella White Simple",manufacturer:"Bella Moulding",material:"composite",width:"1.5",depth:"1.0",price:"6.50",catalogImage:"https://images.unsplash.com/photo-1574117936532-46e544aeb239?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjZ8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",edgeTexture:"https://images.unsplash.com/photo-1574117936532-46e544aeb239?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjZ8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",corner:"https://images.unsplash.com/photo-1574117936532-46e544aeb239?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjZ8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",color:"#F5F5F5"},{id:"larson-8921",name:"Larson Ornate Gold",manufacturer:"Larson-Juhl",material:"wood",width:"3.5",depth:"2.25",price:"18.99",catalogImage:"https://images.unsplash.com/photo-1581814605484-050c5bb1196c?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MzF8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",edgeTexture:"https://images.unsplash.com/photo-1581814605484-050c5bb1196c?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MzF8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",corner:"https://images.unsplash.com/photo-1581814605484-050c5bb1196c?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MzF8fHBpY3R1cmUlMjBmcmFtZXxlbnwwfHwwfHx8MA%3D%3D",color:"#D4AF37"},..._D];function ID(){const[s,t]=p.useState(null),{data:r,isLoading:n,error:a}=me({queryKey:["/api/frames"],queryFn:async()=>{try{console.log("Fetching frames from catalog API...");const l=await AD();if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);const c=await l.json();if(console.log("Loaded frames from API:",(c==null?void 0:c.length)||0),!Array.isArray(c)||c.length===0)return console.log("No valid frames from API, using static frame catalog data"),zn;console.log("Converting API frame data to Frame format");const d=c.filter(u=>u&&typeof u=="object").map((u,h)=>({id:u.id||`api-frame-${h}`,name:u.name||`Frame ${h+1}`,material:u.material||"wood",width:String(u.width||"1.0"),depth:String(u.depth||"0.5"),color:u.color||"#8B4513",price:String(u.price||"10.00"),manufacturer:u.manufacturer||"Generic",imageUrl:u.imageUrl||u.image_url||"",description:u.description||""}));return console.log(`Successfully converted ${d.length} frames from API`),d.length>0?d:zn}catch(l){return console.error("Error fetching frames from API:",l),logError(l,"Frames API fetch"),console.log("Using static frame data as fallback"),zn}},staleTime:5*60*1e3,cacheTime:30*60*1e3,retry:2,retryDelay:1e3});return p.useEffect(()=>{r&&r.length>0?t(r):!n&&(!r||r.length===0)&&(console.log("No frames from API, using static frame catalog data"),t(zn))},[r,n]),{frames:s,loading:n,error:a,getFrameById:l=>s?s.find(c=>c.id===l):zn.find(c=>c.id===l),getFramesByManufacturer:l=>s?s.filter(c=>c.manufacturer===l):zn.filter(c=>c.manufacturer===l)}}var RD="Separator",Fh="horizontal",MD=["horizontal","vertical"],Gb=p.forwardRef((s,t)=>{const{decorative:r,orientation:n=Fh,...a}=s,i=OD(n)?n:Fh,l=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx(Se.div,{"data-orientation":i,...l,...a,ref:t})});Gb.displayName=RD;function OD(s){return MD.includes(s)}var Qb=Gb;const Ot=p.forwardRef(({className:s,orientation:t="horizontal",decorative:r=!0,...n},a)=>e.jsx(Qb,{ref:a,decorative:r,orientation:t,className:J("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...n}));Ot.displayName=Qb.displayName;function FD({primaryDesign:s,comparisonDesign:t,onDesignSelect:r,onCompareToggle:n}){const[a,i]=p.useState(!1),[o,l]=p.useState(!1),[c,d]=p.useState(1),[u,h]=p.useState(1),[m,x]=p.useState(0),[g,f]=p.useState(0);p.useEffect(()=>{n&&n(a)},[a,n]);const v=({design:y,title:j,zoom:b,rotation:k,onZoomChange:S,onRotationChange:A,isComparison:T=!1})=>y?e.jsxs(V,{className:`${T?"border-orange-200":"border-blue-200"}`,children:[e.jsx(G,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Q,{className:"text-sm font-medium",children:j}),e.jsxs(ue,{variant:T?"secondary":"default",children:["$",y.totalPrice.toFixed(2)]})]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"relative h-64 bg-gray-50 rounded-lg overflow-hidden border-2 border-gray-200 mb-4",children:[e.jsx("div",{className:"absolute inset-4 border-8 rounded-sm shadow-lg transition-transform duration-200",style:{borderColor:y.matColor==="black"?"#2C2C2C":y.matColor==="crescent-ultramarine"?"#4166B0":y.matColor||"#8B4513",transform:`scale(${b}) rotate(${k}deg)`,transformOrigin:"center"},children:e.jsx("div",{className:"relative h-full bg-white border-4",style:{borderColor:y.matColor==="black"?"#2C2C2C":y.matColor==="crescent-ultramarine"?"#4166B0":y.matColor||"#F5F5DC"},children:e.jsx("div",{className:"absolute inset-4 bg-gray-300 flex items-center justify-center text-xs text-gray-600",children:y.artworkImage?e.jsx("img",{src:y.artworkImage,alt:"Artwork",className:"max-w-full max-h-full object-contain"}):e.jsx("span",{children:"Artwork Preview"})})})}),e.jsx("div",{className:"absolute inset-4 bg-gradient-to-br from-transparent via-white/10 to-transparent pointer-events-none rounded-sm"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>S(Math.max(.5,b-.1)),children:e.jsx(k2,{className:"h-3 w-3"})}),e.jsxs("span",{className:"text-xs font-mono",children:[(b*100).toFixed(0),"%"]}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>S(Math.min(2,b+.1)),children:e.jsx(T2,{className:"h-3 w-3"})})]}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>A(k+90),children:e.jsx(lj,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Frame:"}),e.jsx("span",{className:"font-medium",children:y.frameName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Dimensions:"}),e.jsxs("span",{className:"font-medium",children:[y.dimensions.width,'" × ',y.dimensions.height,'"']})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Glass:"}),e.jsx("span",{className:"font-medium",children:y.glassType})]})]})]})]}):e.jsx(V,{className:`h-96 ${T?"border-orange-200":"border-blue-200"}`,children:e.jsx(q,{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(pi,{className:"mx-auto mb-2 h-12 w-12"}),e.jsx("p",{children:"No design selected"})]})})});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Frame Preview"}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>l(!o),children:o?e.jsx(oj,{className:"h-4 w-4"}):e.jsx(ns,{className:"h-4 w-4"})})]}),o&&e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(P,{variant:a?"default":"outline",size:"sm",onClick:()=>i(!a),children:[a?e.jsx(C2,{className:"h-4 w-4 mr-1"}):e.jsx(pi,{className:"h-4 w-4 mr-1"}),"Compare Mode"]})})]}),o&&e.jsxs("div",{className:`grid gap-4 ${a?"grid-cols-1 lg:grid-cols-2":"grid-cols-1"}`,children:[e.jsx(v,{design:s,title:"Primary Design",zoom:c,rotation:m,onZoomChange:d,onRotationChange:x}),a&&e.jsx(v,{design:t,title:"Comparison Design",zoom:u,rotation:g,onZoomChange:h,onRotationChange:f,isComparison:!0})]}),!o&&s&&e.jsx(V,{className:"border-gray-200",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-sm",children:s.frameName}),e.jsxs("p",{className:"text-xs text-gray-600",children:[s.dimensions.width,'" × ',s.dimensions.height,'" | ',s.glassType]})]}),e.jsxs(ue,{variant:"secondary",className:"font-medium",children:["$",s.totalPrice.toFixed(2)]})]})})}),a&&s&&t&&e.jsx(V,{className:"bg-gray-50",children:e.jsx(q,{className:"pt-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Price Comparison"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Primary:"}),e.jsxs("span",{children:["$",s.totalPrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Comparison:"}),e.jsxs("span",{children:["$",t.totalPrice.toFixed(2)]})]}),e.jsx(Ot,{}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Difference:"}),e.jsxs("span",{className:s.totalPrice<t.totalPrice?"text-green-600":"text-red-600",children:["$",Math.abs(s.totalPrice-t.totalPrice).toFixed(2)]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{variant:"outline",size:"sm",className:"w-full",onClick:()=>r==null?void 0:r(s),children:"Select Primary"}),e.jsx(P,{variant:"outline",size:"sm",className:"w-full",onClick:()=>r==null?void 0:r(t),children:"Select Comparison"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Design Notes"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsx("p",{children:"• Zoom and rotate to examine details"}),e.jsx("p",{children:"• Compare pricing and materials"}),e.jsx("p",{children:"• Select preferred design for order"})]})]})]})})})]})}var Iu="Popover",[Zb,rU]=fs(Iu,[Ea]),Ki=Ea(),[LD,Jr]=Zb(Iu),Yb=s=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:o=!1}=s,l=Ki(t),c=p.useRef(null),[d,u]=p.useState(!1),[h=!1,m]=ms({prop:n,defaultProp:a,onChange:i});return e.jsx(lu,{...l,children:e.jsx(LD,{scope:t,contentId:hr(),triggerRef:c,open:h,onOpenChange:m,onOpenToggle:p.useCallback(()=>m(x=>!x),[m]),hasCustomAnchor:d,onCustomAnchorAdd:p.useCallback(()=>u(!0),[]),onCustomAnchorRemove:p.useCallback(()=>u(!1),[]),modal:o,children:r})})};Yb.displayName=Iu;var Xb="PopoverAnchor",$D=p.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=Jr(Xb,r),i=Ki(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=a;return p.useEffect(()=>(o(),()=>l()),[o,l]),e.jsx(bl,{...i,...n,ref:t})});$D.displayName=Xb;var Jb="PopoverTrigger",ew=p.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=Jr(Jb,r),i=Ki(r),o=Ge(t,a.triggerRef),l=e.jsx(Se.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":aw(a.open),...n,ref:o,onClick:ge(s.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:e.jsx(bl,{asChild:!0,...i,children:l})});ew.displayName=Jb;var Ru="PopoverPortal",[BD,VD]=Zb(Ru,{forceMount:void 0}),tw=s=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=s,i=Jr(Ru,t);return e.jsx(BD,{scope:t,forceMount:r,children:e.jsx(ds,{present:r||i.open,children:e.jsx(Ky,{asChild:!0,container:a,children:n})})})};tw.displayName=Ru;var ga="PopoverContent",sw=p.forwardRef((s,t)=>{const r=VD(ga,s.__scopePopover),{forceMount:n=r.forceMount,...a}=s,i=Jr(ga,s.__scopePopover);return e.jsx(ds,{present:n||i.open,children:i.modal?e.jsx(UD,{...a,ref:t}):e.jsx(HD,{...a,ref:t})})});sw.displayName=ga;var UD=p.forwardRef((s,t)=>{const r=Jr(ga,s.__scopePopover),n=p.useRef(null),a=Ge(t,n),i=p.useRef(!1);return p.useEffect(()=>{const o=n.current;if(o)return Hy(o)},[]),e.jsx(qy,{as:gl,allowPinchZoom:!0,children:e.jsx(rw,{...s,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(s.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:ge(s.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;i.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:ge(s.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),HD=p.forwardRef((s,t)=>{const r=Jr(ga,s.__scopePopover),n=p.useRef(!1),a=p.useRef(!1);return e.jsx(rw,{...s,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=s.onCloseAutoFocus)==null||o.call(s,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,d;(c=s.onInteractOutside)==null||c.call(s,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((d=r.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),rw=p.forwardRef((s,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...h}=s,m=Jr(ga,r),x=Ki(r);return zy(),e.jsx(Wy,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:e.jsx(vl,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>m.onOpenChange(!1),children:e.jsx(iu,{"data-state":aw(m.open),role:"dialog",id:m.contentId,...x,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),nw="PopoverClose",qD=p.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=Jr(nw,r);return e.jsx(Se.button,{type:"button",...n,ref:t,onClick:ge(s.onClick,()=>a.onOpenChange(!1))})});qD.displayName=nw;var zD="PopoverArrow",WD=p.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=Ki(r);return e.jsx(ou,{...a,...n,ref:t})});WD.displayName=zD;function aw(s){return s?"open":"closed"}var KD=Yb,GD=ew,QD=tw,iw=sw;const ZD=KD,YD=GD,ow=p.forwardRef(({className:s,align:t="center",sideOffset:r=4,...n},a)=>e.jsx(QD,{children:e.jsx(iw,{ref:a,align:t,sideOffset:r,className:J("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})}));ow.displayName=iw.displayName;let XD=class{constructor(t={}){this.initialized=!1,this.canvas=null,this.ctx=null,this.options={markerSizeCm:t.markerSizeCm||2.54,minContourArea:t.minContourArea||1e3,edgeDetectionThreshold:t.edgeDetectionThreshold||100,allowManualOverride:t.allowManualOverride!==void 0?t.allowManualOverride:!0}}async initialize(){try{if(this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),!this.ctx)throw new Error("Failed to get canvas context");this.initialized=!0,console.log("Artwork size detector initialized successfully")}catch(t){throw console.error("Failed to initialize artwork size detector:",t),t}}generateMarker(t=500){const r=document.createElement("canvas"),n=r.getContext("2d");if(!n)throw new Error("Failed to get canvas context");r.width=t,r.height=t,n.fillStyle="white",n.fillRect(0,0,t,t);const a=Math.floor(t*.08);n.fillStyle="black",n.fillRect(0,0,t,a),n.fillRect(0,0,a,t),n.fillRect(t-a,0,a,t),n.fillRect(0,t-a,t,a);const i=t-a*2,o=8,l=i/o,c=[[1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,1],[1,0,1,1,1,1,0,1],[1,0,1,0,0,1,0,1],[1,0,1,0,0,1,0,1],[1,0,1,1,1,1,0,1],[1,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1]];for(let y=0;y<o;y++)for(let j=0;j<o;j++)c[y]&&c[y][j]===1&&n.fillRect(a+j*l,a+y*l,l,l);const d=t/2,u=t/2,h=t*.1;n.strokeStyle="red",n.lineWidth=Math.max(3,t/100),n.beginPath(),n.moveTo(d-h,u),n.lineTo(d+h,u),n.stroke(),n.beginPath(),n.moveTo(d,u-h),n.lineTo(d,u+h),n.stroke();const m=Math.floor(t*.15);n.fillStyle="white",n.fillRect(0,t-m,t,m),n.fillStyle="black";const x=Math.floor(t/16);n.font=`bold ${x}px Arial, sans-serif`,n.textAlign="center";const f=(this.options.markerSizeCm||2.54)/2.54;n.fillText(`${f}" × ${f}"`,t/2,t-m/2);const v=Math.floor(t*.15);return n.fillStyle="red",n.beginPath(),n.moveTo(0,0),n.lineTo(v,0),n.lineTo(0,v),n.fill(),n.beginPath(),n.moveTo(t,0),n.lineTo(t-v,0),n.lineTo(t,v),n.fill(),n.beginPath(),n.moveTo(0,t),n.lineTo(v,t),n.lineTo(0,t-v),n.fill(),n.beginPath(),n.moveTo(t,t),n.lineTo(t-v,t),n.lineTo(t,t-v),n.fill(),r}downloadMarker(){const t=this.generateMarker(500),r=document.createElement("a");r.download="reference-marker.png",r.href=t.toDataURL("image/png"),r.click()}async estimateDimensions(t){if(this.initialized||await this.initialize(),!this.canvas||!this.ctx)throw new Error("Canvas not initialized");try{this.canvas.width=t.width,this.canvas.height=t.height,this.ctx.drawImage(t,0,0,t.width,t.height);const r=t.width/t.height,n=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),a=this.detectReferenceMarker(n);if(a.found){console.log("Reference marker detected:",a);const l=(this.options.markerSizeCm||2.54)/2.54/a.sizeInPixels*a.detectedSizeInPixels,c=t.width-a.detectedSizeInPixels,d=t.height-a.detectedSizeInPixels;let u=c*l,h=d*l;a.position==="top"||a.position==="bottom"?h=d*l:(a.position==="left"||a.position==="right")&&(u=c*l),u=Math.round(u*4)/4,h=Math.round(h*4)/4;const m=5,x=40;return u=Math.max(m,Math.min(x,u)),h=Math.max(m,Math.min(x,h)),console.log("Marker-based dimensions:",u,"x",h,"inches"),{width:u,height:h,unit:"in"}}else{console.log("No reference marker detected, using estimation method");const i=[{width:5,height:7},{width:8,height:10},{width:11,height:14},{width:16,height:20},{width:18,height:24},{width:20,height:24},{width:24,height:36}];let o=i[0],l=Math.abs(o.width/o.height-r);for(const x of i){const g=x.width/x.height,f=Math.abs(g-r);f<l&&(l=f,o=x)}const c=Math.min(1.5,Math.max(.7,t.width/2e3));let d=o.width*c,u=o.height*c;l>.2&&(r>=1?(d=16,u=16/r):(u=16,d=16*r)),d=Math.round(d*2)/2,u=Math.round(u*2)/2;const h=5,m=40;return d=Math.max(h,Math.min(m,d)),u=Math.max(h,Math.min(m,u)),console.log("Image dimensions:",t.width,"x",t.height,"pixels"),console.log("Aspect ratio:",r),console.log("Closest standard size:",o.width,"x",o.height),console.log("Size adjustment factor:",c),console.log("Estimated dimensions:",d,"x",u,"inches"),{width:d,height:u,unit:"in"}}}catch(r){return console.error("Error estimating artwork dimensions:",r),{width:16,height:20,unit:"in"}}}detectReferenceMarker(t){try{const{data:r,width:n,height:a}=t,i={hasDarkBorder:!0,hasInternalPattern:!0,hasColoredCorners:!0},o=this.options.edgeDetectionThreshold||100,l=this.findPotentialMarkers(r,n,a,o);if(l.length===0)return console.log("No potential markers found"),{found:!1,sizeInPixels:0,detectedSizeInPixels:0,confidence:0,position:"center"};let c=0,d=null;for(const u of l){const{x:h,y:m,width:x,height:g}=u,f=this.checkForBlackBorder(r,n,h,m,x,g),v=this.checkForInternalPattern(r,n,h,m,x,g),y=this.checkForRedCorners(r,n,h,m,x,g),j=(f?.4:0)+(v?.4:0)+(y?.2:0);j>c&&(c=j,d=u)}if(d&&c>.5){const u=this.determineMarkerPosition(d,n,a);return{found:!0,sizeInPixels:500,detectedSizeInPixels:Math.max(d.width,d.height),confidence:c,position:u}}return{found:!1,sizeInPixels:0,detectedSizeInPixels:0,confidence:0,position:"center"}}catch(r){return console.error("Error detecting reference marker:",r),{found:!1,sizeInPixels:0,detectedSizeInPixels:0,confidence:0,position:"center"}}}findPotentialMarkers(t,r,n,a){const i=[],o=Math.min(r,n)*.05,l=Math.min(r,n)*.4,c=10,d=Math.floor(r/c),u=Math.floor(n/c);for(let h=0;h<c-1;h++)for(let m=0;m<c-1;m++){const x=m*d,g=h*u;for(let f=1;f<=3;f++){const v=d*f,y=u*f;x+v>=r||g+y>=n||v<o||v>l||y<o||y>l||this.checkRegionEdges(t,r,x,g,v,y,a)&&i.push({x,y:g,width:v,height:y})}}return console.log("Found",i.length,"potential markers"),i}checkRegionEdges(t,r,n,a,i,o,l){let d=0;for(let u=0;u<20;u++){const h=n+Math.floor(i*(u/20));this.isEdgePoint(t,r,h,a,l)&&d++,this.isEdgePoint(t,r,h,a+o-1,l)&&d++}for(let u=0;u<20;u++){const h=a+Math.floor(o*(u/20));this.isEdgePoint(t,r,n,h,l)&&d++,this.isEdgePoint(t,r,n+i-1,h,l)&&d++}return d>=20}isEdgePoint(t,r,n,a,i){if(n<=0||n>=r-1||a<=0)return!1;const o=(a*r+n)*4,l=h=>{const m=o+h;return(t[m]+t[m+1]+t[m+2])/3},c=-l(-r*4-4)+l(-r*4+4)+-2*l(-4)+2*l(4)+-l(r*4-4)+l(r*4+4),d=-l(-r*4-4)-2*l(-r*4)-l(-r*4+4)+l(r*4-4)+2*l(r*4)+l(r*4+4);return Math.sqrt(c*c+d*d)>i}checkForBlackBorder(t,r,n,a,i,o){const l=Math.floor(Math.min(i,o)*.08),c=10;let d=0,u=0;for(let h=0;h<c;h++){const m=n+Math.floor(i*(h/c));for(let v=0;v<l;v++)this.isDarkPixel(t,r,m,a+v)&&d++,u++;const x=n+Math.floor(i*(h/c));for(let v=0;v<l;v++)this.isDarkPixel(t,r,x,a+o-1-v)&&d++,u++;const g=a+Math.floor(o*(h/c));for(let v=0;v<l;v++)this.isDarkPixel(t,r,n+v,g)&&d++,u++;const f=a+Math.floor(o*(h/c));for(let v=0;v<l;v++)this.isDarkPixel(t,r,n+i-1-v,f)&&d++,u++}return d/u>.6}checkForInternalPattern(t,r,n,a,i,o){const l=Math.floor(Math.min(i,o)*.08),c=n+l,d=a+l,u=i-l*2,h=o-l*2,m=3;let x=0,g=0;for(let y=0;y<m;y++)for(let j=0;j<m;j++){const b=c+Math.floor(u*(j+.5)/m),k=d+Math.floor(h*(y+.5)/m);this.isDarkPixel(t,r,b,k)?x++:g++}const f=x+g,v=x/f;return v>.2&&v<.8}checkForRedCorners(t,r,n,a,i,o){const l=Math.floor(Math.min(i,o)*.15);let c=0;return this.hasRedCorner(t,r,n,a,l,"top-left")&&c++,this.hasRedCorner(t,r,n+i-l,a,l,"top-right")&&c++,this.hasRedCorner(t,r,n,a+o-l,l,"bottom-left")&&c++,this.hasRedCorner(t,r,n+i-l,a+o-l,l,"bottom-right")&&c++,c>=2}hasRedCorner(t,r,n,a,i,o){let l=0,c=0;for(let d=0;d<i;d++)for(let u=0;u<i;u++){let h=!1;switch(o){case"top-left":h=u+d<i;break;case"top-right":h=i-u+d<i;break;case"bottom-left":h=u+i-d<i;break;case"bottom-right":h=i-u+i-d<i;break}if(h){const m=n+u,x=a+d;this.isRedPixel(t,r,m,x)&&l++,c++}}return c>0&&l/c>.4}isDarkPixel(t,r,n,a){const i=(a*r+n)*4,o=t[i],l=t[i+1],c=t[i+2];return(o+l+c)/3<80}isRedPixel(t,r,n,a){const i=(a*r+n)*4,o=t[i],l=t[i+1],c=t[i+2];return o>150&&o>l*1.5&&o>c*1.5}determineMarkerPosition(t,r,n){const{x:a,y:i,width:o,height:l}=t,c=a+o/2,d=i+l/2,u=c/r,h=d/n;return h<.33?"top":h>.66?"bottom":u<.33?"left":u>.66?"right":"center"}createVisualization(t,r){const n=document.createElement("canvas"),a=n.getContext("2d");if(!a)throw new Error("Failed to get canvas context");n.width=t.width,n.height=t.height,a.drawImage(t,0,0,t.width,t.height),a.strokeStyle="rgba(0, 255, 0, 0.8)",a.lineWidth=3;const i=Math.min(t.width,t.height)*.1;a.strokeRect(i,i,t.width-i*2,t.height-i*2);const o=`${r.width}" × ${r.height}"`;a.font=`bold ${Math.max(16,Math.floor(t.width/20))}px Arial, sans-serif`,a.fillStyle="rgba(255, 255, 255, 0.8)";const l=a.measureText(o).width+20,c=Math.max(24,Math.floor(t.width/15));return a.fillRect((t.width-l)/2,t.height-i-c-10,l,c),a.fillStyle="rgba(0, 0, 0, 0.9)",a.textAlign="center",a.fillText(o,t.width/2,t.height-i-20),n}};function JD(s){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{if(!a.target||!a.target.result){r(new Error("Failed to read file data"));return}const i=new Image;i.onload=()=>t(i),i.onerror=()=>r(new Error("Failed to load image")),i.src=a.target.result},n.onerror=()=>r(new Error("Failed to read file")),n.readAsDataURL(s)})}function lw({frames:s,mats:t,artworkWidth:r,artworkHeight:n,artworkImage:a,useMultipleMats:i,useMultipleFrames:o,onFrameImageCaptured:l}){const c=p.useRef(null);return p.useEffect(()=>{if(!c.current)return;const d=c.current,u=d.getContext("2d");if(!u)return;const h=1200,m=900;d.width=h,d.height=m,u.clearRect(0,0,d.width,d.height);const x=600,g=r/n;let f,v;g>1?(f=x,v=x/g):(v=x,f=x*g);let y=0,j=0;s.forEach(W=>{const Z=parseFloat(W.frame.width)||1;y+=Z*8}),t.forEach(W=>{j+=W.width*8});const b=y+j,k=f+b*2,S=v+b*2,A=(d.width-k)/2,T=(d.height-S)/2;let C=A,E=T,D=k,w=S;const N=[...s].sort((W,Z)=>Z.position-W.position);if(o)N.forEach(W=>{const Z=(parseFloat(W.frame.width)||1)*8;u.fillStyle=W.frame.color||"#8B4513",u.fillRect(C,E,D,w),u.fillStyle="transparent",u.clearRect(C+Z,E+Z,D-Z*2,w-Z*2),C+=Z,E+=Z,D-=Z*2,w-=Z*2});else if(s.length>0){const W=N[N.length-1].frame,Z=(parseFloat(W.width)||1)*8;u.fillStyle=W.color||"#8B4513",u.fillRect(C,E,D,w),u.clearRect(C+Z,E+Z,D-Z*2,w-Z*2),C+=Z,E+=Z,D-=Z*2,w-=Z*2}const _=[...t].sort((W,Z)=>Z.position-W.position);if(i)_.forEach(W=>{const Z=W.width*8;u.fillStyle=W.matboard.color||"#FFFFFF",u.fillRect(C,E,D,w),u.clearRect(C+Z,E+Z,D-Z*2,w-Z*2),C+=Z,E+=Z,D-=Z*2,w-=Z*2});else if(t.length>0){const W=_[_.length-1],Z=W.width*8;u.fillStyle=W.matboard.color||"#FFFFFF",u.fillRect(C,E,D,w),u.clearRect(C+Z,E+Z,D-Z*2,w-Z*2),C+=Z,E+=Z,D-=Z*2,w-=Z*2}if(a){const W=new Image;W.onload=()=>{u.drawImage(W,C,E,D,w),l&&setTimeout(()=>{try{const Z=d.toDataURL("image/jpeg",.9);l(Z)}catch(Z){console.error("Error capturing frame design:",Z)}},100)},W.onerror=()=>F(),W.src=a}else F();function F(){u&&(u.fillStyle="#f8f9fa",u.fillRect(C,E,D,w),u.strokeStyle="#dee2e6",u.lineWidth=2,u.strokeRect(C,E,D,w),u.fillStyle="#6c757d",u.font="bold 18px Arial",u.textAlign="center",u.textBaseline="middle",u.fillText("Your Artwork",C+D/2,E+w/2),l&&setTimeout(()=>{try{const W=d.toDataURL("image/jpeg",.9);l(W)}catch(W){console.error("Error capturing frame design:",W)}},100))}},[s,t,r,n,a,o,i,l]),e.jsxs("div",{className:"frame-visualizer-container w-full",children:[e.jsx("div",{className:"w-full bg-gray-50 p-2 sm:p-4 rounded-lg overflow-x-auto",children:e.jsx("div",{className:"flex justify-center min-w-[320px]",children:e.jsx("canvas",{ref:c,className:"border-2 border-gray-300 shadow-xl rounded-lg bg-white max-w-full h-auto",width:1200,height:900,style:{width:"100%",maxWidth:"1200px",height:"auto",aspectRatio:"4/3",display:"block"}})})}),e.jsx("div",{className:"text-center text-sm text-gray-600 mt-4",children:s.length>0||t.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[s.length>0&&(o?`${s.length} frames`:"Single frame"),s.length>0&&t.length>0&&" | ",t.length>0&&(i?`${t.length} mats`:"Single mat"),(s.length>0||t.length>0)&&` | Artwork: ${r}" × ${n}"`]}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",onClick:()=>{if(c.current)try{const d=document.createElement("a");d.download=`framed-artwork-${new Date().toISOString().split("T")[0]}.png`,d.href=c.current.toDataURL("image/png",1),d.click()}catch(d){console.error("Error downloading frame design:",d)}},children:"Download Preview"})]}):e.jsx("p",{children:"Select frames and mats to see preview"})})]})}async function mo(s,t={}){const{maxWidth:r=1920,maxHeight:n=1920,quality:a=.8,format:i="jpeg",maxSizeKB:o=1024}=t;return new Promise((l,c)=>{const d=document.createElement("canvas"),u=d.getContext("2d"),h=new Image;if(h.onload=()=>{try{let{width:m,height:x}=h;const g=m/x;if(m>r&&(m=r,x=m/g),x>n&&(x=n,m=x*g),d.width=m,d.height=x,!u){c(new Error("Canvas context not available"));return}u.drawImage(h,0,0,m,x);const f=`image/${i}`;let v=d.toDataURL(f,a);if(v.length*.75/1024>o&&a>.1){const j=Math.max(.1,a*.7);v=d.toDataURL(f,j)}l(v)}catch(m){c(m)}},h.onerror=()=>c(new Error("Failed to load image")),typeof s=="string")h.src=s;else{const m=new FileReader;m.onload=x=>{var g;h.src=(g=x.target)==null?void 0:g.result},m.onerror=()=>c(new Error("Failed to read file")),m.readAsDataURL(s)}})}function Dr(s){return s.split(",")[1].length*.75/1024}function eA({onDimensionsDetected:s,defaultWidth:t=8,defaultHeight:r=10,frames:n=[],mats:a=[],useMultipleFrames:i=!1,useMultipleMats:o=!1,onFrameImageCaptured:l}){const{toast:c}=Be(),[d,u]=p.useState(null),[h,m]=p.useState(!1),[x,g]=p.useState("upload"),[f,v]=p.useState({width:t,height:r,unit:"in"}),[y,j]=p.useState(null),[b,k]=p.useState(!1),[S,A]=p.useState(1),[T,C]=p.useState(0),[E,D]=p.useState(0),[w,N]=p.useState(!1),[_,F]=p.useState(null),W=p.useRef(null),Z=p.useRef(null),$=p.useRef(null);p.useEffect(()=>((async()=>{try{const z=new XD;await z.initialize(),u(z),console.log("Artwork size detector initialized successfully")}catch(z){console.error("Failed to initialize artwork detector:",z),k(!0)}})(),()=>{$.current&&$.current.getTracks().forEach(z=>z.stop())}),[]);const ae=async Y=>{if(!Y.type.startsWith("image/")){c({title:"Invalid File Type",description:"Please upload an image file (JPG, PNG, etc.)",variant:"destructive"});return}m(!0);try{const z=URL.createObjectURL(Y);if(j(z),d){const le=await JD(Y),ye=await d.estimateDimensions(le);v(ye);const he=new FileReader;he.onload=async je=>{var xt;const Ne=(xt=je.target)==null?void 0:xt.result,Qe=Dr(Ne);console.log(`Original image size: ${Qe.toFixed(1)} KB`);let ke=Ne;if(Qe>500){ke=await mo(Ne,{maxWidth:1920,maxHeight:1920,quality:.8,maxSizeKB:500});const yt=Dr(ke);console.log(`Compressed image size: ${yt.toFixed(1)} KB`)}s(ye,ke)},he.readAsDataURL(Y),c({title:"Dimensions Detected",description:`Detected artwork size: ${ye.width}" × ${ye.height}"`})}else{const le=new FileReader;le.onload=async ye=>{var Qe;const he=(Qe=ye.target)==null?void 0:Qe.result,je=Dr(he);console.log(`Original image size: ${je.toFixed(1)} KB`);let Ne=he;if(je>500){Ne=await mo(he,{maxWidth:1920,maxHeight:1920,quality:.8,maxSizeKB:500});const ke=Dr(Ne);console.log(`Compressed image size: ${ke.toFixed(1)} KB`)}s(f,Ne)},le.readAsDataURL(Y)}}catch(z){console.error("Error processing image:",z),c({title:"Processing Error",description:"Failed to process image. Please try again or enter dimensions manually.",variant:"destructive"}),k(!0)}finally{m(!1)}},O=Y=>{Y.target.files&&Y.target.files[0]&&ae(Y.target.files[0])},ne=(Y,z)=>{const le=parseFloat(z);!isNaN(le)&&le>0&&v(ye=>({...ye,[Y]:le}))},Pe=()=>{y?(s(f,y),c({title:"Dimensions Updated",description:`Manual dimensions set to ${f.width}" × ${f.height}"`})):c({title:"No Image Selected",description:"Please upload an image first.",variant:"destructive"})},st=async()=>{try{const z=(await navigator.mediaDevices.enumerateDevices()).filter(ye=>ye.kind==="videoinput");console.log("Available camera devices:",z.length),z.forEach((ye,he)=>{console.log(`Camera ${he}: ${ye.label||"Unnamed camera"}`)});let le;try{le=await navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"},width:{ideal:3840},height:{ideal:2160},frameRate:{ideal:30}}}),console.log("Successfully accessed rear-facing camera")}catch(ye){if(console.log("Could not access rear camera, trying alternative:",ye),z.length>1){const he=z[z.length>1?1:0].deviceId;try{le=await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:he},width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30}}}),console.log("Using specific camera device:",he)}catch(je){console.log("Error using specific camera, falling back to default:",je),le=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1920},height:{ideal:1080}}})}}else le=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1920},height:{ideal:1080}}})}if(Z.current){Z.current.srcObject=le,$.current=le;const ye=le.getVideoTracks()[0];if(ye){console.log("Video track capabilities:",ye.getCapabilities());try{await ye.applyConstraints({advanced:[{focusMode:"continuous"},{whiteBalance:"continuous"},{exposureMode:"continuous"}]})}catch(he){console.log("Could not apply advanced constraints:",he)}}}}catch(Y){console.error("Error accessing webcam:",Y),c({title:"Webcam Error",description:"Failed to access camera. Please check permissions or use file upload instead.",variant:"destructive"})}},rt=()=>{$.current&&($.current.getTracks().forEach(Y=>Y.stop()),$.current=null,Z.current&&(Z.current.srcObject=null))};p.useEffect(()=>{x==="webcam"?st():rt()},[x]);const B=async()=>{if(!Z.current||!$.current){c({title:"Webcam Not Ready",description:"Webcam is not ready. Please try again.",variant:"destructive"});return}m(!0);try{const Y=$.current.getVideoTracks()[0];if(Y&&Y.getCapabilities&&Y.getCapabilities().focusMode)try{await Y.applyConstraints({advanced:[{focusMode:"continuous"}]}),await new Promise(he=>setTimeout(he,500))}catch(he){console.log("Focus before capture not supported:",he)}const z=document.createElement("canvas");z.width=Z.current.videoWidth,z.height=Z.current.videoHeight;const le=z.getContext("2d");if(!le)throw new Error("Failed to get canvas context");console.log("Capturing image at resolution:",z.width,"x",z.height),le.drawImage(Z.current,0,0);try{const he=le.getImageData(0,0,z.width,z.height);this.enhanceImageContrast(he.data),le.putImageData(he,0,0)}catch(he){console.log("Image enhancement failed, continuing with original image:",he)}const ye=z.toDataURL("image/jpeg",.95);if(j(ye),d){const he=new Image;he.onload=async()=>{try{console.log("Processing image for size detection, resolution:",he.width,"x",he.height);const je=await d.estimateDimensions(he);console.log("Detection result:",je);try{const ke=d.createVisualization(he,je).toDataURL("image/jpeg");j(ke)}catch(Qe){console.error("Error creating visualization:",Qe)}if(je.width>=5&&je.width<=40&&je.height>=5&&je.height<=40){v(je);const Qe=Dr(ye);console.log(`Original webcam image size: ${Qe.toFixed(1)} KB`);let ke=ye;if(Qe>500){ke=await mo(ye,{maxWidth:1920,maxHeight:1920,quality:.8,maxSizeKB:500});const xt=Dr(ke);console.log(`Compressed webcam image size: ${xt.toFixed(1)} KB`)}s(je,ke),c({title:"Dimensions Detected",description:`Detected artwork size: ${je.width}" × ${je.height}"`})}else{console.log("Detection resulted in invalid size:",je);const Qe=he.width/he.height;let ke=16,xt;Qe>=1?xt=Math.round(ke/Qe*10)/10:(xt=20,ke=Math.round(xt*Qe*10)/10),ke=Math.max(5,Math.min(40,ke)),xt=Math.max(5,Math.min(40,xt));const yt={width:ke,height:xt,unit:"in"};v(yt);const K=Dr(ye);console.log(`Original webcam image size: ${K.toFixed(1)} KB`);let be=ye;if(K>500){be=await mo(ye,{maxWidth:1920,maxHeight:1920,quality:.8,maxSizeKB:500});const nt=Dr(be);console.log(`Compressed webcam image size: ${nt.toFixed(1)} KB`)}s(yt,be),c({title:"Detection Adjusted",description:"Using estimated dimensions. Please verify or adjust manually.",variant:"warning"}),k(!0)}}catch(je){console.error("Error detecting dimensions:",je),c({title:"Detection Error",description:"Failed to detect dimensions. Please try again or enter manually.",variant:"destructive"}),k(!0),s(f,ye)}finally{m(!1)}},he.onerror=()=>{c({title:"Image Error",description:"Failed to process captured image.",variant:"destructive"}),m(!1)},he.src=ye}else s(f,ye),m(!1)}catch(Y){console.error("Error capturing from webcam:",Y),c({title:"Capture Error",description:"Failed to capture image from webcam.",variant:"destructive"}),m(!1)}},oe=()=>{d&&d.downloadMarker()};return e.jsxs(V,{className:"w-full max-w-none border-2 border-red-200",children:[e.jsxs(G,{children:[e.jsx(Q,{className:"text-red-700",children:"Artwork Upload & Frame Preview"}),e.jsxs(te,{children:[e.jsx("strong",{className:"text-red-600",children:"REQUIRED:"})," Upload an image of your artwork with a reference marker to automatically determine its size and see your framing preview. Orders cannot proceed without artwork images."]})]}),e.jsx(q,{className:"max-w-none",children:e.jsx("div",{className:"space-y-4 w-full",children:e.jsxs("div",{className:"space-y-4 w-full",children:[e.jsxs("div",{className:"border rounded-md bg-muted/10 min-h-[400px] flex flex-col w-full",children:[e.jsx("div",{className:"p-4 border-b bg-white/50 rounded-t-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Artwork Capture & Detection"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(qt,{value:x,onValueChange:g,className:"w-auto",children:e.jsxs($t,{className:"grid w-full grid-cols-2",children:[e.jsxs(ve,{value:"webcam",className:"text-xs",children:[e.jsx(xh,{className:"mr-1 h-3 w-3"}),"Camera"]}),e.jsxs(ve,{value:"upload",className:"text-xs",children:[e.jsx(Or,{className:"mr-1 h-3 w-3"}),"Upload"]})]})})})]})}),e.jsxs("div",{className:"flex-1 p-4",children:[x==="webcam"?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"relative rounded-md overflow-hidden bg-black w-full",style:{aspectRatio:"16/9"},children:[e.jsx("video",{ref:Z,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover transition-transform duration-200 cursor-move",style:{transform:`scale(${S}) translate(${T}px, ${E}px)`,transformOrigin:"center center"},onMouseDown:Y=>{S>1&&(N(!0),F({x:Y.clientX,y:Y.clientY}))},onMouseMove:Y=>{if(w&&_&&S>1){const z=Y.clientX-_.x,le=Y.clientY-_.y;C(ye=>ye+z),D(ye=>ye+le),F({x:Y.clientX,y:Y.clientY})}},onMouseUp:()=>{N(!1),F(null)},onMouseLeave:()=>{N(!1),F(null)},onTouchStart:Y=>{if(Y.touches.length===1&&S>1){const z=Y.touches[0];N(!0),F({x:z.clientX,y:z.clientY})}},onTouchMove:Y=>{if(w&&_&&Y.touches.length===1&&S>1){const z=Y.touches[0],le=z.clientX-_.x,ye=z.clientY-_.y;C(he=>he+le),D(he=>he+ye),F({x:z.clientX,y:z.clientY})}},onTouchEnd:()=>{N(!1),F(null)}}),e.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:e.jsxs("div",{className:"w-3/4 h-3/4 border-2 border-white/30 grid grid-cols-3 grid-rows-3",children:[e.jsx("div",{className:"border-r border-b border-white/30"}),e.jsx("div",{className:"border-r border-b border-white/30"}),e.jsx("div",{className:"border-b border-white/30"}),e.jsx("div",{className:"border-r border-b border-white/30"}),e.jsx("div",{className:"border-r border-b border-white/30"}),e.jsx("div",{className:"border-b border-white/30"}),e.jsx("div",{className:"border-r border-white/30"}),e.jsx("div",{className:"border-r border-white/30"}),e.jsx("div",{})]})}),e.jsxs("div",{className:"absolute top-4 left-0 right-0 text-center text-white text-sm bg-black/70 py-3 px-4 mx-4 rounded-lg backdrop-blur-sm",children:[e.jsx("div",{className:"font-medium",children:'Position artwork with 1" × 1" marker on same plane'}),e.jsxs("div",{className:"text-xs mt-1 opacity-90",children:["Use zoom controls to get closer • ",S>1?"Drag to pan view":"Zoom in to enable panning"]})]}),e.jsxs("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 flex flex-col gap-2 bg-black/70 rounded-lg p-3 backdrop-blur-sm",children:[e.jsx("div",{className:"text-white text-xs text-center font-medium mb-1",children:"Zoom"}),e.jsx(P,{onClick:()=>A(Y=>Math.min(4,Y+.3)),size:"sm",variant:"secondary",className:"bg-white/90 text-black hover:bg-white w-10 h-8 p-0 font-bold text-lg",disabled:S>=4,title:"Zoom In",children:"+"}),e.jsxs("div",{className:"text-white text-sm text-center font-mono bg-black/70 px-2 py-1 rounded border border-white/20",children:[S.toFixed(1),"x"]}),e.jsx(P,{onClick:()=>A(Y=>Math.max(1,Y-.3)),size:"sm",variant:"secondary",className:"bg-white/90 text-black hover:bg-white w-10 h-8 p-0 font-bold text-lg",disabled:S<=1,title:"Zoom Out",children:"-"}),e.jsx(P,{onClick:()=>{A(1),C(0),D(0)},size:"sm",variant:"secondary",className:"bg-white/90 text-black hover:bg-white w-10 h-8 p-0 text-xs font-medium",disabled:S===1&&T===0&&E===0,title:"Reset View",children:"Reset"})]}),e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2",children:e.jsx(P,{onClick:B,size:"lg",className:"bg-white text-black hover:bg-gray-100",disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xh,{className:"mr-2 h-4 w-4"}),"Capture & Detect Size"]})})})]})}):e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"border-2 border-dashed rounded-md p-8 flex flex-col items-center justify-center cursor-pointer hover:bg-muted/50 transition-colors min-h-[300px]",onClick:()=>{var Y;return(Y=W.current)==null?void 0:Y.click()},children:[e.jsx("input",{type:"file",ref:W,className:"hidden",accept:"image/*",onChange:O,disabled:h}),e.jsx("div",{className:"text-center",children:h?e.jsx(Xe,{className:"h-12 w-12 animate-spin text-muted-foreground mx-auto"}):e.jsxs(e.Fragment,{children:[e.jsx(Or,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Upload Artwork Image"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Click to upload JPG, PNG or GIF with reference marker"})]})})]})}),y&&e.jsx("div",{className:"mt-6 space-y-4 w-full",children:e.jsxs("div",{className:"border rounded-md p-1 sm:p-2 bg-white w-full max-w-none",children:[e.jsx("h4",{className:"text-sm font-medium mb-2 text-center",children:"Frame Preview"}),e.jsx("div",{className:"w-full flex justify-center overflow-hidden",children:e.jsx("div",{className:"w-full max-w-full",children:e.jsx(lw,{frames:n,mats:a,artworkWidth:f.width,artworkHeight:f.height,artworkImage:y,useMultipleFrames:i,useMultipleMats:o,onFrameImageCaptured:l})})})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Detected Dimensions"}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>k(!b),children:b?"Hide Manual Entry":"Edit Manually"})]}),b?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(M,{htmlFor:"width",children:"Width (inches)"}),e.jsx(U,{id:"width",type:"number",step:"0.01",min:"0.1",value:f.width,onChange:Y=>ne("width",Y.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(M,{htmlFor:"height",children:"Height (inches)"}),e.jsx(U,{id:"height",type:"number",step:"0.01",min:"0.1",value:f.height,onChange:Y=>ne("height",Y.target.value)})]})]}),e.jsx(P,{onClick:Pe,size:"sm",children:"Apply Dimensions"})]}):e.jsxs("div",{className:"flex items-center space-x-2 bg-muted p-3 rounded-md",children:[e.jsx(cj,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("span",{className:"font-medium",children:[f.width,'" × ',f.height,'"']}),n.length>0&&a.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[i?`${n.length} frames`:"Single frame"," |",o?`${a.length} mats`:"Single mat"]})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsx("div",{className:"bg-muted p-3 rounded-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Reference Marker"}),e.jsxs(ZD,{children:[e.jsx(YD,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"icon",className:"h-6 w-6 rounded-full",children:[e.jsx("span",{className:"sr-only",children:"Help"}),e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("path",{d:"M12 17h.01"})]})]})}),e.jsx(ow,{className:"w-80 text-sm",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Instructions for Accurate Measurement"}),e.jsx("p",{className:"text-muted-foreground",children:'Download and print this marker at exactly 1" × 1" size. Place it next to your artwork on the same plane before taking a photo.'})]})})]})]}),e.jsx(P,{onClick:oe,variant:"outline",size:"sm",children:"Download Marker"})]})}),e.jsxs("div",{className:"bg-muted p-2 rounded-md text-xs text-muted-foreground",children:[e.jsxs("p",{className:"flex items-center",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-green-500 mr-2"}),'Print marker at exactly 1" × 1" size.']}),e.jsxs("p",{className:"mt-1 flex items-center",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-yellow-500 mr-2"}),"Place marker on same plane as artwork."]})]})]})]})]})})}),e.jsx(ht,{className:"text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fi,{className:"h-4 w-4"}),e.jsx("span",{children:'Print marker at exactly 1" × 1" and place next to artwork'})]})})]})}function tA(s,t=[]){let r=[];function n(i,o){const l=p.createContext(o),c=r.length;r=[...r,o];function d(h){const{scope:m,children:x,...g}=h,f=(m==null?void 0:m[s][c])||l,v=p.useMemo(()=>g,Object.values(g));return e.jsx(f.Provider,{value:v,children:x})}function u(h,m){const x=(m==null?void 0:m[s][c])||l,g=p.useContext(x);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return d.displayName=i+"Provider",[d,u]}const a=()=>{const i=r.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[s])||i;return p.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return a.scopeName=s,[n,sA(a,...t)]}function sA(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}var Mu="Progress",Ou=100,[rA,aU]=tA(Mu),[nA,aA]=rA(Mu),cw=p.forwardRef((s,t)=>{const{__scopeProgress:r,value:n=null,max:a,getValueLabel:i=iA,...o}=s;(a||a===0)&&!Lh(a)&&console.error(oA(`${a}`,"Progress"));const l=Lh(a)?a:Ou;n!==null&&!$h(n,l)&&console.error(lA(`${n}`,"Progress"));const c=$h(n,l)?n:null,d=Ho(c)?i(c,l):void 0;return e.jsx(nA,{scope:r,value:c,max:l,children:e.jsx(Se.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":Ho(c)?c:void 0,"aria-valuetext":d,role:"progressbar","data-state":mw(c,l),"data-value":c??void 0,"data-max":l,...o,ref:t})})});cw.displayName=Mu;var dw="ProgressIndicator",uw=p.forwardRef((s,t)=>{const{__scopeProgress:r,...n}=s,a=aA(dw,r);return e.jsx(Se.div,{"data-state":mw(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:t})});uw.displayName=dw;function iA(s,t){return`${Math.round(s/t*100)}%`}function mw(s,t){return s==null?"indeterminate":s===t?"complete":"loading"}function Ho(s){return typeof s=="number"}function Lh(s){return Ho(s)&&!isNaN(s)&&s>0}function $h(s,t){return Ho(s)&&!isNaN(s)&&s<=t&&s>=0}function oA(s,t){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Ou}\`.`}function lA(s,t){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Ou} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var hw=cw,cA=uw;const oa=p.forwardRef(({className:s,value:t,...r},n)=>e.jsx(hw,{ref:n,className:J("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...r,children:e.jsx(cA,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));oa.displayName=hw.displayName;function _l({updateInterval:s=1e4,compact:t=!1}){const[r,n]=p.useState(!1),[a,i]=p.useState("overview"),[o,l]=p.useState({memoryUsage:0,memoryLimit:512,apiResponseTime:0,databaseConnected:!1,frameRate:60,networkLatency:0,lastUpdated:new Date().toLocaleTimeString(),cpuUsage:0,activeConnections:0,diskUsage:0,bundleSize:0,errorCount:0,requestsPerMinute:0,responseTime:[],memoryHistory:[],cpuHistory:[],networkHistory:[],alerts:[],uptime:Date.now(),loadTime:0}),[c,d]=p.useState(!1);p.useRef(0);const u=p.useRef(performance.now()),h=p.useRef(Date.now()),m=p.useRef(0),x=p.useRef(0),g=p.useCallback((T,C,E,D,w)=>({id:`${T}-${Date.now()}`,type:D,message:w,timestamp:Date.now(),metric:T,value:C,threshold:E}),[]),f=p.useCallback(async()=>{if(c)return;d(!0);const T=performance.now();try{const C=performance.memory,E=C?Math.round(C.usedJSHeapSize/1024/1024):0,D=C?Math.round(C.jsHeapSizeLimit/1024/1024):512,w=performance.now(),N=w-u.current,_=N>0?Math.min(60,Math.round(1e3/N)):60;u.current=w;const F=Math.round(document.documentElement.outerHTML.length/1024),W=Math.round(w-h.current),Z=Math.round((Date.now()-h.current)/1e3),$=performance.now();let ae=0,O=!1;try{m.current++;const z=await fetch("/api/kanban/status",{method:"GET",signal:AbortSignal.timeout(5e3)});ae=Math.round(performance.now()-$),O=z.ok,z.ok||x.current++}catch{x.current++,ae=5e3,O=!1}const ne=[{endpoint:"/api/frames",timeout:2e3},{endpoint:"/api/auth/status",timeout:2e3}],Pe=await Promise.allSettled(ne.map(async z=>{const le=performance.now();try{return await fetch(z.endpoint,{method:"HEAD",signal:AbortSignal.timeout(z.timeout)}),performance.now()-le}catch{return z.timeout}})),st=Math.round(Pe.reduce((z,le)=>z+(le.status==="fulfilled"?le.value:2e3),0)/Pe.length),rt=Math.round(m.current/Z*60),B=performance.now()-T,oe=Math.min(100,Math.round(E/D*50+(B>100?25:B/4))),Y=Math.min(100,Math.round((F+E)/10));l(z=>{const le=[...z.memoryHistory,E].slice(-20),ye=[...z.cpuHistory,oe].slice(-20),he=[...z.networkHistory,st].slice(-20),je=[...z.responseTime,ae].slice(-20),Ne=[...z.alerts];E>D*.8&&Ne.push(g("memory",E,D*.8,E>D*.9?"error":"warning",`High memory usage: ${E}MB (${Math.round(E/D*100)}%)`)),ae>2e3&&Ne.push(g("api",ae,2e3,ae>5e3?"error":"warning",`Slow API response: ${ae}ms`)),st>1e3&&Ne.push(g("network",st,1e3,"warning",`High network latency: ${st}ms`)),O||Ne.push(g("database",0,1,"error","Database connection lost")),_<30&&Ne.push(g("framerate",_,30,"warning",`Low frame rate: ${_} FPS`));const Qe=Ne.slice(-10);return{...z,memoryUsage:E,memoryLimit:D,apiResponseTime:ae,databaseConnected:O,frameRate:_,networkLatency:st,lastUpdated:new Date().toLocaleTimeString(),cpuUsage:oe,activeConnections:O?1:0,diskUsage:Y,bundleSize:F,errorCount:x.current,requestsPerMinute:rt,responseTime:je,memoryHistory:le,cpuHistory:ye,networkHistory:he,alerts:Qe,uptime:Z,loadTime:W}})}catch(C){console.error("Performance monitoring error:",C),x.current++}finally{d(!1)}},[c,g]);p.useEffect(()=>{if(!r)return;f();const T=setInterval(f,s);return()=>clearInterval(T)},[r,s,f]);const v=()=>{const T=o.memoryUsage/o.memoryLimit*100,C=k(o.memoryHistory);return T>80?{color:"destructive",label:"Critical",trend:C}:T>60?{color:"warning",label:"High",trend:C}:{color:"success",label:"Good",trend:C}},y=()=>{const T=k(o.responseTime);return o.databaseConnected?o.apiResponseTime>2e3?{color:"destructive",label:"Very Slow",trend:T}:o.apiResponseTime>1e3?{color:"warning",label:"Slow",trend:T}:{color:"success",label:"Fast",trend:T}:{color:"destructive",label:"Offline",trend:T}},j=()=>{const T=k(o.networkHistory);return o.networkLatency>1500?{color:"destructive",label:"Poor",trend:T}:o.networkLatency>800?{color:"warning",label:"Fair",trend:T}:{color:"success",label:"Good",trend:T}},b=()=>{const T=k(o.cpuHistory);return o.cpuUsage>80?{color:"destructive",label:"High",trend:T}:o.cpuUsage>60?{color:"warning",label:"Medium",trend:T}:{color:"success",label:"Good",trend:T}},k=T=>{if(T.length<3)return"stable";const C=T.slice(-3),E=C.reduce((N,_)=>N+_,0)/C.length,D=T.slice(-6,-3);if(D.length===0)return"stable";const w=D.reduce((N,_)=>N+_,0)/D.length;return E>w*1.1?"up":E<w*.9?"down":"stable"},S=T=>{const C=Math.floor(T/3600),E=Math.floor(T%3600/60),D=T%60;return C>0?`${C}h ${E}m`:E>0?`${E}m ${D}s`:`${D}s`},A=({data:T,color:C="#3b82f6"})=>{if(T.length<2)return e.jsx("div",{className:"h-8 bg-gray-100 rounded"});const E=Math.max(...T),D=Math.min(...T),w=E-D||1;return e.jsx("div",{className:"h-8 flex items-end space-x-0.5",children:T.map((N,_)=>{const F=(N-D)/w*100;return e.jsx("div",{className:"flex-1 rounded-t",style:{height:`${Math.max(F,10)}%`,backgroundColor:C,opacity:.7}},_)})})};if(t&&!r){const T=o.alerts.filter(C=>C.type==="error"||C.type==="warning").length;return e.jsx("div",{className:"fixed bottom-20 right-4 z-40",children:e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>n(!0),className:"bg-white/95 backdrop-blur-sm border-gray-300 shadow-lg hover:shadow-xl transition-all duration-200 text-gray-800 relative",children:[e.jsx(gh,{className:"h-4 w-4 mr-2 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-gray-800",children:"Performance"}),T>0&&e.jsx(ue,{className:"absolute -top-2 -right-2 h-5 w-5 p-0 text-xs bg-red-500 text-white",children:T})]})})}return e.jsx("div",{className:"fixed bottom-20 right-4 z-40",children:e.jsxs(V,{className:"w-96 bg-white/95 backdrop-blur-sm border-gray-300 shadow-xl max-h-[600px] overflow-hidden",children:[e.jsx(G,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gh,{className:"h-5 w-5 text-blue-600"}),e.jsx(Q,{className:"text-sm text-gray-800",children:"Performance Monitor"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o.alerts.filter(T=>T.type==="error"||T.type==="warning").length>0&&e.jsx(ue,{className:"bg-red-500 text-white text-xs",children:o.alerts.filter(T=>T.type==="error"||T.type==="warning").length}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>n(!r),className:"h-6 w-6 p-0",children:e.jsx($n,{className:"h-4 w-4"})})]})]})}),e.jsxs(q,{className:"p-0",children:[e.jsxs(qt,{value:a,onValueChange:T=>i(T),className:"w-full",children:[e.jsxs($t,{className:"grid w-full grid-cols-3 mx-4 mb-4",children:[e.jsx(ve,{value:"overview",className:"text-xs",children:"Overview"}),e.jsx(ve,{value:"detailed",className:"text-xs",children:"Detailed"}),e.jsxs(ve,{value:"alerts",className:"text-xs",children:["Alerts ",o.alerts.length>0&&`(${o.alerts.length})`]})]}),e.jsxs("div",{className:"px-4 pb-4 max-h-[500px] overflow-y-auto",children:[e.jsxs(Ae,{value:"overview",className:"mt-0 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(V,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P2,{className:"h-3 w-3 text-gray-700"}),e.jsx("span",{className:"text-xs font-medium",children:"Memory"})]}),e.jsx(ue,{variant:v().color==="success"?"default":"destructive",className:"text-xs",children:v().label})]}),e.jsx(oa,{value:o.memoryUsage/o.memoryLimit*100,className:"h-2 mb-1"}),e.jsxs("div",{className:"text-xs text-gray-600",children:[o.memoryUsage,"MB / ",o.memoryLimit,"MB"]}),e.jsx(A,{data:o.memoryHistory,color:"#3b82f6"})]}),e.jsxs(V,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Fo,{className:"h-3 w-3 text-gray-700"}),e.jsx("span",{className:"text-xs font-medium",children:"CPU"})]}),e.jsx(ue,{variant:b().color==="success"?"default":"destructive",className:"text-xs",children:b().label})]}),e.jsx(oa,{value:o.cpuUsage,className:"h-2 mb-1"}),e.jsxs("div",{className:"text-xs text-gray-600",children:[o.cpuUsage,"%"]}),e.jsx(A,{data:o.cpuHistory,color:"#10b981"})]}),e.jsxs(V,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Nl,{className:"h-3 w-3 text-gray-700"}),e.jsx("span",{className:"text-xs font-medium",children:"API"})]}),e.jsx(ue,{variant:y().color==="success"?"default":"destructive",className:"text-xs",children:y().label})]}),e.jsxs("div",{className:"text-xs text-gray-600 mb-1",children:[o.apiResponseTime,"ms ",o.databaseConnected?"✓":"✗"]}),e.jsx(A,{data:o.responseTime,color:"#f59e0b"})]}),e.jsxs(V,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E2,{className:"h-3 w-3 text-gray-700"}),e.jsx("span",{className:"text-xs font-medium",children:"Network"})]}),e.jsx(ue,{variant:j().color==="success"?"default":"destructive",className:"text-xs",children:j().label})]}),e.jsxs("div",{className:"text-xs text-gray-600 mb-1",children:[o.networkLatency,"ms"]}),e.jsx(A,{data:o.networkHistory,color:"#8b5cf6"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[e.jsx("div",{className:"font-medium text-gray-800",children:S(o.uptime)}),e.jsx("div",{className:"text-gray-600",children:"Uptime"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"font-medium text-gray-800",children:[o.requestsPerMinute,"/min"]}),e.jsx("div",{className:"text-gray-600",children:"Requests"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[e.jsx("div",{className:"font-medium text-gray-800",children:o.errorCount}),e.jsx("div",{className:"text-gray-600",children:"Errors"})]})]})]}),e.jsx(Ae,{value:"detailed",className:"mt-0 space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D2,{className:"h-4 w-4 text-gray-700"}),e.jsx("span",{className:"text-sm font-medium",children:"Disk Usage"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium",children:[o.diskUsage,"%"]}),e.jsx(oa,{value:o.diskUsage,className:"h-1 w-16"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hu,{className:"h-4 w-4 text-gray-700"}),e.jsx("span",{className:"text-sm font-medium",children:"Bundle Size"})]}),e.jsxs("div",{className:"text-sm font-medium",children:[o.bundleSize,"KB"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A2,{className:"h-4 w-4 text-gray-700"}),e.jsx("span",{className:"text-sm font-medium",children:"Frame Rate"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium",children:[o.frameRate," FPS"]}),e.jsx(ue,{variant:o.frameRate>=45?"default":"destructive",className:"text-xs",children:o.frameRate>=45?"Smooth":"Choppy"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4 text-gray-700"}),e.jsx("span",{className:"text-sm font-medium",children:"Load Time"})]}),e.jsxs("div",{className:"text-sm font-medium",children:[o.loadTime,"ms"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pu,{className:"h-4 w-4 text-gray-700"}),e.jsx("span",{className:"text-sm font-medium",children:"Connections"})]}),e.jsx("div",{className:"text-sm font-medium",children:o.activeConnections})]})]})}),e.jsx(Ae,{value:"alerts",className:"mt-0",children:o.alerts.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Gs,{className:"h-8 w-8 mx-auto mb-2 text-green-500"}),e.jsx("div",{className:"text-sm",children:"No performance alerts"}),e.jsx("div",{className:"text-xs",children:"System running smoothly"})]}):e.jsx("div",{className:"space-y-2",children:o.alerts.slice().reverse().map(T=>e.jsx("div",{className:`p-3 rounded border-l-4 ${T.type==="error"?"bg-red-50 border-red-400":T.type==="warning"?"bg-yellow-50 border-yellow-400":"bg-blue-50 border-blue-400"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[T.type==="error"?e.jsx(Ht,{className:"h-4 w-4 text-red-600"}):T.type==="warning"?e.jsx(Ht,{className:"h-4 w-4 text-yellow-600"}):e.jsx(Gs,{className:"h-4 w-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:T.message}),e.jsx("div",{className:"text-xs text-gray-600",children:new Date(T.timestamp).toLocaleTimeString()})]})]}),e.jsx(ue,{variant:"outline",className:"text-xs",children:T.metric})]})},T.id))})})]})]}),e.jsxs("div",{className:"px-4 py-2 border-t bg-gray-50/50 flex items-center justify-between text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(vt,{className:"h-3 w-3"}),e.jsxs("span",{children:["Updated: ",o.lastUpdated]})]}),c&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"animate-spin h-3 w-3 border border-blue-600 border-t-transparent rounded-full"}),e.jsx("span",{children:"Refreshing..."})]})]})]})]})})}const Bt=du,va=uu,dA=cu,uA=Da,pw=p.forwardRef(({className:s,...t},r)=>e.jsx(Ui,{ref:r,className:J("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));pw.displayName=Ui.displayName;const Lt=p.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(dA,{children:[e.jsx(pw,{}),e.jsxs(Hi,{ref:n,className:J("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r,children:[t,e.jsxs(Da,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx($n,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Lt.displayName=Hi.displayName;const Vt=({className:s,...t})=>e.jsx("div",{className:J("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});Vt.displayName="DialogHeader";const _n=({className:s,...t})=>e.jsx("div",{className:J("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});_n.displayName="DialogFooter";const Ut=p.forwardRef(({className:s,...t},r)=>e.jsx(qi,{ref:r,className:J("text-lg font-semibold leading-none tracking-tight",s),...t}));Ut.displayName=qi.displayName;const bs=p.forwardRef(({className:s,...t},r)=>e.jsx(zi,{ref:r,className:J("text-sm text-muted-foreground",s),...t}));bs.displayName=zi.displayName;const Zs=p.forwardRef(({className:s,...t},r)=>e.jsx("textarea",{className:J("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...t}));Zs.displayName="Textarea";const mA=({isOpen:s,onClose:t,onApplyBookmark:r,currentConfiguration:n})=>{const[a,i]=p.useState(""),[o,l]=p.useState(!1),[c,d]=p.useState(""),[u,h]=p.useState(""),[m,x]=p.useState(""),g=Zt(),{toast:f}=Be(),{data:v=[],isLoading:y}=me({queryKey:["/api/bookmarks"],enabled:s}),j=Ce({mutationFn:async D=>{const w=await fetch("/api/bookmarks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!w.ok)throw new Error("Failed to create bookmark");return w.json()},onSuccess:()=>{g.invalidateQueries({queryKey:["/api/bookmarks"]}),l(!1),d(""),h(""),x(""),f({title:"Bookmark saved",description:"Your frame configuration has been bookmarked successfully."})}}),b=Ce({mutationFn:async D=>{const w=await fetch(`/api/bookmarks/${D}`,{method:"DELETE"});if(!w.ok)throw new Error("Failed to delete bookmark");return w.json()},onSuccess:()=>{g.invalidateQueries({queryKey:["/api/bookmarks"]}),f({title:"Bookmark deleted",description:"The bookmark has been removed."})}}),k=Ce({mutationFn:async D=>{const w=await fetch(`/api/bookmarks/${D}/favorite`,{method:"POST"});if(!w.ok)throw new Error("Failed to toggle favorite");return w.json()},onSuccess:()=>{g.invalidateQueries({queryKey:["/api/bookmarks"]})}}),S=Ce({mutationFn:async D=>{const w=await fetch(`/api/bookmarks/${D}/apply`,{method:"POST"});if(!w.ok)throw new Error("Failed to apply bookmark");return w.json()},onSuccess:D=>{g.invalidateQueries({queryKey:["/api/bookmarks"]}),r(D),t(),f({title:"Configuration applied",description:`Applied "${D.name}" bookmark to your current order.`})}}),A=()=>{var w,N,_,F;if(!n)return;const D={name:c,description:u,frames:n.frames.map(W=>({frameId:W.frame.id,position:W.position,distance:W.distance})),mats:n.mats.map(W=>({matColorId:W.matboard.id,position:W.position,width:W.width,offset:W.offset})),glassOptionId:((w=n.glassOption)==null?void 0:w.id)||null,useMultipleMats:n.useMultipleMats,useMultipleFrames:n.useMultipleFrames,defaultArtworkWidth:(N=n.artworkWidth)==null?void 0:N.toString(),defaultArtworkHeight:(_=n.artworkHeight)==null?void 0:_.toString(),defaultMatWidth:(F=n.matWidth)==null?void 0:F.toString(),tags:m?m.split(",").map(W=>W.trim()):[],isFavorite:!1,isPublic:!1,createdBy:1};j.mutate(D)},T=v.filter(D=>{var w;return D.name.toLowerCase().includes(a.toLowerCase())||((w=D.description)==null?void 0:w.toLowerCase().includes(a.toLowerCase()))||D.tags&&D.tags.some(N=>N.toLowerCase().includes(a.toLowerCase()))}),C=T.filter(D=>D.isFavorite),E=T.filter(D=>!D.isFavorite);return e.jsx(Bt,{open:s,onOpenChange:t,children:e.jsxs(Lt,{className:"max-w-4xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx(Vt,{children:e.jsxs(Ut,{className:"flex items-center gap-2",children:[e.jsx(dj,{className:"h-5 w-5"}),"Frame Configuration Bookmarks"]})}),e.jsxs("div",{className:"flex flex-col gap-4 flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Zr,{className:"h-4 w-4 absolute left-3 top-3 text-muted-foreground"}),e.jsx(U,{placeholder:"Search bookmarks...",value:a,onChange:D=>i(D.target.value),className:"pl-9"})]}),n&&e.jsxs(Bt,{open:o,onOpenChange:l,children:[e.jsx(va,{asChild:!0,children:e.jsxs(P,{variant:"outline",children:[e.jsx(Vr,{className:"h-4 w-4 mr-2"}),"Save Current"]})}),e.jsxs(Lt,{children:[e.jsx(Vt,{children:e.jsx(Ut,{children:"Save Current Configuration"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"bookmark-name",children:"Name"}),e.jsx(U,{id:"bookmark-name",value:c,onChange:D=>d(D.target.value),placeholder:"e.g., Gold Classic with Double Mat"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"bookmark-description",children:"Description (Optional)"}),e.jsx(Zs,{id:"bookmark-description",value:u,onChange:D=>h(D.target.value),placeholder:"Describe this configuration...",rows:3})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"bookmark-tags",children:"Tags (Optional)"}),e.jsx(U,{id:"bookmark-tags",value:m,onChange:D=>x(D.target.value),placeholder:"e.g., wedding, portrait, landscape (comma-separated)"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsx(P,{onClick:A,disabled:!c.trim()||j.isPending,children:j.isPending?"Saving...":"Save Bookmark"})]})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y?e.jsx("div",{className:"text-center py-8",children:"Loading bookmarks..."}):T.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a?"No bookmarks match your search.":"No bookmarks saved yet."}):e.jsxs("div",{className:"space-y-4",children:[C.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-muted-foreground mb-2 flex items-center gap-1",children:[e.jsx(Gc,{className:"h-4 w-4"}),"Favorites"]}),e.jsx("div",{className:"grid gap-2",children:C.map(D=>e.jsx(Bh,{bookmark:D,onApply:S.mutate,onDelete:b.mutate,onToggleFavorite:k.mutate},D.id))})]}),E.length>0&&e.jsxs("div",{children:[C.length>0&&e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:"All Bookmarks"}),e.jsx("div",{className:"grid gap-2",children:E.map(D=>e.jsx(Bh,{bookmark:D,onApply:S.mutate,onDelete:b.mutate,onToggleFavorite:k.mutate},D.id))})]})]})})]})]})})},Bh=({bookmark:s,onApply:t,onDelete:r,onToggleFavorite:n})=>{const a=Array.isArray(s.frames)?s.frames:[],i=Array.isArray(s.mats)?s.mats:[];return e.jsx(V,{className:"hover:bg-muted/50 transition-colors",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium",children:s.name}),s.isFavorite&&e.jsx(Gc,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[e.jsxs(ue,{variant:"outline",className:"text-xs",children:[a.length," Frame",a.length!==1?"s":""]}),e.jsxs(ue,{variant:"outline",className:"text-xs",children:[i.length," Mat",i.length!==1?"s":""]}),s.glassOptionId&&e.jsx(ue,{variant:"outline",className:"text-xs",children:"Glass"})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:s.tags.map((o,l)=>e.jsx(ue,{variant:"secondary",className:"text-xs",children:o},l))}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[s.usageCount>0&&e.jsxs("span",{children:["Used ",s.usageCount," time",s.usageCount!==1?"s":""]}),s.lastUsed&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(vt,{className:"h-3 w-3"}),new Date(s.lastUsed).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx(P,{size:"sm",variant:"outline",onClick:()=>n(s.id),children:e.jsx(Gc,{className:`h-4 w-4 ${s.isFavorite?"fill-yellow-400 text-yellow-400":""}`})}),e.jsx(P,{size:"sm",onClick:()=>t(s.id),children:"Apply"}),e.jsx(P,{size:"sm",variant:"outline",onClick:()=>r(s.id),children:e.jsx(Sl,{className:"h-4 w-4"})})]})]})})})},hA=()=>{var lh,ch;const{toast:s}=Be(),[t,r]=p.useState({name:"",email:"",phone:"",address:""}),[n,a]=p.useState(16),[i,o]=p.useState(20),[l,c]=p.useState(null),[d,u]=p.useState(""),[h,m]=p.useState("print"),[x,g]=p.useState(""),[f,v]=p.useState(.8);p.useRef(null),p.useState(!1);const[y,j]=p.useState(!1),b=p.useRef(null);p.useRef(null);const[k,S]=p.useState([]),[A,T]=p.useState(1),[C,E]=p.useState(!1),[D,w]=p.useState("all"),[N,_]=p.useState("all"),[F,W]=p.useState("all"),[Z,$]=p.useState("all"),[ae,O]=p.useState(""),{matboards:ne,crescentMatboards:Pe,loading:st,getMatboardById:rt}=DD(),[B,oe]=p.useState([]),[Y,z]=p.useState(1),[le,ye]=p.useState(!1),[he,je]=p.useState(2);p.useEffect(()=>{ne&&ne.length>0&&B.length===0&&(oe([{matboard:ne[0],position:1,width:2,offset:0}]),je(2))},[ne,B.length]);const[Ne,Qe]=p.useState("all"),[ke,xt]=p.useState(To[0]),[yt,K]=p.useState([]),be=()=>n>40||i>60?75:n>32||i>40?35:0,[nt,gt]=p.useState(!0),[fe,Pt]=p.useState(null),[rs,Yt]=p.useState(!1),[tr,ao]=p.useState(""),[Ha,eh]=p.useState(0),[an,th]=p.useState([]),[Hn,sh]=p.useState(void 0),[rh,HT]=p.useState(void 0),[qT,nh]=p.useState(!1);De.useEffect(()=>{const I=k.length>0?k[0].frame:null,ee=B.length>0?B[0].matboard:null;if(I&&ee){const Oe=rs?Ha:k.reduce((fr,$s)=>fr+od(n,i,$s.distance,Number($s.frame.price)),0),Ue=B.reduce((fr,$s)=>fr+ld(n,i,$s.width,Number($s.matboard.price)),0),Ct=ke?cd(n,i,he,Number(ke.price)):0,io=dd(n,i,he,.02),qa=yt.reduce((fr,$s)=>fr+Number($s.price),0),dh=an.reduce((fr,$s)=>fr+$s.amount,0),hc=be(),pc=(Oe+Ue+Ct+io+25+qa+dh+hc)*1.08,fc={id:`design-${Date.now()}`,frameName:rs?tr:I.name||"Custom Frame",matColor:ee.name||ee.id,glassType:(ke==null?void 0:ke.name)||"Standard Glass",dimensions:{width:n,height:i,unit:"in"},artworkImage:l||void 0,totalPrice:pc};sh(fc)}},[k,B,ke,yt,an,n,i,l,rs,tr,Ha,he]);const{frames:Ps,loading:zT,error:HV}=ID(),ah=De.useMemo(()=>Ps?Ps.filter(I=>{if(ae.trim()!==""){const ee=ae.trim().toLowerCase(),Oe=I.id.split("-")[1]||"";if(Oe===ee)return!0;const Ue=I.id.toLowerCase().includes(ee),Ct=Oe.toLowerCase().includes(ee),io=I.name.toLowerCase().includes(ee),qa=I.manufacturer.toLowerCase().includes(ee);if(!(Ue||Ct||io||qa))return!1}if(D!=="all"&&I.material!==D||N!=="all"&&I.manufacturer!==N)return!1;if(F!=="all"){const ee=parseFloat(I.width);switch(F){case"narrow":if(ee>=1)return!1;break;case"medium":if(ee<1||ee>=2)return!1;break;case"wide":if(ee<2)return!1;break}}if(Z!=="all"){const ee=parseFloat(I.price);switch(Z){case"economy":if(ee>=15)return!1;break;case"standard":if(ee<15||ee>=30)return!1;break;case"premium":if(ee<30)return!1;break}}return!0}):[],[Ps,D,N,F,Z,ae]),WT=De.useMemo(()=>Ps?Array.from(new Set(Ps.map(ee=>ee.manufacturer))):[],[Ps]),KT=De.useMemo(()=>Ps?Array.from(new Set(Ps.map(ee=>ee.material))):[],[Ps]),GT=()=>{y?(b.current&&b.current.srcObject&&(b.current.srcObject.getTracks().forEach(Oe=>Oe.stop()),b.current.srcObject=null),j(!1)):(j(!0),QT())},QT=async()=>{try{const I=await navigator.mediaDevices.getUserMedia({video:{width:1280,height:720}});b.current&&(b.current.srcObject=I)}catch(I){console.error("Error accessing webcam:",I),s({title:"Webcam Error",description:"Could not access the webcam. Please check your permissions and try again.",variant:"destructive"}),j(!1)}},mc=I=>{if(console.log("Changing mat color to ID:",I),I==="none"||I==="no-mat"){const Oe=B.filter(Ue=>Ue.position!==Y);oe(Oe),Y===1&&je(0);return}const ee=rt(I);if(ee){console.log("Found mat color:",ee);const Oe=B.findIndex(Ue=>Ue.position===Y);if(Oe>=0){const Ue=[...B];Ue[Oe]={...Ue[Oe],matboard:ee},oe(Ue)}else oe([...B,{matboard:ee,position:Y,width:2,offset:0}])}else{console.log("Mat color not found in API data, trying static catalog...");const Oe=AE(I);if(Oe){console.log("Found mat color in static catalog:",Oe);const Ue=B.findIndex(Ct=>Ct.position===Y);if(Ue>=0){const Ct=[...B];Ct[Ue]={...Ct[Ue],matboard:Oe},oe(Ct)}else oe([...B,{matboard:Oe,position:Y,width:2,offset:0}])}else console.error("Mat color not found in any catalog:",I)}},ZT=I=>{const ee=parseFloat(I.target.value),Oe=B.findIndex(Ue=>Ue.position===Y);if(Oe>=0){const Ue=[...B];Ue[Oe]={...Ue[Oe],width:ee},oe(Ue),Y===1&&je(ee)}},YT=I=>{const ee=Rh(I);ee&&xt(ee)},ih=(I,ee)=>{ee<=0||(I==="width"?a(ee):o(ee))},XT=Ce({mutationFn:async I=>(await ce("POST","/api/orders",I)).json(),onSuccess:()=>{ut.invalidateQueries({queryKey:["/api/orders"]}),ut.invalidateQueries({queryKey:["/api/order-groups"]}),s({title:"Order Created",description:"The order has been successfully created and added to your cart."})},onError:I=>{s({title:"Failed to Create Order",description:I.message||"There was an error creating the order.",variant:"destructive"})}});Ce({mutationFn:async I=>(await ce("POST","/api/wholesale-orders",{orderId:I})).json(),onSuccess:()=>{s({title:"Wholesale Order Created",description:"The wholesale order has been successfully created."})},onError:I=>{s({title:"Failed to Create Wholesale Order",description:I.message||"There was an error creating the wholesale order.",variant:"destructive"})}});const JT=Ce({mutationFn:async I=>(await ce("POST","/api/customers",I)).json()}),e2=async()=>{var I;if(console.log("Create Order button clicked"),k.length===0||B.length===0||!ke){console.log("Missing required selections:",{frame:k.length>0?"Selected":"Missing",matColor:B.length>0?"Selected":"Missing",glassOption:ke?"Selected":"Missing"});let ee=[];k.length===0&&ee.push("frame"),B.length===0&&ee.push("mat color"),ke||ee.push("glass option"),s({title:"Incomplete Order",description:`Please select a ${ee.join(", ")}.`,variant:"destructive"});return}if(!t.name){console.log("Missing customer name"),s({title:"Customer Information Required",description:"Please enter customer name.",variant:"destructive"});return}if(!l){s({title:"Artwork Image Required",description:"CRITICAL: Every order must have an artwork image. Please upload or capture artwork before proceeding.",variant:"destructive"});return}console.log("Customer data:",t);try{console.log("Creating customer with data:",t);const ee=await JT.mutateAsync(t);console.log("Customer created/retrieved:",ee);const Oe=k.length>0?k[0].frame:null,Ue=B.length>0?B[0].matboard:null,Ct=B.length>0?B[0].width:2,qa=k.map(kt=>od(n,i,Ct,Number(kt.frame.price))).reduce((kt,on)=>kt+on,0),hc=B.map(kt=>ld(n,i,kt.width,Number(kt.matboard.price))).reduce((kt,on)=>kt+on,0),pc=ke?cd(n,i,Ct,Number(ke.price)):0,fc=dd(n,i,Ct,.02),fr=25,$s=yt.reduce((kt,on)=>kt+Number(on.price),0),uh=qa+hc+pc+fc+fr+$s,o2=uh*.08,zV=uh+o2,mh=an.reduce((kt,on)=>kt+on.amount,0),l2=an.length>0?an.map(kt=>`${kt.description}: $${kt.amount.toFixed(2)}`).join("; "):"",hh={customerId:ee.id,frameId:rs?"manual":Oe?Oe.id:"",matColorId:Ue?Ue.id:"",glassOptionId:ke.id,artworkWidth:n.toString(),artworkHeight:i.toString(),matWidth:Ct.toString(),artworkDescription:d,artworkType:h,artworkLocation:x,subtotal:"0",tax:"0",total:"0",artworkImage:l,useManualFrame:rs,manualFrameName:rs?tr:void 0,manualFrameCost:rs?Ha.toString():void 0,miscChargeDescription:l2||void 0,miscChargeAmount:mh>0?mh.toString():void 0};console.log("Creating order with data:",hh);const qn=await XT.mutateAsync(hh);if(console.log("Order created successfully:",qn),s({title:"Order Created Successfully! 🎉",description:`Order #${((I=qn.order)==null?void 0:I.id)||qn.orderId} has been created for ${customerName}`,duration:5e3}),fe)try{const kt=await fetch("/api/frame-designs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:qn.id,imageData:fe})});kt.ok?console.log("Frame design image saved successfully"):console.error("Failed to save frame design image:",await kt.text())}catch(kt){console.error("Error saving frame design image:",kt)}yt.length>0&&(console.log("Adding special services:",yt),await Promise.all(yt.map(kt=>ce("POST","/api/order-special-services",{orderId:qn.id,specialServiceId:kt.id})))),s({title:"Order Created Successfully",description:`Order #${qn.id} has been created.`}),r2()}catch(ee){console.error("Error creating order:",ee),s({title:"Error Creating Order",description:"There was an error creating the order. Please try again.",variant:"destructive"})}},t2=()=>{s({title:"Quote Saved",description:"The quote has been saved for future reference."})},s2=async()=>{if(k.length===0){s({title:"Frame Required",description:"Please select at least one frame to create a wholesale order.",variant:"destructive"});return}try{if(!t.name){s({title:"Customer Information Required",description:"Please enter customer name and create the order first before adding to wholesale order.",variant:"destructive"});return}for(const I of k){const ee={materialType:"frame",materialId:I.frame.id,materialName:I.frame.name,quantity:Math.ceil(2*(n+i)/12+1).toString(),status:"pending",notes:`Wholesale order for ${t.name} (${I.position===1?"Inner":"Outer"} Frame)`,vendor:I.frame.manufacturer||"Larson Juhl",priority:"normal"};await ce("POST","/api/material-orders",ee)}s({title:"Frame Orders Created",description:`Wholesale orders for ${k.length} frame(s) have been created.`});for(const I of B){const ee={materialType:"mat",materialId:I.matboard.id,materialName:I.matboard.name,quantity:"1",status:"pending",notes:`Mat for ${t.name} (${I.position===1?"Top":I.position===2?"Middle":"Bottom"} Mat)`,vendor:I.matboard.manufacturer||"Crescent",priority:"normal"};await ce("POST","/api/material-orders",ee)}if(ke){const I={materialType:"glass",materialId:ke.id,materialName:ke.name,quantity:"1",status:"pending",notes:`Glass for ${t.name}`,vendor:"TruVue",priority:"normal"};await ce("POST","/api/material-orders",I)}}catch(I){console.error("Error creating wholesale order:",I),s({title:"Error Creating Wholesale Order",description:"There was an error creating the wholesale order. Please try again.",variant:"destructive"})}},r2=()=>{r({name:"",email:"",phone:"",address:""}),a(16),o(20),c(null),u(""),m("print"),v(.8),S([]),T(1),oe([]),z(1),w("all"),_("all"),W("all"),$("all"),Qe("all"),xt(To[0]),K([]),je(2),E(!1),ye(!1),Yt(!1),ao(""),eh(0),th([]),O(""),y&&GT()},oh=(I,ee,Oe="chop")=>{const Ue=k.findIndex(Ct=>Ct.position===ee);if(Ue!==-1){const Ct=[...k];Ct[Ue]={...Ct[Ue],frame:I,pricingMethod:Oe},S(Ct)}else S([...k,{frame:I,position:ee,distance:0,pricingMethod:Oe}])},n2=I=>{S(k.filter(ee=>ee.frame.id!==I))},a2=(I,ee)=>{const Oe=k.map(Ue=>Ue.frame.id===I?{...Ue,frame:{...Ue.frame,...ee}}:Ue);S(Oe)},i2=I=>{try{if(I.frames&&Array.isArray(I.frames)){const ee=I.frames.map(Oe=>{const Ue=Ps==null?void 0:Ps.find(Ct=>Ct.id===Oe.frameId);return Ue?{frame:Ue,position:Oe.position||1,distance:Oe.distance||0}:null}).filter(Boolean);ee.length>0&&S(ee)}if(I.mats&&Array.isArray(I.mats)){const ee=I.mats.map(Oe=>{const Ue=rt(Oe.matColorId);return Ue?{matboard:Ue,position:Oe.position||1,width:Oe.width||2,offset:Oe.offset||0}:null}).filter(Boolean);ee.length>0&&(oe(ee),ee[0]&&je(ee[0].width))}if(I.glassOptionId){const ee=Rh(I.glassOptionId);ee&&xt(ee)}I.useMultipleMats!==void 0&&ye(I.useMultipleMats),I.useMultipleFrames!==void 0&&E(I.useMultipleFrames),I.defaultArtworkWidth&&n===16&&a(Number(I.defaultArtworkWidth)),I.defaultArtworkHeight&&i===20&&o(Number(I.defaultArtworkHeight)),s({title:"Configuration Applied",description:`Applied "${I.name}" bookmark configuration successfully.`})}catch(ee){console.error("Error applying bookmark:",ee),s({title:"Error Applying Bookmark",description:"There was a problem applying the bookmark configuration. Please try again.",variant:"destructive"})}};return e.jsxs("div",{className:"w-full max-w-none",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-7 gap-4 lg:gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-4 lg:space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-dark-cardBg rounded-lg shadow-md p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 lg:mb-4",children:[e.jsx("h2",{className:"text-lg lg:text-xl font-semibold header-underline",children:"Order Information"}),e.jsxs("button",{type:"button",onClick:()=>nh(!0),className:"px-3 py-1 text-sm bg-blue-500 hover:bg-blue-600 text-white rounded-md flex items-center gap-2 transition-colors",children:[e.jsx(dj,{className:"h-4 w-4"}),"Bookmarks"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:"Customer Name"}),e.jsx("input",{type:"text",className:"w-full p-3 text-base text-gray-800 border border-gray-300 rounded-md bg-white touch-manipulation",placeholder:"Enter customer name",value:t.name,onChange:I=>r({...t,name:I.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:"Order Date"}),e.jsx("input",{type:"date",className:"w-full p-3 text-base text-gray-800 border border-gray-300 rounded-md bg-white touch-manipulation",value:new Date().toISOString().split("T")[0],readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",className:"w-full p-3 text-base text-gray-800 border border-gray-300 rounded-md bg-white touch-manipulation",placeholder:"(555) 123-4567",value:t.phone||"",onChange:I=>r({...t,phone:I.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:"Email"}),e.jsx("input",{type:"email",className:"w-full p-3 text-base text-gray-800 border border-gray-300 rounded-md bg-white touch-manipulation",placeholder:"customer@example.com",value:t.email||"",onChange:I=>r({...t,email:I.target.value})})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-dark-cardBg rounded-lg shadow-md p-4 lg:p-6",children:[e.jsx("h2",{className:"text-lg lg:text-xl font-semibold mb-3 lg:mb-4 header-underline",children:"Artwork Details"}),n>32||i>40?e.jsx("div",{className:`mb-4 p-3 rounded-lg border-l-4 ${n>40||i>60?"bg-red-50 border-red-400 text-red-800":"bg-yellow-50 border-yellow-400 text-yellow-800"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-semibold mr-2",children:n>40||i>60?"⚠️ Large Size Alert:":"⚠️ Size Notice:"}),e.jsx("span",{children:n>40||i>60?'Artwork over 40"×60" requires special handling and extended processing time.':'Artwork over 32"×40" may have additional costs and longer processing time.'})]}),e.jsxs("div",{className:"font-bold text-lg",children:["+$",be()]})]})}):null,e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:"Width (inches)"}),e.jsx("input",{type:"number",className:"w-full p-3 text-base border border-gray-300 rounded-md bg-white text-gray-800 touch-manipulation",step:"0.125",min:"0.125",value:n,onChange:I=>ih("width",parseFloat(I.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:"Height (inches)"}),e.jsx("input",{type:"number",className:"w-full p-3 text-base border border-gray-300 rounded-md bg-white text-gray-800 touch-manipulation",step:"0.125",min:"0.125",value:i,onChange:I=>ih("height",parseFloat(I.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:"Art Type"}),e.jsxs("select",{className:"w-full p-3 text-base text-gray-800 border border-gray-300 rounded-md bg-white touch-manipulation",value:h,onChange:I=>m(I.target.value),children:[e.jsx("option",{value:"print",children:"Print"}),e.jsx("option",{value:"original",children:"Original Artwork"}),e.jsx("option",{value:"photo",children:"Photograph"}),e.jsx("option",{value:"document",children:"Certificate/Document"}),e.jsx("option",{value:"poster",children:"Poster"}),e.jsx("option",{value:"memorabilia",children:"Memorabilia"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:"Description"}),e.jsx("input",{type:"text",className:"w-full p-3 text-base border border-gray-300 rounded-md bg-white text-gray-800 touch-manipulation",placeholder:"Enter artwork description",value:d,onChange:I=>u(I.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:"Physical Storage Location"}),e.jsx("input",{type:"text",className:"w-full p-3 text-base border border-gray-300 rounded-md bg-white text-gray-800 touch-manipulation",placeholder:"Enter physical storage location at shop",value:x,onChange:I=>g(I.target.value)})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-dark-cardBg rounded-lg shadow-md p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h2",{className:"text-xl font-semibold header-underline",children:"Frame Selection"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Search Frame by Item # or Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"w-full p-2 pl-8 border border-light-border dark:border-dark-border rounded-md bg-light-bg dark:bg-dark-bg",placeholder:"Enter frame item # (e.g. '4512') or name...",value:ae,onChange:I=>O(I.target.value)}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 absolute left-2 top-3 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),ae&&e.jsx("button",{className:"absolute right-2 top-2.5 text-gray-400 hover:text-gray-600",onClick:()=>O(""),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx(SD,{onSelectFrame:(I,ee)=>{oh(I,A,ee||"length")},position:A})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 lg:gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Material"}),e.jsx("select",{className:"w-full p-3 text-base border border-light-border dark:border-dark-border rounded-md bg-light-bg dark:bg-dark-bg touch-manipulation",value:D,onChange:I=>w(I.target.value),children:KT.map(I=>e.jsx("option",{value:I,children:I==="all"?"All Materials":I.charAt(0).toUpperCase()+I.slice(1)},I))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Manufacturer"}),e.jsx("select",{className:"w-full p-3 text-base border border-light-border dark:border-dark-border rounded-md bg-light-bg dark:bg-dark-bg touch-manipulation",value:N,onChange:I=>_(I.target.value),children:WT.map(I=>e.jsx("option",{value:I,children:I==="all"?"All Manufacturers":I},I))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Width Range"}),e.jsxs("select",{className:"w-full p-3 text-base border border-light-border dark:border-dark-border rounded-md bg-light-bg dark:bg-dark-bg touch-manipulation",value:F,onChange:I=>W(I.target.value),children:[e.jsx("option",{value:"all",children:"All Widths"}),e.jsx("option",{value:"narrow",children:"Narrow (0-1.5 in)"}),e.jsx("option",{value:"medium",children:"Medium (1.5-2.5 in)"}),e.jsx("option",{value:"wide",children:"Wide (2.5+ in)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Price Range"}),e.jsxs("select",{className:"w-full p-2 border border-light-border dark:border-dark-border rounded-md bg-light-bg dark:bg-dark-bg",value:Z,onChange:I=>$(I.target.value),children:[e.jsx("option",{value:"all",children:"All Prices"}),e.jsx("option",{value:"economy",children:"Economy ($5-9/ft)"}),e.jsx("option",{value:"standard",children:"Standard ($10-14/ft)"}),e.jsx("option",{value:"premium",children:"Premium ($15+/ft)"})]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",className:`px-3 py-1 text-sm rounded-md ${A===1?"bg-primary text-white":"bg-gray-200 dark:bg-dark-cardBg"}`,onClick:()=>T(1),children:"Inner Frame"}),C&&e.jsx("button",{type:"button",className:`px-3 py-1 text-sm rounded-md ${A===2?"bg-primary text-white":"bg-gray-200 dark:bg-dark-cardBg"}`,onClick:()=>T(2),children:"Outer Frame"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"useMultipleFrames",checked:C,onChange:()=>E(!C),className:"mr-2"}),e.jsx("label",{htmlFor:"useMultipleFrames",className:"text-sm",children:"Use Multiple Frames"})]})]})}),e.jsx("div",{className:"h-64 overflow-y-auto p-2 border border-light-border dark:border-dark-border rounded-lg mb-4",children:zT?e.jsxs("div",{className:"flex justify-center items-center h-full",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full","aria-label":"Loading"}),e.jsx("span",{className:"ml-3 text-gray-500",children:"Loading frames..."})]}):ah.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx("p",{children:"No frames match your filter criteria."}),e.jsx("button",{className:"mt-2 text-primary hover:underline",onClick:()=>{w("all"),_("all"),W("all"),$("all")},children:"Reset filters"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:ah.map(I=>e.jsxs("div",{className:`cursor-pointer hover:scale-105 transform transition-transform duration-200 relative rounded overflow-hidden frame-option ${k.some(ee=>ee.frame.id===I.id)?"border-2 border-primary":""}`,onClick:()=>{oh(I,A,"length")},children:[e.jsx("div",{className:"w-full h-24 bg-gradient-to-r from-gray-200 to-gray-300 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center",style:{backgroundColor:I.color||"#8B4513",backgroundImage:"repeating-linear-gradient(45deg, rgba(255,255,255,0.1), rgba(255,255,255,0.1) 2px, transparent 2px, transparent 8px)"},children:e.jsxs("span",{className:"text-white text-xs font-mono tracking-tight opacity-70",children:[I.manufacturer.split("-")[0]," #",I.id.split("-")[1]]})}),e.jsxs("div",{className:"bg-black/70 text-white text-xs p-1 absolute bottom-0 left-0 right-0",children:[e.jsx("div",{className:"font-medium truncate",children:I.name}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:I.material}),e.jsxs("span",{children:["$",I.price,"/ft"]})]})]}),k.some(ee=>ee.frame.id===I.id)&&e.jsx("div",{className:"absolute top-2 right-2 bg-primary text-white rounded-full w-5 h-5 flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})})]},I.id))})}),e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Mat Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary",children:"Mat Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"useMultipleMats",checked:le,onChange:()=>ye(!le),className:"mr-2"}),e.jsx("label",{htmlFor:"useMultipleMats",className:"text-sm",children:"Use Multiple Mats"})]})]}),e.jsxs("div",{className:"flex space-x-2 mb-3",children:[e.jsx("button",{type:"button",className:`px-3 py-1 text-sm rounded-md ${Y===1?"bg-primary text-white":"bg-gray-200 dark:bg-dark-cardBg"}`,onClick:()=>z(1),children:"Top Mat"}),le&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:`px-3 py-1 text-sm rounded-md ${Y===2?"bg-primary text-white":"bg-gray-200 dark:bg-dark-cardBg"}`,onClick:()=>z(2),children:"Middle Mat"}),e.jsx("button",{type:"button",className:`px-3 py-1 text-sm rounded-md ${Y===3?"bg-primary text-white":"bg-gray-200 dark:bg-dark-cardBg"}`,onClick:()=>z(3),children:"Bottom Mat"})]})]}),e.jsxs("div",{className:"flex mb-2 border-b border-light-border dark:border-dark-border",children:[e.jsx("button",{className:`px-3 py-1 text-sm ${Ne==="all"?"font-medium border-b-2 border-primary":""}`,onClick:()=>Qe("all"),children:"All Matboards"}),e.jsx("button",{className:`px-3 py-1 text-sm ${Ne==="Crescent"?"font-medium border-b-2 border-primary":""}`,onClick:()=>Qe("Crescent"),children:"By Category"})]}),Ne==="Crescent"&&e.jsx("div",{className:"mb-2 max-h-40 overflow-y-auto pr-2",children:st?e.jsxs("div",{className:"flex justify-center items-center py-6",children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-4 border-primary border-t-transparent rounded-full","aria-label":"Loading"}),e.jsx("span",{className:"ml-3 text-gray-500",children:"Loading matboards..."})]}):e.jsx(e.Fragment,{children:IE().map(I=>e.jsxs("div",{className:"mb-2",children:[e.jsx("h4",{className:"text-xs text-light-textSecondary dark:text-dark-textSecondary font-medium mb-1",children:I}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:_E(I).map(ee=>e.jsx("div",{className:`mat-color-option ${B.some(Oe=>Oe.matboard.id===ee.id)?"border-2 border-primary":"border border-gray-400"} rounded-full h-6 w-6 cursor-pointer hover:scale-110 transition-transform overflow-hidden`,onClick:()=>mc(ee.id),title:`${ee.name} (${ee.code})`,children:e.jsx("div",{className:"w-full h-full",style:{backgroundColor:ee.color||"#FFFFFF",border:"2px solid transparent"}})},ee.id))})]},I))})}),Ne==="all"&&e.jsx("div",{className:"grid grid-cols-4 gap-2",children:st?e.jsxs("div",{className:"flex justify-center items-center py-6 col-span-4",children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-4 border-primary border-t-transparent rounded-full","aria-label":"Loading"}),e.jsx("span",{className:"ml-3 text-gray-500",children:"Loading matboards..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`mat-color-option ${B.length===0?"border-2 border-primary":"border border-gray-400"} rounded-md h-8 w-8 cursor-pointer hover:scale-110 transition-transform overflow-hidden bg-gray-100 dark:bg-gray-800 flex items-center justify-center`,onClick:()=>mc("none"),title:"No Mat",children:e.jsx("span",{className:"text-xs text-gray-500",children:"✕"})}),(Ne==="all"?ne:Pe).map(I=>e.jsx("div",{className:`mat-color-option ${B.some(ee=>ee.matboard.id===I.id)?"border-2 border-primary":"border border-gray-400"} rounded-full h-8 w-8 cursor-pointer hover:scale-110 transition-transform overflow-hidden`,onClick:()=>mc(I.id),title:I.name,children:e.jsx("div",{className:"w-full h-full",style:{backgroundColor:I.color||"#FFFFFF",border:"2px solid transparent"}})},I.id))]})}),B.length>0&&e.jsxs("div",{className:"mt-4 text-sm",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Selected Mats"}),B.map((I,ee)=>e.jsxs("div",{className:ee>0?"mt-3 pt-3 border-t border-light-border dark:border-dark-border":"",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[I.position===1?"Top":I.position===2?"Middle":"Bottom"," Mat",le?` (Position ${I.position})`:""]}),e.jsx("button",{className:"text-red-500 hover:text-red-700 text-xs font-medium",onClick:()=>{const Oe=B.filter(Ue=>Ue.position!==I.position);oe(Oe),I.position===1&&je(0)},children:"Remove"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-md inline-block border border-gray-300 shadow-sm",style:{backgroundColor:I.matboard.color||"#FFFFFF"}}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-sm",children:[I.matboard.name,I.matboard.code&&e.jsxs("span",{className:"ml-1 text-light-textSecondary dark:text-dark-textSecondary text-xs",children:["(",I.matboard.code,")"]})]}),I.matboard.manufacturer&&I.matboard.manufacturer!=="Basic"&&e.jsx("p",{className:"text-light-textSecondary dark:text-dark-textSecondary text-xs",children:I.matboard.manufacturer}),I.matboard.category&&e.jsx("p",{className:"text-light-textSecondary dark:text-dark-textSecondary text-xs",children:I.matboard.category}),e.jsxs("p",{className:"text-xs mt-1",children:["Width: ",I.width,'"']})]})]})]},I.matboard.id+"-"+I.position))]}),B.length===0&&e.jsxs("div",{className:"mt-4 p-3 border border-dashed border-gray-300 rounded-md text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"No mats selected"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Click on a mat color above to add matting"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Mat Width (inches)"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"range",min:"0",max:"6",step:"0.25",value:((lh=B.find(I=>I.position===Y))==null?void 0:lh.width)||2,onChange:ZT,className:"w-full h-2 bg-gray-200 dark:bg-dark-border rounded-lg appearance-none cursor-pointer"}),e.jsxs("span",{className:"ml-2 min-w-[40px] text-center",children:[((ch=B.find(I=>I.position===Y))==null?void 0:ch.width)||2,'"']})]}),le&&e.jsxs("div",{className:"mt-2 text-xs text-light-textSecondary dark:text-dark-textSecondary",children:["Adjusting width for ",Y===1?"Top":Y===2?"Middle":"Bottom"," Mat (Position ",Y,")"]})]})]}),e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Glass Options"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 lg:gap-4 mb-6",children:To.map(I=>e.jsxs("div",{className:`border ${ke.id===I.id?"border-primary":"border-light-border dark:border-dark-border"} rounded-lg p-3 cursor-pointer hover:border-primary transition-colors bg-white dark:bg-dark-bg`,onClick:()=>YT(I.id),children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:I.name}),e.jsx("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:I.description})]}),e.jsx("div",{className:`flex h-5 w-5 ${ke.id===I.id?"border border-primary":"border border-gray-300 dark:border-dark-border"} rounded-full items-center justify-center`,children:ke.id===I.id&&e.jsx("div",{className:"h-3 w-3 bg-primary rounded-full"})})]}),e.jsxs("div",{className:"mt-2 text-sm text-right",children:["$",parseFloat(String(I.price))*100,"/sq ft"]})]},I.id))})]}),e.jsx(PD,{onFrameAdd:I=>{const ee={frame:{id:`manual-${Date.now()}`,name:I.name,manufacturer:I.manufacturer,material:I.material,width:I.width.toString(),depth:I.depth.toString(),price:I.price.toString(),catalogImage:"",edgeTexture:null,corner:null,color:I.color},distance:0,position:k.length+1,pricingMethod:"chop"};S([...k,ee])},useManualFrame:rs,onToggleManualFrame:Yt,frameName:tr,onFrameNameChange:ao,frameCost:Ha,onFrameCostChange:eh,selectedFrames:k,onFrameRemove:n2,onFrameEdit:a2}),e.jsx(LE,{selectedServices:yt,onChange:K}),e.jsx(ED,{charges:an,onChange:th})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4 lg:space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-dark-cardBg rounded-lg shadow-md p-4 lg:p-6",children:e.jsx(eA,{defaultWidth:n,defaultHeight:i,frames:k,mats:B,useMultipleFrames:C,useMultipleMats:le,onDimensionsDetected:(I,ee)=>{a(I.width),o(I.height),v(I.width/I.height),c(ee),console.log("Dimensions detected:",I),s({title:"Artwork Dimensions Detected",description:`Width: ${I.width}", Height: ${I.height}"`})},onFrameImageCaptured:Pt})}),e.jsx("div",{className:"bg-white dark:bg-dark-cardBg rounded-lg shadow-md p-4 lg:p-6",children:e.jsx(FD,{primaryDesign:Hn,comparisonDesign:rh,onDesignSelect:I=>{I.id===(Hn==null?void 0:Hn.id)?s({title:"Design Selected",description:"Using current frame design configuration"}):(sh(I),s({title:"Design Updated",description:"Applied comparison design to current order"}))},onCompareToggle:I=>{I&&!rh&&Hn&&(HT(Hn),s({title:"Comparison Mode",description:"Current design saved for comparison"}))}})}),k.length>0&&e.jsx("div",{className:"bg-white dark:bg-dark-cardBg rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Selected Frame Details"}),k.map((I,ee)=>e.jsxs("div",{className:ee>0?"mt-4 pt-4 border-t border-light-border dark:border-dark-border":"",children:[e.jsxs("h4",{className:"text-md font-medium mb-2",children:[I.position===1?"Inner Frame":"Outer Frame",C?` (Position ${I.position})`:""]}),e.jsx("table",{className:"w-full text-sm",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-1 text-light-textSecondary dark:text-dark-textSecondary",children:"Name:"}),e.jsx("td",{className:"py-1 font-medium",children:I.frame.name})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-1 text-light-textSecondary dark:text-dark-textSecondary",children:"Material:"}),e.jsx("td",{className:"py-1",children:I.frame.material})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-1 text-light-textSecondary dark:text-dark-textSecondary",children:"Width:"}),e.jsxs("td",{className:"py-1",children:[I.frame.width," inches"]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-1 text-light-textSecondary dark:text-dark-textSecondary",children:"Depth:"}),e.jsxs("td",{className:"py-1",children:[I.frame.depth," inches"]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-1 text-light-textSecondary dark:text-dark-textSecondary",children:"Wholesale Price:"}),e.jsxs("td",{className:"py-1",children:["$",I.frame.price," per foot"]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-1 text-light-textSecondary dark:text-dark-textSecondary",children:"Pricing Method:"}),e.jsx("td",{className:"py-1",children:I.pricingMethod})]})]})})]},I.frame.id+"-"+I.position))]})}),e.jsx(pD,{frames:k,mats:B,glassOption:ke,artworkWidth:n,artworkHeight:i,artworkLocation:x,primaryMatWidth:he,specialServices:yt,onCreateOrder:e2,onSaveQuote:t2,onCreateWholesaleOrder:s2,useMultipleMats:le,useMultipleFrames:C,addToWholesaleOrder:nt,setAddToWholesaleOrder:gt,orderId:1,sizeSurcharge:be(),useManualFrame:rs,manualFrameName:tr,manualFrameCost:Ha,miscCharges:an})]})]}),e.jsx(_l,{compact:!0,updateInterval:3e3}),e.jsx(mA,{isOpen:qT,onClose:()=>nh(!1),onApplyBookmark:i2,currentConfiguration:k.length>0&&B.length>0?{frames:k,mats:B,glassOption:ke,useMultipleMats:le,useMultipleFrames:C,artworkWidth:n,artworkHeight:i,matWidth:he}:void 0})]})},gs=p.forwardRef(({className:s,...t},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:J("w-full caption-bottom text-sm",s),...t})}));gs.displayName="Table";const vs=p.forwardRef(({className:s,...t},r)=>e.jsx("thead",{ref:r,className:J("[&_tr]:border-b",s),...t}));vs.displayName="TableHeader";const ys=p.forwardRef(({className:s,...t},r)=>e.jsx("tbody",{ref:r,className:J("[&_tr:last-child]:border-0",s),...t}));ys.displayName="TableBody";const pA=p.forwardRef(({className:s,...t},r)=>e.jsx("tfoot",{ref:r,className:J("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));pA.displayName="TableFooter";const tt=p.forwardRef(({className:s,...t},r)=>e.jsx("tr",{ref:r,className:J("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));tt.displayName="TableRow";const de=p.forwardRef(({className:s,...t},r)=>e.jsx("th",{ref:r,className:J("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));de.displayName="TableHead";const ie=p.forwardRef(({className:s,...t},r)=>e.jsx("td",{ref:r,className:J("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));ie.displayName="TableCell";const fA=p.forwardRef(({className:s,...t},r)=>e.jsx("caption",{ref:r,className:J("mt-4 text-sm text-muted-foreground",s),...t}));fA.displayName="TableCaption";function ji(s,[t,r]){return Math.min(r,Math.max(t,s))}var xA=[" ","Enter","ArrowUp","ArrowDown"],gA=[" ","Enter"],Gi="Select",[Il,Rl,vA]=Vi(Gi),[Ma,iU]=fs(Gi,[vA,Ea]),Ml=Ea(),[yA,en]=Ma(Gi),[jA,bA]=Ma(Gi),fw=s=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:h,disabled:m,required:x,form:g}=s,f=Ml(t),[v,y]=p.useState(null),[j,b]=p.useState(null),[k,S]=p.useState(!1),A=Ln(d),[T=!1,C]=ms({prop:n,defaultProp:a,onChange:i}),[E,D]=ms({prop:o,defaultProp:l,onChange:c}),w=p.useRef(null),N=v?g||!!v.closest("form"):!0,[_,F]=p.useState(new Set),W=Array.from(_).map(Z=>Z.props.value).join(";");return e.jsx(lu,{...f,children:e.jsxs(yA,{required:x,scope:t,trigger:v,onTriggerChange:y,valueNode:j,onValueNodeChange:b,valueNodeHasChildren:k,onValueNodeHasChildrenChange:S,contentId:hr(),value:E,onValueChange:D,open:T,onOpenChange:C,dir:A,triggerPointerDownPosRef:w,disabled:m,children:[e.jsx(Il.Provider,{scope:t,children:e.jsx(jA,{scope:s.__scopeSelect,onNativeOptionAdd:p.useCallback(Z=>{F($=>new Set($).add(Z))},[]),onNativeOptionRemove:p.useCallback(Z=>{F($=>{const ae=new Set($);return ae.delete(Z),ae})},[]),children:r})}),N?e.jsxs(Bw,{"aria-hidden":!0,required:x,tabIndex:-1,name:u,autoComplete:h,value:E,onChange:Z=>D(Z.target.value),disabled:m,form:g,children:[E===void 0?e.jsx("option",{value:""}):null,Array.from(_)]},W):null]})})};fw.displayName=Gi;var xw="SelectTrigger",gw=p.forwardRef((s,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=s,i=Ml(r),o=en(xw,r),l=o.disabled||n,c=Ge(t,o.onTriggerChange),d=Rl(r),u=p.useRef("touch"),[h,m,x]=Vw(f=>{const v=d().filter(b=>!b.disabled),y=v.find(b=>b.value===o.value),j=Uw(v,f,y);j!==void 0&&o.onValueChange(j.value)}),g=f=>{l||(o.onOpenChange(!0),x()),f&&(o.triggerPointerDownPosRef.current={x:Math.round(f.pageX),y:Math.round(f.pageY)})};return e.jsx(bl,{asChild:!0,...i,children:e.jsx(Se.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":$w(o.value)?"":void 0,...a,ref:c,onClick:ge(a.onClick,f=>{f.currentTarget.focus(),u.current!=="mouse"&&g(f)}),onPointerDown:ge(a.onPointerDown,f=>{u.current=f.pointerType;const v=f.target;v.hasPointerCapture(f.pointerId)&&v.releasePointerCapture(f.pointerId),f.button===0&&f.ctrlKey===!1&&f.pointerType==="mouse"&&(g(f),f.preventDefault())}),onKeyDown:ge(a.onKeyDown,f=>{const v=h.current!=="";!(f.ctrlKey||f.altKey||f.metaKey)&&f.key.length===1&&m(f.key),!(v&&f.key===" ")&&xA.includes(f.key)&&(g(),f.preventDefault())})})})});gw.displayName=xw;var vw="SelectValue",yw=p.forwardRef((s,t)=>{const{__scopeSelect:r,className:n,style:a,children:i,placeholder:o="",...l}=s,c=en(vw,r),{onValueNodeHasChildrenChange:d}=c,u=i!==void 0,h=Ge(t,c.onValueNodeChange);return Ss(()=>{d(u)},[d,u]),e.jsx(Se.span,{...l,ref:h,style:{pointerEvents:"none"},children:$w(c.value)?e.jsx(e.Fragment,{children:o}):i})});yw.displayName=vw;var wA="SelectIcon",jw=p.forwardRef((s,t)=>{const{__scopeSelect:r,children:n,...a}=s;return e.jsx(Se.span,{"aria-hidden":!0,...a,ref:t,children:n||"▼"})});jw.displayName=wA;var NA="SelectPortal",bw=s=>e.jsx(Ky,{asChild:!0,...s});bw.displayName=NA;var In="SelectContent",ww=p.forwardRef((s,t)=>{const r=en(In,s.__scopeSelect),[n,a]=p.useState();if(Ss(()=>{a(new DocumentFragment)},[]),!r.open){const i=n;return i?mu.createPortal(e.jsx(Nw,{scope:s.__scopeSelect,children:e.jsx(Il.Slot,{scope:s.__scopeSelect,children:e.jsx("div",{children:s.children})})}),i):null}return e.jsx(Sw,{...s,ref:t})});ww.displayName=In;var Bs=10,[Nw,tn]=Ma(In),SA="SelectContentImpl",Sw=p.forwardRef((s,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:m,collisionPadding:x,sticky:g,hideWhenDetached:f,avoidCollisions:v,...y}=s,j=en(In,r),[b,k]=p.useState(null),[S,A]=p.useState(null),T=Ge(t,z=>k(z)),[C,E]=p.useState(null),[D,w]=p.useState(null),N=Rl(r),[_,F]=p.useState(!1),W=p.useRef(!1);p.useEffect(()=>{if(b)return Hy(b)},[b]),zy();const Z=p.useCallback(z=>{const[le,...ye]=N().map(Ne=>Ne.ref.current),[he]=ye.slice(-1),je=document.activeElement;for(const Ne of z)if(Ne===je||(Ne==null||Ne.scrollIntoView({block:"nearest"}),Ne===le&&S&&(S.scrollTop=0),Ne===he&&S&&(S.scrollTop=S.scrollHeight),Ne==null||Ne.focus(),document.activeElement!==je))return},[N,S]),$=p.useCallback(()=>Z([C,b]),[Z,C,b]);p.useEffect(()=>{_&&$()},[_,$]);const{onOpenChange:ae,triggerPointerDownPosRef:O}=j;p.useEffect(()=>{if(b){let z={x:0,y:0};const le=he=>{var je,Ne;z={x:Math.abs(Math.round(he.pageX)-(((je=O.current)==null?void 0:je.x)??0)),y:Math.abs(Math.round(he.pageY)-(((Ne=O.current)==null?void 0:Ne.y)??0))}},ye=he=>{z.x<=10&&z.y<=10?he.preventDefault():b.contains(he.target)||ae(!1),document.removeEventListener("pointermove",le),O.current=null};return O.current!==null&&(document.addEventListener("pointermove",le),document.addEventListener("pointerup",ye,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",le),document.removeEventListener("pointerup",ye,{capture:!0})}}},[b,ae,O]),p.useEffect(()=>{const z=()=>ae(!1);return window.addEventListener("blur",z),window.addEventListener("resize",z),()=>{window.removeEventListener("blur",z),window.removeEventListener("resize",z)}},[ae]);const[ne,Pe]=Vw(z=>{const le=N().filter(je=>!je.disabled),ye=le.find(je=>je.ref.current===document.activeElement),he=Uw(le,z,ye);he&&setTimeout(()=>he.ref.current.focus())}),st=p.useCallback((z,le,ye)=>{const he=!W.current&&!ye;(j.value!==void 0&&j.value===le||he)&&(E(z),he&&(W.current=!0))},[j.value]),rt=p.useCallback(()=>b==null?void 0:b.focus(),[b]),B=p.useCallback((z,le,ye)=>{const he=!W.current&&!ye;(j.value!==void 0&&j.value===le||he)&&w(z)},[j.value]),oe=n==="popper"?ud:Cw,Y=oe===ud?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:m,collisionPadding:x,sticky:g,hideWhenDetached:f,avoidCollisions:v}:{};return e.jsx(Nw,{scope:r,content:b,viewport:S,onViewportChange:A,itemRefCallback:st,selectedItem:C,onItemLeave:rt,itemTextRefCallback:B,focusSelectedItem:$,selectedItemText:D,position:n,isPositioned:_,searchRef:ne,children:e.jsx(qy,{as:gl,allowPinchZoom:!0,children:e.jsx(Wy,{asChild:!0,trapped:j.open,onMountAutoFocus:z=>{z.preventDefault()},onUnmountAutoFocus:ge(a,z=>{var le;(le=j.trigger)==null||le.focus({preventScroll:!0}),z.preventDefault()}),children:e.jsx(vl,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:z=>z.preventDefault(),onDismiss:()=>j.onOpenChange(!1),children:e.jsx(oe,{role:"listbox",id:j.contentId,"data-state":j.open?"open":"closed",dir:j.dir,onContextMenu:z=>z.preventDefault(),...y,...Y,onPlaced:()=>F(!0),ref:T,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:ge(y.onKeyDown,z=>{const le=z.ctrlKey||z.altKey||z.metaKey;if(z.key==="Tab"&&z.preventDefault(),!le&&z.key.length===1&&Pe(z.key),["ArrowUp","ArrowDown","Home","End"].includes(z.key)){let he=N().filter(je=>!je.disabled).map(je=>je.ref.current);if(["ArrowUp","End"].includes(z.key)&&(he=he.slice().reverse()),["ArrowUp","ArrowDown"].includes(z.key)){const je=z.target,Ne=he.indexOf(je);he=he.slice(Ne+1)}setTimeout(()=>Z(he)),z.preventDefault()}})})})})})})});Sw.displayName=SA;var CA="SelectItemAlignedPosition",Cw=p.forwardRef((s,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=s,i=en(In,r),o=tn(In,r),[l,c]=p.useState(null),[d,u]=p.useState(null),h=Ge(t,T=>u(T)),m=Rl(r),x=p.useRef(!1),g=p.useRef(!0),{viewport:f,selectedItem:v,selectedItemText:y,focusSelectedItem:j}=o,b=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&d&&f&&v&&y){const T=i.trigger.getBoundingClientRect(),C=d.getBoundingClientRect(),E=i.valueNode.getBoundingClientRect(),D=y.getBoundingClientRect();if(i.dir!=="rtl"){const je=D.left-C.left,Ne=E.left-je,Qe=T.left-Ne,ke=T.width+Qe,xt=Math.max(ke,C.width),yt=window.innerWidth-Bs,K=ji(Ne,[Bs,Math.max(Bs,yt-xt)]);l.style.minWidth=ke+"px",l.style.left=K+"px"}else{const je=C.right-D.right,Ne=window.innerWidth-E.right-je,Qe=window.innerWidth-T.right-Ne,ke=T.width+Qe,xt=Math.max(ke,C.width),yt=window.innerWidth-Bs,K=ji(Ne,[Bs,Math.max(Bs,yt-xt)]);l.style.minWidth=ke+"px",l.style.right=K+"px"}const w=m(),N=window.innerHeight-Bs*2,_=f.scrollHeight,F=window.getComputedStyle(d),W=parseInt(F.borderTopWidth,10),Z=parseInt(F.paddingTop,10),$=parseInt(F.borderBottomWidth,10),ae=parseInt(F.paddingBottom,10),O=W+Z+_+ae+$,ne=Math.min(v.offsetHeight*5,O),Pe=window.getComputedStyle(f),st=parseInt(Pe.paddingTop,10),rt=parseInt(Pe.paddingBottom,10),B=T.top+T.height/2-Bs,oe=N-B,Y=v.offsetHeight/2,z=v.offsetTop+Y,le=W+Z+z,ye=O-le;if(le<=B){const je=w.length>0&&v===w[w.length-1].ref.current;l.style.bottom="0px";const Ne=d.clientHeight-f.offsetTop-f.offsetHeight,Qe=Math.max(oe,Y+(je?rt:0)+Ne+$),ke=le+Qe;l.style.height=ke+"px"}else{const je=w.length>0&&v===w[0].ref.current;l.style.top="0px";const Qe=Math.max(B,W+f.offsetTop+(je?st:0)+Y)+ye;l.style.height=Qe+"px",f.scrollTop=le-B+f.offsetTop}l.style.margin=`${Bs}px 0`,l.style.minHeight=ne+"px",l.style.maxHeight=N+"px",n==null||n(),requestAnimationFrame(()=>x.current=!0)}},[m,i.trigger,i.valueNode,l,d,f,v,y,i.dir,n]);Ss(()=>b(),[b]);const[k,S]=p.useState();Ss(()=>{d&&S(window.getComputedStyle(d).zIndex)},[d]);const A=p.useCallback(T=>{T&&g.current===!0&&(b(),j==null||j(),g.current=!1)},[b,j]);return e.jsx(TA,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:x,onScrollButtonChange:A,children:e.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:e.jsx(Se.div,{...a,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});Cw.displayName=CA;var kA="SelectPopperPosition",ud=p.forwardRef((s,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=Bs,...i}=s,o=Ml(r);return e.jsx(iu,{...o,...i,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ud.displayName=kA;var[TA,Fu]=Ma(In,{}),md="SelectViewport",kw=p.forwardRef((s,t)=>{const{__scopeSelect:r,nonce:n,...a}=s,i=tn(md,r),o=Fu(md,r),l=Ge(t,i.onViewportChange),c=p.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(Il.Slot,{scope:r,children:e.jsx(Se.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ge(a.onScroll,d=>{const u=d.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:m}=o;if(m!=null&&m.current&&h){const x=Math.abs(c.current-u.scrollTop);if(x>0){const g=window.innerHeight-Bs*2,f=parseFloat(h.style.minHeight),v=parseFloat(h.style.height),y=Math.max(f,v);if(y<g){const j=y+x,b=Math.min(g,j),k=j-b;h.style.height=b+"px",h.style.bottom==="0px"&&(u.scrollTop=k>0?k:0,h.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});kw.displayName=md;var Tw="SelectGroup",[PA,EA]=Ma(Tw),DA=p.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s,a=hr();return e.jsx(PA,{scope:r,id:a,children:e.jsx(Se.div,{role:"group","aria-labelledby":a,...n,ref:t})})});DA.displayName=Tw;var Pw="SelectLabel",Ew=p.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s,a=EA(Pw,r);return e.jsx(Se.div,{id:a.id,...n,ref:t})});Ew.displayName=Pw;var qo="SelectItem",[AA,Dw]=Ma(qo),Aw=p.forwardRef((s,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:i,...o}=s,l=en(qo,r),c=tn(qo,r),d=l.value===n,[u,h]=p.useState(i??""),[m,x]=p.useState(!1),g=Ge(t,j=>{var b;return(b=c.itemRefCallback)==null?void 0:b.call(c,j,n,a)}),f=hr(),v=p.useRef("touch"),y=()=>{a||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(AA,{scope:r,value:n,disabled:a,textId:f,isSelected:d,onItemTextChange:p.useCallback(j=>{h(b=>b||((j==null?void 0:j.textContent)??"").trim())},[]),children:e.jsx(Il.ItemSlot,{scope:r,value:n,disabled:a,textValue:u,children:e.jsx(Se.div,{role:"option","aria-labelledby":f,"data-highlighted":m?"":void 0,"aria-selected":d&&m,"data-state":d?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:g,onFocus:ge(o.onFocus,()=>x(!0)),onBlur:ge(o.onBlur,()=>x(!1)),onClick:ge(o.onClick,()=>{v.current!=="mouse"&&y()}),onPointerUp:ge(o.onPointerUp,()=>{v.current==="mouse"&&y()}),onPointerDown:ge(o.onPointerDown,j=>{v.current=j.pointerType}),onPointerMove:ge(o.onPointerMove,j=>{var b;v.current=j.pointerType,a?(b=c.onItemLeave)==null||b.call(c):v.current==="mouse"&&j.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ge(o.onPointerLeave,j=>{var b;j.currentTarget===document.activeElement&&((b=c.onItemLeave)==null||b.call(c))}),onKeyDown:ge(o.onKeyDown,j=>{var k;((k=c.searchRef)==null?void 0:k.current)!==""&&j.key===" "||(gA.includes(j.key)&&y(),j.key===" "&&j.preventDefault())})})})})});Aw.displayName=qo;var Ja="SelectItemText",_w=p.forwardRef((s,t)=>{const{__scopeSelect:r,className:n,style:a,...i}=s,o=en(Ja,r),l=tn(Ja,r),c=Dw(Ja,r),d=bA(Ja,r),[u,h]=p.useState(null),m=Ge(t,y=>h(y),c.onItemTextChange,y=>{var j;return(j=l.itemTextRefCallback)==null?void 0:j.call(l,y,c.value,c.disabled)}),x=u==null?void 0:u.textContent,g=p.useMemo(()=>e.jsx("option",{value:c.value,disabled:c.disabled,children:x},c.value),[c.disabled,c.value,x]),{onNativeOptionAdd:f,onNativeOptionRemove:v}=d;return Ss(()=>(f(g),()=>v(g)),[f,v,g]),e.jsxs(e.Fragment,{children:[e.jsx(Se.span,{id:c.textId,...i,ref:m}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?mu.createPortal(i.children,o.valueNode):null]})});_w.displayName=Ja;var Iw="SelectItemIndicator",Rw=p.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s;return Dw(Iw,r).isSelected?e.jsx(Se.span,{"aria-hidden":!0,...n,ref:t}):null});Rw.displayName=Iw;var hd="SelectScrollUpButton",Mw=p.forwardRef((s,t)=>{const r=tn(hd,s.__scopeSelect),n=Fu(hd,s.__scopeSelect),[a,i]=p.useState(!1),o=Ge(t,n.onScrollButtonChange);return Ss(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;i(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?e.jsx(Fw,{...s,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});Mw.displayName=hd;var pd="SelectScrollDownButton",Ow=p.forwardRef((s,t)=>{const r=tn(pd,s.__scopeSelect),n=Fu(pd,s.__scopeSelect),[a,i]=p.useState(!1),o=Ge(t,n.onScrollButtonChange);return Ss(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;i(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?e.jsx(Fw,{...s,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});Ow.displayName=pd;var Fw=p.forwardRef((s,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=s,i=tn("SelectScrollButton",r),o=p.useRef(null),l=Rl(r),c=p.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),Ss(()=>{var u;const d=l().find(h=>h.ref.current===document.activeElement);(u=d==null?void 0:d.ref.current)==null||u.scrollIntoView({block:"nearest"})},[l]),e.jsx(Se.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ge(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:ge(a.onPointerMove,()=>{var d;(d=i.onItemLeave)==null||d.call(i),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:ge(a.onPointerLeave,()=>{c()})})}),_A="SelectSeparator",Lw=p.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s;return e.jsx(Se.div,{"aria-hidden":!0,...n,ref:t})});Lw.displayName=_A;var fd="SelectArrow",IA=p.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s,a=Ml(r),i=en(fd,r),o=tn(fd,r);return i.open&&o.position==="popper"?e.jsx(ou,{...a,...n,ref:t}):null});IA.displayName=fd;function $w(s){return s===""||s===void 0}var Bw=p.forwardRef((s,t)=>{const{value:r,...n}=s,a=p.useRef(null),i=Ge(t,a),o=Ia(r);return p.useEffect(()=>{const l=a.current,c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==r&&u){const h=new Event("change",{bubbles:!0});u.call(l,r),l.dispatchEvent(h)}},[o,r]),e.jsx(h2,{asChild:!0,children:e.jsx("select",{...n,ref:i,defaultValue:r})})});Bw.displayName="BubbleSelect";function Vw(s){const t=as(s),r=p.useRef(""),n=p.useRef(0),a=p.useCallback(o=>{const l=r.current+o;t(l),function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=p.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,i]}function Uw(s,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?s.indexOf(r):-1;let o=RA(s,Math.max(i,0));a.length===1&&(o=o.filter(d=>d!==r));const c=o.find(d=>d.textValue.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function RA(s,t){return s.map((r,n)=>s[(t+n)%s.length])}var MA=fw,Hw=gw,OA=yw,FA=jw,LA=bw,qw=ww,$A=kw,zw=Ew,Ww=Aw,BA=_w,VA=Rw,Kw=Mw,Gw=Ow,Qw=Lw;const We=MA,Ke=OA,He=p.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(Hw,{ref:n,className:J("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...r,children:[t,e.jsx(FA,{asChild:!0,children:e.jsx(ns,{className:"h-4 w-4 opacity-50"})})]}));He.displayName=Hw.displayName;const Zw=p.forwardRef(({className:s,...t},r)=>e.jsx(Kw,{ref:r,className:J("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(oj,{className:"h-4 w-4"})}));Zw.displayName=Kw.displayName;const Yw=p.forwardRef(({className:s,...t},r)=>e.jsx(Gw,{ref:r,className:J("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ns,{className:"h-4 w-4"})}));Yw.displayName=Gw.displayName;const qe=p.forwardRef(({className:s,children:t,position:r="popper",...n},a)=>e.jsx(LA,{children:e.jsxs(qw,{ref:a,className:J("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...n,children:[e.jsx(Zw,{}),e.jsx($A,{className:J("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Yw,{})]})}));qe.displayName=qw.displayName;const UA=p.forwardRef(({className:s,...t},r)=>e.jsx(zw,{ref:r,className:J("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));UA.displayName=zw.displayName;const se=p.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(Ww,{ref:n,className:J("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(VA,{children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsx(BA,{children:t})]}));se.displayName=Ww.displayName;const HA=p.forwardRef(({className:s,...t},r)=>e.jsx(Qw,{ref:r,className:J("-mx-1 my-1 h-px bg-muted",s),...t}));HA.displayName=Qw.displayName;const qA=({status:s})=>{const t=r=>{switch(r){case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"in_progress":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"completed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t(s)}`,children:s.charAt(0).toUpperCase()+s.slice(1)})},zA=({orderGroup:s,total:t})=>s?(()=>{const n=parseFloat(s.total||"0"),a=parseFloat(s.cashAmount||"0");if(s.status==="paid")return e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"✅ PAID"});if(a>0&&a<n){const i=n-a;return e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 border-2 border-orange-300 animate-pulse",children:["🔔 PARTIAL: $",i.toFixed(2)," DUE"]})})}return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 border-2 border-red-300 animate-pulse",children:"🚨 PAYMENT REQUIRED"}),e.jsxs("span",{className:"text-sm font-medium text-red-600",children:["$",n.toFixed(2)]})]})})():e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 border-2 border-red-300 animate-pulse",children:"🚨 PAYMENT REQUIRED"}),e.jsxs("span",{className:"text-sm font-medium text-red-600",children:["$",t]})]}),WA=()=>{const{toast:s}=Be(),[t,r]=p.useState(""),[n,a]=p.useState("all"),[i,o]=p.useState(null),[l,c]=p.useState(!1),[d,u]=Cs(),{data:h,isLoading:m,isError:x}=me({queryKey:["/api/orders"],staleTime:3e4}),{data:g,isLoading:f,isError:v}=me({queryKey:["/api/order-groups"],staleTime:3e4}),{data:y}=me({queryKey:["/api/customers"]}),{data:j}=me({queryKey:["/api/frames"]}),{data:b}=me({queryKey:["/api/mat-colors"]}),{data:k}=me({queryKey:["/api/glass-options"]});Ce({mutationFn:async({id:B,status:oe})=>ce("PATCH",`/api/orders/${B}`,{status:oe}),onSuccess:()=>{ut.invalidateQueries({queryKey:["/api/orders"]}),s({title:"Order Updated",description:"Order status has been updated successfully"})},onError:B=>{s({title:"Update Failed",description:B.message||"Failed to update order status",variant:"destructive"})}});const S=Ce({mutationFn:async B=>ce("POST","/api/wholesale-orders",{orderId:B}),onSuccess:()=>{ut.invalidateQueries({queryKey:["/api/orders"]}),ut.invalidateQueries({queryKey:["/api/wholesale-orders"]}),c(!1),s({title:"Wholesale Order Created",description:"Wholesale order has been created successfully"})},onError:B=>{s({title:"Creation Failed",description:B.message||"Failed to create wholesale order",variant:"destructive"})}}),A=B=>{if(!B||!y)return"Unknown";const Y=y.find(z=>z.id===B);return Y?Y.name:"Unknown"},T=B=>{if(!B||!j)return"Unknown";const Y=j.find(z=>z.id===B);return Y?Y.name:"Unknown"},C=B=>{if(!B||!b)return"Unknown";const Y=b.find(z=>z.id===B);return Y?Y.name:"Unknown"},E=B=>{if(!B||!k)return"Unknown";const Y=k.find(z=>z.id===B);return Y?Y.name:"Unknown"},D=()=>{i&&S.mutate(i.id)},w=Ce({mutationFn:async B=>{var z;const oe=(z=ae(B))==null?void 0:z.id;if(!oe)throw new Error("No invoice found for this order");const Y=await fetch(`/api/invoices/${oe}`);if(!Y.ok)throw new Error("Failed to fetch invoice data");return Y.json()},onSuccess:B=>{const oe=window.open("","_blank");oe&&(oe.document.write(_(B)),oe.document.close(),oe.focus(),setTimeout(()=>{oe.print()},250))},onError:B=>{s({title:"Print Failed",description:B.message||"Failed to print invoice",variant:"destructive"})}}),N=Ce({mutationFn:async B=>{const oe=await fetch(`/api/orders/${B}`);if(!oe.ok)throw new Error("Failed to fetch order data");return oe.json()},onSuccess:B=>{const oe=window.open("","_blank");oe&&(oe.document.write(F(B.order)),oe.document.close(),oe.focus(),setTimeout(()=>{oe.print()},250))},onError:B=>{s({title:"Print Failed",description:B.message||"Failed to print work order",variant:"destructive"})}}),_=B=>{const{orderGroup:oe,orders:Y,customer:z}=B;return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice #${oe.id}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.4; }
          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 15px; margin-bottom: 20px; }
          .company-info { text-align: center; margin-bottom: 20px; }
          .invoice-details { display: flex; justify-content: space-between; margin-bottom: 20px; }
          .customer-info { margin-bottom: 20px; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
          th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
          th { background-color: #f5f5f5; font-weight: bold; }
          .totals { text-align: right; margin-top: 20px; }
          .total-line { display: flex; justify-content: space-between; padding: 5px 0; }
          .total-final { font-weight: bold; font-size: 18px; border-top: 2px solid #000; padding-top: 10px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="company-info">
          <h1>Jay's Frames</h1>
          <p>Professional Custom Framing</p>
          <p>Phone: (555) 123-4567 | Email: info@jaysframes.com</p>
        </div>

        <div class="header">
          <h2>INVOICE #${oe.id}</h2>
        </div>

        <div class="invoice-details">
          <div>
            <strong>Invoice Date:</strong> ${new Date(oe.createdAt).toLocaleDateString()}<br>
            <strong>Due Date:</strong> On Receipt<br>
            <strong>Status:</strong> ${oe.status||"Pending"}
          </div>
          <div>
            <strong>Customer:</strong><br>
            ${z.name}<br>
            ${z.email||""}<br>
            ${z.phone||""}
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Description</th>
              <th>Qty</th>
              <th>Price</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            ${Y.map(le=>`
              <tr>
                <td>
                  Custom Framing #${le.id}<br>
                  <small>${le.artworkDescription||"Custom Frame"}</small><br>
                  <small>Size: ${le.artworkWidth}" × ${le.artworkHeight}"</small>
                </td>
                <td>${le.quantity}</td>
                <td>$${parseFloat(le.subtotal).toFixed(2)}</td>
                <td>$${parseFloat(le.total).toFixed(2)}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>

        <div class="totals">
          <div class="total-line">
            <span>Subtotal:</span>
            <span>$${parseFloat(oe.subtotal).toFixed(2)}</span>
          </div>
          <div class="total-line">
            <span>Tax:</span>
            <span>$${parseFloat(oe.tax).toFixed(2)}</span>
          </div>
          <div class="total-line total-final">
            <span>Total:</span>
            <span>$${parseFloat(oe.total).toFixed(2)}</span>
          </div>
        </div>

        <div style="margin-top: 40px; font-size: 12px; color: #666;">
          <p>Thank you for your business! All custom framing sales are final.</p>
        </div>
      </body>
      </html>
    `},F=B=>{const oe=y==null?void 0:y.find(Y=>Y.id===B.customerId);return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Work Order #${B.id}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.4; }
          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 15px; margin-bottom: 20px; }
          .work-order-info { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
          .section { margin-bottom: 15px; }
          .label { font-weight: bold; margin-bottom: 5px; }
          .checklist { margin-top: 30px; }
          .checklist-item { display: flex; align-items: center; margin-bottom: 10px; }
          .checklist-item input { margin-right: 10px; }
          .notes-section { margin-top: 30px; }
          .notes-box { border: 1px solid #ccc; min-height: 100px; padding: 10px; margin-top: 10px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>JAY'S FRAMES - WORK ORDER</h1>
          <h2>Order #${B.id}</h2>
        </div>

        <div class="work-order-info">
          <div>
            <div class="section">
              <div class="label">Customer:</div>
              <div>${(oe==null?void 0:oe.name)||"Unknown Customer"}</div>
            </div>
            <div class="section">
              <div class="label">Artwork Dimensions:</div>
              <div>${B.artworkWidth}" × ${B.artworkHeight}"</div>
            </div>
            <div class="section">
              <div class="label">Artwork Description:</div>
              <div>${B.artworkDescription||"N/A"}</div>
            </div>
            <div class="section">
              <div class="label">Artwork Type:</div>
              <div>${B.artworkType||"N/A"}</div>
            </div>
            <div class="section">
              <div class="label">Artwork Location:</div>
              <div>${B.artworkLocation||"Not specified"}</div>
            </div>
          </div>

          <div>
            <div class="section">
              <div class="label">Frame:</div>
              <div>${T(B.frameId)}</div>
            </div>
            <div class="section">
              <div class="label">Mat:</div>
              <div>${C(B.matColorId)}</div>
            </div>
            <div class="section">
              <div class="label">Glass:</div>
              <div>${E(B.glassOptionId)}</div>
            </div>
            <div class="section">
              <div class="label">Due Date:</div>
              <div>${B.dueDate?new Date(B.dueDate).toLocaleDateString():"Not set"}</div>
            </div>
            <div class="section">
              <div class="label">Order Total:</div>
              <div style="font-size: 18px; font-weight: bold;">$${parseFloat(B.total).toFixed(2)}</div>
            </div>
          </div>
        </div>

        <div class="checklist">
          <div class="label">Production Checklist:</div>
          <div class="checklist-item">
            <input type="checkbox" id="frame-cut">
            <label for="frame-cut">Frame cut and assembled</label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="mat-cut">
            <label for="mat-cut">Mat cut and beveled</label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="glass-cut">
            <label for="glass-cut">Glass cut and cleaned</label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="artwork-mounted">
            <label for="artwork-mounted">Artwork mounted</label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="hardware">
            <label for="hardware">Hardware attached</label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="inspection">
            <label for="inspection">Final inspection</label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="ready">
            <label for="ready">Ready for pickup</label>
          </div>
        </div>

        <div class="notes-section">
          <div class="label">Production Notes:</div>
          <div class="notes-box"></div>
        </div>
      </body>
      </html>
    `},W=Ce({mutationFn:async B=>ce("POST",`/api/orders/${B}/send-update`,{}),onSuccess:()=>{s({title:"Update Sent",description:"Customer has been notified of the current order status"})},onError:B=>{s({title:"Send Failed",description:B.message||"Failed to send customer update",variant:"destructive"})}}),Z=B=>{W.mutate(B)},$=B=>{o(B),c(!0)},ae=B=>{if(!g||!ne)return null;let oe=[];if(Array.isArray(g)?oe=g:g&&typeof g=="object"&&(oe=g.orderGroups||[]),!Array.isArray(oe))return console.warn("Could not extract order groups array:",g),null;const Y=ne.find(z=>z.id===B);return!Y||!Y.orderGroupId?null:oe.find(z=>z&&z.id===Y.orderGroupId)||null},O=B=>{u(`/checkout/${B}`)};Ce({mutationFn:async B=>ce("POST",`/api/orders/${B}/push-to-kanban`,{}),onSuccess:()=>{s({title:"Pushed to Kanban",description:"Order has been pushed to the production Kanban board"})},onError:B=>{s({title:"Push Failed",description:B.message||"Failed to push order to Kanban",variant:"destructive"})}});const ne=De.useMemo(()=>h?Array.isArray(h)?h:h&&typeof h=="object"&&h.orders?h.orders:[]:[],[h]);console.log("Orders response:",h),console.log("Orders array:",ne);const Pe=De.useMemo(()=>Array.isArray(ne)?ne.filter(B=>{try{const Y=A(B.customerId).toLowerCase().includes(t.toLowerCase())||B.id.toString().includes(t),z=n==="all"||B.status===n;return Y&&z}catch(oe){return console.error("Error filtering order:",B,oe),!1}}):[],[ne,t,n]),st=m||f,rt=x||v;return st?e.jsx("div",{className:"flex justify-center items-center min-h-[500px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):rt?e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-red-500 dark:text-red-400 text-xl mb-2",children:"Error Loading Orders"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"There was a problem fetching the orders. Please try again later."}),e.jsx(P,{variant:"outline",className:"mt-4",onClick:()=>{ut.invalidateQueries({queryKey:["/api/orders"]}),ut.invalidateQueries({queryKey:["/api/order-groups"]})},children:"Retry"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Orders"}),e.jsx(P,{variant:"outline",onClick:()=>window.location.href="/",children:"Create New Order"})]}),e.jsx(V,{children:e.jsxs(q,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between mb-6",children:[e.jsx("div",{className:"w-full sm:w-auto",children:e.jsx(U,{placeholder:"Search by customer or order #",className:"max-w-md",value:t,onChange:B=>r(B.target.value)})}),e.jsx("div",{className:"w-full sm:w-auto",children:e.jsxs(We,{value:n,onValueChange:a,children:[e.jsx(He,{className:"w-full sm:w-[180px]",children:e.jsx(Ke,{placeholder:"Filter by status"})}),e.jsxs(qe,{children:[e.jsx(se,{value:"all",children:"All Statuses"}),e.jsx(se,{value:"pending",children:"Pending"}),e.jsx(se,{value:"in_progress",children:"In Progress"}),e.jsx(se,{value:"completed",children:"Completed"}),e.jsx(se,{value:"cancelled",children:"Cancelled"})]})]})})]}),Pe.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 dark:text-gray-500 text-lg mb-2",children:"No orders found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t||n!=="all"?"Try changing your search filters":"Start by creating your first order"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{children:"Order #"}),e.jsx(de,{children:"Customer"}),e.jsx(de,{children:"Payment Status"}),e.jsx(de,{children:"Frame"}),e.jsx(de,{children:"Size"}),e.jsx(de,{children:"Location"}),e.jsx(de,{children:"Status"}),e.jsx(de,{children:"Actions"})]})}),e.jsx(ys,{children:Pe.map(B=>{const oe=ae(B.id);return e.jsxs(tt,{className:!oe||oe.status!=="paid"?"bg-red-50 border-l-4 border-l-red-500":"",children:[e.jsx(ie,{className:"font-medium",children:B.id}),e.jsx(ie,{className:"font-medium",children:A(B.customerId)}),e.jsx(ie,{children:e.jsx(zA,{orderGroup:oe,total:B.total})}),e.jsx(ie,{children:T(B.frameId)}),e.jsx(ie,{children:`${B.artworkWidth}" × ${B.artworkHeight}"`}),e.jsx(ie,{className:"text-sm",children:e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Art:"})," ",B.artworkLocation||"Not specified"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Materials:"})," Workshop - Bay A"]})]})}),e.jsx(ie,{children:e.jsx(qA,{status:B.status})}),e.jsx(ie,{children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[(!oe||oe.status!=="paid")&&e.jsx(P,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>{oe&&oe.id?O(oe.id):s({title:"Creating checkout session...",description:"Setting up payment for this order."})},children:"💳 Checkout"}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>Z(B.id),disabled:W.isPending,children:"📧 Send Update"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>$(B),children:"📦 Materials"}),e.jsx(P,{variant:"secondary",size:"sm",onClick:()=>u(`/order-progress/${B.id}`),children:"📊 Progress"}),e.jsx(P,{size:"sm",variant:"outline",onClick:()=>{try{const Y=ae(B.id);Y&&Y.status==="pending"?console.log("Pushing order group to Kanban:",Y):console.log("Order group not found or not pending")}catch(Y){console.error("Error in push to Kanban operation:",Y)}},children:"🚀 Push to Kanban"}),e.jsxs(P,{variant:"default",size:"sm",onClick:()=>u(`/orders/${B.id}`),children:[e.jsx(pi,{className:"h-4 w-4 mr-1"})," Details"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>w.mutate(B.id),disabled:w.isPending,children:"🧾 Print Invoice"}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>N.mutate(B.id),disabled:N.isPending,children:"📋 Print Work Order"})]})]})})]},B.id)})})]})})]})}),e.jsx(Bt,{open:l,onOpenChange:c,children:e.jsxs(Lt,{children:[e.jsxs(Vt,{children:[e.jsx(Ut,{children:"Create Wholesale Order"}),e.jsxs(bs,{children:["Order materials needed for Order #",i==null?void 0:i.id]})]}),i&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Frame"}),e.jsx("p",{className:"text-sm",children:T(i.frameId)})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Mat"}),e.jsx("p",{className:"text-sm",children:C(i.matColorId)})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Glass"}),e.jsx("p",{className:"text-sm",children:E(i.glassOptionId)})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Size"}),e.jsx("p",{className:"text-sm",children:`${i.artworkWidth}" × ${i.artworkHeight}"`})]})]}),e.jsxs("div",{className:"border rounded-md p-3 bg-gray-50 dark:bg-gray-900",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Materials to Order"}),e.jsxs("ul",{className:"space-y-1 text-sm",children:[e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:"Frame length needed:"}),e.jsxs("span",{className:"font-medium",children:[Math.ceil(2*(Number(i.artworkWidth)+Number(i.artworkHeight))/12+1)," ft"]})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:"Mat board needed:"}),e.jsxs("span",{className:"font-medium",children:[Math.ceil(Number(i.artworkWidth)+Number(i.matWidth)*2+4),'" ×',Math.ceil(Number(i.artworkHeight)+Number(i.matWidth)*2+4),'"']})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:"Glass needed:"}),e.jsxs("span",{className:"font-medium",children:[Math.ceil(Number(i.artworkWidth)+Number(i.matWidth)*2),'" ×',Math.ceil(Number(i.artworkHeight)+Number(i.matWidth)*2),'"']})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx(P,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(P,{onClick:D,disabled:S.isPending,children:S.isPending?"Creating...":"Create Wholesale Order"})]})]})]})}),e.jsx(_l,{compact:!0,updateInterval:4e3})]})},KA=void 0,ho=({title:s,value:t,description:r,icon:n})=>e.jsxs(V,{children:[e.jsxs(G,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Q,{className:"text-sm font-medium",children:s}),e.jsx("div",{className:"text-primary",children:n})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r})]})]}),GA=()=>{const[s,t]=p.useState("30days"),[r,n]=p.useState("overview");Be();const{data:a,isLoading:i}=me({queryKey:["/api/orders"],queryFn:()=>ce("GET","/api/orders?limit=5")}),{data:o}=me({queryKey:["/api/frames"]}),{data:l}=me({queryKey:["/api/mat-colors"]}),{data:c}=me({queryKey:["/api/glass-options"]}),{data:d}=me({queryKey:["/api/wholesale-orders"]}),h=(()=>{const w=Array.isArray(a)?a:a!=null&&a.orders&&Array.isArray(a.orders)?a.orders:[];if(!w.length)return[];const N=new Date;let _=new Date;switch(s){case"7days":_.setDate(N.getDate()-7);break;case"30days":_.setDate(N.getDate()-30);break;case"90days":_.setDate(N.getDate()-90);break;case"12months":_.setMonth(N.getMonth()-12);break;default:_.setDate(N.getDate()-30)}return w.filter(F=>new Date(F.createdAt||"")>=_)})(),m=h.reduce((w,N)=>w+Number(N.total),0),x=h.length,g=x>0?m/x:0,f=h.filter(w=>w.status==="pending").length,v=()=>{if(!h.length)return[];const w={};return h.forEach(N=>{const _=new Date(N.createdAt||"").toLocaleDateString();w[_]||(w[_]={date:_,orders:0,sales:0}),w[_].orders+=1,w[_].sales+=Number(N.total)}),Object.values(w).sort((N,_)=>new Date(N.date).getTime()-new Date(_.date).getTime())},y=()=>{if(!h.length||!o)return[];const w={};return h.forEach(N=>{N.frameId&&(w[N.frameId]||(w[N.frameId]=0),w[N.frameId]+=1)}),Object.entries(w).map(([N,_])=>{const F=o.find(W=>W.id===N);return{name:F?F.name:"Unknown",value:_}}).sort((N,_)=>_.value-N.value).slice(0,5)},j=()=>{if(!h.length||!l)return[];const w={};return h.forEach(N=>{N.matColorId&&(w[N.matColorId]||(w[N.matColorId]=0),w[N.matColorId]+=1)}),Object.entries(w).map(([N,_])=>{const F=l.find(W=>W.id===N);return{name:F?F.name:"Unknown",value:_,color:F?F.color:"#ccc"}})},b=()=>{if(!h.length||!c)return[];const w={};return h.forEach(N=>{N.glassOptionId&&(w[N.glassOptionId]||(w[N.glassOptionId]=0),w[N.glassOptionId]+=1)}),Object.entries(w).map(([N,_])=>{const F=c.find(W=>W.id===N);return{name:F?F.name:"Unknown",value:_}})},k=v(),S=y(),A=j(),T=b(),C=["#00ADB5","#E31E6A","#21C685","#FFC107","#F44336"],{data:E,isLoading:D}=me({queryKey:["/api/dashboard-proxy/metrics"],queryFn:()=>ce("GET","/api/dashboard-proxy/metrics"),enabled:!!KA,retry:!1});return i?e.jsx("div",{className:"flex justify-center items-center min-h-[500px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Dashboard"}),e.jsxs(We,{value:s,onValueChange:t,children:[e.jsx(He,{className:"w-[180px]",children:e.jsx(Ke,{placeholder:"Select time range"})}),e.jsxs(qe,{children:[e.jsx(se,{value:"7days",children:"Last 7 days"}),e.jsx(se,{value:"30days",children:"Last 30 days"}),e.jsx(se,{value:"90days",children:"Last 90 days"}),e.jsx(se,{value:"12months",children:"Last 12 months"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(ho,{title:"Total Sales",value:`$${m.toFixed(2)}`,description:`${x} orders in selected period`,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),e.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})}),e.jsx(ho,{title:"Average Order Value",value:`$${g.toFixed(2)}`,description:"Per order in selected period",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),e.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]})}),e.jsx(ho,{title:"Pending Orders",value:f,description:"Orders awaiting fulfillment",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"6",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),e.jsx(ho,{title:"Wholesale Orders",value:(d==null?void 0:d.length)||0,description:"Material orders to wholesalers",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14"}),e.jsx("path",{d:"M16.5 9.4 7.55 4.24"}),e.jsx("polyline",{points:"3.29 7 12 12 20.71 7"}),e.jsx("line",{x1:"12",y1:"22",x2:"12",y2:"12"}),e.jsx("circle",{cx:"18.5",cy:"15.5",r:"2.5"}),e.jsx("path",{d:"M20.27 17.27 22 19"})]})})]}),e.jsxs(qt,{defaultValue:"overview",onValueChange:n,className:"space-y-4",children:[e.jsxs($t,{children:[e.jsx(ve,{value:"overview",children:"Overview"}),e.jsx(ve,{value:"orders",children:"Orders"}),e.jsx(ve,{value:"materials",children:"Materials"})]}),e.jsx(Ae,{value:"overview",className:"space-y-4",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Sales Overview"}),e.jsx(te,{children:"Sales and order volume over time"})]}),e.jsx(q,{className:"h-[400px]",children:k.length>0?e.jsx(Ir,{width:"100%",height:"100%",children:e.jsxs(bj,{data:k,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(oi,{dataKey:"date"}),e.jsx(Yn,{yAxisId:"left"}),e.jsx(Yn,{yAxisId:"right",orientation:"right"}),e.jsx(Rr,{}),e.jsx(wj,{}),e.jsx(li,{yAxisId:"left",type:"monotone",dataKey:"orders",stroke:"#00ADB5",activeDot:{r:8},name:"Orders"}),e.jsx(li,{yAxisId:"right",type:"monotone",dataKey:"sales",stroke:"#E31E6A",name:"Sales ($)"})]})}):e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No data available for the selected period"})})})]})}),e.jsx(Ae,{value:"orders",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Popular Frames"}),e.jsx(te,{children:"Most ordered frame styles"})]}),e.jsx(q,{className:"h-[300px]",children:S.length>0?e.jsx(Ir,{width:"100%",height:"100%",children:e.jsxs(Xc,{data:S,margin:{top:5,right:30,left:20,bottom:50},children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(oi,{dataKey:"name",angle:-45,textAnchor:"end",height:70}),e.jsx(Yn,{}),e.jsx(Rr,{}),e.jsx(Jc,{dataKey:"value",name:"Orders",fill:"#00ADB5"})]})}):e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No data available"})})})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Mat Colors"}),e.jsx(te,{children:"Distribution of mat color choices"})]}),e.jsx(q,{className:"h-[300px]",children:A.length>0?e.jsx(Ir,{width:"100%",height:"100%",children:e.jsxs(ed,{children:[e.jsx(td,{data:A,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:w,percent:N})=>`${w}: ${(N*100).toFixed(0)}%`,children:A.map((w,N)=>e.jsx(Vo,{fill:w.color||C[N%C.length]},`cell-${N}`))}),e.jsx(Rr,{})]})}):e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No data available"})})})]})]})}),e.jsx(Ae,{value:"materials",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Glass Options"}),e.jsx(te,{children:"Distribution of glass choices"})]}),e.jsx(q,{className:"h-[300px]",children:T.length>0?e.jsx(Ir,{width:"100%",height:"100%",children:e.jsxs(ed,{children:[e.jsx(td,{data:T,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:w,percent:N})=>`${w}: ${(N*100).toFixed(0)}%`,children:T.map((w,N)=>e.jsx(Vo,{fill:C[N%C.length]},`cell-${N}`))}),e.jsx(Rr,{})]})}):e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No data available"})})})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Wholesale Orders"}),e.jsx(te,{children:"Material orders by manufacturer"})]}),e.jsx(q,{className:"h-[300px]",children:d&&d.length>0?e.jsx(Ir,{width:"100%",height:"100%",children:e.jsxs(Xc,{data:d.reduce((w,N)=>{const _=w.findIndex(F=>F.name===N.manufacturer);return _===-1?w.push({name:N.manufacturer,value:1}):w[_].value+=1,w},[]),margin:{top:5,right:30,left:20,bottom:50},children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(oi,{dataKey:"name",angle:-45,textAnchor:"end",height:70}),e.jsx(Yn,{}),e.jsx(Rr,{}),e.jsx(Jc,{dataKey:"value",name:"Orders",fill:"#21C685"})]})}):e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No wholesale orders available"})})})]})]})})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"External Dashboard Integration"}),e.jsx(te,{children:"Connection status to external dashboard API"})]}),e.jsxs(q,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-sm text-yellow-600",children:"Dashboard API not configured. Add DASHBOARD_API_URL to secrets."})]}),E&&e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"External metrics loaded successfully"}),e.jsx("pre",{className:"text-xs mt-2 text-gray-500",children:JSON.stringify(E,null,2)})]}),D&&e.jsx("div",{className:"mt-2 text-sm text-gray-500",children:"Loading external dashboard data..."})]})]}),e.jsx(_l,{compact:!0,updateInterval:5e3})]})};var Xw="basil",QA=function(t){return t===3?"v3":t},Jw="https://js.stripe.com",ZA="".concat(Jw,"/").concat(Xw,"/stripe.js"),YA=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,XA=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,Vh="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",JA=function(t){return YA.test(t)||XA.test(t)},e4=function(){for(var t=document.querySelectorAll('script[src^="'.concat(Jw,'"]')),r=0;r<t.length;r++){var n=t[r];if(JA(n.src))return n}return null},Uh=function(t){var r="",n=document.createElement("script");n.src="".concat(ZA).concat(r);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(n),n},t4=function(t,r){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"7.3.1",startTime:r})},Wa=null,po=null,fo=null,s4=function(t){return function(r){t(new Error("Failed to load Stripe.js",{cause:r}))}},r4=function(t,r){return function(){window.Stripe?t(window.Stripe):r(new Error("Stripe.js not available"))}},n4=function(t){return Wa!==null?Wa:(Wa=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe&&t&&console.warn(Vh),window.Stripe){r(window.Stripe);return}try{var a=e4();if(a&&t)console.warn(Vh);else if(!a)a=Uh(t);else if(a&&fo!==null&&po!==null){var i;a.removeEventListener("load",fo),a.removeEventListener("error",po),(i=a.parentNode)===null||i===void 0||i.removeChild(a),a=Uh(t)}fo=r4(r,n),po=s4(n),a.addEventListener("load",fo),a.addEventListener("error",po)}catch(o){n(o);return}}),Wa.catch(function(r){return Wa=null,Promise.reject(r)}))},a4=function(t,r,n){if(t===null)return null;var a=r[0],i=a.match(/^pk_test/),o=QA(t.version),l=Xw;i&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("7.3.1"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var c=t.apply(void 0,r);return t4(c,n),c},Ka,eN=!1,tN=function(){return Ka||(Ka=n4(null).catch(function(t){return Ka=null,Promise.reject(t)}),Ka)};Promise.resolve().then(function(){return tN()}).catch(function(s){eN||console.warn(s)});var sN=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];eN=!0;var a=Date.now();return tN().then(function(i){return a4(i,r,a)})};function Hh(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function qh(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hh(Object(r),!0).forEach(function(n){rN(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Hh(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function Eo(s){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Eo=function(t){return typeof t}:Eo=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eo(s)}function rN(s,t,r){return t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function i4(s,t){if(s==null)return{};var r={},n=Object.keys(s),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=s[a]);return r}function o4(s,t){if(s==null)return{};var r=i4(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function nN(s,t){return l4(s)||c4(s,t)||d4(s,t)||u4()}function l4(s){if(Array.isArray(s))return s}function c4(s,t){var r=s&&(typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"]);if(r!=null){var n=[],a=!0,i=!1,o,l;try{for(r=r.call(s);!(a=(o=r.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(c){i=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function d4(s,t){if(s){if(typeof s=="string")return zh(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zh(s,t)}}function zh(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function u4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xs=function(t,r,n){var a=!!n,i=De.useRef(n);De.useEffect(function(){i.current=n},[n]),De.useEffect(function(){if(!a||!t)return function(){};var o=function(){i.current&&i.current.apply(i,arguments)};return t.on(r,o),function(){t.off(r,o)}},[a,r,t,i])},xd=function(t){var r=De.useRef(t);return De.useEffect(function(){r.current=t},[t]),r.current},ya=function(t){return t!==null&&Eo(t)==="object"},m4=function(t){return ya(t)&&typeof t.then=="function"},h4=function(t){return ya(t)&&typeof t.elements=="function"&&typeof t.createToken=="function"&&typeof t.createPaymentMethod=="function"&&typeof t.confirmCardPayment=="function"},Wh="[object Object]",p4=function s(t,r){if(!ya(t)||!ya(r))return t===r;var n=Array.isArray(t),a=Array.isArray(r);if(n!==a)return!1;var i=Object.prototype.toString.call(t)===Wh,o=Object.prototype.toString.call(r)===Wh;if(i!==o)return!1;if(!i&&!n)return t===r;var l=Object.keys(t),c=Object.keys(r);if(l.length!==c.length)return!1;for(var d={},u=0;u<l.length;u+=1)d[l[u]]=!0;for(var h=0;h<c.length;h+=1)d[c[h]]=!0;var m=Object.keys(d);if(m.length!==l.length)return!1;var x=t,g=r,f=function(y){return s(x[y],g[y])};return m.every(f)},aN=function(t,r,n){return ya(t)?Object.keys(t).reduce(function(a,i){var o=!ya(r)||!p4(t[i],r[i]);return n.includes(i)?(o&&console.warn("Unsupported prop change: options.".concat(i," is not a mutable property.")),a):o?qh(qh({},a||{}),{},rN({},i,t[i])):a},null):null},iN="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",Kh=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iN;if(t===null||h4(t))return t;throw new Error(r)},f4=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iN;if(m4(t))return{tag:"async",stripePromise:Promise.resolve(t).then(function(a){return Kh(a,r)})};var n=Kh(t,r);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},x4=function(t){!t||!t._registerWrapper||!t.registerAppInfo||(t._registerWrapper({name:"react-stripe-js",version:"3.7.0"}),t.registerAppInfo({name:"react-stripe-js",version:"3.7.0",url:"https://stripe.com/docs/stripe-js/react"}))},Ol=De.createContext(null);Ol.displayName="ElementsContext";var oN=function(t,r){if(!t)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(r," in an <Elements> provider."));return t},Lu=function(t){var r=t.stripe,n=t.options,a=t.children,i=De.useMemo(function(){return f4(r)},[r]),o=De.useState(function(){return{stripe:i.tag==="sync"?i.stripe:null,elements:i.tag==="sync"?i.stripe.elements(n):null}}),l=nN(o,2),c=l[0],d=l[1];De.useEffect(function(){var m=!0,x=function(f){d(function(v){return v.stripe?v:{stripe:f,elements:f.elements(n)}})};return i.tag==="async"&&!c.stripe?i.stripePromise.then(function(g){g&&m&&x(g)}):i.tag==="sync"&&!c.stripe&&x(i.stripe),function(){m=!1}},[i,c,n]);var u=xd(r);De.useEffect(function(){u!==null&&u!==r&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[u,r]);var h=xd(n);return De.useEffect(function(){if(c.elements){var m=aN(n,h,["clientSecret","fonts"]);m&&c.elements.update(m)}},[n,h,c.elements]),De.useEffect(function(){x4(c.stripe)},[c.stripe]),De.createElement(Ol.Provider,{value:c},a)};Lu.propTypes={stripe:jt.any,options:jt.object};var g4=function(t){var r=De.useContext(Ol);return oN(r,t)},lN=function(){var t=g4("calls useElements()"),r=t.elements;return r};jt.func.isRequired;var cN=De.createContext(null);cN.displayName="CheckoutSdkContext";var v4=function(t,r){if(!t)throw new Error("Could not find CheckoutProvider context; You need to wrap the part of your app that ".concat(r," in an <CheckoutProvider> provider."));return t},y4=De.createContext(null);y4.displayName="CheckoutContext";jt.any,jt.shape({fetchClientSecret:jt.func.isRequired,elementsOptions:jt.object}).isRequired;var gd=function(t){var r=De.useContext(cN),n=De.useContext(Ol);if(r&&n)throw new Error("You cannot wrap the part of your app that ".concat(t," in both <CheckoutProvider> and <Elements> providers."));return r?v4(r,t):oN(n,t)},j4=["mode"],b4=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},It=function(t,r){var n="".concat(b4(t),"Element"),a=function(c){var d=c.id,u=c.className,h=c.options,m=h===void 0?{}:h,x=c.onBlur,g=c.onFocus,f=c.onReady,v=c.onChange,y=c.onEscape,j=c.onClick,b=c.onLoadError,k=c.onLoaderStart,S=c.onNetworksChange,A=c.onConfirm,T=c.onCancel,C=c.onShippingAddressChange,E=c.onShippingRateChange,D=gd("mounts <".concat(n,">")),w="elements"in D?D.elements:null,N="checkoutSdk"in D?D.checkoutSdk:null,_=De.useState(null),F=nN(_,2),W=F[0],Z=F[1],$=De.useRef(null),ae=De.useRef(null);xs(W,"blur",x),xs(W,"focus",g),xs(W,"escape",y),xs(W,"click",j),xs(W,"loaderror",b),xs(W,"loaderstart",k),xs(W,"networkschange",S),xs(W,"confirm",A),xs(W,"cancel",T),xs(W,"shippingaddresschange",C),xs(W,"shippingratechange",E),xs(W,"change",v);var O;f&&(t==="expressCheckout"?O=f:O=function(){f(W)}),xs(W,"ready",O),De.useLayoutEffect(function(){if($.current===null&&ae.current!==null&&(w||N)){var Pe=null;if(N)switch(t){case"payment":Pe=N.createPaymentElement(m);break;case"address":if("mode"in m){var st=m.mode,rt=o4(m,j4);if(st==="shipping")Pe=N.createShippingAddressElement(rt);else if(st==="billing")Pe=N.createBillingAddressElement(rt);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":Pe=N.createExpressCheckoutElement(m);break;case"currencySelector":Pe=N.createCurrencySelectorElement();break;default:throw new Error("Invalid Element type ".concat(n,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else w&&(Pe=w.create(t,m));$.current=Pe,Z(Pe),Pe&&Pe.mount(ae.current)}},[w,N,m]);var ne=xd(m);return De.useEffect(function(){if($.current){var Pe=aN(m,ne,["paymentRequest"]);Pe&&"update"in $.current&&$.current.update(Pe)}},[m,ne]),De.useLayoutEffect(function(){return function(){if($.current&&typeof $.current.destroy=="function")try{$.current.destroy(),$.current=null}catch{}}},[]),De.createElement("div",{id:d,className:u,ref:ae})},i=function(c){gd("mounts <".concat(n,">"));var d=c.id,u=c.className;return De.createElement("div",{id:d,className:u})},o=r?i:a;return o.propTypes={id:jt.string,className:jt.string,onChange:jt.func,onBlur:jt.func,onFocus:jt.func,onReady:jt.func,onEscape:jt.func,onClick:jt.func,onLoadError:jt.func,onLoaderStart:jt.func,onNetworksChange:jt.func,onConfirm:jt.func,onCancel:jt.func,onShippingAddressChange:jt.func,onShippingRateChange:jt.func,options:jt.object},o.displayName=n,o.__elementType=t,o},Rt=typeof window>"u",w4=De.createContext(null);w4.displayName="EmbeddedCheckoutProviderContext";var dN=function(){var t=gd("calls useStripe()"),r=t.stripe;return r};It("auBankAccount",Rt);It("card",Rt);It("cardNumber",Rt);It("cardExpiry",Rt);It("cardCvc",Rt);It("fpxBank",Rt);It("iban",Rt);It("idealBank",Rt);It("p24Bank",Rt);It("epsBank",Rt);var uN=It("payment",Rt);It("expressCheckout",Rt);It("currencySelector",Rt);It("paymentRequestButton",Rt);It("linkAuthentication",Rt);It("address",Rt);It("shippingAddress",Rt);It("paymentMethodMessaging",Rt);It("affirmMessage",Rt);It("afterpayClearpayMessage",Rt);var $u="Radio",[N4,mN]=fs($u),[S4,C4]=N4($u),hN=p.forwardRef((s,t)=>{const{__scopeRadio:r,name:n,checked:a=!1,required:i,disabled:o,value:l="on",onCheck:c,form:d,...u}=s,[h,m]=p.useState(null),x=Ge(t,v=>m(v)),g=p.useRef(!1),f=h?d||!!h.closest("form"):!0;return e.jsxs(S4,{scope:r,checked:a,disabled:o,children:[e.jsx(Se.button,{type:"button",role:"radio","aria-checked":a,"data-state":xN(a),"data-disabled":o?"":void 0,disabled:o,value:l,...u,ref:x,onClick:ge(s.onClick,v=>{a||c==null||c(),f&&(g.current=v.isPropagationStopped(),g.current||v.stopPropagation())})}),f&&e.jsx(k4,{control:h,bubbles:!g.current,name:n,value:l,checked:a,required:i,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});hN.displayName=$u;var pN="RadioIndicator",fN=p.forwardRef((s,t)=>{const{__scopeRadio:r,forceMount:n,...a}=s,i=C4(pN,r);return e.jsx(ds,{present:n||i.checked,children:e.jsx(Se.span,{"data-state":xN(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t})})});fN.displayName=pN;var k4=s=>{const{control:t,checked:r,bubbles:n=!0,...a}=s,i=p.useRef(null),o=Ia(r),l=yl(t);return p.useEffect(()=>{const c=i.current,d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(o!==r&&h){const m=new Event("click",{bubbles:n});h.call(c,r),c.dispatchEvent(m)}},[o,r,n]),e.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:i,style:{...s.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function xN(s){return s?"checked":"unchecked"}var T4=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Bu="RadioGroup",[P4,oU]=fs(Bu,[jl,mN]),gN=jl(),vN=mN(),[E4,D4]=P4(Bu),yN=p.forwardRef((s,t)=>{const{__scopeRadioGroup:r,name:n,defaultValue:a,value:i,required:o=!1,disabled:l=!1,orientation:c,dir:d,loop:u=!0,onValueChange:h,...m}=s,x=gN(r),g=Ln(d),[f,v]=ms({prop:i,defaultProp:a,onChange:h});return e.jsx(E4,{scope:r,name:n,required:o,disabled:l,value:f,onValueChange:v,children:e.jsx(Vy,{asChild:!0,...x,orientation:c,dir:g,loop:u,children:e.jsx(Se.div,{role:"radiogroup","aria-required":o,"aria-orientation":c,"data-disabled":l?"":void 0,dir:g,...m,ref:t})})})});yN.displayName=Bu;var jN="RadioGroupItem",bN=p.forwardRef((s,t)=>{const{__scopeRadioGroup:r,disabled:n,...a}=s,i=D4(jN,r),o=i.disabled||n,l=gN(r),c=vN(r),d=p.useRef(null),u=Ge(t,d),h=i.value===a.value,m=p.useRef(!1);return p.useEffect(()=>{const x=f=>{T4.includes(f.key)&&(m.current=!0)},g=()=>m.current=!1;return document.addEventListener("keydown",x),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",x),document.removeEventListener("keyup",g)}},[]),e.jsx(Uy,{asChild:!0,...l,focusable:!o,active:h,children:e.jsx(hN,{disabled:o,required:i.required,checked:h,...c,...a,name:i.name,ref:u,onCheck:()=>i.onValueChange(a.value),onKeyDown:ge(x=>{x.key==="Enter"&&x.preventDefault()}),onFocus:ge(a.onFocus,()=>{var x;m.current&&((x=d.current)==null||x.click())})})})});bN.displayName=jN;var A4="RadioGroupIndicator",wN=p.forwardRef((s,t)=>{const{__scopeRadioGroup:r,...n}=s,a=vN(r);return e.jsx(fN,{...a,...n,ref:t})});wN.displayName=A4;var NN=yN,SN=bN,_4=wN;const CN=p.forwardRef(({className:s,...t},r)=>e.jsx(NN,{className:J("grid gap-2",s),...t,ref:r}));CN.displayName=NN.displayName;const vd=p.forwardRef(({className:s,...t},r)=>e.jsx(SN,{ref:r,className:J("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:e.jsx(_4,{className:"flex items-center justify-center",children:e.jsx(uj,{className:"h-2.5 w-2.5 fill-current text-current"})})}));vd.displayName=SN.displayName;function I4({orderGroupId:s,currentDiscount:t,taxExempt:r=!1,onDiscountApplied:n}){const[a,i]=p.useState((t==null?void 0:t.type)||"percentage"),[o,l]=p.useState((t==null?void 0:t.amount)||""),[c,d]=p.useState(r),[u,h]=p.useState(!1),{toast:m}=Be(),x=async()=>{if(!o||Number(o)<=0){m({title:"Invalid discount",description:"Please enter a valid discount amount",variant:"destructive"});return}h(!0);try{const g=await ce("POST",`/api/order-groups/${s}/apply-discount`,{discountType:a,discountAmount:o,taxExempt:c});if(g.ok){const f=await g.json();m({title:"Discount applied",description:f.message}),n()}else{const f=await g.json();m({title:"Error applying discount",description:f.message||"Something went wrong",variant:"destructive"})}}catch{m({title:"Error",description:"Failed to apply discount",variant:"destructive"})}finally{h(!1)}};return e.jsxs(V,{className:"w-full",children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Discounts & Tax Status"}),e.jsx(te,{children:"Apply discounts or mark order as tax exempt"})]}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Discount Type"}),e.jsxs(CN,{value:a,onValueChange:i,className:"flex space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(vd,{value:"percentage",id:"percentage"}),e.jsx(M,{htmlFor:"percentage",children:"Percentage (%)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(vd,{value:"fixed",id:"fixed"}),e.jsx(M,{htmlFor:"fixed",children:"Fixed Amount ($)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"discountAmount",children:a==="percentage"?"Discount Percentage":"Discount Amount"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{id:"discountAmount",type:"number",min:"0",step:a==="percentage"?"1":"0.01",max:a==="percentage"?"100":void 0,value:o,onChange:g=>l(g.target.value),className:"flex-1",placeholder:a==="percentage"?"10":"25.00"}),e.jsx("span",{className:"ml-2",children:a==="percentage"?"%":"$"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(os,{id:"taxExempt",checked:c,onCheckedChange:g=>d(g)}),e.jsx(M,{htmlFor:"taxExempt",children:"Tax Exempt"})]})]})}),e.jsx(ht,{children:e.jsx(P,{onClick:x,disabled:u,className:"w-full",children:u?"Applying...":"Apply"})})]})}const R4=sN("pk_live_51QC3rtP1hEy5reEdyiTbL1JCiuLRsrZmHHk83DW17gkXCYfPTBJcxMHjV35TZcjlvOuXDqDxd4ckktLBtwAWtl4K00o0kkZ50c"),M4=({orderGroupId:s})=>{const[t,r]=p.useState(!1),[n,a]=p.useState(null),i=dN(),o=lN(),{toast:l}=Be(),[c,d]=Cs(),u=async h=>{if(h.preventDefault(),!i||!o)return;r(!0),a(null);const{error:m,paymentIntent:x}=await i.confirmPayment({elements:o,confirmParams:{return_url:`${window.location.origin}/payment-status`},redirect:"if_required"});if(m){let g="An unexpected error occurred.";switch(m.type){case"card_error":g=`Your card was declined: ${m.message}`;break;case"validation_error":g="Please check your payment information and try again.";break;case"rate_limit_error":g="Too many payment attempts. Please wait a moment and try again.";break;default:g=m.message||g}a(g),l({title:"Payment failed",description:g,variant:"destructive"})}else if(x)switch(x.status){case"succeeded":l({title:"Payment successful",description:"Your payment has been processed successfully."}),d("/payment-status?payment_intent_client_secret="+x.client_secret);break;case"processing":l({title:"Payment processing",description:"Your payment is being processed."}),d("/payment-status?payment_intent_client_secret="+x.client_secret);break;case"requires_action":a("Your payment requires additional authentication.");break;default:a("Payment status unclear. Please contact support.")}r(!1)};return e.jsxs("form",{onSubmit:u,children:[e.jsxs(q,{className:"space-y-6 pt-6",children:[e.jsx(uN,{}),n&&e.jsx("div",{className:"text-red-500 text-sm",children:n})]}),e.jsxs(ht,{className:"pt-6 flex justify-between",children:[e.jsx(P,{variant:"outline",onClick:()=>d("/orders"),children:"Cancel"}),e.jsx(P,{type:"submit",disabled:!i||t,className:"ml-auto",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing"]}):"Pay Now"})]})]})},Gh=({orderGroupId:s})=>{const[t,r]=p.useState("cash"),[n,a]=p.useState(""),[i,o]=p.useState(""),[l,c]=p.useState(""),[d,u]=p.useState(!1),{toast:h}=Be(),[m,x]=Cs(),g=async f=>{if(f.preventDefault(),t==="cash"&&(!n||Number(n)<=0)){h({title:"Invalid cash amount",description:"Please enter a valid cash amount.",variant:"destructive"});return}if(t==="check"&&!i){h({title:"Check number required",description:"Please enter the check number.",variant:"destructive"});return}u(!0);try{const v=await fetch(`/api/order-groups/${s}/pay`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentMethod:t,details:{cashAmount:t==="cash"?Number(n):void 0,checkNumber:t==="check"?i:void 0,notes:l||void 0}})});if(v.ok)h({title:"Payment recorded",description:`${t==="cash"?"Cash":"Check"} payment has been successfully recorded.`}),x("/orders");else{const y=await v.json();h({title:"Payment failed",description:y.message||"Failed to process payment.",variant:"destructive"})}}catch{h({title:"Error",description:"There was an error processing your payment. Please try again.",variant:"destructive"})}finally{u(!1)}};return e.jsxs("form",{onSubmit:g,children:[e.jsxs(q,{className:"space-y-4 pt-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Payment Method"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(P,{type:"button",variant:t==="cash"?"default":"outline",onClick:()=>r("cash"),className:"flex-1",children:[e.jsx(Dn,{className:"mr-2 h-4 w-4"}),"Cash"]}),e.jsxs(P,{type:"button",variant:t==="check"?"default":"outline",onClick:()=>r("check"),className:"flex-1",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),"Check"]})]})]}),t==="cash"?e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"cashAmount",children:"Cash Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",children:"$"}),e.jsx(U,{id:"cashAmount",value:n,onChange:f=>a(f.target.value),type:"number",step:"0.01",min:"0",placeholder:"0.00",className:"pl-8"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"checkNumber",children:"Check Number"}),e.jsx(U,{id:"checkNumber",value:i,onChange:f=>o(f.target.value),placeholder:"Check #"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"notes",children:"Payment Notes (Optional)"}),e.jsx(U,{id:"notes",value:l,onChange:f=>c(f.target.value),placeholder:"Add any payment notes here"})]})]}),e.jsxs(ht,{className:"pt-6 flex justify-between",children:[e.jsx(P,{variant:"outline",onClick:()=>x("/orders"),children:"Cancel"}),e.jsx(P,{type:"submit",disabled:d,className:"ml-auto",children:d?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing"]}):"Record Payment"})]})]})},O4=()=>{const[s,t]=p.useState(null),{orderGroupId:r}=Tl(),{toast:n}=Be(),[a,i]=Cs(),[o,l]=p.useState(0),{data:c,isLoading:d,error:u}=me({queryKey:["/api/order-groups",r,o],queryFn:async()=>{const j=await fetch(`/api/order-groups/${r}`);if(!j.ok)throw new Error("Failed to fetch order group");return j.json()},enabled:!!r}),{data:h,isLoading:m,error:x}=me({queryKey:["/api/order-groups",r,"orders",o],queryFn:async()=>{const j=await fetch(`/api/order-groups/${r}/orders`);if(!j.ok)throw new Error("Failed to fetch orders");return j.json()},enabled:!!r});p.useEffect(()=>{r&&c&&(async()=>{try{const b=await fetch("/api/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderGroupId:Number(r),amount:Math.round(Number(c.total)*100)})});if(!b.ok)throw new Error("Failed to create payment intent");const k=await b.json();t(k.clientSecret)}catch(b){console.error("Error creating payment intent:",b),n({title:"Error",description:"Unable to initialize payment. Please try again later.",variant:"destructive"})}})()},[r,c,n,o]);const g=()=>{l(j=>j+1)},f=(h==null?void 0:h.reduce((j,b)=>j+Number(b.subtotal),0))||0,v=(h==null?void 0:h.reduce((j,b)=>j+Number(b.tax),0))||0,y=(h==null?void 0:h.reduce((j,b)=>j+Number(b.total),0))||0;return d||m?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"})}):u||x||!c||!h?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs(V,{children:[e.jsx(G,{children:e.jsx(Q,{children:"Error"})}),e.jsx(q,{children:e.jsx("p",{children:"There was an error loading the checkout information. Please try again later."})}),e.jsx(ht,{children:e.jsx(P,{onClick:()=>i("/orders"),children:"Return to Orders"})})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Checkout"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"md:col-span-5",children:[e.jsxs(V,{className:"mb-8",children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Order Summary"}),e.jsxs(te,{children:["Order Group #",c.id]})]}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[h.map(j=>e.jsx("div",{className:"border-b pb-4",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Order #",j.id]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[j.artworkWidth,'" × ',j.artworkHeight,'"']})]}),e.jsxs("p",{className:"font-medium",children:["$",Number(j.total).toFixed(2)]})]})},j.id)),e.jsxs("div",{className:"pt-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-muted-foreground",children:"Subtotal"}),e.jsxs("p",{children:["$",f.toFixed(2)]})]}),c.discountAmount&&c.discountType&&e.jsxs("div",{className:"flex justify-between mt-2 text-green-600",children:[e.jsxs("p",{children:["Discount ",c.discountType==="percentage"?`(${c.discountAmount}%)`:""]}),e.jsxs("p",{children:["-$",c.discountType==="percentage"?(Number(c.discountAmount)/100*f).toFixed(2):Number(c.discountAmount).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Tax ",c.taxExempt?"(Exempt)":""]}),e.jsxs("p",{children:["$",v.toFixed(2)]})]}),e.jsx(Ot,{className:"my-4"}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("p",{children:"Total"}),e.jsxs("p",{children:["$",y.toFixed(2)]})]})]})]})})]}),e.jsx(I4,{orderGroupId:Number(r),currentDiscount:c.discountAmount&&c.discountType?{type:c.discountType,amount:String(c.discountAmount)}:void 0,taxExempt:c.taxExempt,onDiscountApplied:g})]}),e.jsx("div",{className:"md:col-span-7",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Payment Method"}),e.jsx(te,{children:"Choose how you would like to pay for this order"})]}),e.jsxs(qt,{defaultValue:"credit_card",className:"w-full",children:[e.jsxs($t,{className:"grid w-full grid-cols-3",children:[e.jsxs(ve,{value:"credit_card",children:[e.jsx(xi,{className:"h-4 w-4 mr-2"}),"Credit Card"]}),e.jsxs(ve,{value:"cash",children:[e.jsx(Dn,{className:"h-4 w-4 mr-2"}),"Cash"]}),e.jsxs(ve,{value:"check",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Check"]})]}),e.jsx(Ae,{value:"credit_card",children:s?e.jsx(Lu,{stripe:R4,options:{clientSecret:s},children:e.jsx(M4,{orderGroupId:Number(r)})}):e.jsx(q,{className:"flex items-center justify-center py-10",children:e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"})})}),e.jsx(Ae,{value:"cash",children:e.jsx(Gh,{orderGroupId:Number(r)})}),e.jsx(Ae,{value:"check",children:e.jsx(Gh,{orderGroupId:Number(r)})})]})]})})]})]})},F4=()=>{const[,s]=Cs(),[t,r]=p.useState("loading"),[n,a]=p.useState(""),[i,o]=p.useState(null);p.useEffect(()=>{const u=new URLSearchParams(window.location.search),h=u.get("payment_intent_client_secret");if(u.get("redirect_status"),!h){r("failed"),a("No payment information found.");return}const m=h.split("_secret_")[0];(async()=>{try{const g=await fetch("/api/payment-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_intent_id:m,client_secret:h})}),f=await g.json();if(g.ok)switch(o(f.orderGroupId),f.status){case"succeeded":r("success"),a("Your payment has been processed successfully!");break;case"processing":r("processing"),a("Your payment is being processed. We'll notify you when it's complete.");break;case"requires_payment_method":r("failed"),a("Your payment was not successful. Please try again with a different payment method.");break;default:r("failed"),a("There was an issue with your payment. Please contact support.")}else r("failed"),a(f.message||"Failed to verify payment status.")}catch(g){console.error("Error checking payment status:",g),r("failed"),a("Unable to verify payment status. Please contact support.")}})()},[]);const l=()=>{switch(t){case"loading":return e.jsx(Xe,{className:"h-12 w-12 animate-spin text-blue-500"});case"success":return e.jsx(Gs,{className:"h-12 w-12 text-green-500"});case"processing":return e.jsx(Ht,{className:"h-12 w-12 text-yellow-500"});case"failed":return e.jsx(Bn,{className:"h-12 w-12 text-red-500"});default:return e.jsx(Xe,{className:"h-12 w-12 animate-spin text-blue-500"})}},c=()=>{switch(t){case"loading":return"Processing Payment...";case"success":return"Payment Successful!";case"processing":return"Payment Processing";case"failed":return"Payment Failed";default:return"Processing Payment..."}},d=()=>{switch(t){case"success":return"text-green-600";case"processing":return"text-yellow-600";case"failed":return"text-red-600";default:return"text-blue-600"}};return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(V,{children:[e.jsxs(G,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:l()}),e.jsx(Q,{className:d(),children:c()}),e.jsx(te,{children:n})]}),e.jsxs(q,{className:"text-center space-y-4",children:[t==="success"&&i&&e.jsx("div",{className:"p-4 bg-green-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-700",children:["Order #",i," has been confirmed and will be processed shortly."]})}),t==="processing"&&e.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-700",children:"We'll send you an email confirmation once the payment is complete."})}),t==="failed"&&e.jsx("div",{className:"p-4 bg-red-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-700",children:"No charges have been made to your account."})}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:t==="success"&&i?e.jsxs(e.Fragment,{children:[e.jsx(P,{onClick:()=>s("/orders"),children:"View My Orders"}),e.jsx(P,{variant:"outline",onClick:()=>s("/"),children:"Return Home"})]}):t==="failed"?e.jsxs(e.Fragment,{children:[e.jsx(P,{onClick:()=>window.history.back(),children:"Try Again"}),e.jsx(P,{variant:"outline",onClick:()=>s("/"),children:"Return Home"})]}):e.jsx(P,{variant:"outline",onClick:()=>s("/"),children:"Return Home"})})]})]})})})},L4=Vn("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),hs=p.forwardRef(({className:s,variant:t,...r},n)=>e.jsx("div",{ref:n,role:"alert",className:J(L4({variant:t}),s),...r}));hs.displayName="Alert";const Ys=p.forwardRef(({className:s,...t},r)=>e.jsx("h5",{ref:r,className:J("mb-1 font-medium leading-none tracking-tight",s),...t}));Ys.displayName="AlertTitle";const ps=p.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:J("text-sm [&_p]:leading-relaxed",s),...t}));ps.displayName="AlertDescription";function kN({customerId:s}){const{toast:t}=Be(),[r,n]=p.useState(null),[a,i]=p.useState(""),[o,l]=p.useState("all"),[c,d]=p.useState("all"),{data:u,isLoading:h}=me({queryKey:["/api/customers",s],queryFn:async()=>{const C=await fetch(`/api/customers/${s}`);if(!C.ok)throw new Error("Failed to fetch customer data");return C.json()}}),{data:m,isLoading:x,isError:g,error:f}=me({queryKey:["/api/customers",s,"invoices"],queryFn:async()=>{const C=await fetch(`/api/customers/${s}/orders`);if(!C.ok)throw new Error("Failed to load invoices");return(await C.json()).map(D=>({orderGroup:D.orderGroup,orders:D.orders,customer:u}))},enabled:!!s&&!!u}),v=C=>C?`$${Number(C).toFixed(2)}`:"$0.00",y=C=>{if(!C)return"N/A";try{return dr(new Date(C),"MMM d, yyyy")}catch{return"Invalid Date"}},j=C=>{n(C)},b=async C=>{try{const E=await fetch(`/api/invoices/send/${C}`,{method:"POST"});if(E.ok)t({title:"Invoice Sent",description:`Invoice has been emailed to ${u==null?void 0:u.email}`,variant:"default"});else{const D=await E.json();t({title:"Failed to Send",description:D.message||"There was an error sending the invoice",variant:"destructive"})}}catch{t({title:"Error",description:"Could not send invoice by email",variant:"destructive"})}},k=C=>{n(C),setTimeout(()=>{window.print()},500)},S=m?m.filter(C=>{const E=a===""||C.orderGroup.id.toString().includes(a)||C.orderGroup.notes&&C.orderGroup.notes.toLowerCase().includes(a.toLowerCase()),D=o==="all"||C.orderGroup.status===o||C.orderGroup.stripePaymentStatus===o,w=c==="all"||C.orderGroup.paymentMethod===c;return E&&D&&w}):[],A=m?[...new Set(m.map(C=>C.orderGroup.paymentMethod||"unknown"))]:[],T=m?[...new Set(m.map(C=>C.orderGroup.stripePaymentStatus||C.orderGroup.status))]:[];return x||h?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"})}):g?e.jsxs(hs,{variant:"destructive",className:"mb-4",children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(Ys,{children:"Error"}),e.jsx(ps,{children:f instanceof Error?f.message:"Failed to load invoices"})]}):e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Invoices & Order History"}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>{window.open(`/api/invoices/export/${s}`,"_blank")},children:[e.jsx(Cl,{className:"h-4 w-4 mr-2"}),"Export All"]})]}),e.jsx(te,{children:"View and manage all invoices for this customer"})]}),e.jsxs(q,{children:[!m||m.length===0?e.jsxs(hs,{className:"mb-4",children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(Ys,{children:"No Invoices"}),e.jsx(ps,{children:"There are no invoices available for this customer yet."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Zr,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(U,{placeholder:"Search by invoice #, notes...",className:"pl-8",value:a,onChange:C=>i(C.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(We,{value:o,onValueChange:l,children:[e.jsxs(He,{className:"w-[180px] text-xs",children:[e.jsx(ai,{className:"h-3.5 w-3.5 mr-2"}),e.jsx(Ke,{placeholder:"Filter by status"})]}),e.jsxs(qe,{children:[e.jsx(se,{value:"all",children:"All Statuses"}),T.map(C=>e.jsx(se,{value:C||"unknown",children:C||"Unknown Status"},C))]})]}),e.jsxs(We,{value:c,onValueChange:d,children:[e.jsxs(He,{className:"w-[180px] text-xs",children:[e.jsx(ai,{className:"h-3.5 w-3.5 mr-2"}),e.jsx(Ke,{placeholder:"Filter by payment"})]}),e.jsxs(qe,{children:[e.jsx(se,{value:"all",children:"All Payment Methods"}),A.map(C=>e.jsx(se,{value:C,children:C==="credit_card"?"Credit Card":C==="cash"?"Cash":C==="check"?"Check":C},C))]})]})]})]}),e.jsx("div",{className:"border rounded-md overflow-hidden",children:e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{className:"w-[100px]",children:"Invoice #"}),e.jsx(de,{children:"Date"}),e.jsx(de,{children:"Status"}),e.jsx(de,{children:"Payment"}),e.jsx(de,{className:"text-right",children:"Amount"}),e.jsx(de,{className:"text-right",children:"Actions"})]})}),e.jsx(ys,{children:S.length===0?e.jsx(tt,{children:e.jsx(ie,{colSpan:6,className:"text-center py-6 text-muted-foreground",children:"No invoices match your filters"})}):S.map(C=>e.jsxs(tt,{children:[e.jsx(ie,{className:"font-medium",children:C.orderGroup.id}),e.jsx(ie,{children:y(C.orderGroup.createdAt)}),e.jsx(ie,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${["succeeded","paid","completed"].includes(C.orderGroup.stripePaymentStatus||C.orderGroup.status)?"bg-green-100 text-green-800":["pending","processing"].includes(C.orderGroup.stripePaymentStatus||C.orderGroup.status)?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:C.orderGroup.stripePaymentStatus||C.orderGroup.status})}),e.jsx(ie,{children:C.orderGroup.paymentMethod||"N/A"}),e.jsx(ie,{className:"text-right",children:v(C.orderGroup.total)}),e.jsx(ie,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>j(C),children:[e.jsx(pi,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"View"})]}),e.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>k(C),children:[e.jsx(Lo,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Print"})]}),(u==null?void 0:u.email)&&e.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>b(C.orderGroup.id),children:[e.jsx(Sr,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Email"})]})]})})]},C.orderGroup.id))})]})})]}),e.jsx(Bt,{open:!!r,onOpenChange:C=>!C&&n(null),children:e.jsx(Lt,{className:"max-w-4xl",children:r&&e.jsxs("div",{className:"p-4",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Invoice #",r.orderGroup.id]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Bill To:"}),e.jsx("p",{className:"text-sm",children:r.customer.name}),r.customer.email&&e.jsx("p",{className:"text-sm",children:r.customer.email}),r.customer.phone&&e.jsx("p",{className:"text-sm",children:r.customer.phone}),r.customer.address&&e.jsx("p",{className:"text-sm",children:r.customer.address})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Invoice Date:"}),e.jsx("span",{children:y(r.orderGroup.createdAt)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Payment Status:"}),e.jsx("span",{children:r.orderGroup.stripePaymentStatus||r.orderGroup.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Payment Method:"}),e.jsx("span",{children:r.orderGroup.paymentMethod||"N/A"})]}),r.orderGroup.paymentDate&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Payment Date:"}),e.jsx("span",{children:y(r.orderGroup.paymentDate)})]})]})]}),e.jsx("div",{className:"border rounded-md mb-6",children:e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{children:"Item"}),e.jsx(de,{children:"Description"}),e.jsx(de,{className:"text-right",children:"Qty"}),e.jsx(de,{className:"text-right",children:"Price"}),e.jsx(de,{className:"text-right",children:"Total"})]})}),e.jsx(ys,{children:r.orders.map(C=>e.jsxs(tt,{children:[e.jsxs(ie,{children:["Order #",C.id]}),e.jsx(ie,{children:C.artworkDescription||`Custom Framing (${C.artworkWidth}" × ${C.artworkHeight}")`}),e.jsx(ie,{className:"text-right",children:C.quantity}),e.jsx(ie,{className:"text-right",children:v(parseFloat(C.subtotal)/C.quantity)}),e.jsx(ie,{className:"text-right",children:v(C.subtotal)})]},C.id))})]})}),e.jsxs("div",{className:"flex flex-col items-end space-y-2 mb-6",children:[e.jsxs("div",{className:"flex justify-between w-60",children:[e.jsx("span",{className:"font-medium",children:"Subtotal:"}),e.jsx("span",{children:v(r.orderGroup.subtotal)})]}),e.jsxs("div",{className:"flex justify-between w-60",children:[e.jsx("span",{className:"font-medium",children:"Tax:"}),e.jsx("span",{children:v(r.orderGroup.tax)})]}),e.jsxs("div",{className:"flex justify-between w-60 text-lg font-bold",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:v(r.orderGroup.total)})]})]}),r.orderGroup.notes&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Notes:"}),e.jsx("p",{className:"text-sm",children:r.orderGroup.notes})]}),e.jsxs("div",{className:"flex justify-end mt-8 gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>n(null),children:"Close"}),e.jsxs(P,{variant:"default",onClick:()=>window.print(),className:"text-white",children:[e.jsx(Lo,{className:"h-4 w-4 mr-2"}),"Print"]}),(u==null?void 0:u.email)&&e.jsxs(P,{variant:"default",onClick:()=>{b(r.orderGroup.id),n(null)},className:"text-white",children:[e.jsx(Sr,{className:"h-4 w-4 mr-2"}),"Email"]})]})]})})})]})]})}function $4({customerId:s}){Be();const[,t]=Cs(),[r,n]=p.useState("all"),{data:a,isLoading:i}=me({queryKey:["/api/customers",s],queryFn:async()=>{const g=await fetch(`/api/customers/${s}`);if(!g.ok)throw new Error("Failed to fetch customer data");return g.json()}}),{data:o,isLoading:l}=me({queryKey:["/api/orders",{customerId:s}],queryFn:async()=>{const g=await fetch(`/api/orders?customerId=${s}`);if(!g.ok)throw new Error("Failed to fetch order history");return g.json()}}),{data:c,isLoading:d}=me({queryKey:["/api/order-groups",{customerId:s}],queryFn:async()=>{const g=await fetch(`/api/customers/${s}/orders`);if(!g.ok)throw new Error("Failed to fetch order groups");return(await g.json()).map(v=>v.orderGroup)}}),u=g=>{if(!g)return"N/A";try{return dr(new Date(g),"MMM d, yyyy")}catch{return"Invalid Date"}},m=(()=>{if(!o||!c)return{totalSpent:0,orderCount:0,averageOrderValue:0,recentOrderDate:null,upcomingOrders:0,inProgressOrders:0,paymentMethods:{},ordersByMonth:{}};const g=o.filter(E=>{if(r==="all")return!0;const D=new Date(E.createdAt),w=r==="6months"?oo(new Date,6):oo(new Date,12);return fh(D,w)}),f=c.filter(E=>{if(r==="all")return!0;const D=new Date(E.createdAt),w=r==="6months"?oo(new Date,6):oo(new Date,12);return fh(D,w)}),v=f.reduce((E,D)=>E+(D.total?parseFloat(D.total):0),0),y=f.length,j=y>0?v/y:0,b=g.map(E=>new Date(E.createdAt).getTime()).sort((E,D)=>D-E),k=b.length>0?new Date(b[0]).toISOString():null,S=g.filter(E=>E.dueDate&&new Date(E.dueDate)>new Date).length,A=g.filter(E=>E.productionStatus!=="completed"&&E.productionStatus!=="order_processed").length,T={};f.forEach(E=>{const D=E.paymentMethod||"unknown";T[D]=(T[D]||0)+1});const C={};return g.forEach(E=>{const D=dr(new Date(E.createdAt),"MMM yyyy");C[D]=(C[D]||0)+1}),{totalSpent:v,orderCount:y,averageOrderValue:j,recentOrderDate:k,upcomingOrders:S,inProgressOrders:A,paymentMethods:T,ordersByMonth:C}})(),x=g=>{let f="";switch(g.toLowerCase()){case"active":f="bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100";break;case"inactive":f="bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100";break;default:f="bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100"}return e.jsx(ue,{className:f,children:g})};return i||l||d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"})}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{children:[e.jsx(G,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(Q,{className:"text-2xl",children:a.name}),e.jsxs(te,{children:["Customer since ",u(a.createdAt)]})]}),e.jsxs("div",{className:"flex flex-col sm:items-end",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Status:"}),x("Active")]}),a.stripeCustomerId&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(xi,{className:"h-4 w-4 mr-1 text-green-600"}),e.jsx("span",{className:"text-sm text-green-600",children:"Stripe Customer"})]})]})]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex flex-col p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Total Spent"}),e.jsx(Dn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs("span",{className:"text-2xl font-bold",children:["$",m.totalSpent.toFixed(2)]}),e.jsx("div",{className:"mt-auto pt-2 text-xs text-muted-foreground",children:"Lifetime value"})]}),e.jsxs("div",{className:"flex flex-col p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Orders"}),e.jsx(ha,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx("span",{className:"text-2xl font-bold",children:m.orderCount}),e.jsx("div",{className:"mt-auto pt-2 text-xs text-muted-foreground",children:"Total orders placed"})]}),e.jsxs("div",{className:"flex flex-col p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Average Order"}),e.jsx($o,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs("span",{className:"text-2xl font-bold",children:["$",m.averageOrderValue.toFixed(2)]}),e.jsx("div",{className:"mt-auto pt-2 text-xs text-muted-foreground",children:"Average order value"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Contact Information"}),e.jsxs("div",{className:"space-y-2",children:[a.email&&e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-sm text-muted-foreground",children:"Email:"}),e.jsx("span",{className:"flex-1 text-sm",children:a.email})]}),a.phone&&e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-sm text-muted-foreground",children:"Phone:"}),e.jsx("span",{className:"flex-1 text-sm",children:a.phone})]}),a.address&&e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-sm text-muted-foreground",children:"Address:"}),e.jsx("span",{className:"flex-1 text-sm",children:a.address})]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(vt,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Recent Order"})]}),e.jsx("span",{className:"text-sm font-medium",children:m.recentOrderDate?u(m.recentOrderDate):"No orders"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(_2,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Upcoming Orders"})]}),e.jsx("span",{className:"text-sm font-medium",children:m.upcomingOrders})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(mj,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"In Progress"})]}),e.jsx("span",{className:"text-sm font-medium",children:m.inProgressOrders})]})]})]})]})]}),e.jsxs(ht,{className:"flex justify-between border-t px-6 py-4",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(P,{variant:r==="all"?"default":"outline",size:"sm",onClick:()=>n("all"),className:r==="all"?"text-white":"",children:"All Time"}),e.jsx(P,{variant:r==="12months"?"default":"outline",size:"sm",onClick:()=>n("12months"),className:r==="12months"?"text-white":"",children:"Last 12 Months"}),e.jsx(P,{variant:r==="6months"?"default":"outline",size:"sm",onClick:()=>n("6months"),className:r==="6months"?"text-white":"",children:"Last 6 Months"})]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>t(`/pos?customerId=${a.id}`),children:["Create Order",e.jsx(kl,{className:"ml-1 h-4 w-4"})]})]})]}),e.jsx(kN,{customerId:s}),e.jsx("div",{className:"mt-8",children:e.jsx(CustomerActivityTimeline,{customerId:s})})]}):e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Customer Not Found"}),e.jsx(te,{children:"Could not find customer information"})]}),e.jsx(q,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ht,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{children:"The requested customer information could not be found."})]})}),e.jsx(ht,{children:e.jsx(P,{variant:"outline",onClick:()=>t("/customers"),children:"Back to Customers"})})]})}var Vu="Switch",[B4,lU]=fs(Vu),[V4,U4]=B4(Vu),TN=p.forwardRef((s,t)=>{const{__scopeSwitch:r,name:n,checked:a,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:d,form:u,...h}=s,[m,x]=p.useState(null),g=Ge(t,b=>x(b)),f=p.useRef(!1),v=m?u||!!m.closest("form"):!0,[y=!1,j]=ms({prop:a,defaultProp:i,onChange:d});return e.jsxs(V4,{scope:r,checked:y,disabled:l,children:[e.jsx(Se.button,{type:"button",role:"switch","aria-checked":y,"aria-required":o,"data-state":DN(y),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:g,onClick:ge(s.onClick,b=>{j(k=>!k),v&&(f.current=b.isPropagationStopped(),f.current||b.stopPropagation())})}),v&&e.jsx(H4,{control:m,bubbles:!f.current,name:n,value:c,checked:y,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});TN.displayName=Vu;var PN="SwitchThumb",EN=p.forwardRef((s,t)=>{const{__scopeSwitch:r,...n}=s,a=U4(PN,r);return e.jsx(Se.span,{"data-state":DN(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:t})});EN.displayName=PN;var H4=s=>{const{control:t,checked:r,bubbles:n=!0,...a}=s,i=p.useRef(null),o=Ia(r),l=yl(t);return p.useEffect(()=>{const c=i.current,d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(o!==r&&h){const m=new Event("click",{bubbles:n});h.call(c,r),c.dispatchEvent(m)}},[o,r,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:i,style:{...s.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function DN(s){return s?"checked":"unchecked"}var AN=TN,q4=EN;const br=p.forwardRef(({className:s,...t},r)=>e.jsx(AN,{className:J("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...t,ref:r,children:e.jsx(q4,{className:J("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));br.displayName=AN.displayName;function z4({customerId:s}){const{toast:t}=Be(),r=Zt(),[n,a]=p.useState(!1),[i,o]=p.useState({}),{data:l,isLoading:c}=me({queryKey:[`/api/customers/${s}/preferences`],queryFn:()=>ce("GET",`/api/customers/${s}/preferences`).then(x=>x.json()).catch(x=>{if(x.status===404)return{customerId:s,notificationsEnabled:!0,emailNotifications:!0,smsNotifications:!1,specialInstructions:"",notes:"",preferredMatType:"",preferredGlassType:"",preferredPickupDay:""};throw x}),enabled:!!s});De.useEffect(()=>{l&&o(l)},[l]);const d=Ce({mutationFn:async x=>{const g=`/api/customers/${s}/preferences`,f=l!=null&&l.id?"PATCH":"POST";return(await ce(f,g,x)).json()},onSuccess:()=>{r.invalidateQueries({queryKey:[`/api/customers/${s}/preferences`]}),a(!1),t({title:"Preferences saved",description:"Customer preferences have been updated"})},onError:x=>{t({title:"Error saving preferences",description:"There was a problem saving customer preferences",variant:"destructive"})}}),u=x=>{const{name:g,value:f}=x.target;o(v=>({...v,[g]:f}))},h=(x,g)=>{o(f=>({...f,[x]:g}))},m=x=>{x.preventDefault(),d.mutate(i)};return c?e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Customer Preferences"}),e.jsx(te,{children:"Loading customer preferences..."})]}),e.jsx(q,{className:"flex justify-center py-8",children:e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"})})]}):e.jsxs(V,{children:[e.jsxs(G,{className:"flex flex-row items-start justify-between space-y-0",children:[e.jsxs("div",{children:[e.jsx(Q,{children:"Customer Preferences"}),e.jsx(te,{children:"Preferences and special notes for this customer"})]}),n?null:e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>a(!0),children:[e.jsx(Aa,{className:"mr-2 h-4 w-4"}),"Edit"]})]}),e.jsx(q,{children:n?e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center",children:[e.jsx(Fr,{className:"mr-2 h-4 w-4"}),"Notification Preferences"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(M,{htmlFor:"notificationsEnabled",className:"flex-1",children:"Enable notifications"}),e.jsx(br,{id:"notificationsEnabled",checked:i.notificationsEnabled,onCheckedChange:x=>h("notificationsEnabled",x)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(M,{htmlFor:"emailNotifications",className:"flex-1",children:"Email notifications"}),e.jsx(br,{id:"emailNotifications",checked:i.emailNotifications,onCheckedChange:x=>h("emailNotifications",x),disabled:!i.notificationsEnabled})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(M,{htmlFor:"smsNotifications",className:"flex-1",children:"SMS notifications"}),e.jsx(br,{id:"smsNotifications",checked:i.smsNotifications,onCheckedChange:x=>h("smsNotifications",x),disabled:!i.notificationsEnabled})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center",children:[e.jsx(hj,{className:"mr-2 h-4 w-4"}),"Special Instructions"]}),e.jsx(Zs,{name:"specialInstructions",value:i.specialInstructions||"",onChange:u,placeholder:"Add special framing instructions for this customer",className:"min-h-[100px]"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Internal Notes"}),e.jsx(Zs,{name:"notes",value:i.notes||"",onChange:u,placeholder:"Add internal notes about this customer (not visible to customer)",className:"min-h-[100px]"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(P,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(P,{type:"submit",disabled:d.isPending,children:[d.isPending&&e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx(I2,{className:"mr-2 h-4 w-4"}),"Save Preferences"]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center",children:[e.jsx(Fr,{className:"mr-2 h-4 w-4"}),"Notification Preferences"]}),e.jsx("div",{className:"rounded-md border p-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("div",{className:"text-muted-foreground",children:"Notifications:"}),e.jsx("div",{children:i.notificationsEnabled?"Enabled":"Disabled"}),e.jsx("div",{className:"text-muted-foreground",children:"Email Notifications:"}),e.jsx("div",{children:i.emailNotifications?"Enabled":"Disabled"}),e.jsx("div",{className:"text-muted-foreground",children:"SMS Notifications:"}),e.jsx("div",{children:i.smsNotifications?"Enabled":"Disabled"})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Special Instructions"}),e.jsx("div",{className:"rounded-md border p-3 min-h-[80px]",children:i.specialInstructions?e.jsx("p",{className:"text-sm",children:i.specialInstructions}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No special instructions"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Internal Notes"}),e.jsx("div",{className:"rounded-md border p-3 min-h-[80px]",children:i.notes?e.jsx("p",{className:"text-sm",children:i.notes}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No internal notes"})})]})]})})]})}function W4(s){switch(s){case"order_created":return e.jsx(ha,{className:"h-5 w-5 text-blue-500"});case"payment_completed":return e.jsx(xi,{className:"h-5 w-5 text-green-500"});case"status_changed":return e.jsx(Fr,{className:"h-5 w-5 text-yellow-500"});case"invoice_generated":return e.jsx(Cl,{className:"h-5 w-5 text-purple-500"});case"order_shipped":return e.jsx(Yr,{className:"h-5 w-5 text-indigo-500"});case"order_ready":return e.jsx(Qs,{className:"h-5 w-5 text-teal-500"});case"appointment_scheduled":return e.jsx(Ur,{className:"h-5 w-5 text-orange-500"});case"production_update":return e.jsx(R2,{className:"h-5 w-5 text-gray-500"});default:return e.jsx(vt,{className:"h-5 w-5 text-gray-500"})}}function K4(s){switch(s){case"order_created":return e.jsx(ue,{variant:"default",children:"New Order"});case"payment_completed":return e.jsx(ue,{className:"bg-green-100 text-green-800",children:"Payment Received"});case"status_changed":return e.jsx(ue,{className:"bg-yellow-100 text-yellow-800",children:"Status Updated"});case"invoice_generated":return e.jsx(ue,{className:"bg-purple-100 text-purple-800",children:"Invoice"});case"order_shipped":return e.jsx(ue,{className:"bg-indigo-100 text-indigo-800",children:"Shipped"});case"order_ready":return e.jsx(ue,{className:"bg-teal-100 text-teal-800",children:"Ready for Pickup"});case"appointment_scheduled":return e.jsx(ue,{className:"bg-orange-100 text-orange-800",children:"Appointment"});case"production_update":return e.jsx(ue,{className:"bg-gray-100 text-gray-800",children:"Production"});default:return e.jsx(ue,{variant:"outline",children:"Activity"})}}function G4({customerId:s}){const{data:t,isLoading:r}=me({queryKey:[`/api/status-history/customers/${s}/status-history`],queryFn:()=>ce("GET",`/api/status-history/customers/${s}/status-history`).then(l=>l.json()),enabled:!!s}),{data:n,isLoading:a}=me({queryKey:[`/api/notifications/customers/${s}/notifications`],queryFn:()=>ce("GET",`/api/notifications/customers/${s}/notifications`).then(l=>l.json()),enabled:!!s}),i=[];t&&t.forEach(l=>{i.push({id:l.id,type:"status_changed",message:`Order #${l.order_id} status changed from "${l.previous_status}" to "${l.new_status}"`,timestamp:l.changed_at,orderId:l.order_id,details:{frameName:l.frame_name,artworkDescription:l.artwork_description,previousStatus:l.previous_status,newStatus:l.new_status}})}),n&&n.forEach(l=>{i.push({id:l.id,type:l.type,message:l.message,timestamp:l.created_at,orderId:l.order_id,details:l.details?JSON.parse(l.details):{}})});const o=i.sort((l,c)=>new Date(c.timestamp).getTime()-new Date(l.timestamp).getTime());return r||a?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"})}):o.length===0?e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Activity Timeline"}),e.jsx(te,{children:"No activity found for this customer"})]}),e.jsx(q,{children:e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(vt,{className:"mx-auto h-12 w-12 text-muted-foreground opacity-50"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"No activity has been recorded yet"})]})})})]}):e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Activity Timeline"}),e.jsx(te,{children:"Recent activity for this customer"})]}),e.jsx(q,{children:e.jsx("div",{className:"space-y-8",children:o.map((l,c)=>{var d;return e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"mr-4 flex flex-col items-center",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full border border-muted bg-background",children:W4(l.type)}),c<o.length-1&&e.jsx("div",{className:"h-full w-px bg-border"})]}),e.jsxs("div",{className:"flex flex-col gap-2 pb-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[K4(l.type),e.jsx("span",{className:"text-sm text-muted-foreground",children:dr(new Date(l.timestamp),"MMM dd, yyyy • h:mm a")})]}),e.jsx("p",{className:"text-sm",children:l.message}),l.orderId&&e.jsxs("div",{className:"mt-1 rounded-md bg-muted/50 p-2 text-xs",children:[e.jsxs("div",{className:"font-medium",children:["Order #",l.orderId]}),((d=l.details)==null?void 0:d.frameName)&&e.jsxs("div",{className:"text-muted-foreground",children:[l.details.frameName,l.details.artworkDescription?` - ${l.details.artworkDescription}`:""]})]})]})]},`${l.type}-${l.id}-${c}`)})})})]})}function Q4(){const[s]=Cs(),t=s.split("/"),r=t[t.length-1],n=r==="new",a=!n&&!isNaN(parseInt(r))?parseInt(r):void 0,{toast:i}=Be(),[,o]=Cs(),l=Zt(),[c,d]=p.useState(!1),[u,h]=p.useState({}),[m,x]=p.useState("dashboard");p.useEffect(()=>{n&&(h({name:"",email:"",phone:"",address:""}),d(!0))},[n]);const{data:g,isLoading:f,error:v}=me({queryKey:["/api/customers",a],queryFn:()=>n||!a?Promise.resolve(void 0):fetch(`/api/customers/${a}`).then(A=>{if(!A.ok)throw new Error("Failed to fetch customer");return A.json()}),enabled:!n&&!!a}),y=Ce({mutationFn:async A=>await(await ce("PATCH",`/api/customers/${a}`,A)).json(),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/customers",a]}),d(!1),i({title:"Customer updated",description:"Customer information has been updated successfully.",variant:"default"})},onError:A=>{i({title:"Update failed",description:A.message,variant:"destructive"})}}),j=Ce({mutationFn:async A=>await(await ce("POST","/api/customers",A)).json(),onSuccess:A=>{l.invalidateQueries({queryKey:["/api/customers"]}),d(!1),i({title:"Customer created",description:"New customer has been created successfully.",variant:"default"}),o(`/customers/${A.id}`)},onError:A=>{i({title:"Creation failed",description:A.message,variant:"destructive"})}}),b=A=>{const{name:T,value:C}=A.target;h(E=>({...E,[T]:C}))},k=A=>{A.preventDefault(),a===void 0||isNaN(a)||!g?j.mutate(u):y.mutate(u)},S=()=>{g&&(h({name:g.name,email:g.email||"",phone:g.phone||"",address:g.address||""}),d(!0))};return f?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"})}):v?e.jsxs(hs,{variant:"destructive",className:"mb-4",children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(Ys,{children:"Error"}),e.jsx(ps,{children:v instanceof Error?v.message:"Failed to load customer information"})]}):n||!g&&!f?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:n?"Create New Customer":"Customer Account"}),e.jsxs("div",{className:"flex gap-2",children:[!n&&e.jsx(P,{variant:"default",onClick:()=>o("/customers/new"),className:"text-white",children:"New Customer"}),e.jsx(P,{variant:"outline",onClick:()=>o("/customers"),children:"Back to Customers"})]})]}),!n&&e.jsxs(hs,{variant:"destructive",className:"mb-4",children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(Ys,{children:"Customer Not Found"}),e.jsx(ps,{children:'The requested customer information could not be found. You can create a new customer using the "New Customer" button above.'})]}),n&&e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Customer Information"}),e.jsx(te,{children:"Enter the information for the new customer"})]}),e.jsx(q,{children:e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"name",children:"Full Name"}),e.jsx(U,{id:"name",name:"name",value:u.name||"",onChange:b,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"email",children:"Email Address"}),e.jsx(U,{id:"email",name:"email",type:"email",value:u.email||"",onChange:b})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"phone",children:"Phone Number"}),e.jsx(U,{id:"phone",name:"phone",value:u.phone||"",onChange:b})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"address",children:"Address"}),e.jsx(U,{id:"address",name:"address",value:u.address||"",onChange:b})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(P,{type:"button",variant:"outline",onClick:()=>o("/customers"),children:"Cancel"}),e.jsxs(P,{type:"submit",disabled:j.isPending,className:"text-white",children:[j.isPending&&e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Customer"]})]})]})})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Customer Account"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"default",onClick:()=>o("/customers/new"),className:"text-white",children:"New Customer"}),e.jsx(P,{variant:"outline",onClick:()=>o("/customers"),children:"Back to Customers"})]})]}),e.jsxs("div",{className:"flex flex-col space-y-6",children:[e.jsxs(V,{children:[e.jsx(G,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(Q,{className:"text-2xl flex items-center",children:[e.jsx(hj,{className:"h-6 w-6 mr-2 text-primary"}),g==null?void 0:g.name]}),e.jsx(te,{children:"Manage customer information"})]}),!c&&e.jsxs(P,{variant:"outline",onClick:S,children:[e.jsx(gi,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})]})}),e.jsx(q,{children:c?e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"name",children:"Full Name"}),e.jsx(U,{id:"name",name:"name",value:u.name||"",onChange:b,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"email",children:"Email Address"}),e.jsx(U,{id:"email",name:"email",type:"email",value:u.email||"",onChange:b})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"phone",children:"Phone Number"}),e.jsx(U,{id:"phone",name:"phone",value:u.phone||"",onChange:b})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"address",children:"Address"}),e.jsx(U,{id:"address",name:"address",value:u.address||"",onChange:b})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(P,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsxs(P,{type:"submit",disabled:y.isPending,className:"text-white",children:[y.isPending&&e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-muted-foreground",children:"Full Name"}),e.jsx("div",{className:"text-lg",children:g==null?void 0:g.name})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-muted-foreground",children:"Email Address"}),e.jsx("div",{className:"text-lg",children:(g==null?void 0:g.email)||"Not provided"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-muted-foreground",children:"Phone Number"}),e.jsx("div",{className:"text-lg",children:(g==null?void 0:g.phone)||"Not provided"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-muted-foreground",children:"Address"}),e.jsx("div",{className:"text-lg",children:(g==null?void 0:g.address)||"Not provided"})]})]})})]}),e.jsxs(qt,{value:m,onValueChange:x,className:"w-full",children:[e.jsxs($t,{className:"mb-4 grid grid-cols-3 md:w-auto md:grid-cols-6",children:[e.jsxs(ve,{value:"dashboard",className:"flex items-center",children:[e.jsx(M2,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),e.jsxs(ve,{value:"orders",className:"flex items-center",children:[e.jsx(ha,{className:"h-4 w-4 mr-2"}),"Orders"]}),e.jsxs(ve,{value:"invoices",className:"flex items-center",children:[e.jsx(O2,{className:"h-4 w-4 mr-2"}),"Invoices"]}),e.jsxs(ve,{value:"activity",className:"flex items-center",children:[e.jsx(F2,{className:"h-4 w-4 mr-2"}),"Activity"]}),e.jsxs(ve,{value:"preferences",className:"flex items-center",children:[e.jsx(gi,{className:"h-4 w-4 mr-2"}),"Preferences"]}),e.jsxs(ve,{value:"payments",className:"flex items-center",children:[e.jsx(xi,{className:"h-4 w-4 mr-2"}),"Payments"]})]}),e.jsx(Ae,{value:"dashboard",children:g&&a&&e.jsx($4,{customerId:a})}),e.jsx(Ae,{value:"orders",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Order History"}),e.jsx(te,{children:"View and manage customer orders and their production status"})]}),e.jsx(q,{children:e.jsx("div",{className:"flex justify-center py-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ha,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"Orders Tab Under Development"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2 max-w-md",children:"This tab will show a detailed list of all orders with production status, due dates, and other important details."}),e.jsx(P,{variant:"default",className:"mt-4 text-white",onClick:()=>{a&&o(`/pos?customerId=${a}`)},children:"Create New Order"})]})})})]})}),e.jsx(Ae,{value:"invoices",children:g&&a&&e.jsx(kN,{customerId:a})}),e.jsx(Ae,{value:"activity",children:g&&a&&e.jsx(G4,{customerId:a})}),e.jsx(Ae,{value:"preferences",children:g&&a&&e.jsx(z4,{customerId:a})}),e.jsx(Ae,{value:"payments",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Payment Methods"}),e.jsx(te,{children:"Manage payment methods and billing information"})]}),e.jsx(q,{children:e.jsx("div",{className:"flex justify-center py-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xi,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"Payments Tab Under Development"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2 max-w-md",children:"This tab will show saved payment methods, billing preferences, and payment history."}),e.jsx(P,{variant:"outline",className:"mt-4",onClick:()=>x("dashboard"),children:"Return to Dashboard"})]})})})]})})]})]})]})}const Z4=()=>{const{toast:s}=Be(),[t,r]=p.useState(""),[n,a]=p.useState(!1),[i,o]=Cs(),[l,c]=p.useState({name:"",email:"",phone:"",address:""}),{data:d,isLoading:u,isError:h}=me({queryKey:["/api/customers"],staleTime:3e4}),m=Ce({mutationFn:async f=>(await ce("POST","/api/customers",f)).json(),onSuccess:f=>{ut.invalidateQueries({queryKey:["/api/customers"]}),a(!1),c({name:"",email:"",phone:"",address:""}),s({title:"Customer Created",description:`Customer ${f.name} has been created successfully`})},onError:f=>{s({title:"Creation Failed",description:f.message||"Failed to create customer",variant:"destructive"})}}),x=f=>{if(f.preventDefault(),!l.name.trim()){s({title:"Validation Error",description:"Customer name is required",variant:"destructive"});return}m.mutate(l)},g=Array.isArray(d)?d.filter(f=>{const v=t.toLowerCase();return f.name.toLowerCase().includes(v)||f.email&&f.email.toLowerCase().includes(v)||f.phone&&f.phone.includes(t)}):[];return u?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{children:"Loading customers..."})]})}):h?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"text-center text-red-600",children:e.jsx("p",{children:"Error loading customers. Please try again."})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Customers"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your customer database and contact information"})]}),e.jsxs(Bt,{open:n,onOpenChange:a,children:[e.jsx(va,{asChild:!0,children:e.jsxs(P,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Vr,{className:"h-4 w-4 mr-2"}),"Add Customer"]})}),e.jsxs(Lt,{children:[e.jsxs(Vt,{children:[e.jsx(Ut,{children:"Add New Customer"}),e.jsx(bs,{children:"Create a new customer record for your framing business"})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"name",children:"Full Name *"}),e.jsx(U,{id:"name",value:l.name,onChange:f=>c(v=>({...v,name:f.target.value})),placeholder:"Enter customer's full name",required:!0})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"email",children:"Email"}),e.jsx(U,{id:"email",type:"email",value:l.email,onChange:f=>c(v=>({...v,email:f.target.value})),placeholder:"customer@email.com"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"phone",children:"Phone"}),e.jsx(U,{id:"phone",value:l.phone,onChange:f=>c(v=>({...v,phone:f.target.value})),placeholder:"(555) 123-4567"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"address",children:"Address"}),e.jsx(U,{id:"address",value:l.address,onChange:f=>c(v=>({...v,address:f.target.value})),placeholder:"123 Main St, City, State 12345"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(P,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(P,{type:"submit",disabled:m.isPending,children:m.isPending?"Creating...":"Create Customer"})]})]})]})]})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Customer List"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(Zr,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(U,{placeholder:"Search customers...",value:t,onChange:f=>r(f.target.value),className:"pl-8"})]})})]}),e.jsx(q,{children:g.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground",children:t?"No customers match your search.":"No customers found."}),!t&&e.jsxs(P,{className:"mt-4",onClick:()=>a(!0),children:[e.jsx(Vr,{className:"h-4 w-4 mr-2"}),"Add Your First Customer"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{children:"Name"}),e.jsx(de,{children:"Contact Info"}),e.jsx(de,{children:"Address"}),e.jsx(de,{children:"Created"}),e.jsx(de,{children:"Actions"})]})}),e.jsx(ys,{children:g.map(f=>e.jsxs(tt,{children:[e.jsx(ie,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"bg-blue-100 text-blue-600 rounded-full w-8 h-8 flex items-center justify-center text-sm font-medium",children:f.name.charAt(0).toUpperCase()}),e.jsx("span",{children:f.name})]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-1",children:[f.email&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx(fu,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{children:f.email})]}),f.phone&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx(Hs,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{children:f.phone})]})]})}),e.jsx(ie,{children:f.address&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx(vi,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"max-w-xs truncate",children:f.address})]})}),e.jsx(ie,{children:new Date(f.createdAt||"").toLocaleDateString()}),e.jsx(ie,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>o(`/customers/${f.id}`),children:[e.jsx(pi,{className:"h-4 w-4 mr-1"}),"View"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>o(`/customers/${f.id}`),children:[e.jsx(Aa,{className:"h-4 w-4 mr-1"}),"Edit"]})]})})]},f.id))})]})})})]})]})};function Qi({orderId:s,customerId:t}){const{toast:r}=Be(),n=me({queryKey:["production-kanban"],queryFn:async()=>{var x;const h=await fetch("/api/orders");if(!h.ok)throw new Error("Failed to fetch orders for kanban board");const m=await h.json();return console.log(`Loaded ${((x=m.orders)==null?void 0:x.length)||0} orders from ${m.source||"unknown"} source`),m.orders||[]},refetchInterval:3e4,staleTime:1e4,retry:3,retryDelay:h=>Math.min(1e3*2**h,3e4)}),a=me({queryKey:["/api/orders",s],queryFn:async()=>{if(!s)return null;const h=await fetch(`/api/orders/${s}`);if(!h.ok)throw new Error("Failed to fetch order");const m=await h.json();return m.order||m},enabled:!!s}),i=me({queryKey:["/api/notifications/customer",t],queryFn:async()=>{if(!t)return[];const h=await fetch(`/api/notifications/customer/${t}`);if(!h.ok)throw new Error("Failed to fetch customer notifications");return h.json()},enabled:!!t}),o=me({queryKey:["/api/notifications/order",s],queryFn:async()=>{if(!s)return[];const h=await fetch(`/api/notifications/order/${s}`);if(!h.ok)throw new Error("Failed to fetch order notifications");return h.json()},enabled:!!s}),l=h=>me({queryKey:["/api/production/status",h],queryFn:async()=>{const m=await fetch(`/api/production/status/${h}`);if(!m.ok)throw new Error(`Failed to fetch orders with status ${h}`);return m.json()}}),c=Ce({mutationFn:async({id:h,status:m})=>(await ce("PATCH",`/api/production/status/${h}`,{status:m})).json(),onSuccess:()=>{r({title:"Order status updated",description:"The order status has been successfully updated"}),ut.invalidateQueries({queryKey:["/api/production/kanban"]}),ut.invalidateQueries({queryKey:["/api/production/status"]}),ut.invalidateQueries({queryKey:["/api/orders"]}),ut.invalidateQueries({queryKey:["/api/notifications/order"]})},onError:h=>{r({title:"Failed to update order status",description:h.message,variant:"destructive"})}}),d=Ce({mutationFn:async({id:h,estimatedDays:m})=>(await ce("POST",`/api/production/schedule/${h}`,{estimatedDays:m})).json(),onSuccess:()=>{r({title:"Order scheduled",description:"The order has been scheduled for production"}),ut.invalidateQueries({queryKey:["/api/production/kanban"]}),ut.invalidateQueries({queryKey:["/api/production/status"]}),ut.invalidateQueries({queryKey:["/api/orders"]}),ut.invalidateQueries({queryKey:["/api/notifications/order"]})},onError:h=>{r({title:"Failed to schedule order",description:h.message,variant:"destructive"})}}),u=Ce({mutationFn:async({id:h,enabled:m})=>(await ce("PATCH",`/api/orders/${h}/notifications`,{enabled:m})).json(),onSuccess:(h,m)=>{r({title:"Notification preferences updated",description:`Email notifications have been ${m.enabled?"enabled":"disabled"} for this order`}),ut.invalidateQueries({queryKey:["/api/orders"]}),s&&ut.invalidateQueries({queryKey:["/api/orders",s]}),ut.invalidateQueries({queryKey:["/api/production/kanban"]})},onError:h=>{r({title:"Failed to update notification preferences",description:h.message,variant:"destructive"})}});return{orders:n.data,isLoadingOrders:n.isLoading,ordersError:n.error,order:a.data,isLoadingOrder:a.isLoading,orderError:a.error,customerNotifications:i.data||[],orderNotifications:o.data||[],isLoadingCustomerNotifications:i.isLoading,isLoadingOrderNotifications:o.isLoading,getOrdersByStatus:l,updateOrderStatus:c.mutate,scheduleOrder:d.mutate,toggleNotificationsMutation:u,isUpdating:c.isPending,isScheduling:d.isPending}}function _N(){const s=Qi({});return{orders:s.orders||[],isLoading:s.isLoadingOrders||!1,error:s.ordersError||null,useOrdersByStatus:s.getOrdersByStatus,updateOrderStatus:s.updateOrderStatus||(t=>console.warn("updateOrderStatus not available")),scheduleOrder:s.scheduleOrder||(t=>console.warn("scheduleOrder not available")),isUpdating:s.isUpdating||!1,isScheduling:s.isScheduling||!1}}function Y4({order:s}){var a;const t=()=>{window.print()},r=()=>{const i=n(),o=new Blob([i],{type:"text/html"}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l,c.download=`work-order-${s.orderNumber||s.id}.html`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l)},n=()=>{var i;return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Work Order - ${s.orderNumber||s.id}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }
          .section { margin-bottom: 20px; }
          .label { font-weight: bold; }
          .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
          .artwork-image { max-width: 200px; max-height: 200px; border: 1px solid #ccc; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>JAY'S FRAMES - WORK ORDER</h1>
          <h2>Order #${s.orderNumber||s.id}</h2>
        </div>
        <div class="grid">
          <div>
            <div class="section">
              <div class="label">Customer:</div>
              <div>${s.customerName}</div>
            </div>
            <div class="section">
              <div class="label">Artwork Dimensions:</div>
              <div>${s.artworkWidth}" × ${s.artworkHeight}"</div>
            </div>
            <div class="section">
              <div class="label">Artwork Description:</div>
              <div>${s.artworkDescription||"N/A"}</div>
            </div>
            <div class="section">
              <div class="label">Artwork Type:</div>
              <div>${s.artworkType||"N/A"}</div>
            </div>
          </div>
          <div>
            <div class="section">
              <div class="label">Frame:</div>
              <div>${s.frameName||"N/A"}</div>
            </div>
            <div class="section">
              <div class="label">Mat:</div>
              <div>${s.matDescription||"N/A"}</div>
            </div>
            <div class="section">
              <div class="label">Glass:</div>
              <div>${s.glassType||"N/A"}</div>
            </div>
            <div class="section">
              <div class="label">Special Services:</div>
              <div>${((i=s.specialServices)==null?void 0:i.join(", "))||"None"}</div>
            </div>
          </div>
        </div>
        ${s.artworkImage?`
          <div class="section">
            <div class="label">Artwork Reference:</div>
            <img src="${s.artworkImage}" alt="Artwork" class="artwork-image" />
          </div>
        `:""}
        <div class="section">
          <div class="label">Due Date:</div>
          <div>${s.dueDate?new Date(s.dueDate).toLocaleDateString():"Not set"}</div>
        </div>
        <div class="section">
          <div class="label">Order Total:</div>
          <div style="font-size: 18px; font-weight: bold;">${An(parseFloat(s.total))}</div>
        </div>
        <div class="section">
          <div class="label">Production Notes:</div>
          <div style="height: 100px; border: 1px solid #ccc; margin-top: 5px;"></div>
        </div>
        <div class="section">
          <div class="label">Quality Check:</div>
          <div style="margin-top: 10px;">
            □ Frame cut and assembled<br/>
            □ Mat cut and beveled<br/>
            □ Glass cut and cleaned<br/>
            □ Artwork mounted<br/>
            □ Hardware attached<br/>
            □ Final inspection<br/>
            □ Ready for pickup
          </div>
        </div>
      </body>
      </html>
    `};return e.jsxs(V,{className:"max-w-4xl mx-auto",children:[e.jsxs(G,{className:"text-center border-b",children:[e.jsx(Q,{className:"text-2xl font-bold",children:"JAY'S FRAMES - WORK ORDER"}),e.jsxs("div",{className:"text-xl font-semibold",children:["Order #",s.orderNumber||s.id]}),e.jsxs("div",{className:"flex justify-center gap-2 mt-4",children:[e.jsxs(P,{onClick:t,variant:"outline",size:"sm",children:[e.jsx(Lo,{className:"w-4 h-4 mr-2"}),"Print"]}),e.jsxs(P,{onClick:r,variant:"outline",size:"sm",children:[e.jsx(xn,{className:"w-4 h-4 mr-2"}),"Download"]})]})]}),e.jsxs(q,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600",children:"Customer"}),e.jsx("div",{className:"text-lg",children:s.customerName})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600",children:"Artwork Dimensions"}),e.jsxs("div",{className:"text-lg",children:[s.artworkWidth,'" × ',s.artworkHeight,'"']})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600",children:"Artwork Description"}),e.jsx("div",{children:s.artworkDescription||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600",children:"Artwork Type"}),e.jsx("div",{children:s.artworkType||"N/A"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600",children:"Frame"}),e.jsx("div",{children:s.frameName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600",children:"Mat"}),e.jsx("div",{children:s.matDescription||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600",children:"Glass"}),e.jsx("div",{children:s.glassType||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600",children:"Special Services"}),e.jsx("div",{children:((a=s.specialServices)==null?void 0:a.join(", "))||"None"})]})]})]}),s.artworkImage&&e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600 mb-2",children:"Artwork Reference"}),e.jsx("img",{src:s.artworkImage,alt:"Artwork",className:"max-w-xs max-h-48 border border-gray-300 rounded"})]}),e.jsx(Ot,{className:"my-6"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600",children:"Due Date"}),e.jsx("div",{className:"text-lg",children:s.dueDate?new Date(s.dueDate).toLocaleDateString():"Not set"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600",children:"Order Total"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:An(parseFloat(s.total))})]})]}),e.jsx(Ot,{className:"my-6"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600 mb-2",children:"Production Notes"}),e.jsx("div",{className:"h-24 border border-gray-300 rounded p-2 bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-600 mb-3",children:"Quality Checklist"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"frame-cut"}),e.jsx("label",{htmlFor:"frame-cut",children:"Frame cut and assembled"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"mat-cut"}),e.jsx("label",{htmlFor:"mat-cut",children:"Mat cut and beveled"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"glass-cut"}),e.jsx("label",{htmlFor:"glass-cut",children:"Glass cut and cleaned"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"artwork-mounted"}),e.jsx("label",{htmlFor:"artwork-mounted",children:"Artwork mounted"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"hardware"}),e.jsx("label",{htmlFor:"hardware",children:"Hardware attached"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"inspection"}),e.jsx("label",{htmlFor:"inspection",children:"Final inspection"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"ready"}),e.jsx("label",{htmlFor:"ready",children:"Ready for pickup"})]})]})]})]})]})}const IN=p.createContext({dragDropManager:void 0});function As(s){return"Minified Redux error #"+s+"; visit https://redux.js.org/Errors?code="+s+" for the full message or use the non-minified dev environment for full errors. "}var Qh=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),jc=function(){return Math.random().toString(36).substring(7).split("").join(".")},Zh={INIT:"@@redux/INIT"+jc(),REPLACE:"@@redux/REPLACE"+jc(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+jc()}};function X4(s){if(typeof s!="object"||s===null)return!1;for(var t=s;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(s)===t}function RN(s,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(As(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(As(1));return r(RN)(s,t)}if(typeof s!="function")throw new Error(As(2));var a=s,i=t,o=[],l=o,c=!1;function d(){l===o&&(l=o.slice())}function u(){if(c)throw new Error(As(3));return i}function h(f){if(typeof f!="function")throw new Error(As(4));if(c)throw new Error(As(5));var v=!0;return d(),l.push(f),function(){if(v){if(c)throw new Error(As(6));v=!1,d();var j=l.indexOf(f);l.splice(j,1),o=null}}}function m(f){if(!X4(f))throw new Error(As(7));if(typeof f.type>"u")throw new Error(As(8));if(c)throw new Error(As(9));try{c=!0,i=a(i,f)}finally{c=!1}for(var v=o=l,y=0;y<v.length;y++){var j=v[y];j()}return f}function x(f){if(typeof f!="function")throw new Error(As(10));a=f,m({type:Zh.REPLACE})}function g(){var f,v=h;return f={subscribe:function(j){if(typeof j!="object"||j===null)throw new Error(As(11));function b(){j.next&&j.next(u())}b();var k=v(b);return{unsubscribe:k}}},f[Qh]=function(){return this},f}return m({type:Zh.INIT}),n={dispatch:m,subscribe:h,getState:u,replaceReducer:x},n[Qh]=g,n}function Le(s,t,...r){if(J4()&&t===void 0)throw new Error("invariant requires an error message argument");if(!s){let n;if(t===void 0)n=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let a=0;n=new Error(t.replace(/%s/g,function(){return r[a++]})),n.name="Invariant Violation"}throw n.framesToPop=1,n}}function J4(){return typeof process<"u"&&!0}function e_(s,t,r){return t.split(".").reduce((n,a)=>n&&n[a]?n[a]:r||null,s)}function t_(s,t){return s.filter(r=>r!==t)}function MN(s){return typeof s=="object"}function s_(s,t){const r=new Map,n=i=>{r.set(i,r.has(i)?r.get(i)+1:1)};s.forEach(n),t.forEach(n);const a=[];return r.forEach((i,o)=>{i===1&&a.push(o)}),a}function r_(s,t){return s.filter(r=>t.indexOf(r)>-1)}const Uu="dnd-core/INIT_COORDS",Fl="dnd-core/BEGIN_DRAG",Hu="dnd-core/PUBLISH_DRAG_SOURCE",Ll="dnd-core/HOVER",$l="dnd-core/DROP",Bl="dnd-core/END_DRAG";function Yh(s,t){return{type:Uu,payload:{sourceClientOffset:t||null,clientOffset:s||null}}}const n_={type:Uu,payload:{clientOffset:null,sourceClientOffset:null}};function a_(s){return function(r=[],n={publishSource:!0}){const{publishSource:a=!0,clientOffset:i,getSourceClientOffset:o}=n,l=s.getMonitor(),c=s.getRegistry();s.dispatch(Yh(i)),i_(r,l,c);const d=c_(r,l);if(d==null){s.dispatch(n_);return}let u=null;if(i){if(!o)throw new Error("getSourceClientOffset must be defined");o_(o),u=o(d)}s.dispatch(Yh(i,u));const m=c.getSource(d).beginDrag(l,d);if(m==null)return;l_(m),c.pinSource(d);const x=c.getSourceType(d);return{type:Fl,payload:{itemType:x,item:m,sourceId:d,clientOffset:i||null,sourceClientOffset:u||null,isSourcePublic:!!a}}}}function i_(s,t,r){Le(!t.isDragging(),"Cannot call beginDrag while dragging."),s.forEach(function(n){Le(r.getSource(n),"Expected sourceIds to be registered.")})}function o_(s){Le(typeof s=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function l_(s){Le(MN(s),"Item must be an object.")}function c_(s,t){let r=null;for(let n=s.length-1;n>=0;n--)if(t.canDragSource(s[n])){r=s[n];break}return r}function d_(s,t,r){return t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function u_(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable}))),n.forEach(function(a){d_(s,a,r[a])})}return s}function m_(s){return function(r={}){const n=s.getMonitor(),a=s.getRegistry();h_(n),x_(n).forEach((o,l)=>{const c=p_(o,l,a,n),d={type:$l,payload:{dropResult:u_({},r,c)}};s.dispatch(d)})}}function h_(s){Le(s.isDragging(),"Cannot call drop while not dragging."),Le(!s.didDrop(),"Cannot call drop twice during one drag operation.")}function p_(s,t,r,n){const a=r.getTarget(s);let i=a?a.drop(n,s):void 0;return f_(i),typeof i>"u"&&(i=t===0?{}:n.getDropResult()),i}function f_(s){Le(typeof s>"u"||MN(s),"Drop result must either be an object or undefined.")}function x_(s){const t=s.getTargetIds().filter(s.canDropOnTarget,s);return t.reverse(),t}function g_(s){return function(){const r=s.getMonitor(),n=s.getRegistry();v_(r);const a=r.getSourceId();return a!=null&&(n.getSource(a,!0).endDrag(r,a),n.unpinSource()),{type:Bl}}}function v_(s){Le(s.isDragging(),"Cannot call endDrag while not dragging.")}function yd(s,t){return t===null?s===null:Array.isArray(s)?s.some(r=>r===t):s===t}function y_(s){return function(r,{clientOffset:n}={}){j_(r);const a=r.slice(0),i=s.getMonitor(),o=s.getRegistry(),l=i.getItemType();return w_(a,o,l),b_(a,i,o),N_(a,i,o),{type:Ll,payload:{targetIds:a,clientOffset:n||null}}}}function j_(s){Le(Array.isArray(s),"Expected targetIds to be an array.")}function b_(s,t,r){Le(t.isDragging(),"Cannot call hover while not dragging."),Le(!t.didDrop(),"Cannot call hover after drop.");for(let n=0;n<s.length;n++){const a=s[n];Le(s.lastIndexOf(a)===n,"Expected targetIds to be unique in the passed array.");const i=r.getTarget(a);Le(i,"Expected targetIds to be registered.")}}function w_(s,t,r){for(let n=s.length-1;n>=0;n--){const a=s[n],i=t.getTargetType(a);yd(i,r)||s.splice(n,1)}}function N_(s,t,r){s.forEach(function(n){r.getTarget(n).hover(t,n)})}function S_(s){return function(){if(s.getMonitor().isDragging())return{type:Hu}}}function C_(s){return{beginDrag:a_(s),publishDragSource:S_(s),hover:y_(s),drop:m_(s),endDrag:g_(s)}}class k_{receiveBackend(t){this.backend=t}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const t=this,{dispatch:r}=this.store;function n(i){return(...o)=>{const l=i.apply(t,o);typeof l<"u"&&r(l)}}const a=C_(this);return Object.keys(a).reduce((i,o)=>{const l=a[o];return i[o]=n(l),i},{})}dispatch(t){this.store.dispatch(t)}constructor(t,r){this.isSetUp=!1,this.handleRefCountChange=()=>{const n=this.store.getState().refCount>0;this.backend&&(n&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!n&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=t,this.monitor=r,t.subscribe(this.handleRefCountChange)}}function T_(s,t){return{x:s.x+t.x,y:s.y+t.y}}function ON(s,t){return{x:s.x-t.x,y:s.y-t.y}}function P_(s){const{clientOffset:t,initialClientOffset:r,initialSourceClientOffset:n}=s;return!t||!r||!n?null:ON(T_(t,n),r)}function E_(s){const{clientOffset:t,initialClientOffset:r}=s;return!t||!r?null:ON(t,r)}const di=[],qu=[];di.__IS_NONE__=!0;qu.__IS_ALL__=!0;function D_(s,t){return s===di?!1:s===qu||typeof t>"u"?!0:r_(t,s).length>0}class A_{subscribeToStateChange(t,r={}){const{handlerIds:n}=r;Le(typeof t=="function","listener must be a function."),Le(typeof n>"u"||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");let a=this.store.getState().stateId;const i=()=>{const o=this.store.getState(),l=o.stateId;try{l===a||l===a+1&&!D_(o.dirtyHandlerIds,n)||t()}finally{a=l}};return this.store.subscribe(i)}subscribeToOffsetChange(t){Le(typeof t=="function","listener must be a function.");let r=this.store.getState().dragOffset;const n=()=>{const a=this.store.getState().dragOffset;a!==r&&(r=a,t())};return this.store.subscribe(n)}canDragSource(t){if(!t)return!1;const r=this.registry.getSource(t);return Le(r,`Expected to find a valid source. sourceId=${t}`),this.isDragging()?!1:r.canDrag(this,t)}canDropOnTarget(t){if(!t)return!1;const r=this.registry.getTarget(t);if(Le(r,`Expected to find a valid target. targetId=${t}`),!this.isDragging()||this.didDrop())return!1;const n=this.registry.getTargetType(t),a=this.getItemType();return yd(n,a)&&r.canDrop(this,t)}isDragging(){return!!this.getItemType()}isDraggingSource(t){if(!t)return!1;const r=this.registry.getSource(t,!0);if(Le(r,`Expected to find a valid source. sourceId=${t}`),!this.isDragging()||!this.isSourcePublic())return!1;const n=this.registry.getSourceType(t),a=this.getItemType();return n!==a?!1:r.isDragging(this,t)}isOverTarget(t,r={shallow:!1}){if(!t)return!1;const{shallow:n}=r;if(!this.isDragging())return!1;const a=this.registry.getTargetType(t),i=this.getItemType();if(i&&!yd(a,i))return!1;const o=this.getTargetIds();if(!o.length)return!1;const l=o.indexOf(t);return n?l===o.length-1:l>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return P_(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return E_(this.store.getState().dragOffset)}constructor(t,r){this.store=t,this.registry=r}}const Xh=typeof global<"u"?global:self,FN=Xh.MutationObserver||Xh.WebKitMutationObserver;function LN(s){return function(){const r=setTimeout(a,0),n=setInterval(a,50);function a(){clearTimeout(r),clearInterval(n),s()}}}function __(s){let t=1;const r=new FN(s),n=document.createTextNode("");return r.observe(n,{characterData:!0}),function(){t=-t,n.data=t}}const I_=typeof FN=="function"?__:LN;class R_{enqueueTask(t){const{queue:r,requestFlush:n}=this;r.length||(n(),this.flushing=!0),r[r.length]=t}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:t}=this;for(;this.index<t.length;){const r=this.index;if(this.index++,t[r].call(),this.index>this.capacity){for(let n=0,a=t.length-this.index;n<a;n++)t[n]=t[n+this.index];t.length-=this.index,this.index=0}}t.length=0,this.index=0,this.flushing=!1},this.registerPendingError=t=>{this.pendingErrors.push(t),this.requestErrorThrow()},this.requestFlush=I_(this.flush),this.requestErrorThrow=LN(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class M_{call(){try{this.task&&this.task()}catch(t){this.onError(t)}finally{this.task=null,this.release(this)}}constructor(t,r){this.onError=t,this.release=r,this.task=null}}class O_{create(t){const r=this.freeTasks,n=r.length?r.pop():new M_(this.onError,a=>r[r.length]=a);return n.task=t,n}constructor(t){this.onError=t,this.freeTasks=[]}}const $N=new R_,F_=new O_($N.registerPendingError);function L_(s){$N.enqueueTask(F_.create(s))}const zu="dnd-core/ADD_SOURCE",Wu="dnd-core/ADD_TARGET",Ku="dnd-core/REMOVE_SOURCE",Vl="dnd-core/REMOVE_TARGET";function $_(s){return{type:zu,payload:{sourceId:s}}}function B_(s){return{type:Wu,payload:{targetId:s}}}function V_(s){return{type:Ku,payload:{sourceId:s}}}function U_(s){return{type:Vl,payload:{targetId:s}}}function H_(s){Le(typeof s.canDrag=="function","Expected canDrag to be a function."),Le(typeof s.beginDrag=="function","Expected beginDrag to be a function."),Le(typeof s.endDrag=="function","Expected endDrag to be a function.")}function q_(s){Le(typeof s.canDrop=="function","Expected canDrop to be a function."),Le(typeof s.hover=="function","Expected hover to be a function."),Le(typeof s.drop=="function","Expected beginDrag to be a function.")}function jd(s,t){if(t&&Array.isArray(s)){s.forEach(r=>jd(r,!1));return}Le(typeof s=="string"||typeof s=="symbol",t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var Os;(function(s){s.SOURCE="SOURCE",s.TARGET="TARGET"})(Os||(Os={}));let z_=0;function W_(){return z_++}function K_(s){const t=W_().toString();switch(s){case Os.SOURCE:return`S${t}`;case Os.TARGET:return`T${t}`;default:throw new Error(`Unknown Handler Role: ${s}`)}}function Jh(s){switch(s[0]){case"S":return Os.SOURCE;case"T":return Os.TARGET;default:throw new Error(`Cannot parse handler ID: ${s}`)}}function ep(s,t){const r=s.entries();let n=!1;do{const{done:a,value:[,i]}=r.next();if(i===t)return!0;n=!!a}while(!n);return!1}class G_{addSource(t,r){jd(t),H_(r);const n=this.addHandler(Os.SOURCE,t,r);return this.store.dispatch($_(n)),n}addTarget(t,r){jd(t,!0),q_(r);const n=this.addHandler(Os.TARGET,t,r);return this.store.dispatch(B_(n)),n}containsHandler(t){return ep(this.dragSources,t)||ep(this.dropTargets,t)}getSource(t,r=!1){return Le(this.isSourceId(t),"Expected a valid source ID."),r&&t===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(t)}getTarget(t){return Le(this.isTargetId(t),"Expected a valid target ID."),this.dropTargets.get(t)}getSourceType(t){return Le(this.isSourceId(t),"Expected a valid source ID."),this.types.get(t)}getTargetType(t){return Le(this.isTargetId(t),"Expected a valid target ID."),this.types.get(t)}isSourceId(t){return Jh(t)===Os.SOURCE}isTargetId(t){return Jh(t)===Os.TARGET}removeSource(t){Le(this.getSource(t),"Expected an existing source."),this.store.dispatch(V_(t)),L_(()=>{this.dragSources.delete(t),this.types.delete(t)})}removeTarget(t){Le(this.getTarget(t),"Expected an existing target."),this.store.dispatch(U_(t)),this.dropTargets.delete(t),this.types.delete(t)}pinSource(t){const r=this.getSource(t);Le(r,"Expected an existing source."),this.pinnedSourceId=t,this.pinnedSource=r}unpinSource(){Le(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(t,r,n){const a=K_(t);return this.types.set(a,r),t===Os.SOURCE?this.dragSources.set(a,n):t===Os.TARGET&&this.dropTargets.set(a,n),a}constructor(t){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=t}}const Q_=(s,t)=>s===t;function Z_(s,t){return!s&&!t?!0:!s||!t?!1:s.x===t.x&&s.y===t.y}function Y_(s,t,r=Q_){if(s.length!==t.length)return!1;for(let n=0;n<s.length;++n)if(!r(s[n],t[n]))return!1;return!0}function X_(s=di,t){switch(t.type){case Ll:break;case zu:case Wu:case Vl:case Ku:return di;case Fl:case Hu:case Bl:case $l:default:return qu}const{targetIds:r=[],prevTargetIds:n=[]}=t.payload,a=s_(r,n);if(!(a.length>0||!Y_(r,n)))return di;const o=n[n.length-1],l=r[r.length-1];return o!==l&&(o&&a.push(o),l&&a.push(l)),a}function J_(s,t,r){return t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function eI(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable}))),n.forEach(function(a){J_(s,a,r[a])})}return s}const tp={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function tI(s=tp,t){const{payload:r}=t;switch(t.type){case Uu:case Fl:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case Ll:return Z_(s.clientOffset,r.clientOffset)?s:eI({},s,{clientOffset:r.clientOffset});case Bl:case $l:return tp;default:return s}}function sI(s,t,r){return t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Wn(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable}))),n.forEach(function(a){sI(s,a,r[a])})}return s}const rI={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function nI(s=rI,t){const{payload:r}=t;switch(t.type){case Fl:return Wn({},s,{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case Hu:return Wn({},s,{isSourcePublic:!0});case Ll:return Wn({},s,{targetIds:r.targetIds});case Vl:return s.targetIds.indexOf(r.targetId)===-1?s:Wn({},s,{targetIds:t_(s.targetIds,r.targetId)});case $l:return Wn({},s,{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case Bl:return Wn({},s,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return s}}function aI(s=0,t){switch(t.type){case zu:case Wu:return s+1;case Ku:case Vl:return s-1;default:return s}}function iI(s=0){return s+1}function oI(s,t,r){return t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function lI(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable}))),n.forEach(function(a){oI(s,a,r[a])})}return s}function cI(s={},t){return{dirtyHandlerIds:X_(s.dirtyHandlerIds,{type:t.type,payload:lI({},t.payload,{prevTargetIds:e_(s,"dragOperation.targetIds",[])})}),dragOffset:tI(s.dragOffset,t),refCount:aI(s.refCount,t),dragOperation:nI(s.dragOperation,t),stateId:iI(s.stateId)}}function dI(s,t=void 0,r={},n=!1){const a=uI(n),i=new A_(a,new G_(a)),o=new k_(a,i),l=s(o,t,r);return o.receiveBackend(l),o}function uI(s){const t=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return RN(cI,s&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}function mI(s,t){if(s==null)return{};var r=hI(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function hI(s,t){if(s==null)return{};var r={},n=Object.keys(s),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=s[a]);return r}let sp=0;const Do=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var pI=p.memo(function(t){var{children:r}=t,n=mI(t,["children"]);const[a,i]=fI(n);return p.useEffect(()=>{if(i){const o=BN();return++sp,()=>{--sp===0&&(o[Do]=null)}}},[]),e.jsx(IN.Provider,{value:a,children:r})});function fI(s){if("manager"in s)return[{dragDropManager:s.manager},!1];const t=xI(s.backend,s.context,s.options,s.debugMode),r=!s.context;return[t,r]}function xI(s,t=BN(),r,n){const a=t;return a[Do]||(a[Do]={dragDropManager:dI(s,t,r,n)}),a[Do]}function BN(){return typeof global<"u"?global:window}var gI=function s(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,a,i;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!s(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(i=Object.keys(t),n=i.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[a]))return!1;for(a=n;a--!==0;){var o=i[a];if(!s(t[o],r[o]))return!1}return!0}return t!==t&&r!==r};const vI=j2(gI),Rn=typeof window<"u"?p.useLayoutEffect:p.useEffect;function yI(s,t,r){const[n,a]=p.useState(()=>t(s)),i=p.useCallback(()=>{const o=t(s);vI(n,o)||(a(o),r&&r())},[n,s,r]);return Rn(i),[n,i]}function jI(s,t,r){const[n,a]=yI(s,t,r);return Rn(function(){const o=s.getHandlerId();if(o!=null)return s.subscribeToStateChange(a,{handlerIds:[o]})},[s,a]),n}function VN(s,t,r){return jI(t,s||(()=>({})),()=>r.reconnect())}function UN(s,t){const r=[];return typeof s!="function"&&r.push(s),p.useMemo(()=>typeof s=="function"?s():s,r)}function bI(s){return p.useMemo(()=>s.hooks.dragSource(),[s])}function wI(s){return p.useMemo(()=>s.hooks.dragPreview(),[s])}let bc=!1,wc=!1;class NI{receiveHandlerId(t){this.sourceId=t}getHandlerId(){return this.sourceId}canDrag(){Le(!bc,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return bc=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{bc=!1}}isDragging(){if(!this.sourceId)return!1;Le(!wc,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return wc=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{wc=!1}}subscribeToStateChange(t,r){return this.internalMonitor.subscribeToStateChange(t,r)}isDraggingSource(t){return this.internalMonitor.isDraggingSource(t)}isOverTarget(t,r){return this.internalMonitor.isOverTarget(t,r)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(t){return this.internalMonitor.subscribeToOffsetChange(t)}canDragSource(t){return this.internalMonitor.canDragSource(t)}canDropOnTarget(t){return this.internalMonitor.canDropOnTarget(t)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(t){this.sourceId=null,this.internalMonitor=t.getMonitor()}}let Nc=!1;class SI{receiveHandlerId(t){this.targetId=t}getHandlerId(){return this.targetId}subscribeToStateChange(t,r){return this.internalMonitor.subscribeToStateChange(t,r)}canDrop(){if(!this.targetId)return!1;Le(!Nc,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return Nc=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{Nc=!1}}isOver(t){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,t):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(t){this.targetId=null,this.internalMonitor=t.getMonitor()}}function CI(s,t,r){const n=r.getRegistry(),a=n.addTarget(s,t);return[a,()=>n.removeTarget(a)]}function kI(s,t,r){const n=r.getRegistry(),a=n.addSource(s,t);return[a,()=>n.removeSource(a)]}function bd(s,t,r,n){let a;if(a!==void 0)return!!a;if(s===t)return!0;if(typeof s!="object"||!s||typeof t!="object"||!t)return!1;const i=Object.keys(s),o=Object.keys(t);if(i.length!==o.length)return!1;const l=Object.prototype.hasOwnProperty.bind(t);for(let c=0;c<i.length;c++){const d=i[c];if(!l(d))return!1;const u=s[d],h=t[d];if(a=void 0,a===!1||a===void 0&&u!==h)return!1}return!0}function wd(s){return s!==null&&typeof s=="object"&&Object.prototype.hasOwnProperty.call(s,"current")}function TI(s){if(typeof s.type=="string")return;const t=s.type.displayName||s.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${t} into a <div>, or turn it into a drag source or a drop target itself.`)}function PI(s){return(t=null,r=null)=>{if(!p.isValidElement(t)){const i=t;return s(i,r),i}const n=t;return TI(n),EI(n,r?i=>s(i,r):s)}}function HN(s){const t={};return Object.keys(s).forEach(r=>{const n=s[r];if(r.endsWith("Ref"))t[r]=s[r];else{const a=PI(n);t[r]=()=>a}}),t}function rp(s,t){typeof s=="function"?s(t):s.current=t}function EI(s,t){const r=s.ref;return Le(typeof r!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r?p.cloneElement(s,{ref:n=>{rp(r,n),rp(t,n)}}):p.cloneElement(s,{ref:t})}class DI{receiveHandlerId(t){this.handlerId!==t&&(this.handlerId=t,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(t){this.dragSourceOptionsInternal=t}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(t){this.dragPreviewOptionsInternal=t}reconnect(){const t=this.reconnectDragSource();this.reconnectDragPreview(t)}reconnectDragSource(){const t=this.dragSource,r=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return r&&this.disconnectDragSource(),this.handlerId?t?(r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=t,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,t,this.dragSourceOptions)),r):(this.lastConnectedDragSource=t,r):r}reconnectDragPreview(t=!1){const r=this.dragPreview,n=t||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(n&&this.disconnectDragPreview(),!!this.handlerId){if(!r){this.lastConnectedDragPreview=r;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=r,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,r,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!bd(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!bd(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(t){this.hooks=HN({dragSource:(r,n)=>{this.clearDragSource(),this.dragSourceOptions=n||null,wd(r)?this.dragSourceRef=r:this.dragSourceNode=r,this.reconnectDragSource()},dragPreview:(r,n)=>{this.clearDragPreview(),this.dragPreviewOptions=n||null,wd(r)?this.dragPreviewRef=r:this.dragPreviewNode=r,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=t}}class AI{get connectTarget(){return this.dropTarget}reconnect(){const t=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();t&&this.disconnectDropTarget();const r=this.dropTarget;if(this.handlerId){if(!r){this.lastConnectedDropTarget=r;return}t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=r,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,r,this.dropTargetOptions))}}receiveHandlerId(t){t!==this.handlerId&&(this.handlerId=t,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(t){this.dropTargetOptionsInternal=t}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!bd(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(t){this.hooks=HN({dropTarget:(r,n)=>{this.clearDropTarget(),this.dropTargetOptions=n,wd(r)?this.dropTargetRef=r:this.dropTargetNode=r,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=t}}function Oa(){const{dragDropManager:s}=p.useContext(IN);return Le(s!=null,"Expected drag drop context"),s}function _I(s,t){const r=Oa(),n=p.useMemo(()=>new DI(r.getBackend()),[r]);return Rn(()=>(n.dragSourceOptions=s||null,n.reconnect(),()=>n.disconnectDragSource()),[n,s]),Rn(()=>(n.dragPreviewOptions=t||null,n.reconnect(),()=>n.disconnectDragPreview()),[n,t]),n}function II(){const s=Oa();return p.useMemo(()=>new NI(s),[s])}class RI{beginDrag(){const t=this.spec,r=this.monitor;let n=null;return typeof t.item=="object"?n=t.item:typeof t.item=="function"?n=t.item(r):n={},n??null}canDrag(){const t=this.spec,r=this.monitor;return typeof t.canDrag=="boolean"?t.canDrag:typeof t.canDrag=="function"?t.canDrag(r):!0}isDragging(t,r){const n=this.spec,a=this.monitor,{isDragging:i}=n;return i?i(a):r===t.getSourceId()}endDrag(){const t=this.spec,r=this.monitor,n=this.connector,{end:a}=t;a&&a(r.getItem(),r),n.reconnect()}constructor(t,r,n){this.spec=t,this.monitor=r,this.connector=n}}function MI(s,t,r){const n=p.useMemo(()=>new RI(s,t,r),[t,r]);return p.useEffect(()=>{n.spec=s},[s]),n}function OI(s){return p.useMemo(()=>{const t=s.type;return Le(t!=null,"spec.type must be defined"),t},[s])}function FI(s,t,r){const n=Oa(),a=MI(s,t,r),i=OI(s);Rn(function(){if(i!=null){const[l,c]=kI(i,a,n);return t.receiveHandlerId(l),r.receiveHandlerId(l),c}},[n,t,r,a,i])}function LI(s,t){const r=UN(s);Le(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const n=II(),a=_I(r.options,r.previewOptions);return FI(r,n,a),[VN(r.collect,n,a),bI(a),wI(a)]}function $I(s){return p.useMemo(()=>s.hooks.dropTarget(),[s])}function BI(s){const t=Oa(),r=p.useMemo(()=>new AI(t.getBackend()),[t]);return Rn(()=>(r.dropTargetOptions=s||null,r.reconnect(),()=>r.disconnectDropTarget()),[s]),r}function VI(){const s=Oa();return p.useMemo(()=>new SI(s),[s])}function UI(s){const{accept:t}=s;return p.useMemo(()=>(Le(s.accept!=null,"accept must be defined"),Array.isArray(t)?t:[t]),[t])}class HI{canDrop(){const t=this.spec,r=this.monitor;return t.canDrop?t.canDrop(r.getItem(),r):!0}hover(){const t=this.spec,r=this.monitor;t.hover&&t.hover(r.getItem(),r)}drop(){const t=this.spec,r=this.monitor;if(t.drop)return t.drop(r.getItem(),r)}constructor(t,r){this.spec=t,this.monitor=r}}function qI(s,t){const r=p.useMemo(()=>new HI(s,t),[t]);return p.useEffect(()=>{r.spec=s},[s]),r}function zI(s,t,r){const n=Oa(),a=qI(s,t),i=UI(s);Rn(function(){const[l,c]=CI(i,a,n);return t.receiveHandlerId(l),r.receiveHandlerId(l),c},[n,t,a,r,i.map(o=>o.toString()).join("|")])}function WI(s,t){const r=UN(s),n=VI(),a=BI(r.options);return zI(r,n,a),[VN(r.collect,n,a),$I(a)]}function qN(s){let t=null;return()=>(t==null&&(t=s()),t)}function KI(s,t){return s.filter(r=>r!==t)}function GI(s,t){const r=new Set,n=i=>r.add(i);s.forEach(n),t.forEach(n);const a=[];return r.forEach(i=>a.push(i)),a}class QI{enter(t){const r=this.entered.length,n=a=>this.isNodeInDocument(a)&&(!a.contains||a.contains(t));return this.entered=GI(this.entered.filter(n),[t]),r===0&&this.entered.length>0}leave(t){const r=this.entered.length;return this.entered=KI(this.entered.filter(this.isNodeInDocument),t),r>0&&this.entered.length===0}reset(){this.entered=[]}constructor(t){this.entered=[],this.isNodeInDocument=t}}class ZI{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(t=>{Object.defineProperty(this.item,t,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${t}" until the drop event.`),null}})})}loadDataTransfer(t){if(t){const r={};Object.keys(this.config.exposeProperties).forEach(n=>{const a=this.config.exposeProperties[n];a!=null&&(r[n]={value:a(t,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,r)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(t,r){return r===t.getSourceId()}endDrag(){}constructor(t){this.config=t,this.item={},this.initializeExposedProperties()}}const zN="__NATIVE_FILE__",WN="__NATIVE_URL__",KN="__NATIVE_TEXT__",GN="__NATIVE_HTML__",np=Object.freeze(Object.defineProperty({__proto__:null,FILE:zN,HTML:GN,TEXT:KN,URL:WN},Symbol.toStringTag,{value:"Module"}));function Sc(s,t,r){const n=t.reduce((a,i)=>a||s.getData(i),"");return n??r}const Nd={[zN]:{exposeProperties:{files:s=>Array.prototype.slice.call(s.files),items:s=>s.items,dataTransfer:s=>s},matchesTypes:["Files"]},[GN]:{exposeProperties:{html:(s,t)=>Sc(s,t,""),dataTransfer:s=>s},matchesTypes:["Html","text/html"]},[WN]:{exposeProperties:{urls:(s,t)=>Sc(s,t,"").split(`
`),dataTransfer:s=>s},matchesTypes:["Url","text/uri-list"]},[KN]:{exposeProperties:{text:(s,t)=>Sc(s,t,""),dataTransfer:s=>s},matchesTypes:["Text","text/plain"]}};function YI(s,t){const r=Nd[s];if(!r)throw new Error(`native type ${s} has no configuration`);const n=new ZI(r);return n.loadDataTransfer(t),n}function Cc(s){if(!s)return null;const t=Array.prototype.slice.call(s.types||[]);return Object.keys(Nd).filter(r=>{const n=Nd[r];return n!=null&&n.matchesTypes?n.matchesTypes.some(a=>t.indexOf(a)>-1):!1})[0]||null}const XI=qN(()=>/firefox/i.test(navigator.userAgent)),QN=qN(()=>!!window.safari);class ap{interpolate(t){const{xs:r,ys:n,c1s:a,c2s:i,c3s:o}=this;let l=r.length-1;if(t===r[l])return n[l];let c=0,d=o.length-1,u;for(;c<=d;){u=Math.floor(.5*(c+d));const x=r[u];if(x<t)c=u+1;else if(x>t)d=u-1;else return n[u]}l=Math.max(0,d);const h=t-r[l],m=h*h;return n[l]+a[l]*h+i[l]*m+o[l]*h*m}constructor(t,r){const{length:n}=t,a=[];for(let x=0;x<n;x++)a.push(x);a.sort((x,g)=>t[x]<t[g]?-1:1);const i=[],o=[];let l,c;for(let x=0;x<n-1;x++)l=t[x+1]-t[x],c=r[x+1]-r[x],i.push(l),o.push(c/l);const d=[o[0]];for(let x=0;x<i.length-1;x++){const g=o[x],f=o[x+1];if(g*f<=0)d.push(0);else{l=i[x];const v=i[x+1],y=l+v;d.push(3*y/((y+v)/g+(y+l)/f))}}d.push(o[o.length-1]);const u=[],h=[];let m;for(let x=0;x<d.length-1;x++){m=o[x];const g=d[x],f=1/i[x],v=g+d[x+1]-m-m;u.push((m-g-v)*f),h.push(v*f*f)}this.xs=t,this.ys=r,this.c1s=d,this.c2s=u,this.c3s=h}}const JI=1;function ZN(s){const t=s.nodeType===JI?s:s.parentElement;if(!t)return null;const{top:r,left:n}=t.getBoundingClientRect();return{x:n,y:r}}function xo(s){return{x:s.clientX,y:s.clientY}}function eR(s){var t;return s.nodeName==="IMG"&&(XI()||!(!((t=document.documentElement)===null||t===void 0)&&t.contains(s)))}function tR(s,t,r,n){let a=s?t.width:r,i=s?t.height:n;return QN()&&s&&(i/=window.devicePixelRatio,a/=window.devicePixelRatio),{dragPreviewWidth:a,dragPreviewHeight:i}}function sR(s,t,r,n,a){const i=eR(t),l=ZN(i?s:t),c={x:r.x-l.x,y:r.y-l.y},{offsetWidth:d,offsetHeight:u}=s,{anchorX:h,anchorY:m}=n,{dragPreviewWidth:x,dragPreviewHeight:g}=tR(i,t,d,u),f=()=>{let A=new ap([0,.5,1],[c.y,c.y/u*g,c.y+g-u]).interpolate(m);return QN()&&i&&(A+=(window.devicePixelRatio-1)*g),A},v=()=>new ap([0,.5,1],[c.x,c.x/d*x,c.x+x-d]).interpolate(h),{offsetX:y,offsetY:j}=a,b=y===0||y,k=j===0||j;return{x:b?y:v(),y:k?j:f()}}class rR{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var t;return!((t=this.globalContext)===null||t===void 0)&&t.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var t;return((t=this.optionsArgs)===null||t===void 0?void 0:t.rootElement)||this.window}constructor(t,r){this.ownerDocument=null,this.globalContext=t,this.optionsArgs=r}}function nR(s,t,r){return t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function ip(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable}))),n.forEach(function(a){nR(s,a,r[a])})}return s}class aR{profile(){var t,r;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((t=this.dragStartSourceIds)===null||t===void 0?void 0:t.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((r=this.dragOverTargetIds)===null||r===void 0?void 0:r.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const t=this.rootElement;if(t!==void 0){if(t.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");t.__isReactDndBackendSetUp=!0,this.addEventListeners(t)}}teardown(){const t=this.rootElement;if(t!==void 0&&(t.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var r;(r=this.window)===null||r===void 0||r.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(t,r,n){return this.sourcePreviewNodeOptions.set(t,n),this.sourcePreviewNodes.set(t,r),()=>{this.sourcePreviewNodes.delete(t),this.sourcePreviewNodeOptions.delete(t)}}connectDragSource(t,r,n){this.sourceNodes.set(t,r),this.sourceNodeOptions.set(t,n);const a=o=>this.handleDragStart(o,t),i=o=>this.handleSelectStart(o);return r.setAttribute("draggable","true"),r.addEventListener("dragstart",a),r.addEventListener("selectstart",i),()=>{this.sourceNodes.delete(t),this.sourceNodeOptions.delete(t),r.removeEventListener("dragstart",a),r.removeEventListener("selectstart",i),r.setAttribute("draggable","false")}}connectDropTarget(t,r){const n=o=>this.handleDragEnter(o,t),a=o=>this.handleDragOver(o,t),i=o=>this.handleDrop(o,t);return r.addEventListener("dragenter",n),r.addEventListener("dragover",a),r.addEventListener("drop",i),()=>{r.removeEventListener("dragenter",n),r.removeEventListener("dragover",a),r.removeEventListener("drop",i)}}addEventListeners(t){t.addEventListener&&(t.addEventListener("dragstart",this.handleTopDragStart),t.addEventListener("dragstart",this.handleTopDragStartCapture,!0),t.addEventListener("dragend",this.handleTopDragEndCapture,!0),t.addEventListener("dragenter",this.handleTopDragEnter),t.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),t.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),t.addEventListener("dragover",this.handleTopDragOver),t.addEventListener("dragover",this.handleTopDragOverCapture,!0),t.addEventListener("drop",this.handleTopDrop),t.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(t){t.removeEventListener&&(t.removeEventListener("dragstart",this.handleTopDragStart),t.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),t.removeEventListener("dragend",this.handleTopDragEndCapture,!0),t.removeEventListener("dragenter",this.handleTopDragEnter),t.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),t.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),t.removeEventListener("dragover",this.handleTopDragOver),t.removeEventListener("dragover",this.handleTopDragOverCapture,!0),t.removeEventListener("drop",this.handleTopDrop),t.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const t=this.monitor.getSourceId(),r=this.sourceNodeOptions.get(t);return ip({dropEffect:this.altKeyPressed?"copy":"move"},r||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const t=this.monitor.getSourceId(),r=this.sourcePreviewNodeOptions.get(t);return ip({anchorX:.5,anchorY:.5,captureDraggingState:!1},r||{})}isDraggingNativeItem(){const t=this.monitor.getItemType();return Object.keys(np).some(r=>np[r]===t)}beginDragNativeItem(t,r){this.clearCurrentDragSourceNode(),this.currentNativeSource=YI(t,r),this.currentNativeHandle=this.registry.addSource(t,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(t){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=t;const r=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var n;return(n=this.rootElement)===null||n===void 0?void 0:n.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},r)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var t;(t=this.window)===null||t===void 0||t.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(t,r){t.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(r))}handleDragEnter(t,r){this.dragEnterTargetIds.unshift(r)}handleDragOver(t,r){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(r)}handleDrop(t,r){this.dropTargetIds.unshift(r)}constructor(t,r,n){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=a=>{const i=this.sourceNodes.get(a);return i&&ZN(i)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=a=>!!(a&&this.document&&this.document.body&&this.document.body.contains(a)),this.endDragIfSourceWasRemovedFromDOM=()=>{const a=this.currentDragSourceNode;a==null||this.isNodeInDocument(a)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=a=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(a||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=a=>{if(a.defaultPrevented)return;const{dragStartSourceIds:i}=this;this.dragStartSourceIds=null;const o=xo(a);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(i||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:o});const{dataTransfer:l}=a,c=Cc(l);if(this.monitor.isDragging()){if(l&&typeof l.setDragImage=="function"){const u=this.monitor.getSourceId(),h=this.sourceNodes.get(u),m=this.sourcePreviewNodes.get(u)||h;if(m){const{anchorX:x,anchorY:g,offsetX:f,offsetY:v}=this.getCurrentSourcePreviewNodeOptions(),b=sR(h,m,o,{anchorX:x,anchorY:g},{offsetX:f,offsetY:v});l.setDragImage(m,b.x,b.y)}}try{l==null||l.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(a.target);const{captureDraggingState:d}=this.getCurrentSourcePreviewNodeOptions();d?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(c)this.beginDragNativeItem(c);else{if(l&&!l.types&&(a.target&&!a.target.hasAttribute||!a.target.hasAttribute("draggable")))return;a.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=a=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var i;(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(a.dataTransfer)}if(!this.enterLeaveCounter.enter(a.target)||this.monitor.isDragging())return;const{dataTransfer:l}=a,c=Cc(l);c&&this.beginDragNativeItem(c,l)},this.handleTopDragEnter=a=>{const{dragEnterTargetIds:i}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=a.altKey,i.length>0&&this.actions.hover(i,{clientOffset:xo(a)}),i.some(l=>this.monitor.canDropOnTarget(l))&&(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=a=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var i;(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(a.dataTransfer)}},this.handleTopDragOver=a=>{const{dragOverTargetIds:i}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}this.altKeyPressed=a.altKey,this.lastClientOffset=xo(a),this.scheduleHover(i),(i||[]).some(l=>this.monitor.canDropOnTarget(l))?(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?a.preventDefault():(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=a=>{this.isDraggingNativeItem()&&a.preventDefault(),this.enterLeaveCounter.leave(a.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=a=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var i;a.preventDefault(),(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(a.dataTransfer)}else Cc(a.dataTransfer)&&a.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=a=>{const{dropTargetIds:i}=this;this.dropTargetIds=[],this.actions.hover(i,{clientOffset:xo(a)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=a=>{const i=a.target;typeof i.dragDrop=="function"&&(i.tagName==="INPUT"||i.tagName==="SELECT"||i.tagName==="TEXTAREA"||i.isContentEditable||(a.preventDefault(),i.dragDrop()))},this.options=new rR(r,n),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new QI(this.isNodeInDocument)}}const iR=function(t,r,n){return new aR(t,r,n)};function oR(){const{toast:s}=Be(),t=me({queryKey:["/api/orders"],queryFn:async()=>{const i=await fetch("/api/orders");if(!i.ok)throw new Error("Failed to fetch orders");const o=await i.json();return console.log("Orders API response:",o),o.orders||o||[]}}),r=i=>me({queryKey:["/api/orders",i],queryFn:async()=>{const o=await fetch(`/api/orders/${i}`);if(!o.ok)throw new Error("Failed to fetch order");return o.json()},enabled:!!i}),n=Ce({mutationFn:async i=>await ce("POST","/api/orders",i),onSuccess:i=>{var o;s({title:"Order created successfully! 🎉",description:`Order #${((o=i.order)==null?void 0:o.id)||i.orderId} has been created`}),ut.invalidateQueries({queryKey:["/api/orders"]}),ut.invalidateQueries({queryKey:["/api/production/kanban"]}),ut.invalidateQueries({queryKey:["/api/order-groups"]}),ut.refetchQueries({queryKey:["/api/orders"]})},onError:i=>{s({title:"Failed to create order",description:i.message,variant:"destructive"})}}),a=Ce({mutationFn:async({id:i,data:o,recalculatePricing:l=!0})=>await ce("PATCH",`/api/orders/${i}`,{...o,recalculatePricing:l}),onSuccess:()=>{s({title:"Order updated",description:"The order has been successfully updated"}),ut.invalidateQueries({queryKey:["/api/orders"]}),ut.invalidateQueries({queryKey:["/api/production/kanban"]}),ut.invalidateQueries({queryKey:["/api/materials/pick-list"]}),ut.invalidateQueries({queryKey:["/api/order-groups"]})},onError:i=>{s({title:"Failed to update order",description:i.message,variant:"destructive"})}});return{orders:t.data,isLoading:t.isLoading,error:t.error,getOrder:r,createOrder:n.mutate,createOrderAsync:n.mutateAsync,isCreatingOrder:n.isPending,updateOrder:a.mutate,isUpdatingOrder:a.isPending}}function YN(s,t){return function(){return s.apply(t,arguments)}}const{toString:lR}=Object.prototype,{getPrototypeOf:Gu}=Object,Ul=(s=>t=>{const r=lR.call(t);return s[r]||(s[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Js=s=>(s=s.toLowerCase(),t=>Ul(t)===s),Hl=s=>t=>typeof t===s,{isArray:Fa}=Array,bi=Hl("undefined");function cR(s){return s!==null&&!bi(s)&&s.constructor!==null&&!bi(s.constructor)&&ws(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const XN=Js("ArrayBuffer");function dR(s){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(s):t=s&&s.buffer&&XN(s.buffer),t}const uR=Hl("string"),ws=Hl("function"),JN=Hl("number"),ql=s=>s!==null&&typeof s=="object",mR=s=>s===!0||s===!1,Ao=s=>{if(Ul(s)!=="object")return!1;const t=Gu(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},hR=Js("Date"),pR=Js("File"),fR=Js("Blob"),xR=Js("FileList"),gR=s=>ql(s)&&ws(s.pipe),vR=s=>{let t;return s&&(typeof FormData=="function"&&s instanceof FormData||ws(s.append)&&((t=Ul(s))==="formdata"||t==="object"&&ws(s.toString)&&s.toString()==="[object FormData]"))},yR=Js("URLSearchParams"),[jR,bR,wR,NR]=["ReadableStream","Request","Response","Headers"].map(Js),SR=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Zi(s,t,{allOwnKeys:r=!1}={}){if(s===null||typeof s>"u")return;let n,a;if(typeof s!="object"&&(s=[s]),Fa(s))for(n=0,a=s.length;n<a;n++)t.call(null,s[n],n,s);else{const i=r?Object.getOwnPropertyNames(s):Object.keys(s),o=i.length;let l;for(n=0;n<o;n++)l=i[n],t.call(null,s[l],l,s)}}function e0(s,t){t=t.toLowerCase();const r=Object.keys(s);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const vn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,t0=s=>!bi(s)&&s!==vn;function Sd(){const{caseless:s}=t0(this)&&this||{},t={},r=(n,a)=>{const i=s&&e0(t,a)||a;Ao(t[i])&&Ao(n)?t[i]=Sd(t[i],n):Ao(n)?t[i]=Sd({},n):Fa(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&Zi(arguments[n],r);return t}const CR=(s,t,r,{allOwnKeys:n}={})=>(Zi(t,(a,i)=>{r&&ws(a)?s[i]=YN(a,r):s[i]=a},{allOwnKeys:n}),s),kR=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),TR=(s,t,r,n)=>{s.prototype=Object.create(t.prototype,n),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:t.prototype}),r&&Object.assign(s.prototype,r)},PR=(s,t,r,n)=>{let a,i,o;const l={};if(t=t||{},s==null)return t;do{for(a=Object.getOwnPropertyNames(s),i=a.length;i-- >0;)o=a[i],(!n||n(o,s,t))&&!l[o]&&(t[o]=s[o],l[o]=!0);s=r!==!1&&Gu(s)}while(s&&(!r||r(s,t))&&s!==Object.prototype);return t},ER=(s,t,r)=>{s=String(s),(r===void 0||r>s.length)&&(r=s.length),r-=t.length;const n=s.indexOf(t,r);return n!==-1&&n===r},DR=s=>{if(!s)return null;if(Fa(s))return s;let t=s.length;if(!JN(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=s[t];return r},AR=(s=>t=>s&&t instanceof s)(typeof Uint8Array<"u"&&Gu(Uint8Array)),_R=(s,t)=>{const n=(s&&s[Symbol.iterator]).call(s);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(s,i[0],i[1])}},IR=(s,t)=>{let r;const n=[];for(;(r=s.exec(t))!==null;)n.push(r);return n},RR=Js("HTMLFormElement"),MR=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),op=(({hasOwnProperty:s})=>(t,r)=>s.call(t,r))(Object.prototype),OR=Js("RegExp"),s0=(s,t)=>{const r=Object.getOwnPropertyDescriptors(s),n={};Zi(r,(a,i)=>{let o;(o=t(a,i,s))!==!1&&(n[i]=o||a)}),Object.defineProperties(s,n)},FR=s=>{s0(s,(t,r)=>{if(ws(s)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=s[r];if(ws(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},LR=(s,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return Fa(s)?n(s):n(String(s).split(t)),r},$R=()=>{},BR=(s,t)=>s!=null&&Number.isFinite(s=+s)?s:t;function VR(s){return!!(s&&ws(s.append)&&s[Symbol.toStringTag]==="FormData"&&s[Symbol.iterator])}const UR=s=>{const t=new Array(10),r=(n,a)=>{if(ql(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const i=Fa(n)?[]:{};return Zi(n,(o,l)=>{const c=r(o,a+1);!bi(c)&&(i[l]=c)}),t[a]=void 0,i}}return n};return r(s,0)},HR=Js("AsyncFunction"),qR=s=>s&&(ql(s)||ws(s))&&ws(s.then)&&ws(s.catch),r0=((s,t)=>s?setImmediate:t?((r,n)=>(vn.addEventListener("message",({source:a,data:i})=>{a===vn&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),vn.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ws(vn.postMessage)),zR=typeof queueMicrotask<"u"?queueMicrotask.bind(vn):typeof process<"u"&&process.nextTick||r0,H={isArray:Fa,isArrayBuffer:XN,isBuffer:cR,isFormData:vR,isArrayBufferView:dR,isString:uR,isNumber:JN,isBoolean:mR,isObject:ql,isPlainObject:Ao,isReadableStream:jR,isRequest:bR,isResponse:wR,isHeaders:NR,isUndefined:bi,isDate:hR,isFile:pR,isBlob:fR,isRegExp:OR,isFunction:ws,isStream:gR,isURLSearchParams:yR,isTypedArray:AR,isFileList:xR,forEach:Zi,merge:Sd,extend:CR,trim:SR,stripBOM:kR,inherits:TR,toFlatObject:PR,kindOf:Ul,kindOfTest:Js,endsWith:ER,toArray:DR,forEachEntry:_R,matchAll:IR,isHTMLForm:RR,hasOwnProperty:op,hasOwnProp:op,reduceDescriptors:s0,freezeMethods:FR,toObjectSet:LR,toCamelCase:MR,noop:$R,toFiniteNumber:BR,findKey:e0,global:vn,isContextDefined:t0,isSpecCompliantForm:VR,toJSONObject:UR,isAsyncFn:HR,isThenable:qR,setImmediate:r0,asap:zR};function Fe(s,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}H.inherits(Fe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.status}}});const n0=Fe.prototype,a0={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{a0[s]={value:s}});Object.defineProperties(Fe,a0);Object.defineProperty(n0,"isAxiosError",{value:!0});Fe.from=(s,t,r,n,a,i)=>{const o=Object.create(n0);return H.toFlatObject(s,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),Fe.call(o,s.message,t,r,n,a),o.cause=s,o.name=s.name,i&&Object.assign(o,i),o};const WR=null;function Cd(s){return H.isPlainObject(s)||H.isArray(s)}function i0(s){return H.endsWith(s,"[]")?s.slice(0,-2):s}function lp(s,t,r){return s?s.concat(t).map(function(a,i){return a=i0(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function KR(s){return H.isArray(s)&&!s.some(Cd)}const GR=H.toFlatObject(H,{},null,function(t){return/^is[A-Z]/.test(t)});function zl(s,t,r){if(!H.isObject(s))throw new TypeError("target must be an object");t=t||new FormData,r=H.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(f,v){return!H.isUndefined(v[f])});const n=r.metaTokens,a=r.visitor||u,i=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&H.isSpecCompliantForm(t);if(!H.isFunction(a))throw new TypeError("visitor must be a function");function d(g){if(g===null)return"";if(H.isDate(g))return g.toISOString();if(!c&&H.isBlob(g))throw new Fe("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(g)||H.isTypedArray(g)?c&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function u(g,f,v){let y=g;if(g&&!v&&typeof g=="object"){if(H.endsWith(f,"{}"))f=n?f:f.slice(0,-2),g=JSON.stringify(g);else if(H.isArray(g)&&KR(g)||(H.isFileList(g)||H.endsWith(f,"[]"))&&(y=H.toArray(g)))return f=i0(f),y.forEach(function(b,k){!(H.isUndefined(b)||b===null)&&t.append(o===!0?lp([f],k,i):o===null?f:f+"[]",d(b))}),!1}return Cd(g)?!0:(t.append(lp(v,f,i),d(g)),!1)}const h=[],m=Object.assign(GR,{defaultVisitor:u,convertValue:d,isVisitable:Cd});function x(g,f){if(!H.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+f.join("."));h.push(g),H.forEach(g,function(y,j){(!(H.isUndefined(y)||y===null)&&a.call(t,y,H.isString(j)?j.trim():j,f,m))===!0&&x(y,f?f.concat(j):[j])}),h.pop()}}if(!H.isObject(s))throw new TypeError("data must be an object");return x(s),t}function cp(s){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Qu(s,t){this._pairs=[],s&&zl(s,this,t)}const o0=Qu.prototype;o0.append=function(t,r){this._pairs.push([t,r])};o0.toString=function(t){const r=t?function(n){return t.call(this,n,cp)}:cp;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function QR(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function l0(s,t,r){if(!t)return s;const n=r&&r.encode||QR;H.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=H.isURLSearchParams(t)?t.toString():new Qu(t,r).toString(n),i){const o=s.indexOf("#");o!==-1&&(s=s.slice(0,o)),s+=(s.indexOf("?")===-1?"?":"&")+i}return s}class dp{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){H.forEach(this.handlers,function(n){n!==null&&t(n)})}}const c0={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ZR=typeof URLSearchParams<"u"?URLSearchParams:Qu,YR=typeof FormData<"u"?FormData:null,XR=typeof Blob<"u"?Blob:null,JR={isBrowser:!0,classes:{URLSearchParams:ZR,FormData:YR,Blob:XR},protocols:["http","https","file","blob","url","data"]},Zu=typeof window<"u"&&typeof document<"u",kd=typeof navigator=="object"&&navigator||void 0,eM=Zu&&(!kd||["ReactNative","NativeScript","NS"].indexOf(kd.product)<0),tM=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",sM=Zu&&window.location.href||"http://localhost",rM=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Zu,hasStandardBrowserEnv:eM,hasStandardBrowserWebWorkerEnv:tM,navigator:kd,origin:sM},Symbol.toStringTag,{value:"Module"})),Jt={...rM,...JR};function nM(s,t){return zl(s,new Jt.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,i){return Jt.isNode&&H.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function aM(s){return H.matchAll(/\w+|\[(\w*)]/g,s).map(t=>t[0]==="[]"?"":t[1]||t[0])}function iM(s){const t={},r=Object.keys(s);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=s[i];return t}function d0(s){function t(r,n,a,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=r.length;return o=!o&&H.isArray(a)?a.length:o,c?(H.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!l):((!a[o]||!H.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],i)&&H.isArray(a[o])&&(a[o]=iM(a[o])),!l)}if(H.isFormData(s)&&H.isFunction(s.entries)){const r={};return H.forEachEntry(s,(n,a)=>{t(aM(n),a,r,0)}),r}return null}function oM(s,t,r){if(H.isString(s))try{return(t||JSON.parse)(s),H.trim(s)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(s)}const Yi={transitional:c0,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=H.isObject(t);if(i&&H.isHTMLForm(t)&&(t=new FormData(t)),H.isFormData(t))return a?JSON.stringify(d0(t)):t;if(H.isArrayBuffer(t)||H.isBuffer(t)||H.isStream(t)||H.isFile(t)||H.isBlob(t)||H.isReadableStream(t))return t;if(H.isArrayBufferView(t))return t.buffer;if(H.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return nM(t,this.formSerializer).toString();if((l=H.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return zl(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),oM(t)):t}],transformResponse:[function(t){const r=this.transitional||Yi.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(H.isResponse(t)||H.isReadableStream(t))return t;if(t&&H.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(l){if(o)throw l.name==="SyntaxError"?Fe.from(l,Fe.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Jt.classes.FormData,Blob:Jt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],s=>{Yi.headers[s]={}});const lM=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),cM=s=>{const t={};let r,n,a;return s&&s.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&lM[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},up=Symbol("internals");function Ga(s){return s&&String(s).trim().toLowerCase()}function _o(s){return s===!1||s==null?s:H.isArray(s)?s.map(_o):String(s)}function dM(s){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(s);)t[n[1]]=n[2];return t}const uM=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function kc(s,t,r,n,a){if(H.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!H.isString(t)){if(H.isString(n))return t.indexOf(n)!==-1;if(H.isRegExp(n))return n.test(t)}}function mM(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function hM(s,t){const r=H.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(s,n+r,{value:function(a,i,o){return this[n].call(this,t,a,i,o)},configurable:!0})})}class us{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(l,c,d){const u=Ga(c);if(!u)throw new Error("header name must be a non-empty string");const h=H.findKey(a,u);(!h||a[h]===void 0||d===!0||d===void 0&&a[h]!==!1)&&(a[h||c]=_o(l))}const o=(l,c)=>H.forEach(l,(d,u)=>i(d,u,c));if(H.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(H.isString(t)&&(t=t.trim())&&!uM(t))o(cM(t),r);else if(H.isHeaders(t))for(const[l,c]of t.entries())i(c,l,n);else t!=null&&i(r,t,n);return this}get(t,r){if(t=Ga(t),t){const n=H.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return dM(a);if(H.isFunction(r))return r.call(this,a,n);if(H.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Ga(t),t){const n=H.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||kc(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(o){if(o=Ga(o),o){const l=H.findKey(n,o);l&&(!r||kc(n,n[l],l,r))&&(delete n[l],a=!0)}}return H.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||kc(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return H.forEach(this,(a,i)=>{const o=H.findKey(n,i);if(o){r[o]=_o(a),delete r[i];return}const l=t?mM(i):String(i).trim();l!==i&&delete r[i],r[l]=_o(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return H.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&H.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[up]=this[up]={accessors:{}}).accessors,a=this.prototype;function i(o){const l=Ga(o);n[l]||(hM(a,o),n[l]=!0)}return H.isArray(t)?t.forEach(i):i(t),this}}us.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);H.reduceDescriptors(us.prototype,({value:s},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>s,set(n){this[r]=n}}});H.freezeMethods(us);function Tc(s,t){const r=this||Yi,n=t||r,a=us.from(n.headers);let i=n.data;return H.forEach(s,function(l){i=l.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function u0(s){return!!(s&&s.__CANCEL__)}function La(s,t,r){Fe.call(this,s??"canceled",Fe.ERR_CANCELED,t,r),this.name="CanceledError"}H.inherits(La,Fe,{__CANCEL__:!0});function m0(s,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?s(r):t(new Fe("Request failed with status code "+r.status,[Fe.ERR_BAD_REQUEST,Fe.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function pM(s){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return t&&t[1]||""}function fM(s,t){s=s||10;const r=new Array(s),n=new Array(s);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=n[i];o||(o=d),r[a]=c,n[a]=d;let h=i,m=0;for(;h!==a;)m+=r[h++],h=h%s;if(a=(a+1)%s,a===i&&(i=(i+1)%s),d-o<t)return;const x=u&&d-u;return x?Math.round(m*1e3/x):void 0}}function xM(s,t){let r=0,n=1e3/t,a,i;const o=(d,u=Date.now())=>{r=u,a=null,i&&(clearTimeout(i),i=null),s.apply(null,d)};return[(...d)=>{const u=Date.now(),h=u-r;h>=n?o(d,u):(a=d,i||(i=setTimeout(()=>{i=null,o(a)},n-h)))},()=>a&&o(a)]}const zo=(s,t,r=3)=>{let n=0;const a=fM(50,250);return xM(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-n,d=a(c),u=o<=l;n=o;const h={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-o)/d:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};s(h)},r)},mp=(s,t)=>{const r=s!=null;return[n=>t[0]({lengthComputable:r,total:s,loaded:n}),t[1]]},hp=s=>(...t)=>H.asap(()=>s(...t)),gM=Jt.hasStandardBrowserEnv?((s,t)=>r=>(r=new URL(r,Jt.origin),s.protocol===r.protocol&&s.host===r.host&&(t||s.port===r.port)))(new URL(Jt.origin),Jt.navigator&&/(msie|trident)/i.test(Jt.navigator.userAgent)):()=>!0,vM=Jt.hasStandardBrowserEnv?{write(s,t,r,n,a,i){const o=[s+"="+encodeURIComponent(t)];H.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),H.isString(n)&&o.push("path="+n),H.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(s){const t=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function yM(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function jM(s,t){return t?s.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):s}function h0(s,t,r){let n=!yM(t);return s&&(n||r==!1)?jM(s,t):t}const pp=s=>s instanceof us?{...s}:s;function Mn(s,t){t=t||{};const r={};function n(d,u,h,m){return H.isPlainObject(d)&&H.isPlainObject(u)?H.merge.call({caseless:m},d,u):H.isPlainObject(u)?H.merge({},u):H.isArray(u)?u.slice():u}function a(d,u,h,m){if(H.isUndefined(u)){if(!H.isUndefined(d))return n(void 0,d,h,m)}else return n(d,u,h,m)}function i(d,u){if(!H.isUndefined(u))return n(void 0,u)}function o(d,u){if(H.isUndefined(u)){if(!H.isUndefined(d))return n(void 0,d)}else return n(void 0,u)}function l(d,u,h){if(h in t)return n(d,u);if(h in s)return n(void 0,d)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,u,h)=>a(pp(d),pp(u),h,!0)};return H.forEach(Object.keys(Object.assign({},s,t)),function(u){const h=c[u]||a,m=h(s[u],t[u],u);H.isUndefined(m)&&h!==l||(r[u]=m)}),r}const p0=s=>{const t=Mn({},s);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:l}=t;t.headers=o=us.from(o),t.url=l0(h0(t.baseURL,t.url,t.allowAbsoluteUrls),s.params,s.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(H.isFormData(r)){if(Jt.hasStandardBrowserEnv||Jt.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[d,...u]=c?c.split(";").map(h=>h.trim()).filter(Boolean):[];o.setContentType([d||"multipart/form-data",...u].join("; "))}}if(Jt.hasStandardBrowserEnv&&(n&&H.isFunction(n)&&(n=n(t)),n||n!==!1&&gM(t.url))){const d=a&&i&&vM.read(i);d&&o.set(a,d)}return t},bM=typeof XMLHttpRequest<"u",wM=bM&&function(s){return new Promise(function(r,n){const a=p0(s);let i=a.data;const o=us.from(a.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=a,u,h,m,x,g;function f(){x&&x(),g&&g(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let v=new XMLHttpRequest;v.open(a.method.toUpperCase(),a.url,!0),v.timeout=a.timeout;function y(){if(!v)return;const b=us.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),S={data:!l||l==="text"||l==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:b,config:s,request:v};m0(function(T){r(T),f()},function(T){n(T),f()},S),v=null}"onloadend"in v?v.onloadend=y:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(y)},v.onabort=function(){v&&(n(new Fe("Request aborted",Fe.ECONNABORTED,s,v)),v=null)},v.onerror=function(){n(new Fe("Network Error",Fe.ERR_NETWORK,s,v)),v=null},v.ontimeout=function(){let k=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const S=a.transitional||c0;a.timeoutErrorMessage&&(k=a.timeoutErrorMessage),n(new Fe(k,S.clarifyTimeoutError?Fe.ETIMEDOUT:Fe.ECONNABORTED,s,v)),v=null},i===void 0&&o.setContentType(null),"setRequestHeader"in v&&H.forEach(o.toJSON(),function(k,S){v.setRequestHeader(S,k)}),H.isUndefined(a.withCredentials)||(v.withCredentials=!!a.withCredentials),l&&l!=="json"&&(v.responseType=a.responseType),d&&([m,g]=zo(d,!0),v.addEventListener("progress",m)),c&&v.upload&&([h,x]=zo(c),v.upload.addEventListener("progress",h),v.upload.addEventListener("loadend",x)),(a.cancelToken||a.signal)&&(u=b=>{v&&(n(!b||b.type?new La(null,s,v):b),v.abort(),v=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const j=pM(a.url);if(j&&Jt.protocols.indexOf(j)===-1){n(new Fe("Unsupported protocol "+j+":",Fe.ERR_BAD_REQUEST,s));return}v.send(i||null)})},NM=(s,t)=>{const{length:r}=s=s?s.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(d){if(!a){a=!0,l();const u=d instanceof Error?d:this.reason;n.abort(u instanceof Fe?u:new La(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,i(new Fe(`timeout ${t} of ms exceeded`,Fe.ETIMEDOUT))},t);const l=()=>{s&&(o&&clearTimeout(o),o=null,s.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),s=null)};s.forEach(d=>d.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>H.asap(l),c}},SM=function*(s,t){let r=s.byteLength;if(r<t){yield s;return}let n=0,a;for(;n<r;)a=n+t,yield s.slice(n,a),n=a},CM=async function*(s,t){for await(const r of kM(s))yield*SM(r,t)},kM=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const t=s.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},fp=(s,t,r,n)=>{const a=CM(s,t);let i=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await a.next();if(d){l(),c.close();return}let h=u.byteLength;if(r){let m=i+=h;r(m)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),a.return()}},{highWaterMark:2})},Wl=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",f0=Wl&&typeof ReadableStream=="function",TM=Wl&&(typeof TextEncoder=="function"?(s=>t=>s.encode(t))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),x0=(s,...t)=>{try{return!!s(...t)}catch{return!1}},PM=f0&&x0(()=>{let s=!1;const t=new Request(Jt.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!t}),xp=64*1024,Td=f0&&x0(()=>H.isReadableStream(new Response("").body)),Wo={stream:Td&&(s=>s.body)};Wl&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Wo[t]&&(Wo[t]=H.isFunction(s[t])?r=>r[t]():(r,n)=>{throw new Fe(`Response type '${t}' is not supported`,Fe.ERR_NOT_SUPPORT,n)})})})(new Response);const EM=async s=>{if(s==null)return 0;if(H.isBlob(s))return s.size;if(H.isSpecCompliantForm(s))return(await new Request(Jt.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(H.isArrayBufferView(s)||H.isArrayBuffer(s))return s.byteLength;if(H.isURLSearchParams(s)&&(s=s+""),H.isString(s))return(await TM(s)).byteLength},DM=async(s,t)=>{const r=H.toFiniteNumber(s.getContentLength());return r??EM(t)},AM=Wl&&(async s=>{let{url:t,method:r,data:n,signal:a,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:d,headers:u,withCredentials:h="same-origin",fetchOptions:m}=p0(s);d=d?(d+"").toLowerCase():"text";let x=NM([a,i&&i.toAbortSignal()],o),g;const f=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let v;try{if(c&&PM&&r!=="get"&&r!=="head"&&(v=await DM(u,n))!==0){let S=new Request(t,{method:"POST",body:n,duplex:"half"}),A;if(H.isFormData(n)&&(A=S.headers.get("content-type"))&&u.setContentType(A),S.body){const[T,C]=mp(v,zo(hp(c)));n=fp(S.body,xp,T,C)}}H.isString(h)||(h=h?"include":"omit");const y="credentials"in Request.prototype;g=new Request(t,{...m,signal:x,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",credentials:y?h:void 0});let j=await fetch(g);const b=Td&&(d==="stream"||d==="response");if(Td&&(l||b&&f)){const S={};["status","statusText","headers"].forEach(E=>{S[E]=j[E]});const A=H.toFiniteNumber(j.headers.get("content-length")),[T,C]=l&&mp(A,zo(hp(l),!0))||[];j=new Response(fp(j.body,xp,T,()=>{C&&C(),f&&f()}),S)}d=d||"text";let k=await Wo[H.findKey(Wo,d)||"text"](j,s);return!b&&f&&f(),await new Promise((S,A)=>{m0(S,A,{data:k,headers:us.from(j.headers),status:j.status,statusText:j.statusText,config:s,request:g})})}catch(y){throw f&&f(),y&&y.name==="TypeError"&&/fetch/i.test(y.message)?Object.assign(new Fe("Network Error",Fe.ERR_NETWORK,s,g),{cause:y.cause||y}):Fe.from(y,y&&y.code,s,g)}}),Pd={http:WR,xhr:wM,fetch:AM};H.forEach(Pd,(s,t)=>{if(s){try{Object.defineProperty(s,"name",{value:t})}catch{}Object.defineProperty(s,"adapterName",{value:t})}});const gp=s=>`- ${s}`,_M=s=>H.isFunction(s)||s===null||s===!1,g0={getAdapter:s=>{s=H.isArray(s)?s:[s];const{length:t}=s;let r,n;const a={};for(let i=0;i<t;i++){r=s[i];let o;if(n=r,!_M(r)&&(n=Pd[(o=String(r)).toLowerCase()],n===void 0))throw new Fe(`Unknown adapter '${o}'`);if(n)break;a[o||"#"+i]=n}if(!n){const i=Object.entries(a).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(gp).join(`
`):" "+gp(i[0]):"as no adapter specified";throw new Fe("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Pd};function Pc(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new La(null,s)}function vp(s){return Pc(s),s.headers=us.from(s.headers),s.data=Tc.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),g0.getAdapter(s.adapter||Yi.adapter)(s).then(function(n){return Pc(s),n.data=Tc.call(s,s.transformResponse,n),n.headers=us.from(n.headers),n},function(n){return u0(n)||(Pc(s),n&&n.response&&(n.response.data=Tc.call(s,s.transformResponse,n.response),n.response.headers=us.from(n.response.headers))),Promise.reject(n)})}const v0="1.8.4",Kl={};["object","boolean","number","function","string","symbol"].forEach((s,t)=>{Kl[s]=function(n){return typeof n===s||"a"+(t<1?"n ":" ")+s}});const yp={};Kl.transitional=function(t,r,n){function a(i,o){return"[Axios v"+v0+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,l)=>{if(t===!1)throw new Fe(a(o," has been removed"+(r?" in "+r:"")),Fe.ERR_DEPRECATED);return r&&!yp[o]&&(yp[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};Kl.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function IM(s,t,r){if(typeof s!="object")throw new Fe("options must be an object",Fe.ERR_BAD_OPTION_VALUE);const n=Object.keys(s);let a=n.length;for(;a-- >0;){const i=n[a],o=t[i];if(o){const l=s[i],c=l===void 0||o(l,i,s);if(c!==!0)throw new Fe("option "+i+" must be "+c,Fe.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Fe("Unknown option "+i,Fe.ERR_BAD_OPTION)}}const Io={assertOptions:IM,validators:Kl},sr=Io.validators;class Tn{constructor(t){this.defaults=t,this.interceptors={request:new dp,response:new dp}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Mn(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&Io.assertOptions(n,{silentJSONParsing:sr.transitional(sr.boolean),forcedJSONParsing:sr.transitional(sr.boolean),clarifyTimeoutError:sr.transitional(sr.boolean)},!1),a!=null&&(H.isFunction(a)?r.paramsSerializer={serialize:a}:Io.assertOptions(a,{encode:sr.function,serialize:sr.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Io.assertOptions(r,{baseUrl:sr.spelling("baseURL"),withXsrfToken:sr.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&H.merge(i.common,i[r.method]);i&&H.forEach(["delete","get","head","post","put","patch","common"],g=>{delete i[g]}),r.headers=us.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(f){typeof f.runWhen=="function"&&f.runWhen(r)===!1||(c=c&&f.synchronous,l.unshift(f.fulfilled,f.rejected))});const d=[];this.interceptors.response.forEach(function(f){d.push(f.fulfilled,f.rejected)});let u,h=0,m;if(!c){const g=[vp.bind(this),void 0];for(g.unshift.apply(g,l),g.push.apply(g,d),m=g.length,u=Promise.resolve(r);h<m;)u=u.then(g[h++],g[h++]);return u}m=l.length;let x=r;for(h=0;h<m;){const g=l[h++],f=l[h++];try{x=g(x)}catch(v){f.call(this,v);break}}try{u=vp.call(this,x)}catch(g){return Promise.reject(g)}for(h=0,m=d.length;h<m;)u=u.then(d[h++],d[h++]);return u}getUri(t){t=Mn(this.defaults,t);const r=h0(t.baseURL,t.url,t.allowAbsoluteUrls);return l0(r,t.params,t.paramsSerializer)}}H.forEach(["delete","get","head","options"],function(t){Tn.prototype[t]=function(r,n){return this.request(Mn(n||{},{method:t,url:r,data:(n||{}).data}))}});H.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,l){return this.request(Mn(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Tn.prototype[t]=r(),Tn.prototype[t+"Form"]=r(!0)});class Yu{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(l=>{n.subscribe(l),i=l}).then(a);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,l){n.reason||(n.reason=new La(i,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Yu(function(a){t=a}),cancel:t}}}function RM(s){return function(r){return s.apply(null,r)}}function MM(s){return H.isObject(s)&&s.isAxiosError===!0}const Ed={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ed).forEach(([s,t])=>{Ed[t]=s});function y0(s){const t=new Tn(s),r=YN(Tn.prototype.request,t);return H.extend(r,Tn.prototype,t,{allOwnKeys:!0}),H.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return y0(Mn(s,a))},r}const _t=y0(Yi);_t.Axios=Tn;_t.CanceledError=La;_t.CancelToken=Yu;_t.isCancel=u0;_t.VERSION=v0;_t.toFormData=zl;_t.AxiosError=Fe;_t.Cancel=_t.CanceledError;_t.all=function(t){return Promise.all(t)};_t.spread=RM;_t.isAxiosError=MM;_t.mergeConfig=Mn;_t.AxiosHeaders=us;_t.formToJSON=s=>d0(H.isHTMLForm(s)?new FormData(s):s);_t.getAdapter=g0.getAdapter;_t.HttpStatusCode=Ed;_t.default=_t;async function OM(s,t){try{return(await _t.post(`/api/files/orders/${s}/artwork`,{imageData:t})).data}catch(r){throw console.error("Error uploading artwork image:",r),r}}function j0({isOpen:s,onClose:t,order:r}){var C,E,D;const{updateOrder:n,isUpdatingOrder:a}=oR(),{toast:i}=Be(),o=p.useRef(null),[l,c]=p.useState({frameId:"",matColorId:"",glassOptionId:"",artworkWidth:"",artworkHeight:"",matWidth:"",artworkDescription:"",artworkType:"",quantity:"1"}),[d,u]=p.useState(!1),[h,m]=p.useState(null),{data:x}=me({queryKey:["/api/frames"],queryFn:async()=>{const w=await fetch("/api/frames");if(!w.ok)throw new Error("Failed to fetch frames");return w.json()}}),{data:g}=me({queryKey:["/api/larson-catalog/crescent"],queryFn:async()=>{const w=await fetch("/api/larson-catalog/crescent");if(!w.ok)throw new Error("Failed to fetch mat colors");return w.json()}}),{data:f}=me({queryKey:["/api/glass-options"],queryFn:async()=>{const w=await fetch("/api/glass-options");if(!w.ok)throw new Error("Failed to fetch glass options");return w.json()}});p.useEffect(()=>{c(r?{frameId:r.frameId||"",matColorId:r.matColorId||"",glassOptionId:r.glassOptionId||"",artworkWidth:String(r.artworkWidth||""),artworkHeight:String(r.artworkHeight||""),matWidth:String(r.matWidth||""),artworkDescription:r.artworkDescription||"",artworkType:r.artworkType||"",quantity:String(r.quantity||"1")}:{frameId:"",matColorId:"",glassOptionId:"",artworkWidth:"",artworkHeight:"",matWidth:"",artworkDescription:"",artworkType:"",quantity:"1"})},[r]);const v=w=>{const{name:N,value:_}=w.target;c(F=>({...F,[N]:_}))},y=w=>{const{value:N}=w.target;c(_=>({..._,artworkWidth:N}))},j=w=>{const{value:N}=w.target;c(_=>({..._,artworkHeight:N}))},b=(w,N)=>{c(_=>({..._,[w]:N}))},k=()=>r?String(l.artworkWidth)!==String(r.artworkWidth)||String(l.artworkHeight)!==String(r.artworkHeight)||String(l.matWidth)!==String(r.matWidth):!1,S=w=>{var F;const N=(F=w.target.files)==null?void 0:F[0];if(!N)return;u(!0);const _=new FileReader;_.onloadend=()=>{m(_.result),u(!1)},_.onerror=()=>{i({title:"Error Reading File",description:"There was an error reading the selected file.",variant:"destructive"}),u(!1)},_.readAsDataURL(N)},A=()=>{var w;(w=o.current)==null||w.click()},T=async()=>{if(r&&Object.keys(l).length>0){const w=k(),N={frameId:l.frameId||void 0,matColorId:l.matColorId||void 0,glassOptionId:l.glassOptionId||void 0,artworkWidth:l.artworkWidth&&parseFloat(l.artworkWidth)||void 0,artworkHeight:l.artworkHeight&&parseFloat(l.artworkHeight)||void 0,matWidth:l.matWidth&&parseFloat(l.matWidth)||void 0,artworkDescription:l.artworkDescription||void 0,artworkType:l.artworkType||void 0,quantity:l.quantity&&parseInt(l.quantity)||1};n({id:r.id,data:N,recalculatePricing:w},{onSuccess:async()=>{if(w&&i({title:"Size Updated",description:"Order dimensions and pricing have been recalculated",variant:"default"}),h)try{await OM(r.id,h),i({title:"Artwork Updated",description:"Order artwork has been updated",variant:"default"})}catch(_){console.error("Error uploading artwork image:",_),i({title:"Image Upload Failed",description:"Order was updated but the artwork image failed to upload.",variant:"destructive"})}t()}})}};return r?e.jsx(Bt,{open:s,onOpenChange:t,children:e.jsxs(Lt,{className:"sm:max-w-[500px]",children:[e.jsx(Vt,{children:e.jsxs(Ut,{children:["Edit Order #",r.id]})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(M,{htmlFor:"frameId",className:"text-right",children:"Frame"}),e.jsx("div",{className:"col-span-3",children:e.jsxs(We,{value:((C=l.frameId)==null?void 0:C.toString())||"",onValueChange:w=>b("frameId",w),children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a frame"})}),e.jsx(qe,{children:x&&x.map(w=>e.jsx(se,{value:w.id,children:w.name},w.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(M,{htmlFor:"matColorId",className:"text-right",children:"Mat Color"}),e.jsx("div",{className:"col-span-3",children:e.jsxs(We,{value:((E=l.matColorId)==null?void 0:E.toString())||"",onValueChange:w=>b("matColorId",w),children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a mat color"})}),e.jsx(qe,{children:g&&g.map(w=>e.jsx(se,{value:w.id,children:w.name},w.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(M,{htmlFor:"glassOptionId",className:"text-right",children:"Glass Option"}),e.jsx("div",{className:"col-span-3",children:e.jsxs(We,{value:((D=l.glassOptionId)==null?void 0:D.toString())||"",onValueChange:w=>b("glassOptionId",w),children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select glass"})}),e.jsx(qe,{children:f&&f.map(w=>e.jsx(se,{value:w.id,children:w.name},w.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(M,{htmlFor:"artworkWidth",className:"text-right",children:"Width (inches)"}),e.jsx(U,{id:"artworkWidth",name:"artworkWidth",type:"number",step:"0.125",value:l.artworkWidth||"",onChange:y,className:"col-span-3",placeholder:"Enter width"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(M,{htmlFor:"artworkHeight",className:"text-right",children:"Height (inches)"}),e.jsx(U,{id:"artworkHeight",name:"artworkHeight",type:"number",step:"0.125",value:l.artworkHeight||"",onChange:j,className:"col-span-3",placeholder:"Enter height"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(M,{htmlFor:"matWidth",className:"text-right",children:"Mat Width (inches)"}),e.jsx(U,{id:"matWidth",name:"matWidth",type:"number",step:"0.125",value:l.matWidth||"",onChange:v,className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(M,{htmlFor:"quantity",className:"text-right",children:"Quantity"}),e.jsx(U,{id:"quantity",name:"quantity",type:"number",min:"1",value:l.quantity||"1",onChange:v,className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(M,{htmlFor:"artworkImage",className:"text-right",children:"Artwork Image"}),e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(P,{type:"button",variant:"outline",onClick:A,disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin h-4 w-4 mr-2 border-2 border-current border-t-transparent rounded-full"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Or,{className:"h-4 w-4 mr-2"}),"Upload Image"]})}),e.jsx("input",{ref:o,type:"file",id:"artworkImage",accept:"image/*",className:"hidden",onChange:S}),h&&e.jsx("div",{className:"relative border rounded-md p-1",children:e.jsx("img",{src:h,alt:"Artwork preview",className:"h-16 object-cover rounded"})}),!h&&r.artworkImagePath&&e.jsxs("div",{className:"text-sm flex items-center text-muted-foreground",children:[e.jsx(fi,{className:"h-4 w-4 mr-1"}),"Existing artwork image available"]})]})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(M,{htmlFor:"artworkDescription",className:"text-right",children:"Description"}),e.jsx(U,{id:"artworkDescription",name:"artworkDescription",value:l.artworkDescription||"",onChange:v,className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(M,{htmlFor:"artworkType",className:"text-right",children:"Type"}),e.jsx(U,{id:"artworkType",name:"artworkType",value:l.artworkType||"",onChange:v,className:"col-span-3"})]})]}),e.jsxs(_n,{children:[e.jsx(P,{variant:"outline",onClick:t,children:"Cancel"}),e.jsxs(P,{onClick:T,disabled:a||d,children:[(a||d)&&e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})}):null}function FM({order:s,customerId:t,onSuccess:r}){const[n,a]=p.useState(s?s.total:""),[i,o]=p.useState(s?`Payment for Order #${s.orderNumber||s.id} - ${s.customerName}`:""),[l,c]=p.useState("7"),[d,u]=p.useState(""),[h,m]=p.useState(""),[x,g]=p.useState(!0),[f,v]=p.useState(null),{toast:y}=Be(),j=Zt(),b=Ce({mutationFn:async T=>(await ce("POST","/api/payment-links",T)).json(),onSuccess:T=>{var C;if(j.invalidateQueries({queryKey:["/api/payment-links"]}),(C=T.paymentLink)!=null&&C.token){const D=`${window.location.origin}/payment/${T.paymentLink.token}`;v(D)}y({title:"Payment link created",description:x?"The payment link has been created and sent to the customer.":"The payment link has been created successfully."}),r&&r()},onError:T=>{y({title:"Error creating payment link",description:T.message||"There was an error creating the payment link.",variant:"destructive"})}}),k=T=>{if(T.preventDefault(),!n||isNaN(parseFloat(n))||parseFloat(n)<=0){y({title:"Invalid amount",description:"Please enter a valid payment amount.",variant:"destructive"});return}if(x&&!d&&!h){y({title:"Contact information required",description:"Please provide either an email address or phone number to send the notification.",variant:"destructive"});return}const C={amount:parseFloat(n),expiresInDays:parseInt(l),sendNotification:x};i&&(C.description=i),(t||s)&&(C.customerId=t||(s==null?void 0:s.id)),x&&(d&&(C.email=d),h&&(C.phone=h)),b.mutate(C)},S=()=>{f&&(navigator.clipboard.writeText(f),y({title:"Link copied",description:"Payment link copied to clipboard"}))},A=()=>{f&&window.open(f,"_blank")};return e.jsxs(V,{className:"w-full max-w-2xl",children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(Sr,{className:"w-5 h-5"}),"Send Payment Link"]}),e.jsx(te,{children:"Create and send a secure payment link to your customer using Stripe."})]}),e.jsx(q,{children:f?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-green-800 mb-2",children:"Payment Link Created!"}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"Your payment link is ready. You can copy it and send it manually, or it has been automatically sent if you selected notification options."}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white border rounded",children:[e.jsx(U,{value:f,readOnly:!0,className:"flex-1"}),e.jsx(P,{onClick:S,variant:"outline",size:"sm",children:e.jsx(pj,{className:"w-4 h-4"})}),e.jsx(P,{onClick:A,variant:"outline",size:"sm",children:e.jsx(L2,{className:"w-4 h-4"})})]})]}),e.jsx(P,{onClick:()=>{v(null),a(s?s.total:""),o(s?`Payment for Order #${s.orderNumber||s.id} - ${s.customerName}`:""),u(""),m("")},variant:"outline",className:"w-full",children:"Create Another Link"})]}):e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"amount",children:"Amount ($)"}),e.jsx(U,{id:"amount",type:"number",step:"0.01",min:"0.01",placeholder:"Amount",value:n,onChange:T=>a(T.target.value),required:!0}),n&&!isNaN(parseFloat(n))&&e.jsx("p",{className:"text-sm text-gray-600",children:An(parseFloat(n))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"expiresInDays",children:"Expires In (days)"}),e.jsx(U,{id:"expiresInDays",type:"number",min:"1",max:"30",placeholder:"7",value:l,onChange:T=>c(T.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"description",children:"Description"}),e.jsx(Zs,{id:"description",placeholder:"Payment description",value:i,onChange:T=>o(T.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(os,{id:"sendNotification",checked:x,onCheckedChange:T=>g(!!T)}),e.jsx(M,{htmlFor:"sendNotification",children:"Send payment link automatically"})]}),x&&e.jsxs("div",{className:"pl-6 space-y-4 border-l-2 border-gray-200",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"email",children:"Customer Email"}),e.jsx(U,{id:"email",type:"email",placeholder:"customer@example.com",value:d,onChange:T=>u(T.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"phone",children:"Customer Phone Number"}),e.jsx(U,{id:"phone",type:"tel",placeholder:"+1 (123) 456-7890",value:h,onChange:T=>m(T.target.value)})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Provide at least one contact method to send the payment link automatically."})]})]}),e.jsx(P,{type:"submit",disabled:b.isPending,className:"w-full",children:b.isPending?"Creating Payment Link...":e.jsxs(e.Fragment,{children:[e.jsx(Sr,{className:"w-4 h-4 mr-2"}),"Create Payment Link"]})})]})})]})}const b0={ORDER_CARD:"order"};function LM({order:s,onMoveLeft:t,onMoveRight:r,canMoveLeft:n,canMoveRight:a,onSchedule:i,index:o,moveOrder:l}){var b,k;const[c,d]=p.useState(!1),[u,h]=p.useState(!1),[m,x]=p.useState(7),g=p.useRef(null),f=S=>S.replace(/_/g," ").replace(/\b\w/g,A=>A.toUpperCase()),v=()=>{i(m),d(!1)},[{isDragging:y},j]=LI({type:b0.ORDER_CARD,item:{id:s.id,status:s.productionStatus,index:o},collect:S=>({isDragging:S.isDragging()}),end:(S,A)=>{A.getDropResult()}});return j(g),e.jsxs(V,{ref:g,className:`mb-4 shadow-md relative cursor-grab active:cursor-grabbing transition-all duration-200 hover:shadow-lg ${y?"opacity-60 rotate-3 scale-105 z-50":"hover:scale-[1.02]"}`,style:{transform:y?"rotate(3deg) scale(1.05)":void 0,zIndex:y?1e3:"auto"},children:[e.jsx("div",{className:"absolute top-2 right-2 text-muted-foreground",children:e.jsx($2,{className:"h-4 w-4"})}),e.jsxs(G,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(Q,{className:"text-md",children:["Order #",s.id]}),e.jsx(ue,{variant:s.productionStatus==="completed"?"default":s.productionStatus==="delayed"?"destructive":"secondary",children:f(s.productionStatus||"order_processed")})]}),e.jsxs(te,{children:["Customer #",s.customerId||"Unknown"]})]}),e.jsxs(q,{className:"text-sm space-y-2 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Frame:"})," ",((b=s.frameId)==null?void 0:b.split("-")[1])||"None"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Mat:"})," ",((k=s.matColorId)==null?void 0:k.split("-")[1])||"None"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Size:"})," ",s.artworkWidth,"×",s.artworkHeight,'"']}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Glass:"})," ",s.glassOptionId?s.glassOptionId.includes("-")?s.glassOptionId.split("-")[1]:s.glassOptionId==="museum"?"Museum":s.glassOptionId==="uv"?"UV Protection":s.glassOptionId:"None"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Hs,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Contact customer for details"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fu,{className:"h-3 w-3"}),e.jsxs("span",{className:"text-xs",children:["Order #",s.id]})]}),s.estimatedCompletionDays&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ur,{className:"h-3 w-3"}),e.jsxs("span",{className:"text-xs",children:["Est. completion: ",new Date(new Date().setDate(new Date().getDate()+s.estimatedCompletionDays)).toLocaleDateString()]})]})]}),e.jsxs(ht,{className:"pt-0 flex gap-2",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:t,disabled:!n,children:[e.jsx(B2,{className:"h-4 w-4 mr-1"}),"Back"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>h(!0),children:[e.jsx(Aa,{className:"h-4 w-4 mr-1"}),"Edit"]}),s.productionStatus==="order_processed"?e.jsxs(Bt,{open:c,onOpenChange:d,children:[e.jsx(va,{asChild:!0,children:e.jsxs(P,{size:"sm",variant:"default",children:[e.jsx(Ur,{className:"h-4 w-4 mr-1"}),"Schedule"]})}),e.jsxs(Lt,{children:[e.jsxs(Vt,{children:[e.jsxs(Ut,{children:["Schedule Order #",s.id," for Production"]}),e.jsx(bs,{children:"Set the estimated number of days until completion"})]}),e.jsxs("div",{className:"py-4",children:[e.jsx(M,{htmlFor:"estimated-days",children:"Estimated Days"}),e.jsx(U,{id:"estimated-days",type:"number",min:7,max:30,value:m,onChange:S=>x(parseInt(S.target.value))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Minimum 7 days required for scheduling."})]}),e.jsxs(_n,{children:[e.jsx(uA,{asChild:!0,children:e.jsx(P,{variant:"outline",children:"Cancel"})}),e.jsx(P,{onClick:v,children:"Schedule"})]})]})]}):e.jsxs(P,{variant:"default",size:"sm",onClick:r,disabled:!a,children:["Next",e.jsx(Qc,{className:"h-4 w-4 ml-1"})]}),e.jsx(j0,{isOpen:u,onClose:()=>h(!1),order:s})]})]})}function $M({title:s,orders:t=[],isLoading:r=!1,previousStatus:n,nextStatus:a,updateOrderStatus:i,scheduleOrder:o,currentStatus:l}){const c=p.useRef(null),[{isOver:d,canDrop:u},h]=WI({accept:b0.ORDER_CARD,drop:x=>(x.status!==l&&i(x.id,l),{status:l}),canDrop:x=>l==="delayed"||x.status===n||x.status===a,collect:x=>({isOver:x.isOver({shallow:!0}),canDrop:x.canDrop()})});h(c);const m=()=>d&&u?"bg-primary/20 border-primary shadow-lg":u?"bg-primary/5 border-primary/50":d?"bg-destructive/10 border-destructive":"bg-muted/20 border-muted";return e.jsxs("div",{className:"kanban-column min-w-[280px] max-w-[280px]",children:[e.jsxs("div",{className:"bg-muted rounded-t-lg p-3 sticky top-0 z-10",children:[e.jsx("h3",{className:"font-medium",children:s}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.length," order",t.length!==1?"s":""]})]}),e.jsx("div",{ref:c,className:`p-6 min-h-[calc(100vh-160px)] rounded-b-lg ${m()} transition-all duration-200 border-2 border-dashed ${d&&u?"border-primary scale-[1.02]":u?"border-primary/30":"border-transparent"}`,style:{minHeight:"calc(100vh - 160px)",padding:d&&u?"8px":"24px"},children:r?e.jsx("div",{className:"flex items-center justify-center h-20",children:e.jsx(Xe,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-20 text-muted-foreground",children:[e.jsx(fj,{className:"h-8 w-8 mb-2"}),e.jsx("p",{className:"text-xs",children:"No orders in this column"})]}):t.map((x,g)=>e.jsx(LM,{order:x,canMoveLeft:!!n,canMoveRight:!!a,onMoveLeft:()=>i(x.id,n),onMoveRight:()=>i(x.id,a),onSchedule:f=>o(x.id,f),index:g,moveOrder:i},x.id))})]})}function BM(){const{orders:s=[],isLoading:t=!1,error:r=null,updateOrderStatus:n=g=>console.log("Update status called with:",g),scheduleOrder:a=g=>console.log("Schedule order called with:",g)}=_N(),[i,o]=p.useState(null),[l,c]=p.useState(null),d=(g,f)=>{n({id:g,status:f})},u=(g,f)=>{a({id:g,estimatedDays:f})},h=[{title:"Order Processed",status:"order_processed",nextStatus:"scheduled"},{title:"Scheduled",status:"scheduled",previousStatus:"order_processed",nextStatus:"materials_ordered"},{title:"Materials Ordered",status:"materials_ordered",previousStatus:"scheduled",nextStatus:"materials_arrived"},{title:"Materials Arrived",status:"materials_arrived",previousStatus:"materials_ordered",nextStatus:"frame_cut"},{title:"Frame Cut",status:"frame_cut",previousStatus:"materials_arrived",nextStatus:"mat_cut"},{title:"Mat Cut",status:"mat_cut",previousStatus:"frame_cut",nextStatus:"prepped"},{title:"Prepped",status:"prepped",previousStatus:"mat_cut",nextStatus:"completed"},{title:"Completed",status:"completed",previousStatus:"prepped"},{title:"Delayed",status:"delayed",previousStatus:"completed"}],m=g=>{if(!s)return console.log("No orders data available"),[];if(!Array.isArray(s))return console.log("Orders is not an array:",s),[];const f=s.filter(v=>v.productionStatus===g);return console.log(`Found ${f.length} orders with status ${g}`),f};if(r)return e.jsxs("div",{className:"p-4 bg-destructive/10 rounded-lg",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Error Loading Production Board"}),e.jsxs("p",{className:"text-muted-foreground",children:[e.jsx(At,{className:"inline-block h-4 w-4 mr-1 align-middle"}),r.message||"Failed to connect to database"]}),e.jsx("div",{className:"mt-4",children:e.jsxs(P,{onClick:()=>window.location.reload(),variant:"outline",children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"Retry Loading"]})}),e.jsx("div",{className:"mt-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"This error typically occurs when there are temporary database connection issues. You can try refreshing the page or checking your database connection."})})]});const x=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Production Kanban Board"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and track framing orders through each production stage"})]}),e.jsx("div",{children:e.jsxs(Bt,{children:[e.jsx(va,{asChild:!0,children:e.jsxs(P,{variant:"outline",children:[e.jsx(yi,{className:"h-4 w-4 mr-2"}),"How to Use"]})}),e.jsxs(Lt,{children:[e.jsxs(Vt,{children:[e.jsx(Ut,{children:"Using the Production Kanban Board"}),e.jsx(bs,{children:"A guide to managing your framing production workflow"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Moving Orders"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Use drag and drop to move cards between production stages, or use the 'Back' and 'Next' buttons."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Scheduling"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"New orders must be scheduled before they can enter production. Click 'Schedule' on orders in the first column to set an estimated completion date."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Customer Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatic notifications are sent to customers when orders change status. You can disable notifications for specific orders in the order details."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Daily Capacity"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"The system limits new production to 5 orders per day to ensure quality and predictable completion times."})]})]})]})]})})]}),t?e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("span",{className:"ml-2",children:"Loading production board..."})]}):e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:h.map(g=>e.jsx($M,{title:g.title,orders:m(g.status),previousStatus:g.previousStatus,nextStatus:g.nextStatus,updateOrderStatus:d,scheduleOrder:u,currentStatus:g.status},g.status))})]});return e.jsxs(pI,{backend:iR,children:[e.jsx(x,{}),i&&e.jsx(Bt,{open:!0,onOpenChange:()=>o(null),children:e.jsxs(Lt,{className:"max-w-4xl",children:[e.jsx(Vt,{children:e.jsx(Ut,{children:"Work Order"})}),e.jsx(Y4,{order:{id:i.id,orderNumber:i.orderNumber,customerName:i.customerName,artworkWidth:i.artworkWidth,artworkHeight:i.artworkHeight,artworkDescription:i.artworkDescription,artworkType:i.artworkType,frameName:i.frameName,matDescription:i.matDescription,glassType:i.glassType,specialServices:i.specialServices,dueDate:i.dueDate,status:i.status,total:i.total,createdAt:i.createdAt,artworkImage:i.artworkImage}})]})}),l&&e.jsx(Bt,{open:!0,onOpenChange:()=>c(null),children:e.jsxs(Lt,{className:"max-w-md",children:[e.jsx(Vt,{children:e.jsx(Ut,{children:"Send Payment Link"})}),e.jsx(FM,{order:{id:l.id,customerName:l.customerName,total:l.total,orderNumber:l.orderNumber},onSuccess:()=>c(null)})]})})]})}function VM(){const{orders:s=[],isLoading:t=!1,error:r=null,updateOrderStatus:n=()=>{},scheduleOrder:a=()=>{}}=_N()||{},[i,o]=p.useState(0);p.useEffect(()=>{console.log("ProductionPage loaded with orders:",s?s.length:0)},[s]);const l=()=>{o(c=>c+1),window.location.reload()};return e.jsx("div",{className:"container mx-auto py-4",children:r?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(hs,{variant:"destructive",className:"mb-4",children:[e.jsxs(Ys,{className:"flex items-center",children:[e.jsx(Nl,{className:"mr-2 h-5 w-5"}),"Database Connection Error"]}),e.jsxs(ps,{className:"flex flex-col gap-2",children:[e.jsx("p",{children:"There was a problem connecting to the database. This might be due to a temporary connection issue or server load."}),e.jsxs(P,{variant:"outline",className:"w-fit",onClick:l,children:[e.jsx(ir,{className:"mr-2 h-4 w-4"}),"Retry Connection"]})]})]}),e.jsxs("div",{className:"rounded-lg bg-muted/30 p-8 text-center",children:[e.jsx(At,{className:"h-12 w-12 mx-auto text-amber-500 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Production Kanban Temporarily Unavailable"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The production board cannot be displayed due to a database connection issue."}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"You can try accessing other parts of the application while we resolve this issue."})]})]}):e.jsx(BM,{})})}const X=Symbol.for("drizzle:entityKind");function Kt(s,t){if(!s||typeof s!="object")return!1;if(s instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,X))throw new Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(s).constructor;if(r)for(;r;){if(X in r&&r[X]===t[X])return!0;r=Object.getPrototypeOf(r)}return!1}var Zf;Zf=X;class ja{constructor(t,r){R(this,"name");R(this,"keyAsName");R(this,"primary");R(this,"notNull");R(this,"default");R(this,"defaultFn");R(this,"onUpdateFn");R(this,"hasDefault");R(this,"isUnique");R(this,"uniqueName");R(this,"uniqueType");R(this,"dataType");R(this,"columnType");R(this,"enumValues");R(this,"generated");R(this,"generatedIdentity");R(this,"config");this.table=t,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}mapFromDriverValue(t){return t}mapToDriverValue(t){return t}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}R(ja,Zf,"Column");var Yf;Yf=X;class w0{constructor(t,r,n){R(this,"config");R(this,"$default",this.$defaultFn);R(this,"$onUpdate",this.$onUpdateFn);this.config={name:t,keyAsName:t==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(t){return this.config.default=t,this.config.hasDefault=!0,this}$defaultFn(t){return this.config.defaultFn=t,this.config.hasDefault=!0,this}$onUpdateFn(t){return this.config.onUpdateFn=t,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(t){this.config.name===""&&(this.config.name=t)}}R(w0,Yf,"ColumnBuilder");const la=Symbol.for("drizzle:Name");var Xf;Xf=X;class N0{constructor(t,r){R(this,"reference");R(this,"_onUpdate","no action");R(this,"_onDelete","no action");this.reference=()=>{const{name:n,columns:a,foreignColumns:i}=t();return{name:n,columns:a,foreignTable:i[0].table,foreignColumns:i}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(t){return this._onUpdate=t===void 0?"no action":t,this}onDelete(t){return this._onDelete=t===void 0?"no action":t,this}build(t){return new S0(t,this)}}R(N0,Xf,"PgForeignKeyBuilder");var Jf;Jf=X;class S0{constructor(t,r){R(this,"reference");R(this,"onUpdate");R(this,"onDelete");this.table=t,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}getName(){const{name:t,columns:r,foreignColumns:n}=this.reference(),a=r.map(l=>l.name),i=n.map(l=>l.name),o=[this.table[la],...a,n[0].table[la],...i];return t??`${o.join("_")}_fk`}}R(S0,Jf,"PgForeignKey");function UM(s,...t){return s(...t)}function HM(s,t){return`${s[la]}_${t.join("_")}_unique`}function jp(s,t,r){for(let n=t;n<s.length;n++){const a=s[n];if(a==="\\"){n++;continue}if(a==='"')return[s.slice(t,n).replace(/\\/g,""),n+1];if(!r&&(a===","||a==="}"))return[s.slice(t,n).replace(/\\/g,""),n]}return[s.slice(t).replace(/\\/g,""),s.length]}function C0(s,t=0){const r=[];let n=t,a=!1;for(;n<s.length;){const i=s[n];if(i===","){(a||n===t)&&r.push(""),a=!0,n++;continue}if(a=!1,i==="\\"){n+=2;continue}if(i==='"'){const[c,d]=jp(s,n+1,!0);r.push(c),n=d;continue}if(i==="}")return[r,n+1];if(i==="{"){const[c,d]=C0(s,n+1);r.push(c),n=d;continue}const[o,l]=jp(s,n,!1);r.push(o),n=l}return[r,n]}function qM(s){const[t]=C0(s,1);return t}function k0(s){return`{${s.map(t=>Array.isArray(t)?k0(t):typeof t=="string"?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}var ex,tx;class et extends(tx=w0,ex=X,tx){constructor(){super(...arguments);R(this,"foreignKeyConfigs",[])}array(r){return new P0(this.config.name,this,r)}references(r,n={}){return this.foreignKeyConfigs.push({ref:r,actions:n}),this}unique(r,n){return this.config.isUnique=!0,this.config.uniqueName=r,this.config.uniqueType=n==null?void 0:n.nulls,this}generatedAlwaysAs(r){return this.config.generated={as:r,type:"always",mode:"stored"},this}buildForeignKeys(r,n){return this.foreignKeyConfigs.map(({ref:a,actions:i})=>UM((o,l)=>{const c=new N0(()=>{const d=o();return{columns:[r],foreignColumns:[d]}});return l.onUpdate&&c.onUpdate(l.onUpdate),l.onDelete&&c.onDelete(l.onDelete),c.build(n)},a,i))}buildExtraConfigColumn(r){return new T0(r,this.config)}}R(et,ex,"PgColumnBuilder");var sx,rx;class Ve extends(rx=ja,sx=X,rx){constructor(t,r){r.uniqueName||(r.uniqueName=HM(t,[r.name])),super(t,r),this.table=t}}R(Ve,sx,"PgColumn");var nx,ax;class T0 extends(ax=Ve,nx=X,ax){constructor(){super(...arguments);R(this,"indexConfig",{order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass});R(this,"defaultConfig",{order:"asc",nulls:"last",opClass:void 0})}getSQLType(){return this.getSQLType()}asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(r){return this.indexConfig.opClass=r,this}}R(T0,nx,"ExtraConfigColumn");var ix,ox;class P0 extends(ox=et,ix=X,ox){constructor(t,r,n){super(t,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(t){const r=this.config.baseBuilder.build(t);return new Dd(t,this.config,r)}}R(P0,ix,"PgArrayBuilder");var lx,cx;const xl=class xl extends(cx=Ve,lx=X,cx){constructor(r,n,a,i){super(r,n);R(this,"size");this.baseColumn=a,this.range=i,this.size=n.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(r){return typeof r=="string"&&(r=qM(r)),r.map(n=>this.baseColumn.mapFromDriverValue(n))}mapToDriverValue(r,n=!1){const a=r.map(i=>i===null?null:Kt(this.baseColumn,xl)?this.baseColumn.mapToDriverValue(i,!0):this.baseColumn.mapToDriverValue(i));return n?a:k0(a)}};R(xl,lx,"PgArray");let Dd=xl;const bp=Symbol.for("drizzle:isPgEnum");function zM(s){return!!s&&typeof s=="function"&&bp in s&&s[bp]===!0}var dx;dx=X;class Xu{constructor(t,r,n,a=!1){this._={brand:"Subquery",sql:t,selectedFields:r,alias:n,isWith:a}}}R(Xu,dx,"Subquery");const WM={startActiveSpan(s,t){return t()}},ca=Symbol.for("drizzle:ViewBaseConfig"),Ec=Symbol.for("drizzle:Schema"),wp=Symbol.for("drizzle:Columns"),Np=Symbol.for("drizzle:ExtraConfigColumns"),Dc=Symbol.for("drizzle:OriginalName"),Ac=Symbol.for("drizzle:BaseName"),Ko=Symbol.for("drizzle:IsAlias"),Sp=Symbol.for("drizzle:ExtraConfigBuilder"),E0=Symbol.for("drizzle:IsDrizzleTable");var ux,mx,hx,px,fx,xx,gx,vx,yx,jx;jx=X,yx=la,vx=Dc,gx=Ec,xx=wp,fx=Np,px=Ac,hx=Ko,mx=E0,ux=Sp;class is{constructor(t,r,n){R(this,yx);R(this,vx);R(this,gx);R(this,xx);R(this,fx);R(this,px);R(this,hx,!1);R(this,mx,!0);R(this,ux);this[la]=this[Dc]=t,this[Ec]=r,this[Ac]=n}}R(is,jx,"Table"),R(is,"Symbol",{Name:la,Schema:Ec,OriginalName:Dc,Columns:wp,ExtraConfigColumns:Np,BaseName:Ac,IsAlias:Ko,ExtraConfigBuilder:Sp});function D0(s){return typeof s=="object"&&s!==null&&E0 in s}function KM(s){return s!=null&&typeof s.getSQL=="function"}function GM(s){var r;const t={sql:"",params:[]};for(const n of s)t.sql+=n.sql,t.params.push(...n.params),(r=n.typings)!=null&&r.length&&(t.typings||(t.typings=[]),t.typings.push(...n.typings));return t}var bx;bx=X;class Rs{constructor(t){R(this,"value");this.value=Array.isArray(t)?t:[t]}getSQL(){return new Ft([this])}}R(Rs,bx,"StringChunk");var wx;wx=X;const fn=class fn{constructor(t){R(this,"decoder",A0);R(this,"shouldInlineParams",!1);this.queryChunks=t}append(t){return this.queryChunks.push(...t.queryChunks),this}toQuery(t){return WM.startActiveSpan("drizzle.buildSQL",r=>{const n=this.buildQueryFromSourceParams(this.queryChunks,t);return r==null||r.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(t,r){const n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:a,escapeName:i,escapeParam:o,prepareTyping:l,inlineParams:c,paramStartIndex:d}=n;return GM(t.map(u=>{var h;if(Kt(u,Rs))return{sql:u.value.join(""),params:[]};if(Kt(u,Go))return{sql:i(u.value),params:[]};if(u===void 0)return{sql:"",params:[]};if(Array.isArray(u)){const m=[new Rs("(")];for(const[x,g]of u.entries())m.push(g),x<u.length-1&&m.push(new Rs(", "));return m.push(new Rs(")")),this.buildQueryFromSourceParams(m,n)}if(Kt(u,fn))return this.buildQueryFromSourceParams(u.queryChunks,{...n,inlineParams:c||u.shouldInlineParams});if(Kt(u,is)){const m=u[is.Symbol.Schema],x=u[is.Symbol.Name];return{sql:m===void 0||u[Ko]?i(x):i(m)+"."+i(x),params:[]}}if(Kt(u,ja)){const m=a.getColumnCasing(u);if(r.invokeSource==="indexes")return{sql:i(m),params:[]};const x=u.table[is.Symbol.Schema];return{sql:u.table[Ko]||x===void 0?i(u.table[is.Symbol.Name])+"."+i(m):i(x)+"."+i(u.table[is.Symbol.Name])+"."+i(m),params:[]}}if(Kt(u,R0)){const m=u[ca].schema,x=u[ca].name;return{sql:m===void 0||u[ca].isAlias?i(x):i(m)+"."+i(x),params:[]}}if(Kt(u,Ju)){if(Kt(u.value,Zo))return{sql:o(d.value++,u),params:[u],typings:["none"]};const m=u.value===null?null:u.encoder.mapToDriverValue(u.value);if(Kt(m,fn))return this.buildQueryFromSourceParams([m],n);if(c)return{sql:this.mapInlineParam(m,n),params:[]};let x=["none"];return l&&(x=[l(u.encoder)]),{sql:o(d.value++,m),params:[m],typings:x}}return Kt(u,Zo)?{sql:o(d.value++,u),params:[u],typings:["none"]}:Kt(u,fn.Aliased)&&u.fieldAlias!==void 0?{sql:i(u.fieldAlias),params:[]}:Kt(u,Xu)?u._.isWith?{sql:i(u._.alias),params:[]}:this.buildQueryFromSourceParams([new Rs("("),u._.sql,new Rs(") "),new Go(u._.alias)],n):zM(u)?u.schema?{sql:i(u.schema)+"."+i(u.enumName),params:[]}:{sql:i(u.enumName),params:[]}:KM(u)?(h=u.shouldOmitSQLParens)!=null&&h.call(u)?this.buildQueryFromSourceParams([u.getSQL()],n):this.buildQueryFromSourceParams([new Rs("("),u.getSQL(),new Rs(")")],n):c?{sql:this.mapInlineParam(u,n),params:[]}:{sql:o(d.value++,u),params:[u],typings:["none"]}}))}mapInlineParam(t,{escapeString:r}){if(t===null)return"null";if(typeof t=="number"||typeof t=="boolean")return t.toString();if(typeof t=="string")return r(t);if(typeof t=="object"){const n=t.toString();return r(n==="[object Object]"?JSON.stringify(t):n)}throw new Error("Unexpected param value: "+t)}getSQL(){return this}as(t){return t===void 0?this:new fn.Aliased(this,t)}mapWith(t){return this.decoder=typeof t=="function"?{mapFromDriverValue:t}:t,this}inlineParams(){return this.shouldInlineParams=!0,this}if(t){return t?this:void 0}};R(fn,wx,"SQL");let Ft=fn;var Nx;Nx=X;class Go{constructor(t){R(this,"brand");this.value=t}getSQL(){return new Ft([this])}}R(Go,Nx,"Name");const A0={mapFromDriverValue:s=>s},_0={mapToDriverValue:s=>s};({...A0,..._0});var Sx;Sx=X;class Ju{constructor(t,r=_0){R(this,"brand");this.value=t,this.encoder=r}getSQL(){return new Ft([this])}}R(Ju,Sx,"Param");function Qo(s,...t){const r=[];(t.length>0||s.length>0&&s[0]!=="")&&r.push(new Rs(s[0]));for(const[n,a]of t.entries())r.push(a,new Rs(s[n+1]));return new Ft(r)}(s=>{function t(){return new Ft([])}s.empty=t;function r(c){return new Ft(c)}s.fromList=r;function n(c){return new Ft([new Rs(c)])}s.raw=n;function a(c,d){const u=[];for(const[h,m]of c.entries())h>0&&d!==void 0&&u.push(d),u.push(m);return new Ft(u)}s.join=a;function i(c){return new Go(c)}s.identifier=i;function o(c){return new Zo(c)}s.placeholder=o;function l(c,d){return new Ju(c,d)}s.param=l})(Qo||(Qo={}));(s=>{var r;r=X;const n=class n{constructor(i,o){R(this,"isSelectionField",!1);this.sql=i,this.fieldAlias=o}getSQL(){return this.sql}clone(){return new n(this.sql,this.fieldAlias)}};R(n,r,"SQL.Aliased");let t=n;s.Aliased=t})(Ft||(Ft={}));var Cx;Cx=X;class Zo{constructor(t){this.name=t}getSQL(){return new Ft([this])}}R(Zo,Cx,"Placeholder");const I0=Symbol.for("drizzle:IsDrizzleView");var kx,Tx,Px;Px=X,Tx=ca,kx=I0;class R0{constructor({name:t,schema:r,selectedFields:n,query:a}){R(this,Tx);R(this,kx,!0);this[ca]={name:t,originalName:t,schema:r,selectedFields:n,query:a,isExisting:!a,isAlias:!1}}getSQL(){return new Ft([this])}}R(R0,Px,"View");function QM(s){return typeof s=="object"&&s!==null&&I0 in s}ja.prototype.getSQL=function(){return new Ft([this])};is.prototype.getSQL=function(){return new Ft([this])};Xu.prototype.getSQL=function(){return new Ft([this])};function ZM(s){return s[is.Symbol.Columns]}function YM(s){return s[ca].selectedFields}function zt(s,t){return{name:typeof s=="string"&&s.length>0?s:"",config:typeof s=="object"?s:t}}var Ex,Dx;class Xi extends(Dx=et,Ex=X,Dx){generatedAlwaysAsIdentity(t){if(t){const{name:r,...n}=t;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(t){if(t){const{name:r,...n}=t;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}R(Xi,Ex,"PgIntColumnBaseBuilder");var Ax,_x;class M0 extends(_x=Xi,Ax=X,_x){constructor(t){super(t,"number","PgBigInt53")}build(t){return new O0(t,this.config)}}R(M0,Ax,"PgBigInt53Builder");var Ix,Rx;class O0 extends(Rx=Ve,Ix=X,Rx){getSQLType(){return"bigint"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}R(O0,Ix,"PgBigInt53");var Mx,Ox;class F0 extends(Ox=Xi,Mx=X,Ox){constructor(t){super(t,"bigint","PgBigInt64")}build(t){return new L0(t,this.config)}}R(F0,Mx,"PgBigInt64Builder");var Fx,Lx;class L0 extends(Lx=Ve,Fx=X,Lx){getSQLType(){return"bigint"}mapFromDriverValue(t){return BigInt(t)}}R(L0,Fx,"PgBigInt64");function XM(s,t){const{name:r,config:n}=zt(s,t);return n.mode==="number"?new M0(r):new F0(r)}var $x,Bx;class $0 extends(Bx=et,$x=X,Bx){constructor(t){super(t,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new B0(t,this.config)}}R($0,$x,"PgBigSerial53Builder");var Vx,Ux;class B0 extends(Ux=Ve,Vx=X,Ux){getSQLType(){return"bigserial"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}R(B0,Vx,"PgBigSerial53");var Hx,qx;class V0 extends(qx=et,Hx=X,qx){constructor(t){super(t,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(t){return new U0(t,this.config)}}R(V0,Hx,"PgBigSerial64Builder");var zx,Wx;class U0 extends(Wx=Ve,zx=X,Wx){getSQLType(){return"bigserial"}mapFromDriverValue(t){return BigInt(t)}}R(U0,zx,"PgBigSerial64");function JM(s,t){const{name:r,config:n}=zt(s,t);return n.mode==="number"?new $0(r):new V0(r)}var Kx,Gx;class H0 extends(Gx=et,Kx=X,Gx){constructor(t){super(t,"boolean","PgBoolean")}build(t){return new q0(t,this.config)}}R(H0,Kx,"PgBooleanBuilder");var Qx,Zx;class q0 extends(Zx=Ve,Qx=X,Zx){getSQLType(){return"boolean"}}R(q0,Qx,"PgBoolean");function Nt(s){return new H0(s??"")}var Yx,Xx;class z0 extends(Xx=et,Yx=X,Xx){constructor(t,r){super(t,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(t){return new W0(t,this.config)}}R(z0,Yx,"PgCharBuilder");var Jx,eg;class W0 extends(eg=Ve,Jx=X,eg){constructor(){super(...arguments);R(this,"length",this.config.length);R(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}R(W0,Jx,"PgChar");function eO(s,t={}){const{name:r,config:n}=zt(s,t);return new z0(r,n)}var tg,sg;class K0 extends(sg=et,tg=X,sg){constructor(t){super(t,"string","PgCidr")}build(t){return new G0(t,this.config)}}R(K0,tg,"PgCidrBuilder");var rg,ng;class G0 extends(ng=Ve,rg=X,ng){getSQLType(){return"cidr"}}R(G0,rg,"PgCidr");function tO(s){return new K0(s??"")}var ag,ig;class Q0 extends(ig=et,ag=X,ig){constructor(t,r,n){super(t,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(t){return new Z0(t,this.config)}}R(Q0,ag,"PgCustomColumnBuilder");var og,lg;class Z0 extends(lg=Ve,og=X,lg){constructor(r,n){super(r,n);R(this,"sqlName");R(this,"mapTo");R(this,"mapFrom");this.sqlName=n.customTypeParams.dataType(n.fieldConfig),this.mapTo=n.customTypeParams.toDriver,this.mapFrom=n.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(r){return typeof this.mapFrom=="function"?this.mapFrom(r):r}mapToDriverValue(r){return typeof this.mapTo=="function"?this.mapTo(r):r}}R(Z0,og,"PgCustomColumn");function sO(s){return(t,r)=>{const{name:n,config:a}=zt(t,r);return new Q0(n,a,s)}}var cg,dg;class $a extends(dg=et,cg=X,dg){defaultNow(){return this.default(Qo`now()`)}}R($a,cg,"PgDateColumnBaseBuilder");var ug,mg;class Y0 extends(mg=$a,ug=X,mg){constructor(t){super(t,"date","PgDate")}build(t){return new X0(t,this.config)}}R(Y0,ug,"PgDateBuilder");var hg,pg;class X0 extends(pg=Ve,hg=X,pg){getSQLType(){return"date"}mapFromDriverValue(t){return new Date(t)}mapToDriverValue(t){return t.toISOString()}}R(X0,hg,"PgDate");var fg,xg;class J0 extends(xg=$a,fg=X,xg){constructor(t){super(t,"string","PgDateString")}build(t){return new eS(t,this.config)}}R(J0,fg,"PgDateStringBuilder");var gg,vg;class eS extends(vg=Ve,gg=X,vg){getSQLType(){return"date"}}R(eS,gg,"PgDateString");function rO(s,t){const{name:r,config:n}=zt(s,t);return(n==null?void 0:n.mode)==="date"?new Y0(r):new J0(r)}var yg,jg;class tS extends(jg=et,yg=X,jg){constructor(t){super(t,"number","PgDoublePrecision")}build(t){return new sS(t,this.config)}}R(tS,yg,"PgDoublePrecisionBuilder");var bg,wg;class sS extends(wg=Ve,bg=X,wg){getSQLType(){return"double precision"}mapFromDriverValue(t){return typeof t=="string"?Number.parseFloat(t):t}}R(sS,bg,"PgDoublePrecision");function nO(s){return new tS(s??"")}var Ng,Sg;class rS extends(Sg=et,Ng=X,Sg){constructor(t){super(t,"string","PgInet")}build(t){return new nS(t,this.config)}}R(rS,Ng,"PgInetBuilder");var Cg,kg;class nS extends(kg=Ve,Cg=X,kg){getSQLType(){return"inet"}}R(nS,Cg,"PgInet");function aO(s){return new rS(s??"")}var Tg,Pg;class aS extends(Pg=Xi,Tg=X,Pg){constructor(t){super(t,"number","PgInteger")}build(t){return new iS(t,this.config)}}R(aS,Tg,"PgIntegerBuilder");var Eg,Dg;class iS extends(Dg=Ve,Eg=X,Dg){getSQLType(){return"integer"}mapFromDriverValue(t){return typeof t=="string"?Number.parseInt(t):t}}R(iS,Eg,"PgInteger");function Me(s){return new aS(s??"")}var Ag,_g;class oS extends(_g=et,Ag=X,_g){constructor(t,r){super(t,"string","PgInterval"),this.config.intervalConfig=r}build(t){return new lS(t,this.config)}}R(oS,Ag,"PgIntervalBuilder");var Ig,Rg;class lS extends(Rg=Ve,Ig=X,Rg){constructor(){super(...arguments);R(this,"fields",this.config.intervalConfig.fields);R(this,"precision",this.config.intervalConfig.precision)}getSQLType(){const r=this.fields?` ${this.fields}`:"",n=this.precision?`(${this.precision})`:"";return`interval${r}${n}`}}R(lS,Ig,"PgInterval");function iO(s,t={}){const{name:r,config:n}=zt(s,t);return new oS(r,n)}var Mg,Og;class cS extends(Og=et,Mg=X,Og){constructor(t){super(t,"json","PgJson")}build(t){return new dS(t,this.config)}}R(cS,Mg,"PgJsonBuilder");var Fg,Lg;class dS extends(Lg=Ve,Fg=X,Lg){constructor(t,r){super(t,r)}getSQLType(){return"json"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}R(dS,Fg,"PgJson");function oO(s){return new cS(s??"")}var $g,Bg;class uS extends(Bg=et,$g=X,Bg){constructor(t){super(t,"json","PgJsonb")}build(t){return new mS(t,this.config)}}R(uS,$g,"PgJsonbBuilder");var Vg,Ug;class mS extends(Ug=Ve,Vg=X,Ug){constructor(t,r){super(t,r)}getSQLType(){return"jsonb"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}R(mS,Vg,"PgJsonb");function Hr(s){return new uS(s??"")}var Hg,qg;class hS extends(qg=et,Hg=X,qg){constructor(t){super(t,"array","PgLine")}build(t){return new pS(t,this.config)}}R(hS,Hg,"PgLineBuilder");var zg,Wg;class pS extends(Wg=Ve,zg=X,Wg){getSQLType(){return"line"}mapFromDriverValue(t){const[r,n,a]=t.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(a)]}mapToDriverValue(t){return`{${t[0]},${t[1]},${t[2]}}`}}R(pS,zg,"PgLine");var Kg,Gg;class fS extends(Gg=et,Kg=X,Gg){constructor(t){super(t,"json","PgLineABC")}build(t){return new xS(t,this.config)}}R(fS,Kg,"PgLineABCBuilder");var Qg,Zg;class xS extends(Zg=Ve,Qg=X,Zg){getSQLType(){return"line"}mapFromDriverValue(t){const[r,n,a]=t.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(a)}}mapToDriverValue(t){return`{${t.a},${t.b},${t.c}}`}}R(xS,Qg,"PgLineABC");function lO(s,t){const{name:r,config:n}=zt(s,t);return!(n!=null&&n.mode)||n.mode==="tuple"?new hS(r):new fS(r)}var Yg,Xg;class gS extends(Xg=et,Yg=X,Xg){constructor(t){super(t,"string","PgMacaddr")}build(t){return new vS(t,this.config)}}R(gS,Yg,"PgMacaddrBuilder");var Jg,ev;class vS extends(ev=Ve,Jg=X,ev){getSQLType(){return"macaddr"}}R(vS,Jg,"PgMacaddr");function cO(s){return new gS(s??"")}var tv,sv;class yS extends(sv=et,tv=X,sv){constructor(t){super(t,"string","PgMacaddr8")}build(t){return new jS(t,this.config)}}R(yS,tv,"PgMacaddr8Builder");var rv,nv;class jS extends(nv=Ve,rv=X,nv){getSQLType(){return"macaddr8"}}R(jS,rv,"PgMacaddr8");function dO(s){return new yS(s??"")}var av,iv;class bS extends(iv=et,av=X,iv){constructor(t,r,n){super(t,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(t){return new wS(t,this.config)}}R(bS,av,"PgNumericBuilder");var ov,lv;class wS extends(lv=Ve,ov=X,lv){constructor(r,n){super(r,n);R(this,"precision");R(this,"scale");this.precision=n.precision,this.scale=n.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}R(wS,ov,"PgNumeric");function Te(s,t){const{name:r,config:n}=zt(s,t);return new bS(r,n==null?void 0:n.precision,n==null?void 0:n.scale)}var cv,dv;class NS extends(dv=et,cv=X,dv){constructor(t){super(t,"array","PgPointTuple")}build(t){return new SS(t,this.config)}}R(NS,cv,"PgPointTupleBuilder");var uv,mv;class SS extends(mv=Ve,uv=X,mv){getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[r,n]=t.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[t.x,t.y]}mapToDriverValue(t){return`(${t[0]},${t[1]})`}}R(SS,uv,"PgPointTuple");var hv,pv;class CS extends(pv=et,hv=X,pv){constructor(t){super(t,"json","PgPointObject")}build(t){return new kS(t,this.config)}}R(CS,hv,"PgPointObjectBuilder");var fv,xv;class kS extends(xv=Ve,fv=X,xv){getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[r,n]=t.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return t}mapToDriverValue(t){return`(${t.x},${t.y})`}}R(kS,fv,"PgPointObject");function uO(s,t){const{name:r,config:n}=zt(s,t);return!(n!=null&&n.mode)||n.mode==="tuple"?new NS(r):new CS(r)}function mO(s){const t=[];for(let r=0;r<s.length;r+=2)t.push(Number.parseInt(s.slice(r,r+2),16));return new Uint8Array(t)}function Cp(s,t){const r=new ArrayBuffer(8),n=new DataView(r);for(let a=0;a<8;a++)n.setUint8(a,s[t+a]);return n.getFloat64(0,!0)}function TS(s){const t=mO(s);let r=0;const n=t[r];r+=1;const a=new DataView(t.buffer),i=a.getUint32(r,n===1);if(r+=4,i&536870912&&(a.getUint32(r,n===1),r+=4),(i&65535)===1){const o=Cp(t,r);r+=8;const l=Cp(t,r);return r+=8,[o,l]}throw new Error("Unsupported geometry type")}var gv,vv;class PS extends(vv=et,gv=X,vv){constructor(t){super(t,"array","PgGeometry")}build(t){return new ES(t,this.config)}}R(PS,gv,"PgGeometryBuilder");var yv,jv;class ES extends(jv=Ve,yv=X,jv){getSQLType(){return"geometry(point)"}mapFromDriverValue(t){return TS(t)}mapToDriverValue(t){return`point(${t[0]} ${t[1]})`}}R(ES,yv,"PgGeometry");var bv,wv;class DS extends(wv=et,bv=X,wv){constructor(t){super(t,"json","PgGeometryObject")}build(t){return new AS(t,this.config)}}R(DS,bv,"PgGeometryObjectBuilder");var Nv,Sv;class AS extends(Sv=Ve,Nv=X,Sv){getSQLType(){return"geometry(point)"}mapFromDriverValue(t){const r=TS(t);return{x:r[0],y:r[1]}}mapToDriverValue(t){return`point(${t.x} ${t.y})`}}R(AS,Nv,"PgGeometryObject");function hO(s,t){const{name:r,config:n}=zt(s,t);return!(n!=null&&n.mode)||n.mode==="tuple"?new PS(r):new DS(r)}var Cv,kv;class _S extends(kv=et,Cv=X,kv){constructor(t,r){super(t,"number","PgReal"),this.config.length=r}build(t){return new IS(t,this.config)}}R(_S,Cv,"PgRealBuilder");var Tv,Pv;class IS extends(Pv=Ve,Tv=X,Pv){constructor(r,n){super(r,n);R(this,"mapFromDriverValue",r=>typeof r=="string"?Number.parseFloat(r):r)}getSQLType(){return"real"}}R(IS,Tv,"PgReal");function pO(s){return new _S(s??"")}var Ev,Dv;class RS extends(Dv=et,Ev=X,Dv){constructor(t){super(t,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new MS(t,this.config)}}R(RS,Ev,"PgSerialBuilder");var Av,_v;class MS extends(_v=Ve,Av=X,_v){getSQLType(){return"serial"}}R(MS,Av,"PgSerial");function ft(s){return new RS(s??"")}var Iv,Rv;class OS extends(Rv=Xi,Iv=X,Rv){constructor(t){super(t,"number","PgSmallInt")}build(t){return new FS(t,this.config)}}R(OS,Iv,"PgSmallIntBuilder");var Mv,Ov;class FS extends(Ov=Ve,Mv=X,Ov){constructor(){super(...arguments);R(this,"mapFromDriverValue",r=>typeof r=="string"?Number(r):r)}getSQLType(){return"smallint"}}R(FS,Mv,"PgSmallInt");function fO(s){return new OS(s??"")}var Fv,Lv;class LS extends(Lv=et,Fv=X,Lv){constructor(t){super(t,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new $S(t,this.config)}}R(LS,Fv,"PgSmallSerialBuilder");var $v,Bv;class $S extends(Bv=Ve,$v=X,Bv){getSQLType(){return"smallserial"}}R($S,$v,"PgSmallSerial");function xO(s){return new LS(s??"")}var Vv,Uv;class BS extends(Uv=et,Vv=X,Uv){constructor(t,r){super(t,"string","PgText"),this.config.enumValues=r.enum}build(t){return new VS(t,this.config)}}R(BS,Vv,"PgTextBuilder");var Hv,qv;class VS extends(qv=Ve,Hv=X,qv){constructor(){super(...arguments);R(this,"enumValues",this.config.enumValues)}getSQLType(){return"text"}}R(VS,Hv,"PgText");function L(s,t={}){const{name:r,config:n}=zt(s,t);return new BS(r,n)}var zv,Wv;class US extends(Wv=$a,zv=X,Wv){constructor(t,r,n){super(t,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}build(t){return new HS(t,this.config)}}R(US,zv,"PgTimeBuilder");var Kv,Gv;class HS extends(Gv=Ve,Kv=X,Gv){constructor(r,n){super(r,n);R(this,"withTimezone");R(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}R(HS,Kv,"PgTime");function gO(s,t={}){const{name:r,config:n}=zt(s,t);return new US(r,n.withTimezone??!1,n.precision)}var Qv,Zv;class qS extends(Zv=$a,Qv=X,Zv){constructor(t,r,n){super(t,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(t){return new zS(t,this.config)}}R(qS,Qv,"PgTimestampBuilder");var Yv,Xv;class zS extends(Xv=Ve,Yv=X,Xv){constructor(r,n){super(r,n);R(this,"withTimezone");R(this,"precision");R(this,"mapFromDriverValue",r=>new Date(this.withTimezone?r:r+"+0000"));R(this,"mapToDriverValue",r=>r.toISOString());this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}}R(zS,Yv,"PgTimestamp");var Jv,ey;class WS extends(ey=$a,Jv=X,ey){constructor(t,r,n){super(t,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(t){return new KS(t,this.config)}}R(WS,Jv,"PgTimestampStringBuilder");var ty,sy;class KS extends(sy=Ve,ty=X,sy){constructor(r,n){super(r,n);R(this,"withTimezone");R(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}R(KS,ty,"PgTimestampString");function _e(s,t={}){const{name:r,config:n}=zt(s,t);return(n==null?void 0:n.mode)==="string"?new WS(r,n.withTimezone??!1,n.precision):new qS(r,(n==null?void 0:n.withTimezone)??!1,n==null?void 0:n.precision)}var ry,ny;class GS extends(ny=et,ry=X,ny){constructor(t){super(t,"string","PgUUID")}defaultRandom(){return this.default(Qo`gen_random_uuid()`)}build(t){return new QS(t,this.config)}}R(GS,ry,"PgUUIDBuilder");var ay,iy;class QS extends(iy=Ve,ay=X,iy){getSQLType(){return"uuid"}}R(QS,ay,"PgUUID");function vO(s){return new GS(s??"")}var oy,ly;class ZS extends(ly=et,oy=X,ly){constructor(t,r){super(t,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(t){return new YS(t,this.config)}}R(ZS,oy,"PgVarcharBuilder");var cy,dy;class YS extends(dy=Ve,cy=X,dy){constructor(){super(...arguments);R(this,"length",this.config.length);R(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}R(YS,cy,"PgVarchar");function yO(s,t={}){const{name:r,config:n}=zt(s,t);return new ZS(r,n)}var uy,my;class XS extends(my=et,uy=X,my){constructor(t,r){super(t,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(t){return new JS(t,this.config)}}R(XS,uy,"PgBinaryVectorBuilder");var hy,py;class JS extends(py=Ve,hy=X,py){constructor(){super(...arguments);R(this,"dimensions",this.config.dimensions)}getSQLType(){return`bit(${this.dimensions})`}}R(JS,hy,"PgBinaryVector");function jO(s,t){const{name:r,config:n}=zt(s,t);return new XS(r,n)}var fy,xy;class eC extends(xy=et,fy=X,xy){constructor(t,r){super(t,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(t){return new tC(t,this.config)}}R(eC,fy,"PgHalfVectorBuilder");var gy,vy;class tC extends(vy=Ve,gy=X,vy){constructor(){super(...arguments);R(this,"dimensions",this.config.dimensions)}getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}R(tC,gy,"PgHalfVector");function bO(s,t){const{name:r,config:n}=zt(s,t);return new eC(r,n)}var yy,jy;class sC extends(jy=et,yy=X,jy){constructor(t,r){super(t,"string","PgSparseVector"),this.config.dimensions=r.dimensions}build(t){return new rC(t,this.config)}}R(sC,yy,"PgSparseVectorBuilder");var by,wy;class rC extends(wy=Ve,by=X,wy){constructor(){super(...arguments);R(this,"dimensions",this.config.dimensions)}getSQLType(){return`sparsevec(${this.dimensions})`}}R(rC,by,"PgSparseVector");function wO(s,t){const{name:r,config:n}=zt(s,t);return new sC(r,n)}var Ny,Sy;class nC extends(Sy=et,Ny=X,Sy){constructor(t,r){super(t,"array","PgVector"),this.config.dimensions=r.dimensions}build(t){return new aC(t,this.config)}}R(nC,Ny,"PgVectorBuilder");var Cy,ky;class aC extends(ky=Ve,Cy=X,ky){constructor(){super(...arguments);R(this,"dimensions",this.config.dimensions)}getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}R(aC,Cy,"PgVector");function NO(s,t){const{name:r,config:n}=zt(s,t);return new nC(r,n)}function SO(){return{bigint:XM,bigserial:JM,boolean:Nt,char:eO,cidr:tO,customType:sO,date:rO,doublePrecision:nO,inet:aO,integer:Me,interval:iO,json:oO,jsonb:Hr,line:lO,macaddr:cO,macaddr8:dO,numeric:Te,point:uO,geometry:hO,real:pO,serial:ft,smallint:fO,smallserial:xO,text:L,time:gO,timestamp:_e,uuid:vO,varchar:yO,bit:jO,halfvec:bO,sparsevec:wO,vector:NO}}const Ad=Symbol.for("drizzle:PgInlineForeignKeys"),kp=Symbol.for("drizzle:EnableRLS");var Ty,Py,Ey,Dy,Ay;class da extends(Ay=is,Dy=X,Ey=Ad,Py=kp,Ty=is.Symbol.ExtraConfigBuilder,Ay){constructor(){super(...arguments);R(this,Ey,[]);R(this,Py,!1);R(this,Ty)}}R(da,Dy,"PgTable"),R(da,"Symbol",Object.assign({},is.Symbol,{InlineForeignKeys:Ad,EnableRLS:kp}));function CO(s,t,r,n,a=s){const i=new da(s,n,a),o=typeof t=="function"?t(SO()):t,l=Object.fromEntries(Object.entries(o).map(([u,h])=>{const m=h;m.setName(u);const x=m.build(i);return i[Ad].push(...m.buildForeignKeys(x,i)),[u,x]})),c=Object.fromEntries(Object.entries(o).map(([u,h])=>{const m=h;m.setName(u);const x=m.buildExtraConfigColumn(i);return[u,x]})),d=Object.assign(i,l);return d[is.Symbol.Columns]=l,d[is.Symbol.ExtraConfigColumns]=c,r&&(d[da.Symbol.ExtraConfigBuilder]=r),Object.assign(d,{enableRLS:()=>(d[da.Symbol.EnableRLS]=!0,d)})}const at=(s,t,r)=>CO(s,t,r,void 0);function kO(...s){return s[0].columns?new _d(s[0].columns,s[0].name):new _d(s)}var _y;_y=X;class _d{constructor(t,r){R(this,"columns");R(this,"name");this.columns=t,this.name=r}build(t){return new iC(t,this.columns,this.name)}}R(_d,_y,"PgPrimaryKeyBuilder");var Iy;Iy=X;class iC{constructor(t,r,n){R(this,"columns");R(this,"name");this.table=t,this.columns=r,this.name=n}getName(){return this.name??`${this.table[da.Symbol.Name]}_${this.columns.map(t=>t.name).join("_")}_pk`}}R(iC,Iy,"PgPrimaryKey");var Je;(function(s){s.assertEqual=a=>a;function t(a){}s.assertIs=t;function r(a){throw new Error}s.assertNever=r,s.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},s.getValidEnumValues=a=>{const i=s.objectKeys(a).filter(l=>typeof a[a[l]]!="number"),o={};for(const l of i)o[l]=a[l];return s.objectValues(o)},s.objectValues=a=>s.objectKeys(a).map(function(i){return a[i]}),s.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},s.find=(a,i)=>{for(const o of a)if(i(o))return o},s.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function n(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}s.joinValues=n,s.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Je||(Je={}));var Id;(function(s){s.mergeShapes=(t,r)=>({...t,...r})})(Id||(Id={}));const xe=Je.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Mr=s=>{switch(typeof s){case"undefined":return xe.undefined;case"string":return xe.string;case"number":return isNaN(s)?xe.nan:xe.number;case"boolean":return xe.boolean;case"function":return xe.function;case"bigint":return xe.bigint;case"symbol":return xe.symbol;case"object":return Array.isArray(s)?xe.array:s===null?xe.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?xe.promise:typeof Map<"u"&&s instanceof Map?xe.map:typeof Set<"u"&&s instanceof Set?xe.set:typeof Date<"u"&&s instanceof Date?xe.date:xe.object;default:return xe.unknown}},re=Je.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),TO=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:");class Ns extends Error{constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){const r=t||function(i){return i.message},n={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)n._errors.push(r(o));else{let l=n,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(r(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return a(this),n}static assert(t){if(!(t instanceof Ns))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Je.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Ns.create=s=>new Ns(s);const ba=(s,t)=>{let r;switch(s.code){case re.invalid_type:s.received===xe.undefined?r="Required":r=`Expected ${s.expected}, received ${s.received}`;break;case re.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,Je.jsonStringifyReplacer)}`;break;case re.unrecognized_keys:r=`Unrecognized key(s) in object: ${Je.joinValues(s.keys,", ")}`;break;case re.invalid_union:r="Invalid input";break;case re.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Je.joinValues(s.options)}`;break;case re.invalid_enum_value:r=`Invalid enum value. Expected ${Je.joinValues(s.options)}, received '${s.received}'`;break;case re.invalid_arguments:r="Invalid function arguments";break;case re.invalid_return_type:r="Invalid function return type";break;case re.invalid_date:r="Invalid date";break;case re.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:Je.assertNever(s.validation):s.validation!=="regex"?r=`Invalid ${s.validation}`:r="Invalid";break;case re.too_small:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:r="Invalid input";break;case re.too_big:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?r=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:r="Invalid input";break;case re.custom:r="Invalid input";break;case re.invalid_intersection_types:r="Intersection results could not be merged";break;case re.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case re.not_finite:r="Number must be finite";break;default:r=t.defaultError,Je.assertNever(s)}return{message:r}};let oC=ba;function PO(s){oC=s}function Yo(){return oC}const Xo=s=>{const{data:t,path:r,errorMaps:n,issueData:a}=s,i=[...r,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let l="";const c=n.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:t,defaultError:l}).message;return{...a,path:i,message:l}},EO=[];function pe(s,t){const r=Yo(),n=Xo({issueData:t,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===ba?void 0:ba].filter(a=>!!a)});s.common.issues.push(n)}class ss{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const a of r){if(a.status==="aborted")return Re;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const a of r){const i=await a.key,o=await a.value;n.push({key:i,value:o})}return ss.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const a of r){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return Re;i.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(n[i.value]=o.value)}return{status:t.value,value:n}}}const Re=Object.freeze({status:"aborted"}),Xn=s=>({status:"dirty",value:s}),cs=s=>({status:"valid",value:s}),Rd=s=>s.status==="aborted",Md=s=>s.status==="dirty",wi=s=>s.status==="valid",Ni=s=>typeof Promise<"u"&&s instanceof Promise;function Jo(s,t,r,n){if(typeof t=="function"?s!==t||!n:!t.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(s)}function lC(s,t,r,n,a){if(typeof t=="function"?s!==t||!a:!t.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(s,r),r}var we;(function(s){s.errToObj=t=>typeof t=="string"?{message:t}:t||{},s.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(we||(we={}));var ei,ti;class ur{constructor(t,r,n,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Tp=(s,t)=>{if(wi(t))return{success:!0,data:t.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Ns(s.common.issues);return this._error=r,this._error}}};function $e(s){if(!s)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=s;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(o,l)=>{var c,d;const{message:u}=s;return o.code==="invalid_enum_value"?{message:u??l.defaultError}:typeof l.data>"u"?{message:(c=u??n)!==null&&c!==void 0?c:l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:(d=u??r)!==null&&d!==void 0?d:l.defaultError}},description:a}}class ze{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return Mr(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Mr(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ss,ctx:{common:t.parent.common,data:t.data,parsedType:Mr(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(Ni(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const a={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Mr(t)},i=this._parseSync({data:t,path:a.path,parent:a});return Tp(a,i)}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Mr(t)},a=this._parse({data:t,path:n.path,parent:n}),i=await(Ni(a)?a:Promise.resolve(a));return Tp(n,i)}refine(t,r){const n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,i)=>{const o=t(a),l=()=>i.addIssue({code:re.custom,...n(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(t,r){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(t){return new Xs({schema:this,typeName:Ie.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return or.create(this,this._def)}nullable(){return Kr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ks.create(this,this._def)}promise(){return Na.create(this,this._def)}or(t){return Ti.create([this,t],this._def)}and(t){return Pi.create(this,t,this._def)}transform(t){return new Xs({...$e(this._def),schema:this,typeName:Ie.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new Ii({...$e(this._def),innerType:this,defaultValue:r,typeName:Ie.ZodDefault})}brand(){return new em({typeName:Ie.ZodBranded,type:this,...$e(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new Ri({...$e(this._def),innerType:this,catchValue:r,typeName:Ie.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return Ji.create(this,t)}readonly(){return Mi.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const DO=/^c[^\s-]{8,}$/i,AO=/^[0-9a-z]+$/,_O=/^[0-9A-HJKMNP-TV-Z]{26}$/,IO=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,RO=/^[a-z0-9_-]{21}$/i,MO=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,OO=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,FO="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let _c;const LO=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,$O=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,BO=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,cC="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",VO=new RegExp(`^${cC}$`);function dC(s){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return s.precision?t=`${t}\\.\\d{${s.precision}}`:s.precision==null&&(t=`${t}(\\.\\d+)?`),t}function UO(s){return new RegExp(`^${dC(s)}$`)}function uC(s){let t=`${cC}T${dC(s)}`;const r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function HO(s,t){return!!((t==="v4"||!t)&&LO.test(s)||(t==="v6"||!t)&&$O.test(s))}class Ws extends ze{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==xe.string){const i=this._getOrReturnCtx(t);return pe(i,{code:re.invalid_type,expected:xe.string,received:i.parsedType}),Re}const n=new ss;let a;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(a=this._getOrReturnCtx(t,a),pe(a,{code:re.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(a=this._getOrReturnCtx(t,a),pe(a,{code:re.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const o=t.data.length>i.value,l=t.data.length<i.value;(o||l)&&(a=this._getOrReturnCtx(t,a),o?pe(a,{code:re.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&pe(a,{code:re.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")OO.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"email",code:re.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")_c||(_c=new RegExp(FO,"u")),_c.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"emoji",code:re.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")IO.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"uuid",code:re.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")RO.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"nanoid",code:re.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")DO.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"cuid",code:re.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")AO.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"cuid2",code:re.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")_O.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"ulid",code:re.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),pe(a,{validation:"url",code:re.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"regex",code:re.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(t,a),pe(a,{code:re.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(a=this._getOrReturnCtx(t,a),pe(a,{code:re.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(a=this._getOrReturnCtx(t,a),pe(a,{code:re.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?uC(i).test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{code:re.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?VO.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{code:re.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?UO(i).test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{code:re.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?MO.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"duration",code:re.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?HO(t.data,i.version)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"ip",code:re.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?BO.test(t.data)||(a=this._getOrReturnCtx(t,a),pe(a,{validation:"base64",code:re.invalid_string,message:i.message}),n.dirty()):Je.assertNever(i);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(a=>t.test(a),{validation:r,code:re.invalid_string,...we.errToObj(n)})}_addCheck(t){return new Ws({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...we.errToObj(t)})}url(t){return this._addCheck({kind:"url",...we.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...we.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...we.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...we.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...we.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...we.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...we.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...we.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...we.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...we.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...we.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...we.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...we.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...we.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...we.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...we.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...we.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...we.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...we.errToObj(r)})}nonempty(t){return this.min(1,we.errToObj(t))}trim(){return new Ws({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ws({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ws({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Ws.create=s=>{var t;return new Ws({checks:[],typeName:Ie.ZodString,coerce:(t=s==null?void 0:s.coerce)!==null&&t!==void 0?t:!1,...$e(s)})};function qO(s,t){const r=(s.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,i=parseInt(s.toFixed(a).replace(".","")),o=parseInt(t.toFixed(a).replace(".",""));return i%o/Math.pow(10,a)}class qr extends ze{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==xe.number){const i=this._getOrReturnCtx(t);return pe(i,{code:re.invalid_type,expected:xe.number,received:i.parsedType}),Re}let n;const a=new ss;for(const i of this._def.checks)i.kind==="int"?Je.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),pe(n,{code:re.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:re.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:re.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?qO(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),pe(n,{code:re.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),pe(n,{code:re.not_finite,message:i.message}),a.dirty()):Je.assertNever(i);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,we.toString(r))}gt(t,r){return this.setLimit("min",t,!1,we.toString(r))}lte(t,r){return this.setLimit("max",t,!0,we.toString(r))}lt(t,r){return this.setLimit("max",t,!1,we.toString(r))}setLimit(t,r,n,a){return new qr({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:we.toString(a)}]})}_addCheck(t){return new qr({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:we.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:we.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:we.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:we.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:we.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:we.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:we.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:we.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:we.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Je.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}qr.create=s=>new qr({checks:[],typeName:Ie.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...$e(s)});class zr extends ze{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==xe.bigint){const i=this._getOrReturnCtx(t);return pe(i,{code:re.invalid_type,expected:xe.bigint,received:i.parsedType}),Re}let n;const a=new ss;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:re.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:re.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:re.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Je.assertNever(i);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,we.toString(r))}gt(t,r){return this.setLimit("min",t,!1,we.toString(r))}lte(t,r){return this.setLimit("max",t,!0,we.toString(r))}lt(t,r){return this.setLimit("max",t,!1,we.toString(r))}setLimit(t,r,n,a){return new zr({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:we.toString(a)}]})}_addCheck(t){return new zr({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:we.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:we.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:we.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:we.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:we.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}zr.create=s=>{var t;return new zr({checks:[],typeName:Ie.ZodBigInt,coerce:(t=s==null?void 0:s.coerce)!==null&&t!==void 0?t:!1,...$e(s)})};class Si extends ze{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==xe.boolean){const n=this._getOrReturnCtx(t);return pe(n,{code:re.invalid_type,expected:xe.boolean,received:n.parsedType}),Re}return cs(t.data)}}Si.create=s=>new Si({typeName:Ie.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...$e(s)});class On extends ze{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==xe.date){const i=this._getOrReturnCtx(t);return pe(i,{code:re.invalid_type,expected:xe.date,received:i.parsedType}),Re}if(isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return pe(i,{code:re.invalid_date}),Re}const n=new ss;let a;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(a=this._getOrReturnCtx(t,a),pe(a,{code:re.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(a=this._getOrReturnCtx(t,a),pe(a,{code:re.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Je.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new On({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:we.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:we.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}On.create=s=>new On({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:Ie.ZodDate,...$e(s)});class el extends ze{_parse(t){if(this._getType(t)!==xe.symbol){const n=this._getOrReturnCtx(t);return pe(n,{code:re.invalid_type,expected:xe.symbol,received:n.parsedType}),Re}return cs(t.data)}}el.create=s=>new el({typeName:Ie.ZodSymbol,...$e(s)});class Ci extends ze{_parse(t){if(this._getType(t)!==xe.undefined){const n=this._getOrReturnCtx(t);return pe(n,{code:re.invalid_type,expected:xe.undefined,received:n.parsedType}),Re}return cs(t.data)}}Ci.create=s=>new Ci({typeName:Ie.ZodUndefined,...$e(s)});class ki extends ze{_parse(t){if(this._getType(t)!==xe.null){const n=this._getOrReturnCtx(t);return pe(n,{code:re.invalid_type,expected:xe.null,received:n.parsedType}),Re}return cs(t.data)}}ki.create=s=>new ki({typeName:Ie.ZodNull,...$e(s)});class wa extends ze{constructor(){super(...arguments),this._any=!0}_parse(t){return cs(t.data)}}wa.create=s=>new wa({typeName:Ie.ZodAny,...$e(s)});class Pn extends ze{constructor(){super(...arguments),this._unknown=!0}_parse(t){return cs(t.data)}}Pn.create=s=>new Pn({typeName:Ie.ZodUnknown,...$e(s)});class Cr extends ze{_parse(t){const r=this._getOrReturnCtx(t);return pe(r,{code:re.invalid_type,expected:xe.never,received:r.parsedType}),Re}}Cr.create=s=>new Cr({typeName:Ie.ZodNever,...$e(s)});class tl extends ze{_parse(t){if(this._getType(t)!==xe.undefined){const n=this._getOrReturnCtx(t);return pe(n,{code:re.invalid_type,expected:xe.void,received:n.parsedType}),Re}return cs(t.data)}}tl.create=s=>new tl({typeName:Ie.ZodVoid,...$e(s)});class Ks extends ze{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),a=this._def;if(r.parsedType!==xe.array)return pe(r,{code:re.invalid_type,expected:xe.array,received:r.parsedType}),Re;if(a.exactLength!==null){const o=r.data.length>a.exactLength.value,l=r.data.length<a.exactLength.value;(o||l)&&(pe(r,{code:o?re.too_big:re.too_small,minimum:l?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(pe(r,{code:re.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(pe(r,{code:re.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((o,l)=>a.type._parseAsync(new ur(r,o,r.path,l)))).then(o=>ss.mergeArray(n,o));const i=[...r.data].map((o,l)=>a.type._parseSync(new ur(r,o,r.path,l)));return ss.mergeArray(n,i)}get element(){return this._def.type}min(t,r){return new Ks({...this._def,minLength:{value:t,message:we.toString(r)}})}max(t,r){return new Ks({...this._def,maxLength:{value:t,message:we.toString(r)}})}length(t,r){return new Ks({...this._def,exactLength:{value:t,message:we.toString(r)}})}nonempty(t){return this.min(1,t)}}Ks.create=(s,t)=>new Ks({type:s,minLength:null,maxLength:null,exactLength:null,typeName:Ie.ZodArray,...$e(t)});function Gn(s){if(s instanceof wt){const t={};for(const r in s.shape){const n=s.shape[r];t[r]=or.create(Gn(n))}return new wt({...s._def,shape:()=>t})}else return s instanceof Ks?new Ks({...s._def,type:Gn(s.element)}):s instanceof or?or.create(Gn(s.unwrap())):s instanceof Kr?Kr.create(Gn(s.unwrap())):s instanceof mr?mr.create(s.items.map(t=>Gn(t))):s}class wt extends ze{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Je.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==xe.object){const d=this._getOrReturnCtx(t);return pe(d,{code:re.invalid_type,expected:xe.object,received:d.parsedType}),Re}const{status:n,ctx:a}=this._processInputParams(t),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof Cr&&this._def.unknownKeys==="strip"))for(const d in a.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const u=i[d],h=a.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new ur(a,h,a.path,d)),alwaysSet:d in a.data})}if(this._def.catchall instanceof Cr){const d=this._def.unknownKeys;if(d==="passthrough")for(const u of l)c.push({key:{status:"valid",value:u},value:{status:"valid",value:a.data[u]}});else if(d==="strict")l.length>0&&(pe(a,{code:re.unrecognized_keys,keys:l}),n.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const u of l){const h=a.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new ur(a,h,a.path,u)),alwaysSet:u in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const d=[];for(const u of c){const h=await u.key,m=await u.value;d.push({key:h,value:m,alwaysSet:u.alwaysSet})}return d}).then(d=>ss.mergeObjectSync(n,d)):ss.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(t){return we.errToObj,new wt({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var a,i,o,l;const c=(o=(i=(a=this._def).errorMap)===null||i===void 0?void 0:i.call(a,r,n).message)!==null&&o!==void 0?o:n.defaultError;return r.code==="unrecognized_keys"?{message:(l=we.errToObj(t).message)!==null&&l!==void 0?l:c}:{message:c}}}:{}})}strip(){return new wt({...this._def,unknownKeys:"strip"})}passthrough(){return new wt({...this._def,unknownKeys:"passthrough"})}extend(t){return new wt({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new wt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Ie.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new wt({...this._def,catchall:t})}pick(t){const r={};return Je.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new wt({...this._def,shape:()=>r})}omit(t){const r={};return Je.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new wt({...this._def,shape:()=>r})}deepPartial(){return Gn(this)}partial(t){const r={};return Je.objectKeys(this.shape).forEach(n=>{const a=this.shape[n];t&&!t[n]?r[n]=a:r[n]=a.optional()}),new wt({...this._def,shape:()=>r})}required(t){const r={};return Je.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof or;)i=i._def.innerType;r[n]=i}}),new wt({...this._def,shape:()=>r})}keyof(){return mC(Je.objectKeys(this.shape))}}wt.create=(s,t)=>new wt({shape:()=>s,unknownKeys:"strip",catchall:Cr.create(),typeName:Ie.ZodObject,...$e(t)});wt.strictCreate=(s,t)=>new wt({shape:()=>s,unknownKeys:"strict",catchall:Cr.create(),typeName:Ie.ZodObject,...$e(t)});wt.lazycreate=(s,t)=>new wt({shape:s,unknownKeys:"strip",catchall:Cr.create(),typeName:Ie.ZodObject,...$e(t)});class Ti extends ze{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function a(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return r.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new Ns(l.ctx.common.issues));return pe(r,{code:re.invalid_union,unionErrors:o}),Re}if(r.common.async)return Promise.all(n.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const c of n){const d={...r,common:{...r.common,issues:[]},parent:null},u=c._parseSync({data:r.data,path:r.path,parent:d});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(c=>new Ns(c));return pe(r,{code:re.invalid_union,unionErrors:l}),Re}}get options(){return this._def.options}}Ti.create=(s,t)=>new Ti({options:s,typeName:Ie.ZodUnion,...$e(t)});const gr=s=>s instanceof Di?gr(s.schema):s instanceof Xs?gr(s.innerType()):s instanceof Ai?[s.value]:s instanceof Wr?s.options:s instanceof _i?Je.objectValues(s.enum):s instanceof Ii?gr(s._def.innerType):s instanceof Ci?[void 0]:s instanceof ki?[null]:s instanceof or?[void 0,...gr(s.unwrap())]:s instanceof Kr?[null,...gr(s.unwrap())]:s instanceof em||s instanceof Mi?gr(s.unwrap()):s instanceof Ri?gr(s._def.innerType):[];class Gl extends ze{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==xe.object)return pe(r,{code:re.invalid_type,expected:xe.object,received:r.parsedType}),Re;const n=this.discriminator,a=r.data[n],i=this.optionsMap.get(a);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(pe(r,{code:re.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Re)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const a=new Map;for(const i of r){const o=gr(i.shape[t]);if(!o.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const l of o){if(a.has(l))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(l)}`);a.set(l,i)}}return new Gl({typeName:Ie.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:a,...$e(n)})}}function Od(s,t){const r=Mr(s),n=Mr(t);if(s===t)return{valid:!0,data:s};if(r===xe.object&&n===xe.object){const a=Je.objectKeys(t),i=Je.objectKeys(s).filter(l=>a.indexOf(l)!==-1),o={...s,...t};for(const l of i){const c=Od(s[l],t[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(r===xe.array&&n===xe.array){if(s.length!==t.length)return{valid:!1};const a=[];for(let i=0;i<s.length;i++){const o=s[i],l=t[i],c=Od(o,l);if(!c.valid)return{valid:!1};a.push(c.data)}return{valid:!0,data:a}}else return r===xe.date&&n===xe.date&&+s==+t?{valid:!0,data:s}:{valid:!1}}class Pi extends ze{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=(i,o)=>{if(Rd(i)||Rd(o))return Re;const l=Od(i.value,o.value);return l.valid?((Md(i)||Md(o))&&r.dirty(),{status:r.value,value:l.data}):(pe(n,{code:re.invalid_intersection_types}),Re)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Pi.create=(s,t,r)=>new Pi({left:s,right:t,typeName:Ie.ZodIntersection,...$e(r)});class mr extends ze{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==xe.array)return pe(n,{code:re.invalid_type,expected:xe.array,received:n.parsedType}),Re;if(n.data.length<this._def.items.length)return pe(n,{code:re.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Re;!this._def.rest&&n.data.length>this._def.items.length&&(pe(n,{code:re.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new ur(n,o,n.path,l)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>ss.mergeArray(r,o)):ss.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new mr({...this._def,rest:t})}}mr.create=(s,t)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new mr({items:s,typeName:Ie.ZodTuple,rest:null,...$e(t)})};class Ei extends ze{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==xe.object)return pe(n,{code:re.invalid_type,expected:xe.object,received:n.parsedType}),Re;const a=[],i=this._def.keyType,o=this._def.valueType;for(const l in n.data)a.push({key:i._parse(new ur(n,l,n.path,l)),value:o._parse(new ur(n,n.data[l],n.path,l)),alwaysSet:l in n.data});return n.common.async?ss.mergeObjectAsync(r,a):ss.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof ze?new Ei({keyType:t,valueType:r,typeName:Ie.ZodRecord,...$e(n)}):new Ei({keyType:Ws.create(),valueType:t,typeName:Ie.ZodRecord,...$e(r)})}}class sl extends ze{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==xe.map)return pe(n,{code:re.invalid_type,expected:xe.map,received:n.parsedType}),Re;const a=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([l,c],d)=>({key:a._parse(new ur(n,l,n.path,[d,"key"])),value:i._parse(new ur(n,c,n.path,[d,"value"]))}));if(n.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,u=await c.value;if(d.status==="aborted"||u.status==="aborted")return Re;(d.status==="dirty"||u.status==="dirty")&&r.dirty(),l.set(d.value,u.value)}return{status:r.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,u=c.value;if(d.status==="aborted"||u.status==="aborted")return Re;(d.status==="dirty"||u.status==="dirty")&&r.dirty(),l.set(d.value,u.value)}return{status:r.value,value:l}}}}sl.create=(s,t,r)=>new sl({valueType:t,keyType:s,typeName:Ie.ZodMap,...$e(r)});class Fn extends ze{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==xe.set)return pe(n,{code:re.invalid_type,expected:xe.set,received:n.parsedType}),Re;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(pe(n,{code:re.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(pe(n,{code:re.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const i=this._def.valueType;function o(c){const d=new Set;for(const u of c){if(u.status==="aborted")return Re;u.status==="dirty"&&r.dirty(),d.add(u.value)}return{status:r.value,value:d}}const l=[...n.data.values()].map((c,d)=>i._parse(new ur(n,c,n.path,d)));return n.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(t,r){return new Fn({...this._def,minSize:{value:t,message:we.toString(r)}})}max(t,r){return new Fn({...this._def,maxSize:{value:t,message:we.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Fn.create=(s,t)=>new Fn({valueType:s,minSize:null,maxSize:null,typeName:Ie.ZodSet,...$e(t)});class ua extends ze{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==xe.function)return pe(r,{code:re.invalid_type,expected:xe.function,received:r.parsedType}),Re;function n(l,c){return Xo({data:l,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Yo(),ba].filter(d=>!!d),issueData:{code:re.invalid_arguments,argumentsError:c}})}function a(l,c){return Xo({data:l,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Yo(),ba].filter(d=>!!d),issueData:{code:re.invalid_return_type,returnTypeError:c}})}const i={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof Na){const l=this;return cs(async function(...c){const d=new Ns([]),u=await l._def.args.parseAsync(c,i).catch(x=>{throw d.addIssue(n(c,x)),d}),h=await Reflect.apply(o,this,u);return await l._def.returns._def.type.parseAsync(h,i).catch(x=>{throw d.addIssue(a(h,x)),d})})}else{const l=this;return cs(function(...c){const d=l._def.args.safeParse(c,i);if(!d.success)throw new Ns([n(c,d.error)]);const u=Reflect.apply(o,this,d.data),h=l._def.returns.safeParse(u,i);if(!h.success)throw new Ns([a(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new ua({...this._def,args:mr.create(t).rest(Pn.create())})}returns(t){return new ua({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new ua({args:t||mr.create([]).rest(Pn.create()),returns:r||Pn.create(),typeName:Ie.ZodFunction,...$e(n)})}}class Di extends ze{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Di.create=(s,t)=>new Di({getter:s,typeName:Ie.ZodLazy,...$e(t)});class Ai extends ze{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return pe(r,{received:r.data,code:re.invalid_literal,expected:this._def.value}),Re}return{status:"valid",value:t.data}}get value(){return this._def.value}}Ai.create=(s,t)=>new Ai({value:s,typeName:Ie.ZodLiteral,...$e(t)});function mC(s,t){return new Wr({values:s,typeName:Ie.ZodEnum,...$e(t)})}class Wr extends ze{constructor(){super(...arguments),ei.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return pe(r,{expected:Je.joinValues(n),received:r.parsedType,code:re.invalid_type}),Re}if(Jo(this,ei)||lC(this,ei,new Set(this._def.values)),!Jo(this,ei).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return pe(r,{received:r.data,code:re.invalid_enum_value,options:n}),Re}return cs(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Wr.create(t,{...this._def,...r})}exclude(t,r=this._def){return Wr.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}ei=new WeakMap;Wr.create=mC;class _i extends ze{constructor(){super(...arguments),ti.set(this,void 0)}_parse(t){const r=Je.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==xe.string&&n.parsedType!==xe.number){const a=Je.objectValues(r);return pe(n,{expected:Je.joinValues(a),received:n.parsedType,code:re.invalid_type}),Re}if(Jo(this,ti)||lC(this,ti,new Set(Je.getValidEnumValues(this._def.values))),!Jo(this,ti).has(t.data)){const a=Je.objectValues(r);return pe(n,{received:n.data,code:re.invalid_enum_value,options:a}),Re}return cs(t.data)}get enum(){return this._def.values}}ti=new WeakMap;_i.create=(s,t)=>new _i({values:s,typeName:Ie.ZodNativeEnum,...$e(t)});class Na extends ze{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==xe.promise&&r.common.async===!1)return pe(r,{code:re.invalid_type,expected:xe.promise,received:r.parsedType}),Re;const n=r.parsedType===xe.promise?r.data:Promise.resolve(r.data);return cs(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Na.create=(s,t)=>new Na({type:s,typeName:Ie.ZodPromise,...$e(t)});class Xs extends ze{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ie.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=this._def.effect||null,i={addIssue:o=>{pe(n,o),o.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(n.data,i);if(n.common.async)return Promise.resolve(o).then(async l=>{if(r.value==="aborted")return Re;const c=await this._def.schema._parseAsync({data:l,path:n.path,parent:n});return c.status==="aborted"?Re:c.status==="dirty"||r.value==="dirty"?Xn(c.value):c});{if(r.value==="aborted")return Re;const l=this._def.schema._parseSync({data:o,path:n.path,parent:n});return l.status==="aborted"?Re:l.status==="dirty"||r.value==="dirty"?Xn(l.value):l}}if(a.type==="refinement"){const o=l=>{const c=a.refinement(l,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?Re:(l.status==="dirty"&&r.dirty(),o(l.value),{status:r.value,value:l.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>l.status==="aborted"?Re:(l.status==="dirty"&&r.dirty(),o(l.value).then(()=>({status:r.value,value:l.value}))))}if(a.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!wi(o))return o;const l=a.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:l}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>wi(o)?Promise.resolve(a.transform(o.value,i)).then(l=>({status:r.value,value:l})):o);Je.assertNever(a)}}Xs.create=(s,t,r)=>new Xs({schema:s,typeName:Ie.ZodEffects,effect:t,...$e(r)});Xs.createWithPreprocess=(s,t,r)=>new Xs({schema:t,effect:{type:"preprocess",transform:s},typeName:Ie.ZodEffects,...$e(r)});class or extends ze{_parse(t){return this._getType(t)===xe.undefined?cs(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}or.create=(s,t)=>new or({innerType:s,typeName:Ie.ZodOptional,...$e(t)});class Kr extends ze{_parse(t){return this._getType(t)===xe.null?cs(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Kr.create=(s,t)=>new Kr({innerType:s,typeName:Ie.ZodNullable,...$e(t)});class Ii extends ze{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===xe.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Ii.create=(s,t)=>new Ii({innerType:s,typeName:Ie.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...$e(t)});class Ri extends ze{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Ni(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ns(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Ns(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Ri.create=(s,t)=>new Ri({innerType:s,typeName:Ie.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...$e(t)});class rl extends ze{_parse(t){if(this._getType(t)!==xe.nan){const n=this._getOrReturnCtx(t);return pe(n,{code:re.invalid_type,expected:xe.nan,received:n.parsedType}),Re}return{status:"valid",value:t.data}}}rl.create=s=>new rl({typeName:Ie.ZodNaN,...$e(s)});const zO=Symbol("zod_brand");class em extends ze{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Ji extends ze{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Re:i.status==="dirty"?(r.dirty(),Xn(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Re:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,r){return new Ji({in:t,out:r,typeName:Ie.ZodPipeline})}}class Mi extends ze{_parse(t){const r=this._def.innerType._parse(t),n=a=>(wi(a)&&(a.value=Object.freeze(a.value)),a);return Ni(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}Mi.create=(s,t)=>new Mi({innerType:s,typeName:Ie.ZodReadonly,...$e(t)});function hC(s,t={},r){return s?wa.create().superRefine((n,a)=>{var i,o;if(!s(n)){const l=typeof t=="function"?t(n):typeof t=="string"?{message:t}:t,c=(o=(i=l.fatal)!==null&&i!==void 0?i:r)!==null&&o!==void 0?o:!0,d=typeof l=="string"?{message:l}:l;a.addIssue({code:"custom",...d,fatal:c})}}):wa.create()}const WO={object:wt.lazycreate};var Ie;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(Ie||(Ie={}));const KO=(s,t={message:`Input not instance of ${s.name}`})=>hC(r=>r instanceof s,t),vr=Ws.create,pC=qr.create,GO=rl.create,QO=zr.create,nl=Si.create,ZO=On.create,YO=el.create,XO=Ci.create,JO=ki.create,eF=wa.create,tF=Pn.create,sF=Cr.create,rF=tl.create,nF=Ks.create,fC=wt.create,aF=wt.strictCreate,iF=Ti.create,oF=Gl.create,lF=Pi.create,cF=mr.create,dF=Ei.create,uF=sl.create,mF=Fn.create,hF=ua.create,pF=Di.create,fF=Ai.create,xF=Wr.create,gF=_i.create,vF=Na.create,Pp=Xs.create,yF=or.create,jF=Kr.create,bF=Xs.createWithPreprocess,wF=Ji.create,NF=()=>vr().optional(),SF=()=>pC().optional(),CF=()=>nl().optional(),kF={string:s=>Ws.create({...s,coerce:!0}),number:s=>qr.create({...s,coerce:!0}),boolean:s=>Si.create({...s,coerce:!0}),bigint:s=>zr.create({...s,coerce:!0}),date:s=>On.create({...s,coerce:!0})},TF=Re;var Ze=Object.freeze({__proto__:null,defaultErrorMap:ba,setErrorMap:PO,getErrorMap:Yo,makeIssue:Xo,EMPTY_PATH:EO,addIssueToContext:pe,ParseStatus:ss,INVALID:Re,DIRTY:Xn,OK:cs,isAborted:Rd,isDirty:Md,isValid:wi,isAsync:Ni,get util(){return Je},get objectUtil(){return Id},ZodParsedType:xe,getParsedType:Mr,ZodType:ze,datetimeRegex:uC,ZodString:Ws,ZodNumber:qr,ZodBigInt:zr,ZodBoolean:Si,ZodDate:On,ZodSymbol:el,ZodUndefined:Ci,ZodNull:ki,ZodAny:wa,ZodUnknown:Pn,ZodNever:Cr,ZodVoid:tl,ZodArray:Ks,ZodObject:wt,ZodUnion:Ti,ZodDiscriminatedUnion:Gl,ZodIntersection:Pi,ZodTuple:mr,ZodRecord:Ei,ZodMap:sl,ZodSet:Fn,ZodFunction:ua,ZodLazy:Di,ZodLiteral:Ai,ZodEnum:Wr,ZodNativeEnum:_i,ZodPromise:Na,ZodEffects:Xs,ZodTransformer:Xs,ZodOptional:or,ZodNullable:Kr,ZodDefault:Ii,ZodCatch:Ri,ZodNaN:rl,BRAND:zO,ZodBranded:em,ZodPipeline:Ji,ZodReadonly:Mi,custom:hC,Schema:ze,ZodSchema:ze,late:WO,get ZodFirstPartyTypeKind(){return Ie},coerce:kF,any:eF,array:nF,bigint:QO,boolean:nl,date:ZO,discriminatedUnion:oF,effect:Pp,enum:xF,function:hF,instanceof:KO,intersection:lF,lazy:pF,literal:fF,map:uF,nan:GO,nativeEnum:gF,never:sF,null:JO,nullable:jF,number:pC,object:fC,oboolean:CF,onumber:SF,optional:yF,ostring:NF,pipeline:wF,preprocess:bF,promise:vF,record:dF,set:mF,strictObject:aF,string:vr,symbol:YO,transformer:Pp,tuple:cF,undefined:XO,union:iF,unknown:tF,void:rF,NEVER:TF,ZodIssueCode:re,quotelessJson:TO,ZodError:Ns});const bt={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function Dt(s,t){return t.includes(s.columnType)}function PF(s){return"enumValues"in s&&Array.isArray(s.enumValues)&&s.enumValues.length>0}const EF=Ze.union([Ze.string(),Ze.number(),Ze.boolean(),Ze.null()]),DF=Ze.union([EF,Ze.record(Ze.any()),Ze.array(Ze.any())]),AF=Ze.custom(s=>s instanceof Buffer);function xC(s,t){const r=(t==null?void 0:t.zodInstance)??Ze,n=(t==null?void 0:t.coerce)??{};let a;return PF(s)&&(a=s.enumValues.length?r.enum(s.enumValues):r.string()),a||(Dt(s,["PgGeometry","PgPointTuple"])?a=r.tuple([r.number(),r.number()]):Dt(s,["PgGeometryObject","PgPointObject"])?a=r.object({x:r.number(),y:r.number()}):Dt(s,["PgHalfVector","PgVector"])?(a=r.array(r.number()),a=s.dimensions?a.length(s.dimensions):a):Dt(s,["PgLine"])?a=r.tuple([r.number(),r.number(),r.number()]):Dt(s,["PgLineABC"])?a=r.object({a:r.number(),b:r.number(),c:r.number()}):Dt(s,["PgArray"])?(a=r.array(xC(s.baseColumn,r)),a=s.size?a.length(s.size):a):s.dataType==="array"?a=r.array(r.any()):s.dataType==="number"?a=_F(s,r,n):s.dataType==="bigint"?a=IF(s,r,n):s.dataType==="boolean"?a=n===!0||n.boolean?r.coerce.boolean():r.boolean():s.dataType==="date"?a=n===!0||n.date?r.coerce.date():r.date():s.dataType==="string"?a=RF(s,r,n):s.dataType==="json"?a=DF:s.dataType==="custom"?a=r.any():s.dataType==="buffer"&&(a=AF)),a||(a=r.any()),a}function _F(s,t,r){let n=s.getSQLType().includes("unsigned"),a,i,o=!1;Dt(s,["MySqlTinyInt","SingleStoreTinyInt"])?(a=n?0:bt.INT8_MIN,i=n?bt.INT8_UNSIGNED_MAX:bt.INT8_MAX,o=!0):Dt(s,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(a=n?0:bt.INT16_MIN,i=n?bt.INT16_UNSIGNED_MAX:bt.INT16_MAX,o=!0):Dt(s,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(a=n?0:bt.INT24_MIN,i=n?bt.INT24_UNSIGNED_MAX:bt.INT24_MAX,o=Dt(s,["MySqlMediumInt","SingleStoreMediumInt"])):Dt(s,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(a=n?0:bt.INT32_MIN,i=n?bt.INT32_UNSIGNED_MAX:bt.INT32_MAX,o=!0):Dt(s,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(a=n?0:bt.INT48_MIN,i=n?bt.INT48_UNSIGNED_MAX:bt.INT48_MAX):Dt(s,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(n=n||Dt(s,["MySqlSerial","SingleStoreSerial"]),a=n?0:Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=!0):Dt(s,["MySqlYear","SingleStoreYear"])?(a=1901,i=2155,o=!0):(a=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER);let l=r===!0||r!=null&&r.number?t.coerce.number():t.number();return l=l.min(a).max(i),o?l.int():l}function IF(s,t,r){const n=s.getSQLType().includes("unsigned"),a=n?0n:bt.INT64_MIN,i=n?bt.INT64_UNSIGNED_MAX:bt.INT64_MAX;return(r===!0||r!=null&&r.bigint?t.coerce.bigint():t.bigint()).min(a).max(i)}function RF(s,t,r){if(Dt(s,["PgUUID"]))return t.string().uuid();let n,a,i=!1;Dt(s,["PgVarchar","SQLiteText"])?n=s.length:Dt(s,["MySqlVarChar","SingleStoreVarChar"])?n=s.length??bt.INT16_UNSIGNED_MAX:Dt(s,["MySqlText","SingleStoreText"])&&(s.textType==="longtext"?n=bt.INT32_UNSIGNED_MAX:s.textType==="mediumtext"?n=bt.INT24_UNSIGNED_MAX:s.textType==="text"?n=bt.INT16_UNSIGNED_MAX:n=bt.INT8_UNSIGNED_MAX),Dt(s,["PgChar","MySqlChar","SingleStoreChar"])&&(n=s.length,i=!0),Dt(s,["PgBinaryVector"])&&(a=/^[01]+$/,n=s.dimensions);let o=r===!0||r!=null&&r.string?t.coerce.string():t.string();return o=a?o.regex(a):o,n&&i?o.length(n):n?o.max(n):o}function gC(s){return D0(s)?ZM(s):YM(s)}function vC(s,t,r,n){const a={};for(const[i,o]of Object.entries(s)){if(!Kt(o,ja)&&!Kt(o,Ft)&&!Kt(o,Ft.Aliased)&&typeof o=="object"){const h=D0(o)||QM(o)?gC(o):o;a[i]=vC(h,t[i]??{},r,n);continue}const l=t[i];if(l!==void 0&&typeof l!="function"){a[i]=l;continue}const c=Kt(o,ja)?o:void 0,d=c?xC(c,n):Ze.any(),u=typeof l=="function"?l(d):d;r.never(c)||(a[i]=u,c&&(r.nullable(c)&&(a[i]=a[i].nullable()),r.optional(c)&&(a[i]=a[i].optional())))}return Ze.object(a)}const MF={never:s=>{var t,r;return((t=s==null?void 0:s.generated)==null?void 0:t.type)==="always"||((r=s==null?void 0:s.generatedIdentity)==null?void 0:r.type)==="always"},optional:s=>!s.notNull||s.notNull&&s.hasDefault,nullable:s=>!s.notNull},it=(s,t)=>{const r=gC(s);return vC(r,{},MF)},eo=at("customers",{id:ft("id").primaryKey(),name:L("name").notNull(),email:L("email"),phone:L("phone"),address:L("address"),stripeCustomerId:L("stripe_customer_id"),createdAt:_e("created_at").defaultNow()});it(eo).omit({id:!0,createdAt:!0});const tm=at("frames",{id:L("id").primaryKey(),name:L("name").notNull(),manufacturer:L("manufacturer").notNull(),material:L("material").notNull(),width:Te("width").notNull(),depth:Te("depth").notNull(),price:Te("price").notNull(),catalogImage:L("catalog_image").notNull(),edgeTexture:L("edge_texture"),corner:L("corner")});it(tm);const sm=at("mat_colors",{id:L("id").primaryKey(),name:L("name").notNull(),color:L("color").notNull(),price:Te("price").notNull(),manufacturer:L("manufacturer"),code:L("code"),description:L("description"),category:L("category")});it(sm);const rm=at("glass_options",{id:L("id").primaryKey(),name:L("name").notNull(),description:L("description").notNull(),price:Te("price").notNull()});it(rm);const yC=at("special_services",{id:L("id").primaryKey(),name:L("name").notNull(),description:L("description").notNull(),price:Te("price").notNull()});it(yC);const jC=at("order_groups",{id:ft("id").primaryKey(),customerId:Me("customer_id").references(()=>eo.id),subtotal:Te("subtotal"),tax:Te("tax"),total:Te("total"),status:L("status").notNull().default("open"),paymentMethod:L("payment_method"),notes:L("notes"),createdAt:_e("created_at").defaultNow(),stripePaymentIntentId:L("stripe_payment_intent_id"),stripePaymentStatus:L("stripe_payment_status"),paymentDate:_e("payment_date"),discountAmount:Te("discount_amount"),discountType:L("discount_type"),taxExempt:Nt("tax_exempt").default(!1),cashAmount:Te("cash_amount"),checkNumber:L("check_number"),invoiceEmailSent:Nt("invoice_email_sent").default(!1),invoiceEmailDate:_e("invoice_email_date")});it(jC).omit({id:!0,createdAt:!0});const go=["order_processed","scheduled","materials_ordered","materials_arrived","frame_cut","mat_cut","prepped","completed","delayed"],sn=at("orders",{id:ft("id").primaryKey(),customerId:Me("customer_id").references(()=>eo.id),orderGroupId:Me("order_group_id").references(()=>jC.id),frameId:L("frame_id").references(()=>tm.id),matColorId:L("mat_color_id").references(()=>sm.id),glassOptionId:L("glass_option_id").references(()=>rm.id),artworkWidth:Te("artwork_width").notNull(),artworkHeight:Te("artwork_height").notNull(),matWidth:Te("mat_width").notNull(),artworkDescription:L("artwork_description"),artworkType:L("artwork_type"),artworkLocation:L("artwork_location"),quantity:Me("quantity").notNull().default(1),subtotal:Te("subtotal").notNull(),tax:Te("tax").notNull(),total:Te("total").notNull(),status:L("status").notNull().default("pending"),productionStatus:L("production_status").$type().notNull().default("order_processed"),previousStatus:L("previous_status").$type(),createdAt:_e("created_at").defaultNow(),dueDate:_e("due_date"),artworkImage:L("artwork_image"),frameDesignImage:L("frame_design_image"),lastNotificationSent:_e("last_notification_sent"),estimatedCompletionDays:Me("estimated_completion_days"),addToWholesaleOrder:Nt("add_to_wholesale_order").default(!1),lastStatusChange:_e("last_status_change").defaultNow(),notificationsEnabled:Nt("notifications_enabled").default(!0),useMultipleMats:Nt("use_multiple_mats").default(!1),useMultipleFrames:Nt("use_multiple_frames").default(!1),useManualFrame:Nt("use_manual_frame").default(!1),manualFrameName:L("manual_frame_name"),manualFrameCost:Te("manual_frame_cost"),miscChargeDescription:L("misc_charge_description"),miscChargeAmount:Te("misc_charge_amount")});it(sn).omit({id:!0,createdAt:!0});const OF=at("order_special_services",{orderId:Me("order_id").references(()=>sn.id),specialServiceId:L("special_service_id").references(()=>yC.id)},s=>({pk:kO({columns:[s.orderId,s.specialServiceId]})}));it(OF);const FF=at("order_mats",{id:ft("id").primaryKey(),orderId:Me("order_id").references(()=>sn.id).notNull(),matColorId:L("mat_color_id").references(()=>sm.id).notNull(),position:Me("position").notNull(),width:Te("width").notNull(),offset:Te("offset").notNull().default("0"),createdAt:_e("created_at").defaultNow()});it(FF).omit({id:!0,createdAt:!0});const LF=at("order_frames",{id:ft("id").primaryKey(),orderId:Me("order_id").references(()=>sn.id).notNull(),frameId:L("frame_id").references(()=>tm.id).notNull(),position:Me("position").notNull(),distance:Te("distance").notNull().default("0"),createdAt:_e("created_at").defaultNow()});it(LF).omit({id:!0,createdAt:!0});const $F=at("wholesale_orders",{id:ft("id").primaryKey(),orderId:Me("order_id").references(()=>sn.id),manufacturer:L("manufacturer").notNull(),items:Hr("items").notNull(),status:L("status").notNull().default("pending"),createdAt:_e("created_at").defaultNow()});it($F).omit({id:!0,createdAt:!0});const rn=at("users",{id:ft("id").primaryKey(),username:L("username").notNull().unique(),password:L("password").notNull(),role:L("role").notNull().default("employee")});it(rn).omit({id:!0});const BF=at("larson_juhl_catalog",{id:L("id").primaryKey(),name:L("name").notNull(),hex_color:L("hex_color"),price:Te("price",{precision:10,scale:6}).notNull(),code:L("code").notNull(),crescent_code:L("crescent_code"),description:L("description"),category:L("category"),manufacturer:L("manufacturer").notNull(),type:L("type").notNull().default("matboard"),material:L("material"),width:Te("width"),depth:Te("depth"),edge_texture:L("edge_texture"),corner:L("corner"),catalog_image:L("catalog_image"),createdAt:_e("created_at").defaultNow()});it(BF).omit({createdAt:!0});const VF=at("customer_notifications",{id:ft("id").primaryKey(),customerId:Me("customer_id").references(()=>eo.id),orderId:Me("order_id").references(()=>sn.id),notificationType:L("notification_type").$type().notNull(),channel:L("channel").$type().notNull().default("email"),subject:L("subject").notNull(),message:L("message").notNull(),sentAt:_e("sent_at").defaultNow(),successful:Nt("successful").notNull(),responseData:Hr("response_data"),previousStatus:L("previous_status"),newStatus:L("new_status"),paymentLinkId:Me("payment_link_id")});it(VF).omit({id:!0,sentAt:!0});const UF=["pending","processed","ordered","arrived","frame_cut","mat_cut","prepped","completed","delayed","canceled"],HF=at("material_orders",{id:ft("id").primaryKey(),materialType:L("material_type").$type().notNull(),materialId:L("material_id").notNull(),materialName:L("material_name").notNull(),quantity:Te("quantity").notNull(),status:L("status").$type().notNull().default("pending"),sourceOrderId:Me("source_order_id").references(()=>sn.id),orderDate:_e("order_date"),expectedArrival:_e("expected_arrival"),actualArrival:_e("actual_arrival"),supplierName:L("supplier_name"),supplierOrderNumber:L("supplier_order_number"),notes:L("notes"),costPerUnit:Te("cost_per_unit"),totalCost:Te("total_cost"),priority:L("priority").default("normal"),hubOrderId:L("hub_order_id"),hubSyncStatus:L("hub_sync_status").default("not_synced"),hubLastSyncDate:_e("hub_last_sync_date"),hubTrackingInfo:L("hub_tracking_info"),hubEstimatedDelivery:_e("hub_estimated_delivery"),hubSupplierNotes:L("hub_supplier_notes"),orderReference:L("order_reference"),unitMeasurement:L("unit_measurement"),createdAt:_e("created_at").defaultNow()});it(HF).omit({id:!0,createdAt:!0,hubOrderId:!0,hubSyncStatus:!0,hubLastSyncDate:!0,hubTrackingInfo:!0,hubEstimatedDelivery:!0,hubSupplierNotes:!0});const nm=at("suppliers",{id:ft("id").primaryKey(),name:L("name").notNull(),contactName:L("contact_name"),email:L("email"),phone:L("phone"),address:L("address"),website:L("website"),accountNumber:L("account_number"),notes:L("notes"),paymentTerms:L("payment_terms"),minimumOrderAmount:Te("minimum_order_amount"),shippingPreference:L("shipping_preference"),leadTime:Me("lead_time"),active:Nt("active").default(!0),createdAt:_e("created_at").defaultNow(),lastOrderDate:_e("last_order_date")});it(nm).omit({id:!0,createdAt:!0});const am=at("inventory_categories",{id:ft("id").primaryKey(),name:L("name").notNull(),description:L("description"),parentCategoryId:Me("parent_category_id").references(()=>am.id),createdAt:_e("created_at").defaultNow()});it(am).omit({id:!0,createdAt:!0});const Ba=at("inventory_locations",{id:ft("id").primaryKey(),name:L("name").notNull(),description:L("description"),type:L("type"),parentLocationId:Me("parent_location_id").references(()=>Ba.id),active:Nt("active").default(!0),createdAt:_e("created_at").defaultNow()});it(Ba).omit({id:!0,createdAt:!0});const Ql=at("inventory_items",{id:ft("id").primaryKey(),sku:L("sku").notNull().unique(),name:L("name").notNull(),description:L("description"),categoryId:Me("category_id").references(()=>am.id),supplierId:Me("supplier_id").references(()=>nm.id),supplierSku:L("supplier_sku"),unitOfMeasure:L("unit_of_measure").$type().notNull(),costPerUnit:Te("cost_per_unit").notNull(),retailPrice:Te("retail_price"),minimumStockLevel:Te("minimum_stock_level").notNull(),reorderLevel:Te("reorder_level").notNull(),reorderQuantity:Te("reorder_quantity"),locationId:Me("location_id").references(()=>Ba.id),barcode:L("barcode"),notes:L("notes"),tags:L("tags").array(),isActive:Nt("is_active").default(!0),createdAt:_e("created_at").defaultNow(),updatedAt:_e("updated_at").defaultNow(),lastCountDate:_e("last_count_date"),imageUrl:L("image_url"),dimensions:Hr("dimensions"),autoBatchReorder:Nt("auto_batch_reorder").default(!1),materialType:L("material_type").$type(),materialId:L("material_id")});it(Ql).omit({id:!0,createdAt:!0,updatedAt:!0});const qF=at("inventory_transactions",{id:ft("id").primaryKey(),itemId:Me("item_id").references(()=>Ql.id).notNull(),type:L("type").$type().notNull(),quantity:Te("quantity").notNull(),unitCost:Te("unit_cost"),locationId:Me("location_id").references(()=>Ba.id),relatedOrderId:Me("related_order_id").references(()=>sn.id),notes:L("notes"),referenceNumber:L("reference_number"),createdAt:_e("created_at").defaultNow(),createdBy:Me("created_by").references(()=>rn.id)});it(qF).omit({id:!0,createdAt:!0});const bC=at("purchase_orders",{id:ft("id").primaryKey(),poNumber:L("po_number").notNull(),supplierId:Me("supplier_id").references(()=>nm.id).notNull(),orderDate:_e("order_date").notNull(),expectedDeliveryDate:_e("expected_delivery_date"),status:L("status").$type().default("draft").notNull(),subtotal:Te("subtotal"),tax:Te("tax"),shipping:Te("shipping"),total:Te("total"),notes:L("notes"),createdBy:Me("created_by").references(()=>rn.id),createdAt:_e("created_at").defaultNow(),updatedAt:_e("updated_at").defaultNow(),receivedDate:_e("received_date"),supplierOrderConfirmation:L("supplier_order_confirmation"),shippingMethod:L("shipping_method"),paymentMethod:L("payment_method"),paymentTerms:L("payment_terms"),tracking:L("tracking"),attachments:L("attachments").array()});it(bC).omit({id:!0,createdAt:!0,updatedAt:!0});const zF=at("purchase_order_lines",{id:ft("id").primaryKey(),purchaseOrderId:Me("purchase_order_id").references(()=>bC.id).notNull(),itemId:Me("item_id").references(()=>Ql.id).notNull(),quantity:Te("quantity").notNull(),unitCost:Te("unit_cost").notNull(),lineTotal:Te("line_total").notNull(),receivedQuantity:Te("received_quantity").default("0"),notes:L("notes"),createdAt:_e("created_at").defaultNow()});it(zF).omit({id:!0,createdAt:!0});const wC=at("inventory_counts",{id:ft("id").primaryKey(),countReference:L("count_reference").notNull(),startDate:_e("start_date").notNull(),endDate:_e("end_date"),status:L("status").default("in_progress").notNull(),notes:L("notes"),createdBy:Me("created_by").references(()=>rn.id),createdAt:_e("created_at").defaultNow()});it(wC).omit({id:!0,createdAt:!0});const WF=at("inventory_count_items",{id:ft("id").primaryKey(),countId:Me("count_id").references(()=>wC.id).notNull(),itemId:Me("item_id").references(()=>Ql.id).notNull(),locationId:Me("location_id").references(()=>Ba.id),expectedQuantity:Te("expected_quantity"),actualQuantity:Te("actual_quantity"),notes:L("notes"),countedBy:Me("counted_by").references(()=>rn.id),countedAt:_e("counted_at"),createdAt:_e("created_at").defaultNow()});it(WF).omit({id:!0,createdAt:!0});const KF=at("payment_links",{id:ft("id").primaryKey(),token:L("token").notNull().unique(),amount:Te("amount",{precision:10,scale:2}).notNull(),description:L("description"),customerId:Me("customer_id").references(()=>eo.id),createdAt:_e("created_at").defaultNow(),expiresAt:_e("expires_at").notNull(),usedAt:_e("used_at"),used:Nt("used").default(!1),paymentIntentId:L("payment_intent_id"),paymentStatus:L("payment_status").default("pending")});it(KF).omit({id:!0,createdAt:!0,usedAt:!0,used:!0,paymentIntentId:!0,paymentStatus:!0});const GF=["inventory_location","inventory_item","material_order","customer_order","production_status","artwork_location"],im=at("qr_codes",{id:ft("id").primaryKey(),code:L("code").notNull().unique(),type:L("type").$type().notNull(),entityId:L("entity_id").notNull(),title:L("title").notNull(),description:L("description"),metadata:Hr("metadata"),createdAt:_e("created_at").defaultNow(),lastScanned:_e("last_scanned"),scanCount:Me("scan_count").default(0),active:Nt("active").default(!0)});it(im).omit({id:!0,createdAt:!0,lastScanned:!0,scanCount:!0});const QF=at("qr_code_scans",{id:ft("id").primaryKey(),qrCodeId:Me("qr_code_id").references(()=>im.id).notNull(),userId:Me("user_id").references(()=>rn.id),scannedAt:_e("scanned_at").defaultNow(),location:L("location"),action:L("action"),metadata:Hr("metadata")});it(QF).omit({id:!0,scannedAt:!0});const ZF=at("material_locations",{id:ft("id").primaryKey(),materialType:L("material_type").$type().notNull(),materialId:L("material_id").notNull(),locationId:Me("location_id").references(()=>Ba.id).notNull(),qrCodeId:Me("qr_code_id").references(()=>im.id),quantity:Te("quantity").notNull().default("1"),notes:L("notes"),lastUpdated:_e("last_updated").defaultNow(),active:Nt("active").default(!0)});it(ZF).omit({id:!0,lastUpdated:!0});const YF=at("notifications",{id:ft("id").primaryKey(),title:L("title").notNull(),description:L("description").notNull(),source:L("source").notNull(),sourceId:L("source_id"),type:L("type").$type().notNull().default("info"),createdAt:_e("created_at").defaultNow(),read:Nt("read").default(!1),actionable:Nt("actionable").default(!1),link:L("link"),smsEnabled:Nt("sms_enabled").default(!1),smsRecipient:L("sms_recipient"),userId:Me("user_id").references(()=>rn.id)});it(YF).omit({id:!0,createdAt:!0});const XF=at("frame_configuration_bookmarks",{id:ft("id").primaryKey(),name:L("name").notNull(),description:L("description"),frames:Hr("frames").notNull(),mats:Hr("mats").notNull(),glassOptionId:L("glass_option_id").references(()=>rm.id),useMultipleMats:Nt("use_multiple_mats").default(!1),useMultipleFrames:Nt("use_multiple_frames").default(!1),defaultArtworkWidth:Te("default_artwork_width"),defaultArtworkHeight:Te("default_artwork_height"),defaultMatWidth:Te("default_mat_width"),tags:L("tags").array(),usageCount:Me("usage_count").default(0),lastUsed:_e("last_used"),isFavorite:Nt("is_favorite").default(!1),isPublic:Nt("is_public").default(!1),createdBy:Me("created_by").references(()=>rn.id),createdAt:_e("created_at").defaultNow(),updatedAt:_e("updated_at").defaultNow()});it(XF).omit({id:!0,createdAt:!0,updatedAt:!0,usageCount:!0,lastUsed:!0});function NC({order:s,showHistory:t=!0}){const{toast:r}=Be(),{toggleNotificationsMutation:n}=Qi({orderId:s.id,customerId:s.customerId||void 0}),a=()=>{const d=go.indexOf(s.productionStatus);if(s.productionStatus==="scheduled")return 10;if(s.productionStatus==="delayed"){if(s.previousStatus){const u=go.indexOf(s.previousStatus);return Math.max(u*100/(go.length-1)-10,10)}return 50}return d>=0?d*100/(go.length-1):0},i=d=>{switch(d){case"order_processed":return e.jsx(vh,{className:"h-5 w-5"});case"scheduled":return e.jsx(Ur,{className:"h-5 w-5"});case"materials_ordered":return e.jsx(Yr,{className:"h-5 w-5"});case"materials_arrived":return e.jsx(U2,{className:"h-5 w-5"});case"frame_cut":case"mat_cut":return e.jsx(pa,{className:"h-5 w-5"});case"in_production":return e.jsx(pa,{className:"h-5 w-5"});case"prepped":return e.jsx(vh,{className:"h-5 w-5"});case"completed":return e.jsx(V2,{className:"h-5 w-5"});case"delayed":return e.jsx(At,{className:"h-5 w-5"});default:return e.jsx(vt,{className:"h-5 w-5"})}},l=(d=>{switch(d){case"order_processed":return{title:"Order Processed",description:"Your order has been received and is being processed."};case"scheduled":return{title:"Order Scheduled",description:"Your order has been scheduled for production."};case"materials_ordered":return{title:"Materials Ordered",description:"Materials for your frame have been ordered from our suppliers."};case"materials_arrived":return{title:"Materials Arrived",description:"All materials for your frame have arrived and are ready for assembly."};case"frame_cut":return{title:"Frame Cutting",description:"The frame moulding is being cut to size for your artwork."};case"mat_cut":return{title:"Mat Cutting",description:"The mat board is being cut to size for your artwork."};case"in_production":return{title:"In Production",description:"Your frame is currently being assembled and finished."};case"prepped":return{title:"Assembly Preparation",description:"Your frame components are prepared and ready for final assembly."};case"completed":return{title:"Order Completed",description:"Your custom frame is complete and ready for pickup or delivery."};case"delayed":return{title:"Order Delayed",description:"There is a delay with your order. We will provide updates as soon as possible."};default:return{title:"Processing",description:"Your order is being processed."}}})(s.productionStatus),c=d=>{n.mutate({id:s.id,enabled:d},{onSuccess:()=>{r({title:"Notification preferences updated",description:`Email notifications have been ${d?"enabled":"disabled"} for this order`})}})};return e.jsxs(V,{children:[e.jsx(G,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(Q,{children:"Order Progress"}),e.jsxs(te,{children:["Current status: ",l.title]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Email notifications"}),e.jsx(br,{checked:!!s.notificationsEnabled,onCheckedChange:c,disabled:n.isPending})]})]})}),e.jsxs(q,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Order Received"}),e.jsx("span",{children:"Completed"})]}),e.jsx(oa,{value:a(),className:"h-2"})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-md flex items-start gap-3",children:[i(s.productionStatus),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:l.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.description}),s.dueDate&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm",children:[e.jsx(Ur,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["Expected completion: ",dr(new Date(s.dueDate),"PPP")]})]})]})]}),s.estimatedCompletionDays&&s.estimatedCompletionDays>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(vt,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["Estimated time to completion: ",s.estimatedCompletionDays," ",s.estimatedCompletionDays===1?"day":"days"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/30 rounded-md",children:[e.jsx(vi,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Materials Location"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.artworkLocation||"Workshop - Bay A"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/30 rounded-md",children:[e.jsx(vi,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Artwork Location"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Shelf #",s.id,"-ART"]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qs,{className:"h-6 w-6 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Order QR Code"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Quick access to order #",s.id]})]})]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>{const d=`${window.location.origin}/order-progress/${s.id}`,u={orderId:s.id,status:s.productionStatus,materials:s.artworkLocation||"Workshop - Bay A",artwork:`Shelf #${s.id}-ART`,url:d},h=document.createElement("div");h.style.cssText=`
                  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                  background: rgba(0,0,0,0.8); display: flex; align-items: center;
                  justify-content: center; z-index: 9999;
                `;const m=document.createElement("div");m.style.cssText=`
                  background: white; padding: 30px; border-radius: 10px;
                  text-align: center; max-width: 400px;
                `;const x=`https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=${encodeURIComponent(d)}`;m.innerHTML=`
                  <h3 style="margin: 0 0 20px 0;">Order #${s.id} QR Code</h3>
                  <div style="margin: 20px 0; padding: 10px; background: #f5f5f5;">
                    <img src="${x}" alt="QR Code" style="max-width: 200px; height: auto;" />
                  </div>
                  <p style="font-size: 12px; color: #666; margin: 15px 0;">
                    Materials: ${u.materials}<br>
                    Artwork: ${u.artwork}<br>
                    <strong>URL:</strong> ${d}
                  </p>
                  <button onclick="this.closest('.qr-modal').remove()" style="
                    padding: 8px 16px; background: #007bff; color: white;
                    border: none; border-radius: 4px; cursor: pointer; margin-right: 8px;
                  ">Close</button>
                  <button onclick="window.print()" style="
                    padding: 8px 16px; background: #28a745; color: white;
                    border: none; border-radius: 4px; cursor: pointer;
                  ">Print</button>
                `,h.className="qr-modal",h.appendChild(m),document.body.appendChild(h),h.addEventListener("click",g=>{g.target===h&&h.remove()})},children:[e.jsx(qs,{className:"h-4 w-4 mr-1"}),"View QR"]})]})]}),e.jsx("div",{className:"flex gap-2 pt-4 border-t",children:e.jsxs(P,{variant:"outline",size:"sm",onClick:async()=>{try{const d=await fetch(`/api/customers/${s.customerId}`),u=await d.json();if(!d.ok||!u.customer)throw new Error("Customer not found");const h=u.customer,m=await fetch("/api/notifications/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:s.id,customerEmail:h.email,customerPhone:h.phone,type:"status_update",message:`Your order #${s.id} status has been updated to: ${l.title}`})}),x=await m.json();if(m.ok)r({title:"Notification Sent",description:`Customer ${h.name} has been notified of the order status update.`});else throw new Error(x.error||"Failed to send notification")}catch(d){console.error("Notification error:",d),r({title:"Notification Failed",description:d.message||"Failed to send notification. Please try again.",variant:"destructive"})}},children:[e.jsx(Sr,{className:"h-4 w-4 mr-1"}),"Send Update"]})})]}),t&&e.jsx(ht,{className:"flex justify-end border-t pt-4",children:e.jsx(P,{variant:"ghost",asChild:!0,children:e.jsx(Mt,{href:`/order-progress/${s.id}`,children:"View detailed progress"})})})]})}var om="Collapsible",[JF,SC]=fs(om),[e5,lm]=JF(om),CC=p.forwardRef((s,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:i,onOpenChange:o,...l}=s,[c=!1,d]=ms({prop:n,defaultProp:a,onChange:o});return e.jsx(e5,{scope:r,disabled:i,contentId:hr(),open:c,onOpenToggle:p.useCallback(()=>d(u=>!u),[d]),children:e.jsx(Se.div,{"data-state":dm(c),"data-disabled":i?"":void 0,...l,ref:t})})});CC.displayName=om;var kC="CollapsibleTrigger",TC=p.forwardRef((s,t)=>{const{__scopeCollapsible:r,...n}=s,a=lm(kC,r);return e.jsx(Se.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":dm(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:t,onClick:ge(s.onClick,a.onOpenToggle)})});TC.displayName=kC;var cm="CollapsibleContent",PC=p.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=lm(cm,s.__scopeCollapsible);return e.jsx(ds,{present:r||a.open,children:({present:i})=>e.jsx(t5,{...n,ref:t,present:i})})});PC.displayName=cm;var t5=p.forwardRef((s,t)=>{const{__scopeCollapsible:r,present:n,children:a,...i}=s,o=lm(cm,r),[l,c]=p.useState(n),d=p.useRef(null),u=Ge(t,d),h=p.useRef(0),m=h.current,x=p.useRef(0),g=x.current,f=o.open||l,v=p.useRef(f),y=p.useRef();return p.useEffect(()=>{const j=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(j)},[]),Ss(()=>{const j=d.current;if(j){y.current=y.current||{transitionDuration:j.style.transitionDuration,animationName:j.style.animationName},j.style.transitionDuration="0s",j.style.animationName="none";const b=j.getBoundingClientRect();h.current=b.height,x.current=b.width,v.current||(j.style.transitionDuration=y.current.transitionDuration,j.style.animationName=y.current.animationName),c(n)}},[o.open,n]),e.jsx(Se.div,{"data-state":dm(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!f,...i,ref:u,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0,...s.style},children:f&&a})});function dm(s){return s?"open":"closed"}var s5=CC,r5=TC,n5=PC,Tr="Accordion",a5=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[um,i5,o5]=Vi(Tr),[Zl,cU]=fs(Tr,[o5,SC]),mm=SC(),EC=De.forwardRef((s,t)=>{const{type:r,...n}=s,a=n,i=n;return e.jsx(um.Provider,{scope:s.__scopeAccordion,children:r==="multiple"?e.jsx(u5,{...i,ref:t}):e.jsx(d5,{...a,ref:t})})});EC.displayName=Tr;var[DC,l5]=Zl(Tr),[AC,c5]=Zl(Tr,{collapsible:!1}),d5=De.forwardRef((s,t)=>{const{value:r,defaultValue:n,onValueChange:a=()=>{},collapsible:i=!1,...o}=s,[l,c]=ms({prop:r,defaultProp:n,onChange:a});return e.jsx(DC,{scope:s.__scopeAccordion,value:l?[l]:[],onItemOpen:c,onItemClose:De.useCallback(()=>i&&c(""),[i,c]),children:e.jsx(AC,{scope:s.__scopeAccordion,collapsible:i,children:e.jsx(_C,{...o,ref:t})})})}),u5=De.forwardRef((s,t)=>{const{value:r,defaultValue:n,onValueChange:a=()=>{},...i}=s,[o=[],l]=ms({prop:r,defaultProp:n,onChange:a}),c=De.useCallback(u=>l((h=[])=>[...h,u]),[l]),d=De.useCallback(u=>l((h=[])=>h.filter(m=>m!==u)),[l]);return e.jsx(DC,{scope:s.__scopeAccordion,value:o,onItemOpen:c,onItemClose:d,children:e.jsx(AC,{scope:s.__scopeAccordion,collapsible:!0,children:e.jsx(_C,{...i,ref:t})})})}),[m5,Yl]=Zl(Tr),_C=De.forwardRef((s,t)=>{const{__scopeAccordion:r,disabled:n,dir:a,orientation:i="vertical",...o}=s,l=De.useRef(null),c=Ge(l,t),d=i5(r),h=Ln(a)==="ltr",m=ge(s.onKeyDown,x=>{var C;if(!a5.includes(x.key))return;const g=x.target,f=d().filter(E=>{var D;return!((D=E.ref.current)!=null&&D.disabled)}),v=f.findIndex(E=>E.ref.current===g),y=f.length;if(v===-1)return;x.preventDefault();let j=v;const b=0,k=y-1,S=()=>{j=v+1,j>k&&(j=b)},A=()=>{j=v-1,j<b&&(j=k)};switch(x.key){case"Home":j=b;break;case"End":j=k;break;case"ArrowRight":i==="horizontal"&&(h?S():A());break;case"ArrowDown":i==="vertical"&&S();break;case"ArrowLeft":i==="horizontal"&&(h?A():S());break;case"ArrowUp":i==="vertical"&&A();break}const T=j%y;(C=f[T].ref.current)==null||C.focus()});return e.jsx(m5,{scope:r,disabled:n,direction:a,orientation:i,children:e.jsx(um.Slot,{scope:r,children:e.jsx(Se.div,{...o,"data-orientation":i,ref:c,onKeyDown:n?void 0:m})})})}),al="AccordionItem",[h5,hm]=Zl(al),IC=De.forwardRef((s,t)=>{const{__scopeAccordion:r,value:n,...a}=s,i=Yl(al,r),o=l5(al,r),l=mm(r),c=hr(),d=n&&o.value.includes(n)||!1,u=i.disabled||s.disabled;return e.jsx(h5,{scope:r,open:d,disabled:u,triggerId:c,children:e.jsx(s5,{"data-orientation":i.orientation,"data-state":$C(d),...l,...a,ref:t,disabled:u,open:d,onOpenChange:h=>{h?o.onItemOpen(n):o.onItemClose(n)}})})});IC.displayName=al;var RC="AccordionHeader",MC=De.forwardRef((s,t)=>{const{__scopeAccordion:r,...n}=s,a=Yl(Tr,r),i=hm(RC,r);return e.jsx(Se.h3,{"data-orientation":a.orientation,"data-state":$C(i.open),"data-disabled":i.disabled?"":void 0,...n,ref:t})});MC.displayName=RC;var Fd="AccordionTrigger",OC=De.forwardRef((s,t)=>{const{__scopeAccordion:r,...n}=s,a=Yl(Tr,r),i=hm(Fd,r),o=c5(Fd,r),l=mm(r);return e.jsx(um.ItemSlot,{scope:r,children:e.jsx(r5,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":a.orientation,id:i.triggerId,...l,...n,ref:t})})});OC.displayName=Fd;var FC="AccordionContent",LC=De.forwardRef((s,t)=>{const{__scopeAccordion:r,...n}=s,a=Yl(Tr,r),i=hm(FC,r),o=mm(r);return e.jsx(n5,{role:"region","aria-labelledby":i.triggerId,"data-orientation":a.orientation,...o,...n,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...s.style}})});LC.displayName=FC;function $C(s){return s?"open":"closed"}var p5=EC,f5=IC,x5=MC,BC=OC,VC=LC;const g5=p5,UC=p.forwardRef(({className:s,...t},r)=>e.jsx(f5,{ref:r,className:J("border-b",s),...t}));UC.displayName="AccordionItem";const HC=p.forwardRef(({className:s,children:t,...r},n)=>e.jsx(x5,{className:"flex",children:e.jsxs(BC,{ref:n,className:J("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s),...r,children:[t,e.jsx(ns,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));HC.displayName=BC.displayName;const qC=p.forwardRef(({className:s,children:t,...r},n)=>e.jsx(VC,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:e.jsx("div",{className:J("pb-4 pt-0",s),children:t})}));qC.displayName=VC.displayName;function zC({orderId:s,customerId:t,limit:r=5}){const{orderNotifications:n,customerNotifications:a,isLoadingOrderNotifications:i,isLoadingCustomerNotifications:o}=Qi({orderId:s,customerId:t}),l=x=>x==="status_update"?e.jsx(yi,{className:"h-4 w-4"}):x==="estimated_completion"?e.jsx(Ur,{className:"h-4 w-4"}):x.includes("status_change")?e.jsx(yi,{className:"h-4 w-4"}):x.includes("due_date")?e.jsx(Ur,{className:"h-4 w-4"}):x.includes("completion")?e.jsx(ls,{className:"h-4 w-4"}):x.includes("delay")?e.jsx(At,{className:"h-4 w-4"}):e.jsx(Fr,{className:"h-4 w-4"}),c=x=>{switch(x){case"email":return e.jsx(fu,{className:"h-4 w-4"});case"sms":return e.jsx(xj,{className:"h-4 w-4"});default:return e.jsx(Fr,{className:"h-4 w-4"})}},d=s?n:t?a:[],u=[...d].sort((x,g)=>new Date(g.sentAt).getTime()-new Date(x.sentAt).getTime()),h=r?u.slice(0,r):u;return(s?i:o)?e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Notification History"}),e.jsx(te,{children:"Recent updates about your order"})]}),e.jsx(q,{children:e.jsx("div",{className:"flex items-center justify-center py-6",children:e.jsx("div",{className:"animate-spin h-6 w-6 border-4 border-primary border-t-transparent rounded-full"})})})]}):d.length===0?e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Notification History"}),e.jsx(te,{children:"Recent updates about your order"})]}),e.jsx(q,{children:e.jsxs("div",{className:"py-6 text-center",children:[e.jsx(Fr,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"No notifications have been sent yet."})]})})]}):e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Notification History"}),e.jsx(te,{children:"Recent updates about your order"})]}),e.jsx(q,{children:e.jsx(g5,{type:"single",collapsible:!0,className:"w-full",children:h.map(x=>e.jsxs(UC,{value:`notification-${x.id}`,children:[e.jsx(HC,{children:e.jsxs("div",{className:"flex items-center text-left",children:[e.jsx("span",{className:"mr-2",children:l(x.notificationType)}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:x.subject}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx(vt,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:dr(new Date(x.sentAt),"PPP p")})]})]})]})}),e.jsx(qC,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2 pt-2",children:[e.jsx("div",{className:"bg-muted p-2 rounded-full",children:c(x.channel)}),e.jsxs("div",{children:[e.jsx("p",{className:"whitespace-pre-line",children:x.message}),e.jsx("div",{className:"flex items-center mt-2 text-xs text-muted-foreground",children:e.jsx("span",{className:"flex items-center",children:x.successful?e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-3 w-3 mr-1 text-green-500"}),e.jsx("span",{className:"text-green-600",children:"Delivered"})]}):e.jsxs(e.Fragment,{children:[e.jsx(At,{className:"h-3 w-3 mr-1 text-amber-500"}),e.jsx("span",{className:"text-amber-600",children:"Delivery failed"})]})})})]})]}),x.previousStatus&&x.newStatus&&e.jsx("div",{className:"mt-2 text-xs text-muted-foreground border-t pt-2",children:e.jsxs("p",{children:["Status changed from ",e.jsx("strong",{children:x.previousStatus})," to ",e.jsx("strong",{children:x.newStatus})]})})]})})]},x.id))})})]})}function Ep(){const{orderId:s}=Tl(),[t]=Cs();Be(),console.log("OrderProgressPage received orderId:",s),console.log("Current location:",t);const{order:r,isLoadingOrder:n,orderError:a,orderNotifications:i,isLoadingOrderNotifications:o}=Qi({orderId:s?parseInt(s):void 0});return n?e.jsx("div",{className:"container mx-auto py-10 space-y-6",children:e.jsx("div",{className:"flex items-center justify-center py-32",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading order details..."})]})})}):a||!n&&!r?e.jsx("div",{className:"container mx-auto py-10 space-y-6",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Order Not Found"}),e.jsxs(te,{children:["Order #",s," could not be found in the system."]})]}),e.jsxs(q,{className:"flex flex-col items-center justify-center py-10",children:[e.jsx(Ht,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-center mb-6",children:"The order you're looking for doesn't exist. Please check the order number and try again."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(P,{asChild:!0,variant:"outline",children:e.jsxs(Mt,{href:"/orders",children:[e.jsx(ha,{className:"mr-2 h-4 w-4"}),"View All Orders"]})}),e.jsx(P,{asChild:!0,children:e.jsxs(Mt,{href:"/",children:[e.jsx(Zc,{className:"mr-2 h-4 w-4"}),"Return Home"]})})]})]})]})}):e.jsxs("div",{className:"container mx-auto py-10 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Order Progress"}),e.jsx("p",{className:"text-muted-foreground",children:"Track the status of your custom framing order"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(P,{variant:"outline",asChild:!0,children:e.jsxs(Mt,{href:"/orders",children:[e.jsx(ha,{className:"mr-2 h-4 w-4"}),"All Orders"]})})})]}),e.jsx(Ot,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(V,{className:"md:col-span-1",children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Order Summary"}),e.jsxs(te,{children:["Order #",r.id]})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Artwork Dimensions"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.artworkWidth,'" x ',r.artworkHeight,'"']})]}),r.artworkDescription&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Artwork Description"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.artworkDescription})]}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-md",children:[e.jsx(vt,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Order Date"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.createdAt?new Date(r.createdAt).toLocaleDateString():"Not available"})]})]}),e.jsxs("div",{className:"space-y-1 border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm",children:"Subtotal"}),e.jsxs("p",{className:"text-sm font-medium",children:["$",parseFloat(r.subtotal||"0").toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm",children:"Tax"}),e.jsxs("p",{className:"text-sm font-medium",children:["$",parseFloat(r.tax||"0").toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center font-medium mt-2",children:[e.jsx("p",{children:"Total"}),e.jsxs("p",{children:["$",parseFloat(r.total||"0").toFixed(2)]})]})]})]}),e.jsx(ht,{className:"border-t pt-6",children:e.jsx(P,{variant:"outline",className:"w-full",asChild:!0,children:e.jsx(Mt,{href:"/orders",children:"View All Orders"})})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(NC,{order:r,showHistory:!1}),e.jsx("div",{className:"mt-6",children:e.jsx(zC,{orderId:r.id})})]})]})]})}const WC=()=>me({queryKey:["materials","pick-list"],queryFn:async()=>{try{const s=await fetch("/api/materials/pick-list");if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const t=await s.json();return Array.isArray(t)?t:[]}catch(s){return console.error("Error fetching materials pick list:",s),[]}},retry:1,retryDelay:1e3}),v5=()=>{const s=Zt();return Ce({mutationFn:async({id:t,data:r})=>{try{const n=await fetch(`/api/materials/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:r})});if(!n.ok){const a=await n.text();throw new Error(`Failed to update material: ${a}`)}return n.json()}catch(n){throw console.error("Error updating material:",n),n}},onSuccess:()=>{s.invalidateQueries({queryKey:["materials"]})}})},y5=()=>{const s=Zt();return Ce({mutationFn:async({materialIds:t,expectedDeliveryDate:r})=>{try{const n=await fetch("/api/materials/purchase-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materialIds:t,expectedDeliveryDate:r})});if(!n.ok){const a=await n.text();throw new Error(`Failed to create purchase order: ${a}`)}return n.json()}catch(n){throw console.error("Error creating purchase order:",n),n}},onSuccess:()=>{s.invalidateQueries({queryKey:["materials"]}),s.invalidateQueries({queryKey:["purchase-orders"]})}})},j5=()=>me({queryKey:["materials","types"],queryFn:async()=>{try{const s=await fetch("/api/materials/types");if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const t=await s.json();return Array.isArray(t)?t:[]}catch(s){return console.error("Error fetching material types:",s),["frame","mat","glass","hardware"]}},retry:1}),b5=()=>me({queryKey:["materials","suppliers"],queryFn:async()=>{try{const s=await fetch("/api/materials/suppliers");if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const t=await s.json();return Array.isArray(t)?t:[]}catch(s){return console.error("Error fetching material suppliers:",s),["Larson-Juhl","Crescent","Tru Vue"]}},retry:1}),w5=["pending","ordered","received","backorder","cancelled"],N5=()=>{const[s,t]=p.useState("all"),[r,n]=p.useState("all"),[a,i]=p.useState(""),{data:o=[],isLoading:l,error:c,refetch:d}=WC(),{data:u=[]}=j5();b5();const h=async()=>{try{const v=await(await fetch("/api/orders/generate-all-materials",{method:"POST",headers:{"Content-Type":"application/json"}})).json();v.success?(d(),console.log("Materials generated successfully:",v.message)):console.error("Failed to generate materials:",v.error)}catch(f){console.error("Error generating materials:",f)}},m=o.filter(f=>{const v=s==="all"||f.status===s,y=r==="all"||f.type===r,j=a===""||f.name.toLowerCase().includes(a.toLowerCase())||f.sku.toLowerCase().includes(a.toLowerCase())||f.supplier.toLowerCase().includes(a.toLowerCase());return v&&y&&j}),x=f=>{const v={pending:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",ordered:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",received:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",backorder:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",cancelled:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"};return e.jsx(ue,{className:v[f]||"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",children:f.replace("_"," ")})},g=f=>{const v={high:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",low:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"};return e.jsx(ue,{variant:"outline",className:v[f]||"",children:f})};return e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Material Orders"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and track material orders for your framing business"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{onClick:h,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Qs,{className:"h-4 w-4"}),"Generate Materials"]}),e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(Vr,{className:"h-4 w-4"}),"New Order"]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsx(qt,{value:s,onValueChange:f=>t(f),className:"w-full",children:e.jsxs($t,{className:"mb-4",children:[e.jsx(ve,{value:"all",children:"All"}),w5.map(f=>e.jsx(ve,{value:f,children:f.replace("_"," ").replace(/\b\w/g,v=>v.toUpperCase())},f))]})})}),e.jsxs("div",{className:"flex flex-col gap-4 mb-6 md:flex-row md:items-center",children:[e.jsx("div",{className:"flex-1",children:e.jsx(U,{placeholder:"Search materials, SKUs, or suppliers...",value:a,onChange:f=>i(f.target.value)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{htmlFor:"type-filter",className:"whitespace-nowrap",children:"Filter by type:"}),e.jsxs(We,{value:r,onValueChange:n,children:[e.jsx(He,{id:"type-filter",className:"w-[180px]",children:e.jsx(Ke,{placeholder:"Select type"})}),e.jsxs(qe,{children:[e.jsx(se,{value:"all",children:"All Types"}),u.map(f=>e.jsx(se,{value:f,children:f.replace("_"," ").replace(/\b\w/g,v=>v.toUpperCase())},f))]})]})]})]}),c?e.jsx(V,{children:e.jsxs(q,{className:"py-12 text-center",children:[e.jsx(At,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-600 mb-2",children:"Error loading materials"}),e.jsx("p",{className:"text-muted-foreground",children:c instanceof Error?c.message:"Unable to load material orders. Please try again."})]})}):l?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):e.jsx("div",{className:"grid gap-4",children:m.length===0?e.jsx(V,{children:e.jsxs(q,{className:"py-12 text-center",children:[e.jsx(Qs,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No materials found"}),e.jsx("p",{className:"text-muted-foreground",children:a||r!=="all"||s!=="all"?"Try adjusting your filters to see more results.":"No material orders have been created yet."})]})}):m.map(f=>e.jsxs(V,{children:[e.jsx(G,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(Q,{className:"text-lg",children:f.name}),e.jsxs(te,{children:["SKU: ",f.sku," | Supplier: ",f.supplier]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[x(f.status),e.jsx(ue,{variant:"outline",children:f.type}),g(f.priority)]})]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{className:"text-sm font-medium",children:"Quantity"}),e.jsx("p",{className:"text-2xl font-bold",children:f.quantity})]}),e.jsxs("div",{children:[e.jsx(M,{className:"text-sm font-medium",children:"Related Orders"}),e.jsxs("p",{className:"text-sm",children:[f.orderIds.length," order",f.orderIds.length!==1?"s":""]})]}),e.jsxs("div",{children:[e.jsx(M,{className:"text-sm font-medium",children:"Order Date"}),e.jsx("p",{className:"text-sm",children:f.orderDate?new Date(f.orderDate).toLocaleDateString():"Not ordered"})]}),e.jsxs("div",{children:[e.jsx(M,{className:"text-sm font-medium",children:"Receive Date"}),e.jsx("p",{className:"text-sm",children:f.receiveDate?new Date(f.receiveDate).toLocaleDateString():"Not received"})]})]}),f.notes&&e.jsxs("div",{className:"mt-4",children:[e.jsx(M,{className:"text-sm font-medium",children:"Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.notes})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",children:"Edit Order"}),e.jsx(P,{variant:"outline",size:"sm",children:"Update Status"}),e.jsx(P,{variant:"ghost",size:"sm",children:"View Details"})]})]})]},f.id))})]})},Qn=f2,Zn=x2,S5=p.forwardRef(({className:s,inset:t,children:r,...n},a)=>e.jsxs(Gy,{ref:a,className:J("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",s),...n,children:[r,e.jsx(kl,{className:"ml-auto h-4 w-4"})]}));S5.displayName=Gy.displayName;const C5=p.forwardRef(({className:s,...t},r)=>e.jsx(Qy,{ref:r,className:J("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t}));C5.displayName=Qy.displayName;const pn=p.forwardRef(({className:s,sideOffset:t=4,...r},n)=>e.jsx(p2,{children:e.jsx(Zy,{ref:n,sideOffset:t,className:J("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}));pn.displayName=Zy.displayName;const Ms=p.forwardRef(({className:s,inset:t,...r},n)=>e.jsx(Yy,{ref:n,className:J("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",s),...r}));Ms.displayName=Yy.displayName;const k5=p.forwardRef(({className:s,children:t,checked:r,...n},a)=>e.jsxs(Xy,{ref:a,className:J("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:r,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Jy,{children:e.jsx(ls,{className:"h-4 w-4"})})}),t]}));k5.displayName=Xy.displayName;const T5=p.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(ej,{ref:n,className:J("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Jy,{children:e.jsx(uj,{className:"h-2 w-2 fill-current"})})}),t]}));T5.displayName=ej.displayName;const KC=p.forwardRef(({className:s,inset:t,...r},n)=>e.jsx(tj,{ref:n,className:J("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",s),...r}));KC.displayName=tj.displayName;const GC=p.forwardRef(({className:s,...t},r)=>e.jsx(sj,{ref:r,className:J("-mx-1 my-1 h-px bg-muted",s),...t}));GC.displayName=sj.displayName;const cn=[{value:"pending",label:"Pending",color:"default"},{value:"ordered",label:"Ordered",color:"secondary"},{value:"received",label:"Received",color:"success"},{value:"backorder",label:"Back Ordered",color:"warning"},{value:"cancelled",label:"Cancelled",color:"destructive"}],Dp=[{value:"in_stock",label:"In Stock",color:"success",icon:ls},{value:"low_stock",label:"Low Stock",color:"warning",icon:At},{value:"out_of_stock",label:"Out of Stock",color:"destructive",icon:At},{value:"unknown",label:"Check Stock",color:"default",icon:vt}],P5=({onCreateOrder:s})=>{const[t,r]=p.useState([]),[n,a]=p.useState(""),[i,o]=p.useState(null),[l,c]=p.useState(null),[d,u]=p.useState(null),[h,m]=p.useState("name"),[x,g]=p.useState("asc"),[f,v]=p.useState("all"),[y,j]=p.useState(!1),[b,k]=p.useState(null),[S,A]=p.useState(""),[T,C]=p.useState(""),{toast:E}=Be(),{data:D=[],isLoading:w,error:N}=WC(),_=v5(),[F,W]=p.useState(!1),[Z,$]=p.useState(null),ae=Array.from(new Set(D.map(K=>K.supplier))),O=Array.from(new Set(D.map(K=>K.type))),ne=D.filter(K=>{const be=n===""||K.name.toLowerCase().includes(n.toLowerCase())||K.sku.toLowerCase().includes(n.toLowerCase())||K.supplier.toLowerCase().includes(n.toLowerCase()),nt=i===null||K.supplier===i,gt=l===null||K.type===l,fe=d===null||K.status===d,Pt=f==="all"||f==="pending"&&K.status==="pending"||f==="ordered"&&K.status==="ordered"||f==="received"&&K.status==="received";return be&&nt&&gt&&fe&&Pt}).sort((K,be)=>{if(h==="name")return x==="asc"?K.name.localeCompare(be.name):be.name.localeCompare(K.name);if(h==="supplier")return x==="asc"?K.supplier.localeCompare(be.supplier):be.supplier.localeCompare(K.supplier);if(h==="type")return x==="asc"?K.type.localeCompare(be.type):be.type.localeCompare(K.type);if(h==="quantity")return x==="asc"?K.quantity-be.quantity:be.quantity-K.quantity;if(h==="status")return x==="asc"?K.status.localeCompare(be.status):be.status.localeCompare(K.status);if(h==="priority"){const nt=gt=>gt==="high"?3:gt==="medium"?2:1;return x==="asc"?nt(K.priority)-nt(be.priority):nt(be.priority)-nt(K.priority)}return 0}),Pe=()=>{t.length===ne.length?r([]):r(ne.map(K=>K.id))},st=K=>{t.includes(K)?r(t.filter(be=>be!==K)):r([...t,K])},rt=K=>{h===K?g(x==="asc"?"desc":"asc"):(m(K),g("asc"))},B=async(K,be=!1)=>{if(t.length===0){E({title:"No items selected",description:"Please select materials to update.",variant:"destructive"});return}try{const nt=await fetch("/api/materials/bulk-update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materialIds:t,status:K,adminApproval:be})}),gt=await nt.json();if(!nt.ok){if(gt.error==="DOUBLE_ORDER_PREVENTION"){$({materialIds:t,status:K,alreadyOrderedMaterials:gt.alreadyOrderedMaterials}),W(!0);return}throw new Error(gt.message||"Failed to update materials")}E({title:"Success",description:gt.message,variant:"default"}),r([]),window.location.reload()}catch(nt){E({title:"Error",description:nt.message,variant:"destructive"})}},oe=async()=>{Z&&(await B(Z.status,!0),W(!1),$(null))},Y=async()=>{try{const be=await(await fetch("/api/orders/generate-all-materials",{method:"POST",headers:{"Content-Type":"application/json"}})).json();if(be.success)E({title:"Materials Generated",description:`Created ${be.totalMaterialOrders} material orders from ${be.processedOrders} orders`}),window.location.reload();else throw new Error(be.error||"Failed to generate materials")}catch{E({title:"Error",description:"Failed to generate materials from orders",variant:"destructive"})}},z=async(K,be,nt)=>{try{await _.mutateAsync({id:K,data:{stockStatus:be,stockQuantity:(nt==null?void 0:nt.toString())||"0"}}),E({title:"Stock status updated",description:"Material stock status updated"}),window.location.reload()}catch{E({title:"Error",description:"Failed to update stock status",variant:"destructive"})}},le=K=>{const be=Dp.find(gt=>gt.value===(K.stockStatus||"unknown")),nt=(be==null?void 0:be.icon)||vt;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Qn,{children:[e.jsx(Zn,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"flex items-center gap-1 h-6 px-2",children:[e.jsx(nt,{className:"h-3 w-3"}),be==null?void 0:be.label]})}),e.jsx(pn,{children:Dp.map(gt=>e.jsxs(Ms,{onClick:()=>z(K.id,gt.value),className:"flex items-center gap-2",children:[e.jsx(gt.icon,{className:"h-3 w-3"}),gt.label]},gt.value))})]}),K.stockQuantity&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Qty: ",K.stockQuantity]})]})},ye=async(K="")=>{if(t.length===0){E({title:"No items selected",description:"Please select materials to mark as out of stock.",variant:"destructive"});return}try{const be=await fetch("/api/materials/mark-out-of-stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materialIds:t,notes:K})}),nt=await be.json();if(!be.ok)throw new Error(nt.error||"Failed to mark materials as out of stock");E({title:"Success",description:nt.message,variant:"default"}),r([]),window.location.reload()}catch(be){E({title:"Error",description:be.message,variant:"destructive"})}},he=K=>{k(K),A(K.status),C(K.notes||""),j(!0)},je=()=>{!b||!S||_.mutate({id:b.id,data:{status:S,notes:T,orderDate:S==="ordered"?new Date().toISOString():b.orderDate,receiveDate:S==="received"?new Date().toISOString():b.receiveDate}},{onSuccess:()=>{var K;E({title:"Status updated",description:`Material "${b.name}" is now ${((K=cn.find(be=>be.value===S))==null?void 0:K.label)||S}`}),j(!1)},onError:K=>{E({title:"Error updating status",description:K.message,variant:"destructive"})}})},Ne=K=>{const be=cn.find(nt=>nt.value===K)||cn[0];return e.jsx(ue,{variant:be.color,children:be.label})},Qe=K=>{let be;switch(K){case"high":be="destructive";break;case"medium":be="warning";break;default:be="outline"}return e.jsx(ue,{variant:be,children:K})},ke=y5(),xt=()=>{if(t.length===0){E({title:"No items selected",description:"Please select at least one item to create a purchase order",variant:"destructive"});return}ke.mutate({materialIds:t,expectedDeliveryDate:new Date(Date.now()+14*24*60*60*1e3).toISOString()},{onSuccess:()=>{B("ordered"),s&&s()}})},yt=()=>{const K=t.length>0?D.filter(Yt=>t.includes(Yt.id)):ne;if(K.length===0){E({title:"No items to export",description:"The current filtered list is empty",variant:"destructive"});return}const be=["SKU","Name","Supplier","Type","Quantity","Status","Priority","Notes"],nt=K.map(Yt=>{var tr;return[Yt.sku,Yt.name,Yt.supplier,Yt.type,Yt.quantity.toString(),((tr=cn.find(ao=>ao.value===Yt.status))==null?void 0:tr.label)||Yt.status,Yt.priority,Yt.notes||""]}),gt=[be.join(","),...nt.map(Yt=>Yt.map(tr=>`"${tr.replace(/"/g,'""')}"`).join(","))].join(`
`),fe=new Blob([gt],{type:"text/csv;charset=utf-8;"}),Pt=URL.createObjectURL(fe),rs=document.createElement("a");rs.setAttribute("href",Pt),rs.setAttribute("download",`materials-pick-list-${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(rs),rs.click(),document.body.removeChild(rs),E({title:"Pick list exported",description:`Exported ${K.length} items to CSV file`})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Materials Pick List"}),e.jsx("p",{className:"text-muted-foreground",children:"Track and manage materials needed for orders"})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsxs(P,{variant:"outline",onClick:yt,className:"flex items-center gap-2",children:[e.jsx(Cl,{className:"h-4 w-4"}),"Export"]}),e.jsxs(P,{onClick:()=>B("ordered"),disabled:t.length===0,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700",children:[e.jsx(ls,{className:"h-4 w-4"}),"Mark as Ordered"]}),e.jsxs(P,{variant:"outline",onClick:()=>ye(),disabled:t.length===0,className:"flex items-center gap-2 border-red-500 text-red-600 hover:bg-red-50",children:[e.jsx(At,{className:"h-4 w-4"}),"Out of Stock"]}),e.jsxs(P,{onClick:xt,disabled:t.length===0,className:"flex items-center gap-2",children:[e.jsx(wl,{className:"h-4 w-4"}),"Create Purchase Order"]}),e.jsxs(P,{onClick:Y,variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(Vr,{className:"h-4 w-4"}),"Generate Materials from Orders"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Zr,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(U,{placeholder:"Search materials, SKUs, or suppliers...",className:"pl-8",value:n,onChange:K=>a(K.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Qn,{children:[e.jsx(Zn,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ai,{className:"h-4 w-4"}),"Supplier",e.jsx(ns,{className:"h-4 w-4"})]})}),e.jsxs(pn,{align:"end",children:[e.jsx(Ms,{onClick:()=>o(null),children:"All Suppliers"}),ae.map(K=>e.jsx(Ms,{onClick:()=>o(K),children:K},K))]})]}),e.jsxs(Qn,{children:[e.jsx(Zn,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ai,{className:"h-4 w-4"}),"Type",e.jsx(ns,{className:"h-4 w-4"})]})}),e.jsxs(pn,{align:"end",children:[e.jsx(Ms,{onClick:()=>c(null),children:"All Types"}),O.map(K=>e.jsx(Ms,{onClick:()=>c(K),children:K},K))]})]}),e.jsxs(Qn,{children:[e.jsx(Zn,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ai,{className:"h-4 w-4"}),"Status",e.jsx(ns,{className:"h-4 w-4"})]})}),e.jsxs(pn,{align:"end",children:[e.jsx(Ms,{onClick:()=>u(null),children:"All Statuses"}),cn.map(K=>e.jsx(Ms,{onClick:()=>u(K.value),children:K.label},K.value))]})]})]})]}),e.jsx(qt,{value:f,onValueChange:v,children:e.jsxs($t,{children:[e.jsxs(ve,{value:"all",className:"flex items-center gap-2",children:[e.jsx(fj,{className:"h-4 w-4"}),"All Materials"]}),e.jsxs(ve,{value:"pending",className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4"}),"Pending"]}),e.jsxs(ve,{value:"ordered",className:"flex items-center gap-2",children:[e.jsx(Yr,{className:"h-4 w-4"}),"Ordered"]}),e.jsxs(ve,{value:"received",className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-4 w-4"}),"Received"]})]})}),e.jsx(V,{children:e.jsx(q,{className:"p-0",children:N?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(At,{className:"mx-auto h-12 w-12 text-red-500"}),e.jsx("h3",{className:"mt-4 text-lg font-semibold text-red-600",children:"Error loading materials"}),e.jsx("p",{className:"text-muted-foreground",children:N instanceof Error?N.message:"Unable to load materials pick list. Please try again."})]}):w?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):ne.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Qs,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("h3",{className:"mt-4 text-lg font-semibold",children:"No materials found"}),e.jsx("p",{className:"text-muted-foreground",children:n||i||l||d?"Try adjusting your filters":"No materials in the pick list"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{className:"w-12",children:e.jsx(os,{checked:ne.length>0&&t.length===ne.length,onCheckedChange:Pe,"aria-label":"Select all"})}),e.jsx(de,{className:"w-[180px]",children:e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>rt("name"),children:["Material",h==="name"&&e.jsx(ns,{className:`h-4 w-4 ml-1 ${x==="desc"?"rotate-180":""} transition-transform`})]})}),e.jsx(de,{children:e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>rt("supplier"),children:["Supplier",h==="supplier"&&e.jsx(ns,{className:`h-4 w-4 ml-1 ${x==="desc"?"rotate-180":""} transition-transform`})]})}),e.jsx(de,{children:e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>rt("type"),children:["Type",h==="type"&&e.jsx(ns,{className:`h-4 w-4 ml-1 ${x==="desc"?"rotate-180":""} transition-transform`})]})}),e.jsx(de,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end cursor-pointer",onClick:()=>rt("quantity"),children:["Quantity",h==="quantity"&&e.jsx(ns,{className:`h-4 w-4 ml-1 ${x==="desc"?"rotate-180":""} transition-transform`})]})}),e.jsx(de,{children:e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>rt("priority"),children:["Priority",h==="priority"&&e.jsx(ns,{className:`h-4 w-4 ml-1 ${x==="desc"?"rotate-180":""} transition-transform`})]})}),e.jsx(de,{children:e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>rt("status"),children:["Order Status",h==="status"&&e.jsx(ns,{className:`h-4 w-4 ml-1 ${x==="desc"?"rotate-180":""} transition-transform`})]})}),e.jsx(de,{children:"Stock Status"}),e.jsx(de,{className:"text-right",children:"Actions"})]})}),e.jsx(ys,{children:ne.map(K=>e.jsxs(tt,{children:[e.jsx(ie,{children:e.jsx(os,{checked:t.includes(K.id),onCheckedChange:()=>st(K.id),"aria-label":`Select ${K.name}`})}),e.jsxs(ie,{children:[e.jsx("div",{className:"font-medium",children:K.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["SKU: ",K.sku]})]}),e.jsx(ie,{children:K.supplier}),e.jsx(ie,{children:K.type}),e.jsx(ie,{className:"text-right",children:K.quantity}),e.jsx(ie,{children:Qe(K.priority)}),e.jsx(ie,{children:Ne(K.status)}),e.jsx(ie,{children:le(K)}),e.jsx(ie,{className:"text-right",children:e.jsxs(P,{variant:"ghost",size:"icon",onClick:()=>he(K),children:[e.jsx(H2,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Update status"})]})})]},K.id))})]})})})}),t.length>0&&e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-background border-t p-4 flex items-center justify-between shadow-lg",children:[e.jsx("div",{children:e.jsxs("span",{className:"font-medium",children:[t.length," items selected"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>r([]),children:"Clear Selection"}),e.jsxs(Qn,{children:[e.jsx(Zn,{asChild:!0,children:e.jsxs(P,{size:"sm",className:"flex items-center gap-2",children:["Update Status",e.jsx(ns,{className:"h-4 w-4"})]})}),e.jsx(pn,{align:"end",children:cn.map(K=>e.jsx(Ms,{onClick:()=>B(K.value),children:K.label},K.value))})]})]})]}),e.jsx(Bt,{open:y,onOpenChange:j,children:e.jsxs(Lt,{children:[e.jsxs(Vt,{children:[e.jsx(Ut,{children:"Update Material Status"}),e.jsx(bs,{children:"Change the status and add notes for this material."})]}),b&&e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:b.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["SKU: ",b.sku]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:cn.map(K=>e.jsxs("div",{className:`
                        flex items-center space-x-2 rounded-md border p-2 cursor-pointer
                        ${S===K.value?"border-primary":""}
                      `,onClick:()=>A(K.value),children:[e.jsx(os,{checked:S===K.value,onCheckedChange:()=>A(K.value)}),e.jsxs("div",{className:"flex flex-1 items-center justify-between",children:[e.jsx("span",{children:K.label}),Ne(K.value)]})]},K.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes"}),e.jsx("textarea",{className:"w-full h-24 p-2 rounded-md border",placeholder:"Add notes about this order...",value:T,onChange:K=>C(K.target.value)})]})]}),e.jsxs(_n,{children:[e.jsx(P,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(P,{onClick:je,children:"Update Status"})]})]})}),e.jsx(Bt,{open:F,onOpenChange:W,children:e.jsxs(Lt,{className:"sm:max-w-[600px]",children:[e.jsxs(Vt,{children:[e.jsx(Ut,{className:"text-red-600 font-bold",children:"⚠️ DOUBLE ORDER PREVENTION ALERT"}),e.jsx(bs,{className:"text-red-700",children:"Some materials are already ordered. Admin approval required to proceed."})]}),Z&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Already Ordered Materials:"}),e.jsx("ul",{className:"space-y-1",children:Z.alreadyOrderedMaterials.map(K=>e.jsxs("li",{className:"text-sm text-red-700",children:["• ",K.name," (SKU: ",K.sku,") - Status: ",K.status]},K.id))})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Action Requested:"}),e.jsxs("p",{className:"text-sm text-yellow-700",children:["Mark ",Z.materialIds.length,' materials as "',Z.status,'"']})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Admin Override Options:"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• Approve if duplicate ordering is intentional"}),e.jsx("li",{children:"• Cancel if this was an error"}),e.jsx("li",{children:"• Review material status before proceeding"})]})]})]}),e.jsxs(_n,{className:"gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>{W(!1),$(null)},children:"Cancel"}),e.jsx(P,{variant:"destructive",onClick:oe,className:"bg-red-600 hover:bg-red-700",children:"Admin Approve Override"})]})]})})]})},E5=()=>{const[,s]=Cs(),t=()=>{s("/materials")};return e.jsx("div",{className:"container mx-auto py-6",children:e.jsx(P5,{onCreateOrder:t})})};function D5(s){if(typeof Proxy>"u")return s;const t=new Map,r=(...n)=>s(...n);return new Proxy(r,{get:(n,a)=>a==="create"?s:(t.has(a)||t.set(a,s(a)),t.get(a))})}function Xl(s){return s!==null&&typeof s=="object"&&typeof s.start=="function"}const Ld=s=>Array.isArray(s);function QC(s,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==s.length)return!1;for(let n=0;n<r;n++)if(t[n]!==s[n])return!1;return!0}function Oi(s){return typeof s=="string"||Array.isArray(s)}function Ap(s){const t=[{},{}];return s==null||s.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function pm(s,t,r,n){if(typeof t=="function"){const[a,i]=Ap(n);t=t(r!==void 0?r:s.custom,a,i)}if(typeof t=="string"&&(t=s.variants&&s.variants[t]),typeof t=="function"){const[a,i]=Ap(n);t=t(r!==void 0?r:s.custom,a,i)}return t}function Jl(s,t,r){const n=s.getProps();return pm(n,t,r!==void 0?r:n.custom,s)}const fm=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],xm=["initial",...fm],to=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Un=new Set(to),wr=s=>s*1e3,Nr=s=>s/1e3,A5={type:"spring",stiffness:500,damping:25,restSpeed:10},_5=s=>({type:"spring",stiffness:550,damping:s===0?2*Math.sqrt(550):30,restSpeed:10}),I5={type:"keyframes",duration:.8},R5={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},M5=(s,{keyframes:t})=>t.length>2?I5:Un.has(s)?s.startsWith("scale")?_5(t[1]):A5:R5;function gm(s,t){return s?s[t]||s.default||s:void 0}const O5={skipAnimations:!1,useManualTiming:!1},F5=s=>s!==null;function ec(s,{repeat:t,repeatType:r="loop"},n){const a=s.filter(F5),i=t&&r!=="loop"&&t%2===1?0:a.length-1;return!i||n===void 0?a[i]:n}const ts=s=>s;let $d=ts;function L5(s){let t=new Set,r=new Set,n=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(d){i.has(d)&&(c.schedule(d),s()),d(o)}const c={schedule:(d,u=!1,h=!1)=>{const x=h&&n?t:r;return u&&i.add(d),x.has(d)||x.add(d),d},cancel:d=>{r.delete(d),i.delete(d)},process:d=>{if(o=d,n){a=!0;return}n=!0,[t,r]=[r,t],r.clear(),t.forEach(l),n=!1,a&&(a=!1,c.process(d))}};return c}const vo=["read","resolveKeyframes","update","preRender","render","postRender"],$5=40;function ZC(s,t){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,o=vo.reduce((y,j)=>(y[j]=L5(i),y),{}),{read:l,resolveKeyframes:c,update:d,preRender:u,render:h,postRender:m}=o,x=()=>{const y=performance.now();r=!1,a.delta=n?1e3/60:Math.max(Math.min(y-a.timestamp,$5),1),a.timestamp=y,a.isProcessing=!0,l.process(a),c.process(a),d.process(a),u.process(a),h.process(a),m.process(a),a.isProcessing=!1,r&&t&&(n=!1,s(x))},g=()=>{r=!0,n=!0,a.isProcessing||s(x)};return{schedule:vo.reduce((y,j)=>{const b=o[j];return y[j]=(k,S=!1,A=!1)=>(r||g(),b.schedule(k,S,A)),y},{}),cancel:y=>{for(let j=0;j<vo.length;j++)o[vo[j]].cancel(y)},state:a,steps:o}}const{schedule:mt,cancel:Gr,state:Gt,steps:Ic}=ZC(typeof requestAnimationFrame<"u"?requestAnimationFrame:ts,!0),YC=(s,t,r)=>(((1-3*r+3*t)*s+(3*r-6*t))*s+3*t)*s,B5=1e-7,V5=12;function U5(s,t,r,n,a){let i,o,l=0;do o=t+(r-t)/2,i=YC(o,n,a)-s,i>0?r=o:t=o;while(Math.abs(i)>B5&&++l<V5);return o}function so(s,t,r,n){if(s===t&&r===n)return ts;const a=i=>U5(i,0,1,s,r);return i=>i===0||i===1?i:YC(a(i),t,n)}const XC=s=>t=>t<=.5?s(2*t)/2:(2-s(2*(1-t)))/2,JC=s=>t=>1-s(1-t),e1=so(.33,1.53,.69,.99),vm=JC(e1),t1=XC(vm),s1=s=>(s*=2)<1?.5*vm(s):.5*(2-Math.pow(2,-10*(s-1))),ym=s=>1-Math.sin(Math.acos(s)),r1=JC(ym),n1=XC(ym),a1=s=>/^0[^.\s]+$/u.test(s);function H5(s){return typeof s=="number"?s===0:s!==null?s==="none"||s==="0"||a1(s):!0}const i1=s=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(s),o1=s=>t=>typeof t=="string"&&t.startsWith(s),l1=o1("--"),q5=o1("var(--"),jm=s=>q5(s)?z5.test(s.split("/*")[0].trim()):!1,z5=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,W5=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function K5(s){const t=W5.exec(s);if(!t)return[,];const[,r,n,a]=t;return[`--${r??n}`,a]}function c1(s,t,r=1){const[n,a]=K5(s);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const o=i.trim();return i1(o)?parseFloat(o):o}return jm(a)?c1(a,t,r+1):a}const kr=(s,t,r)=>r>t?t:r<s?s:r,Va={test:s=>typeof s=="number",parse:parseFloat,transform:s=>s},Fi={...Va,transform:s=>kr(0,1,s)},yo={...Va,default:1},ro=s=>({test:t=>typeof t=="string"&&t.endsWith(s)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${s}`}),_r=ro("deg"),lr=ro("%"),Ee=ro("px"),G5=ro("vh"),Q5=ro("vw"),_p={...lr,parse:s=>lr.parse(s)/100,transform:s=>lr.transform(s*100)},Z5=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),Ip=s=>s===Va||s===Ee,Rp=(s,t)=>parseFloat(s.split(", ")[t]),Mp=(s,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const a=n.match(/^matrix3d\((.+)\)$/u);if(a)return Rp(a[1],t);{const i=n.match(/^matrix\((.+)\)$/u);return i?Rp(i[1],s):0}},Y5=new Set(["x","y","z"]),X5=to.filter(s=>!Y5.has(s));function J5(s){const t=[];return X5.forEach(r=>{const n=s.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const Sa={width:({x:s},{paddingLeft:t="0",paddingRight:r="0"})=>s.max-s.min-parseFloat(t)-parseFloat(r),height:({y:s},{paddingTop:t="0",paddingBottom:r="0"})=>s.max-s.min-parseFloat(t)-parseFloat(r),top:(s,{top:t})=>parseFloat(t),left:(s,{left:t})=>parseFloat(t),bottom:({y:s},{top:t})=>parseFloat(t)+(s.max-s.min),right:({x:s},{left:t})=>parseFloat(t)+(s.max-s.min),x:Mp(4,13),y:Mp(5,14)};Sa.translateX=Sa.x;Sa.translateY=Sa.y;const d1=s=>t=>t.test(s),eL={test:s=>s==="auto",parse:s=>s},u1=[Va,Ee,lr,_r,Q5,G5,eL],Op=s=>u1.find(d1(s)),En=new Set;let Bd=!1,Vd=!1;function m1(){if(Vd){const s=Array.from(En).filter(n=>n.needsMeasurement),t=new Set(s.map(n=>n.element)),r=new Map;t.forEach(n=>{const a=J5(n);a.length&&(r.set(n,a),n.render())}),s.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const a=r.get(n);a&&a.forEach(([i,o])=>{var l;(l=n.getValue(i))===null||l===void 0||l.set(o)})}),s.forEach(n=>n.measureEndState()),s.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Vd=!1,Bd=!1,En.forEach(s=>s.complete()),En.clear()}function h1(){En.forEach(s=>{s.readKeyframes(),s.needsMeasurement&&(Vd=!0)})}function tL(){h1(),m1()}class bm{constructor(t,r,n,a,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=a,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(En.add(this),Bd||(Bd=!0,mt.read(h1),mt.resolveKeyframes(m1))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:a}=this;for(let i=0;i<t.length;i++)if(t[i]===null)if(i===0){const o=a==null?void 0:a.get(),l=t[t.length-1];if(o!==void 0)t[0]=o;else if(n&&r){const c=n.readValue(r,l);c!=null&&(t[0]=c)}t[0]===void 0&&(t[0]=l),a&&o===void 0&&a.set(t[0])}else t[i]=t[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),En.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,En.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const ui=s=>Math.round(s*1e5)/1e5,wm=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function sL(s){return s==null}const rL=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Nm=(s,t)=>r=>!!(typeof r=="string"&&rL.test(r)&&r.startsWith(s)||t&&!sL(r)&&Object.prototype.hasOwnProperty.call(r,t)),p1=(s,t,r)=>n=>{if(typeof n!="string")return n;const[a,i,o,l]=n.match(wm);return{[s]:parseFloat(a),[t]:parseFloat(i),[r]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},nL=s=>kr(0,255,s),Rc={...Va,transform:s=>Math.round(nL(s))},yn={test:Nm("rgb","red"),parse:p1("red","green","blue"),transform:({red:s,green:t,blue:r,alpha:n=1})=>"rgba("+Rc.transform(s)+", "+Rc.transform(t)+", "+Rc.transform(r)+", "+ui(Fi.transform(n))+")"};function aL(s){let t="",r="",n="",a="";return s.length>5?(t=s.substring(1,3),r=s.substring(3,5),n=s.substring(5,7),a=s.substring(7,9)):(t=s.substring(1,2),r=s.substring(2,3),n=s.substring(3,4),a=s.substring(4,5),t+=t,r+=r,n+=n,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const Ud={test:Nm("#"),parse:aL,transform:yn.transform},Jn={test:Nm("hsl","hue"),parse:p1("hue","saturation","lightness"),transform:({hue:s,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(s)+", "+lr.transform(ui(t))+", "+lr.transform(ui(r))+", "+ui(Fi.transform(n))+")"},Xt={test:s=>yn.test(s)||Ud.test(s)||Jn.test(s),parse:s=>yn.test(s)?yn.parse(s):Jn.test(s)?Jn.parse(s):Ud.parse(s),transform:s=>typeof s=="string"?s:s.hasOwnProperty("red")?yn.transform(s):Jn.transform(s)},iL=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function oL(s){var t,r;return isNaN(s)&&typeof s=="string"&&(((t=s.match(wm))===null||t===void 0?void 0:t.length)||0)+(((r=s.match(iL))===null||r===void 0?void 0:r.length)||0)>0}const f1="number",x1="color",lL="var",cL="var(",Fp="${}",dL=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Li(s){const t=s.toString(),r=[],n={color:[],number:[],var:[]},a=[];let i=0;const l=t.replace(dL,c=>(Xt.test(c)?(n.color.push(i),a.push(x1),r.push(Xt.parse(c))):c.startsWith(cL)?(n.var.push(i),a.push(lL),r.push(c)):(n.number.push(i),a.push(f1),r.push(parseFloat(c))),++i,Fp)).split(Fp);return{values:r,split:l,indexes:n,types:a}}function g1(s){return Li(s).values}function v1(s){const{split:t,types:r}=Li(s),n=t.length;return a=>{let i="";for(let o=0;o<n;o++)if(i+=t[o],a[o]!==void 0){const l=r[o];l===f1?i+=ui(a[o]):l===x1?i+=Xt.transform(a[o]):i+=a[o]}return i}}const uL=s=>typeof s=="number"?0:s;function mL(s){const t=g1(s);return v1(s)(t.map(uL))}const Qr={test:oL,parse:g1,createTransformer:v1,getAnimatableNone:mL},hL=new Set(["brightness","contrast","saturate","opacity"]);function pL(s){const[t,r]=s.slice(0,-1).split("(");if(t==="drop-shadow")return s;const[n]=r.match(wm)||[];if(!n)return s;const a=r.replace(n,"");let i=hL.has(t)?1:0;return n!==r&&(i*=100),t+"("+i+a+")"}const fL=/\b([a-z-]*)\(.*?\)/gu,Hd={...Qr,getAnimatableNone:s=>{const t=s.match(fL);return t?t.map(pL).join(" "):s}},xL={borderWidth:Ee,borderTopWidth:Ee,borderRightWidth:Ee,borderBottomWidth:Ee,borderLeftWidth:Ee,borderRadius:Ee,radius:Ee,borderTopLeftRadius:Ee,borderTopRightRadius:Ee,borderBottomRightRadius:Ee,borderBottomLeftRadius:Ee,width:Ee,maxWidth:Ee,height:Ee,maxHeight:Ee,top:Ee,right:Ee,bottom:Ee,left:Ee,padding:Ee,paddingTop:Ee,paddingRight:Ee,paddingBottom:Ee,paddingLeft:Ee,margin:Ee,marginTop:Ee,marginRight:Ee,marginBottom:Ee,marginLeft:Ee,backgroundPositionX:Ee,backgroundPositionY:Ee},gL={rotate:_r,rotateX:_r,rotateY:_r,rotateZ:_r,scale:yo,scaleX:yo,scaleY:yo,scaleZ:yo,skew:_r,skewX:_r,skewY:_r,distance:Ee,translateX:Ee,translateY:Ee,translateZ:Ee,x:Ee,y:Ee,z:Ee,perspective:Ee,transformPerspective:Ee,opacity:Fi,originX:_p,originY:_p,originZ:Ee},Lp={...Va,transform:Math.round},Sm={...xL,...gL,zIndex:Lp,size:Ee,fillOpacity:Fi,strokeOpacity:Fi,numOctaves:Lp},vL={...Sm,color:Xt,backgroundColor:Xt,outlineColor:Xt,fill:Xt,stroke:Xt,borderColor:Xt,borderTopColor:Xt,borderRightColor:Xt,borderBottomColor:Xt,borderLeftColor:Xt,filter:Hd,WebkitFilter:Hd},Cm=s=>vL[s];function y1(s,t){let r=Cm(s);return r!==Hd&&(r=Qr),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const yL=new Set(["auto","none","0"]);function jL(s,t,r){let n=0,a;for(;n<s.length&&!a;){const i=s[n];typeof i=="string"&&!yL.has(i)&&Li(i).values.length&&(a=s[n]),n++}if(a&&r)for(const i of t)s[i]=y1(r,a)}class j1 extends bm{constructor(t,r,n,a,i){super(t,r,n,a,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let d=t[c];if(typeof d=="string"&&(d=d.trim(),jm(d))){const u=c1(d,r.current);u!==void 0&&(t[c]=u),c===t.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!Z5.has(n)||t.length!==2)return;const[a,i]=t,o=Op(a),l=Op(i);if(o!==l)if(Ip(o)&&Ip(l))for(let c=0;c<t.length;c++){const d=t[c];typeof d=="string"&&(t[c]=parseFloat(d))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let a=0;a<t.length;a++)H5(t[a])&&n.push(a);n.length&&jL(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Sa[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const a=r[r.length-1];a!==void 0&&t.getValue(n,a).jump(a,!1)}measureEndState(){var t;const{element:r,name:n,unresolvedKeyframes:a}=this;if(!r||!r.current)return;const i=r.getValue(n);i&&i.jump(this.measuredOrigin,!1);const o=a.length-1,l=a[o];a[o]=Sa[n](r.measureViewportBox(),window.getComputedStyle(r.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([c,d])=>{r.getValue(c).set(d)}),this.resolveNoneKeyframes()}}function km(s){return typeof s=="function"}let Ro;function bL(){Ro=void 0}const cr={now:()=>(Ro===void 0&&cr.set(Gt.isProcessing||O5.useManualTiming?Gt.timestamp:performance.now()),Ro),set:s=>{Ro=s,queueMicrotask(bL)}},$p=(s,t)=>t==="zIndex"?!1:!!(typeof s=="number"||Array.isArray(s)||typeof s=="string"&&(Qr.test(s)||s==="0")&&!s.startsWith("url("));function wL(s){const t=s[0];if(s.length===1)return!0;for(let r=0;r<s.length;r++)if(s[r]!==t)return!0}function NL(s,t,r,n){const a=s[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const i=s[s.length-1],o=$p(a,t),l=$p(i,t);return!o||!l?!1:wL(s)||(r==="spring"||km(r))&&n}const SL=40;class b1{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:a=0,repeatDelay:i=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=cr.now(),this.options={autoplay:t,delay:r,type:n,repeat:a,repeatDelay:i,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>SL?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&tL(),this._resolved}onKeyframesResolved(t,r){this.resolvedAt=cr.now(),this.hasAttemptedResolve=!0;const{name:n,type:a,velocity:i,delay:o,onComplete:l,onUpdate:c,isGenerator:d}=this.options;if(!d&&!NL(t,n,a,i))if(o)this.options.duration=0;else{c==null||c(ec(t,this.options,r)),l==null||l(),this.resolveFinishedPromise();return}const u=this.initPlayback(t,r);u!==!1&&(this._resolved={keyframes:t,finalKeyframe:r,...u},this.onPostResolved())}onPostResolved(){}then(t,r){return this.currentFinishedPromise.then(t,r)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const Ca=(s,t,r)=>{const n=t-s;return n===0?1:(r-s)/n},w1=(s,t,r=10)=>{let n="";const a=Math.max(Math.round(t/r),2);for(let i=0;i<a;i++)n+=s(Ca(0,a-1,i))+", ";return`linear(${n.substring(0,n.length-2)})`};function N1(s,t){return t?s*(1e3/t):0}const CL=5;function S1(s,t,r){const n=Math.max(t-CL,0);return N1(r-s(n),t-n)}const Tt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Mc=.001;function kL({duration:s=Tt.duration,bounce:t=Tt.bounce,velocity:r=Tt.velocity,mass:n=Tt.mass}){let a,i,o=1-t;o=kr(Tt.minDamping,Tt.maxDamping,o),s=kr(Tt.minDuration,Tt.maxDuration,Nr(s)),o<1?(a=d=>{const u=d*o,h=u*s,m=u-r,x=qd(d,o),g=Math.exp(-h);return Mc-m/x*g},i=d=>{const h=d*o*s,m=h*r+r,x=Math.pow(o,2)*Math.pow(d,2)*s,g=Math.exp(-h),f=qd(Math.pow(d,2),o);return(-a(d)+Mc>0?-1:1)*((m-x)*g)/f}):(a=d=>{const u=Math.exp(-d*s),h=(d-r)*s+1;return-Mc+u*h},i=d=>{const u=Math.exp(-d*s),h=(r-d)*(s*s);return u*h});const l=5/s,c=PL(a,i,l);if(s=wr(s),isNaN(c))return{stiffness:Tt.stiffness,damping:Tt.damping,duration:s};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:o*2*Math.sqrt(n*d),duration:s}}}const TL=12;function PL(s,t,r){let n=r;for(let a=1;a<TL;a++)n=n-s(n)/t(n);return n}function qd(s,t){return s*Math.sqrt(1-t*t)}const zd=2e4;function C1(s){let t=0;const r=50;let n=s.next(t);for(;!n.done&&t<zd;)t+=r,n=s.next(t);return t>=zd?1/0:t}const EL=["duration","bounce"],DL=["stiffness","damping","mass"];function Bp(s,t){return t.some(r=>s[r]!==void 0)}function AL(s){let t={velocity:Tt.velocity,stiffness:Tt.stiffness,damping:Tt.damping,mass:Tt.mass,isResolvedFromDuration:!1,...s};if(!Bp(s,DL)&&Bp(s,EL))if(s.visualDuration){const r=s.visualDuration,n=2*Math.PI/(r*1.2),a=n*n,i=2*kr(.05,1,1-s.bounce)*Math.sqrt(a);t={...t,mass:Tt.mass,stiffness:a,damping:i}}else{const r=kL(s);t={...t,...r,mass:Tt.mass},t.isResolvedFromDuration=!0}return t}function k1(s=Tt.visualDuration,t=Tt.bounce){const r=typeof s!="object"?{visualDuration:s,keyframes:[0,1],bounce:t}:s;let{restSpeed:n,restDelta:a}=r;const i=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],l={done:!1,value:i},{stiffness:c,damping:d,mass:u,duration:h,velocity:m,isResolvedFromDuration:x}=AL({...r,velocity:-Nr(r.velocity||0)}),g=m||0,f=d/(2*Math.sqrt(c*u)),v=o-i,y=Nr(Math.sqrt(c/u)),j=Math.abs(v)<5;n||(n=j?Tt.restSpeed.granular:Tt.restSpeed.default),a||(a=j?Tt.restDelta.granular:Tt.restDelta.default);let b;if(f<1){const S=qd(y,f);b=A=>{const T=Math.exp(-f*y*A);return o-T*((g+f*y*v)/S*Math.sin(S*A)+v*Math.cos(S*A))}}else if(f===1)b=S=>o-Math.exp(-y*S)*(v+(g+y*v)*S);else{const S=y*Math.sqrt(f*f-1);b=A=>{const T=Math.exp(-f*y*A),C=Math.min(S*A,300);return o-T*((g+f*y*v)*Math.sinh(C)+S*v*Math.cosh(C))/S}}const k={calculatedDuration:x&&h||null,next:S=>{const A=b(S);if(x)l.done=S>=h;else{let T=0;f<1&&(T=S===0?wr(g):S1(b,S,A));const C=Math.abs(T)<=n,E=Math.abs(o-A)<=a;l.done=C&&E}return l.value=l.done?o:A,l},toString:()=>{const S=Math.min(C1(k),zd),A=w1(T=>k.next(S*T).value,S,30);return S+"ms "+A}};return k}function Vp({keyframes:s,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:d=.5,restSpeed:u}){const h=s[0],m={done:!1,value:h},x=C=>l!==void 0&&C<l||c!==void 0&&C>c,g=C=>l===void 0?c:c===void 0||Math.abs(l-C)<Math.abs(c-C)?l:c;let f=r*t;const v=h+f,y=o===void 0?v:o(v);y!==v&&(f=y-h);const j=C=>-f*Math.exp(-C/n),b=C=>y+j(C),k=C=>{const E=j(C),D=b(C);m.done=Math.abs(E)<=d,m.value=m.done?y:D};let S,A;const T=C=>{x(m.value)&&(S=C,A=k1({keyframes:[m.value,g(m.value)],velocity:S1(b,C,m.value),damping:a,stiffness:i,restDelta:d,restSpeed:u}))};return T(0),{calculatedDuration:null,next:C=>{let E=!1;return!A&&S===void 0&&(E=!0,k(C),T(C)),S!==void 0&&C>=S?A.next(C-S):(!E&&k(C),m)}}}const _L=so(.42,0,1,1),IL=so(0,0,.58,1),T1=so(.42,0,.58,1),RL=s=>Array.isArray(s)&&typeof s[0]!="number",Tm=s=>Array.isArray(s)&&typeof s[0]=="number",Up={linear:ts,easeIn:_L,easeInOut:T1,easeOut:IL,circIn:ym,circInOut:n1,circOut:r1,backIn:vm,backInOut:t1,backOut:e1,anticipate:s1},Hp=s=>{if(Tm(s)){$d(s.length===4);const[t,r,n,a]=s;return so(t,r,n,a)}else if(typeof s=="string")return $d(Up[s]!==void 0),Up[s];return s},ML=(s,t)=>r=>t(s(r)),$r=(...s)=>s.reduce(ML),St=(s,t,r)=>s+(t-s)*r;function Oc(s,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?s+(t-s)*6*r:r<1/2?t:r<2/3?s+(t-s)*(2/3-r)*6:s}function OL({hue:s,saturation:t,lightness:r,alpha:n}){s/=360,t/=100,r/=100;let a=0,i=0,o=0;if(!t)a=i=o=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;a=Oc(c,l,s+1/3),i=Oc(c,l,s),o=Oc(c,l,s-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:n}}function il(s,t){return r=>r>0?t:s}const Fc=(s,t,r)=>{const n=s*s,a=r*(t*t-n)+n;return a<0?0:Math.sqrt(a)},FL=[Ud,yn,Jn],LL=s=>FL.find(t=>t.test(s));function qp(s){const t=LL(s);if(!t)return!1;let r=t.parse(s);return t===Jn&&(r=OL(r)),r}const zp=(s,t)=>{const r=qp(s),n=qp(t);if(!r||!n)return il(s,t);const a={...r};return i=>(a.red=Fc(r.red,n.red,i),a.green=Fc(r.green,n.green,i),a.blue=Fc(r.blue,n.blue,i),a.alpha=St(r.alpha,n.alpha,i),yn.transform(a))},Wd=new Set(["none","hidden"]);function $L(s,t){return Wd.has(s)?r=>r<=0?s:t:r=>r>=1?t:s}function BL(s,t){return r=>St(s,t,r)}function Pm(s){return typeof s=="number"?BL:typeof s=="string"?jm(s)?il:Xt.test(s)?zp:HL:Array.isArray(s)?P1:typeof s=="object"?Xt.test(s)?zp:VL:il}function P1(s,t){const r=[...s],n=r.length,a=s.map((i,o)=>Pm(i)(i,t[o]));return i=>{for(let o=0;o<n;o++)r[o]=a[o](i);return r}}function VL(s,t){const r={...s,...t},n={};for(const a in r)s[a]!==void 0&&t[a]!==void 0&&(n[a]=Pm(s[a])(s[a],t[a]));return a=>{for(const i in n)r[i]=n[i](a);return r}}function UL(s,t){var r;const n=[],a={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const o=t.types[i],l=s.indexes[o][a[o]],c=(r=s.values[l])!==null&&r!==void 0?r:0;n[i]=c,a[o]++}return n}const HL=(s,t)=>{const r=Qr.createTransformer(t),n=Li(s),a=Li(t);return n.indexes.var.length===a.indexes.var.length&&n.indexes.color.length===a.indexes.color.length&&n.indexes.number.length>=a.indexes.number.length?Wd.has(s)&&!a.values.length||Wd.has(t)&&!n.values.length?$L(s,t):$r(P1(UL(n,a),a.values),r):il(s,t)};function E1(s,t,r){return typeof s=="number"&&typeof t=="number"&&typeof r=="number"?St(s,t,r):Pm(s)(s,t)}function qL(s,t,r){const n=[],a=r||E1,i=s.length-1;for(let o=0;o<i;o++){let l=a(s[o],s[o+1]);if(t){const c=Array.isArray(t)?t[o]||ts:t;l=$r(c,l)}n.push(l)}return n}function zL(s,t,{clamp:r=!0,ease:n,mixer:a}={}){const i=s.length;if($d(i===t.length),i===1)return()=>t[0];if(i===2&&s[0]===s[1])return()=>t[1];s[0]>s[i-1]&&(s=[...s].reverse(),t=[...t].reverse());const o=qL(t,n,a),l=o.length,c=d=>{let u=0;if(l>1)for(;u<s.length-2&&!(d<s[u+1]);u++);const h=Ca(s[u],s[u+1],d);return o[u](h)};return r?d=>c(kr(s[0],s[i-1],d)):c}function WL(s,t){const r=s[s.length-1];for(let n=1;n<=t;n++){const a=Ca(0,t,n);s.push(St(r,1,a))}}function KL(s){const t=[0];return WL(t,s.length-1),t}function GL(s,t){return s.map(r=>r*t)}function QL(s,t){return s.map(()=>t||T1).splice(0,s.length-1)}function ol({duration:s=300,keyframes:t,times:r,ease:n="easeInOut"}){const a=RL(n)?n.map(Hp):Hp(n),i={done:!1,value:t[0]},o=GL(r&&r.length===t.length?r:KL(t),s),l=zL(o,t,{ease:Array.isArray(a)?a:QL(t,a)});return{calculatedDuration:s,next:c=>(i.value=l(c),i.done=c>=s,i)}}const ZL=s=>{const t=({timestamp:r})=>s(r);return{start:()=>mt.update(t,!0),stop:()=>Gr(t),now:()=>Gt.isProcessing?Gt.timestamp:cr.now()}},YL={decay:Vp,inertia:Vp,tween:ol,keyframes:ol,spring:k1},XL=s=>s/100;class Em extends b1{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:r,motionValue:n,element:a,keyframes:i}=this.options,o=(a==null?void 0:a.KeyframeResolver)||bm,l=(c,d)=>this.onKeyframesResolved(c,d);this.resolver=new o(i,l,r,n,a),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:r="keyframes",repeat:n=0,repeatDelay:a=0,repeatType:i,velocity:o=0}=this.options,l=km(r)?r:YL[r]||ol;let c,d;l!==ol&&typeof t[0]!="number"&&(c=$r(XL,E1(t[0],t[1])),t=[0,100]);const u=l({...this.options,keyframes:t});i==="mirror"&&(d=l({...this.options,keyframes:[...t].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=C1(u));const{calculatedDuration:h}=u,m=h+a,x=m*(n+1)-a;return{generator:u,mirroredGenerator:d,mapPercentToKeyframes:c,calculatedDuration:h,resolvedDuration:m,totalDuration:x}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,r=!1){const{resolved:n}=this;if(!n){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:a,generator:i,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:c,calculatedDuration:d,totalDuration:u,resolvedDuration:h}=n;if(this.startTime===null)return i.next(0);const{delay:m,repeat:x,repeatType:g,repeatDelay:f,onUpdate:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-u/this.speed,this.startTime)),r?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const y=this.currentTime-m*(this.speed>=0?1:-1),j=this.speed>=0?y<0:y>u;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let b=this.currentTime,k=i;if(x){const C=Math.min(this.currentTime,u)/h;let E=Math.floor(C),D=C%1;!D&&C>=1&&(D=1),D===1&&E--,E=Math.min(E,x+1),!!(E%2)&&(g==="reverse"?(D=1-D,f&&(D-=f/h)):g==="mirror"&&(k=o)),b=kr(0,1,D)*h}const S=j?{done:!1,value:c[0]}:k.next(b);l&&(S.value=l(S.value));let{done:A}=S;!j&&d!==null&&(A=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const T=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&A);return T&&a!==void 0&&(S.value=ec(c,this.options,a)),v&&v(S.value),T&&this.finish(),S}get duration(){const{resolved:t}=this;return t?Nr(t.calculatedDuration):0}get time(){return Nr(this.currentTime)}set time(t){t=wr(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Nr(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=ZL,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),r&&r();const a=this.driver.now();this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=a):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const JL=new Set(["opacity","clipPath","filter","transform"]);function Dm(s){let t;return()=>(t===void 0&&(t=s()),t)}const e3={linearEasing:void 0};function t3(s,t){const r=Dm(s);return()=>{var n;return(n=e3[t])!==null&&n!==void 0?n:r()}}const ll=t3(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing");function D1(s){return!!(typeof s=="function"&&ll()||!s||typeof s=="string"&&(s in Kd||ll())||Tm(s)||Array.isArray(s)&&s.every(D1))}const si=([s,t,r,n])=>`cubic-bezier(${s}, ${t}, ${r}, ${n})`,Kd={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:si([0,.65,.55,1]),circOut:si([.55,0,1,.45]),backIn:si([.31,.01,.66,-.59]),backOut:si([.33,1.53,.69,.99])};function A1(s,t){if(s)return typeof s=="function"&&ll()?w1(s,t):Tm(s)?si(s):Array.isArray(s)?s.map(r=>A1(r,t)||Kd.easeOut):Kd[s]}function s3(s,t,r,{delay:n=0,duration:a=300,repeat:i=0,repeatType:o="loop",ease:l="easeInOut",times:c}={}){const d={[t]:r};c&&(d.offset=c);const u=A1(l,a);return Array.isArray(u)&&(d.easing=u),s.animate(d,{delay:n,duration:a,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function Wp(s,t){s.timeline=t,s.onfinish=null}const r3=Dm(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),cl=10,n3=2e4;function a3(s){return km(s.type)||s.type==="spring"||!D1(s.ease)}function i3(s,t){const r=new Em({...t,keyframes:s,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:s[0]};const a=[];let i=0;for(;!n.done&&i<n3;)n=r.sample(i),a.push(n.value),i+=cl;return{times:void 0,keyframes:a,duration:i-cl,ease:"linear"}}const _1={anticipate:s1,backInOut:t1,circInOut:n1};function o3(s){return s in _1}class Kp extends b1{constructor(t){super(t);const{name:r,motionValue:n,element:a,keyframes:i}=this.options;this.resolver=new j1(i,(o,l)=>this.onKeyframesResolved(o,l),r,n,a),this.resolver.scheduleResolve()}initPlayback(t,r){var n;let{duration:a=300,times:i,ease:o,type:l,motionValue:c,name:d,startTime:u}=this.options;if(!(!((n=c.owner)===null||n===void 0)&&n.current))return!1;if(typeof o=="string"&&ll()&&o3(o)&&(o=_1[o]),a3(this.options)){const{onComplete:m,onUpdate:x,motionValue:g,element:f,...v}=this.options,y=i3(t,v);t=y.keyframes,t.length===1&&(t[1]=t[0]),a=y.duration,i=y.times,o=y.ease,l="keyframes"}const h=s3(c.owner.current,d,t,{...this.options,duration:a,times:i,ease:o});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(Wp(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:m}=this.options;c.set(ec(t,this.options,r)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:a,times:i,type:l,ease:o,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:r}=t;return Nr(r)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:r}=t;return Nr(r.currentTime||0)}set time(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.currentTime=wr(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:r}=t;return r.playbackRate}set speed(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:r}=t;return r.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:r}=t;return r.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:r}=this;if(!r)return ts;const{animation:n}=r;Wp(n,t)}return ts}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:r,keyframes:n,duration:a,type:i,ease:o,times:l}=t;if(r.playState==="idle"||r.playState==="finished")return;if(this.time){const{motionValue:d,onUpdate:u,onComplete:h,element:m,...x}=this.options,g=new Em({...x,keyframes:n,duration:a,type:i,ease:o,times:l,isGenerator:!0}),f=wr(this.time);d.setWithVelocity(g.sample(f-cl).value,g.sample(f).value,cl)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:r,name:n,repeatDelay:a,repeatType:i,damping:o,type:l}=t;return r3()&&n&&JL.has(n)&&r&&r.owner&&r.owner.current instanceof HTMLElement&&!r.owner.getProps().onUpdate&&!a&&i!=="mirror"&&o!==0&&l!=="inertia"}}const l3=Dm(()=>window.ScrollTimeline!==void 0);class c3{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}then(t,r){return Promise.all(this.animations).then(t).catch(r)}getAll(t){return this.animations[0][t]}setAll(t,r){for(let n=0;n<this.animations.length;n++)this.animations[n][t]=r}attachTimeline(t,r){const n=this.animations.map(a=>l3()&&a.attachTimeline?a.attachTimeline(t):r(a));return()=>{n.forEach((a,i)=>{a&&a(),this.animations[i].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let r=0;r<this.animations.length;r++)t=Math.max(t,this.animations[r].duration);return t}runAll(t){this.animations.forEach(r=>r[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function d3({when:s,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}const Am=(s,t,r,n={},a,i)=>o=>{const l=gm(n,s)||{},c=l.delay||n.delay||0;let{elapsed:d=0}=n;d=d-wr(c);let u={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-d,onUpdate:m=>{t.set(m),l.onUpdate&&l.onUpdate(m)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:s,motionValue:t,element:i?void 0:a};d3(l)||(u={...u,...M5(s,u)}),u.duration&&(u.duration=wr(u.duration)),u.repeatDelay&&(u.repeatDelay=wr(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(h=!0)),h&&!i&&t.get()!==void 0){const m=ec(u.keyframes,l);if(m!==void 0)return mt.update(()=>{u.onUpdate(m),u.onComplete()}),new c3([])}return!i&&Kp.supports(u)?new Kp(u):new Em(u)},u3=s=>!!(s&&typeof s=="object"&&s.mix&&s.toValue),m3=s=>Ld(s)?s[s.length-1]||0:s;function _m(s,t){s.indexOf(t)===-1&&s.push(t)}function Im(s,t){const r=s.indexOf(t);r>-1&&s.splice(r,1)}class Rm{constructor(){this.subscriptions=[]}add(t){return _m(this.subscriptions,t),()=>Im(this.subscriptions,t)}notify(t,r,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,n);else for(let i=0;i<a;i++){const o=this.subscriptions[i];o&&o(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Gp=30,h3=s=>!isNaN(parseFloat(s));class p3{constructor(t,r={}){this.version="11.13.1",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,a=!0)=>{const i=cr.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=cr.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=h3(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Rm);const n=this.events[t].add(r);return t==="change"?()=>{n(),mt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=cr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Gp)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Gp);return N1(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function $i(s,t){return new p3(s,t)}function f3(s,t,r){s.hasValue(t)?s.getValue(t).set(r):s.addValue(t,$i(r))}function x3(s,t){const r=Jl(s,t);let{transitionEnd:n={},transition:a={},...i}=r||{};i={...i,...n};for(const o in i){const l=m3(i[o]);f3(s,o,l)}}const Mm=s=>s.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),g3="framerAppearId",I1="data-"+Mm(g3);function R1(s){return s.props[I1]}const es=s=>!!(s&&s.getVelocity);function v3(s){return!!(es(s)&&s.add)}function Gd(s,t){const r=s.getValue("willChange");if(v3(r))return r.add(t)}function y3({protectedKeys:s,needsAnimating:t},r){const n=s.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function M1(s,t,{delay:r=0,transitionOverride:n,type:a}={}){var i;let{transition:o=s.getDefaultTransition(),transitionEnd:l,...c}=t;n&&(o=n);const d=[],u=a&&s.animationState&&s.animationState.getState()[a];for(const h in c){const m=s.getValue(h,(i=s.latestValues[h])!==null&&i!==void 0?i:null),x=c[h];if(x===void 0||u&&y3(u,h))continue;const g={delay:r,...gm(o||{},h)};let f=!1;if(window.MotionHandoffAnimation){const y=R1(s);if(y){const j=window.MotionHandoffAnimation(y,h,mt);j!==null&&(g.startTime=j,f=!0)}}Gd(s,h),m.start(Am(h,m,x,s.shouldReduceMotion&&Un.has(h)?{type:!1}:g,s,f));const v=m.animation;v&&d.push(v)}return l&&Promise.all(d).then(()=>{mt.update(()=>{l&&x3(s,l)})}),d}function Qd(s,t,r={}){var n;const a=Jl(s,t,r.type==="exit"?(n=s.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:i=s.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(i=r.transitionOverride);const o=a?()=>Promise.all(M1(s,a,r)):()=>Promise.resolve(),l=s.variantChildren&&s.variantChildren.size?(d=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:m}=i;return j3(s,t,u+d,h,m,r)}:()=>Promise.resolve(),{when:c}=i;if(c){const[d,u]=c==="beforeChildren"?[o,l]:[l,o];return d().then(()=>u())}else return Promise.all([o(),l(r.delay)])}function j3(s,t,r=0,n=0,a=1,i){const o=[],l=(s.variantChildren.size-1)*n,c=a===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(s.variantChildren).sort(b3).forEach((d,u)=>{d.notify("AnimationStart",t),o.push(Qd(d,t,{...i,delay:r+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(o)}function b3(s,t){return s.sortNodePosition(t)}function w3(s,t,r={}){s.notify("AnimationStart",t);let n;if(Array.isArray(t)){const a=t.map(i=>Qd(s,i,r));n=Promise.all(a)}else if(typeof t=="string")n=Qd(s,t,r);else{const a=typeof t=="function"?Jl(s,t,r.custom):t;n=Promise.all(M1(s,a,r))}return n.then(()=>{s.notify("AnimationComplete",t)})}const N3=xm.length;function O1(s){if(!s)return;if(!s.isControllingVariants){const r=s.parent?O1(s.parent)||{}:{};return s.props.initial!==void 0&&(r.initial=s.props.initial),r}const t={};for(let r=0;r<N3;r++){const n=xm[r],a=s.props[n];(Oi(a)||a===!1)&&(t[n]=a)}return t}const S3=[...fm].reverse(),C3=fm.length;function k3(s){return t=>Promise.all(t.map(({animation:r,options:n})=>w3(s,r,n)))}function T3(s){let t=k3(s),r=Qp(),n=!0;const a=c=>(d,u)=>{var h;const m=Jl(s,u,c==="exit"?(h=s.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(m){const{transition:x,transitionEnd:g,...f}=m;d={...d,...f,...g}}return d};function i(c){t=c(s)}function o(c){const{props:d}=s,u=O1(s.parent)||{},h=[],m=new Set;let x={},g=1/0;for(let v=0;v<C3;v++){const y=S3[v],j=r[y],b=d[y]!==void 0?d[y]:u[y],k=Oi(b),S=y===c?j.isActive:null;S===!1&&(g=v);let A=b===u[y]&&b!==d[y]&&k;if(A&&n&&s.manuallyAnimateOnMount&&(A=!1),j.protectedKeys={...x},!j.isActive&&S===null||!b&&!j.prevProp||Xl(b)||typeof b=="boolean")continue;const T=P3(j.prevProp,b);let C=T||y===c&&j.isActive&&!A&&k||v>g&&k,E=!1;const D=Array.isArray(b)?b:[b];let w=D.reduce(a(y),{});S===!1&&(w={});const{prevResolvedValues:N={}}=j,_={...N,...w},F=$=>{C=!0,m.has($)&&(E=!0,m.delete($)),j.needsAnimating[$]=!0;const ae=s.getValue($);ae&&(ae.liveStyle=!1)};for(const $ in _){const ae=w[$],O=N[$];if(x.hasOwnProperty($))continue;let ne=!1;Ld(ae)&&Ld(O)?ne=!QC(ae,O):ne=ae!==O,ne?ae!=null?F($):m.add($):ae!==void 0&&m.has($)?F($):j.protectedKeys[$]=!0}j.prevProp=b,j.prevResolvedValues=w,j.isActive&&(x={...x,...w}),n&&s.blockInitialAnimation&&(C=!1),C&&(!(A&&T)||E)&&h.push(...D.map($=>({animation:$,options:{type:y}})))}if(m.size){const v={};m.forEach(y=>{const j=s.getBaseTarget(y),b=s.getValue(y);b&&(b.liveStyle=!0),v[y]=j??null}),h.push({animation:v})}let f=!!h.length;return n&&(d.initial===!1||d.initial===d.animate)&&!s.manuallyAnimateOnMount&&(f=!1),n=!1,f?t(h):Promise.resolve()}function l(c,d){var u;if(r[c].isActive===d)return Promise.resolve();(u=s.variantChildren)===null||u===void 0||u.forEach(m=>{var x;return(x=m.animationState)===null||x===void 0?void 0:x.setActive(c,d)}),r[c].isActive=d;const h=o(c);for(const m in r)r[m].protectedKeys={};return h}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>r,reset:()=>{r=Qp(),n=!0}}}function P3(s,t){return typeof t=="string"?t!==s:Array.isArray(t)?!QC(t,s):!1}function dn(s=!1){return{isActive:s,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Qp(){return{animate:dn(!0),whileInView:dn(),whileHover:dn(),whileTap:dn(),whileDrag:dn(),whileFocus:dn(),exit:dn()}}class nn{constructor(t){this.isMounted=!1,this.node=t}update(){}}class E3 extends nn{constructor(t){super(t),t.animationState||(t.animationState=T3(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Xl(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let D3=0;class A3 extends nn{constructor(){super(...arguments),this.id=D3++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const a=this.node.animationState.setActive("exit",!t);r&&!t&&a.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const _3={animation:{Feature:E3},exit:{Feature:A3}};function I3(s,t,r){var n;if(s instanceof Element)return[s];if(typeof s=="string"){let a=document;const i=(n=void 0)!==null&&n!==void 0?n:a.querySelectorAll(s);return i?Array.from(i):[]}return Array.from(s)}const Vs={x:!1,y:!1};function F1(){return Vs.x||Vs.y}function Zp(s){return t=>{t.pointerType==="touch"||F1()||s(t)}}function R3(s,t,r={}){const n=new AbortController,a={passive:!0,...r,signal:n.signal},i=Zp(o=>{const{target:l}=o,c=t(o);if(!c||!l)return;const d=Zp(u=>{c(u),l.removeEventListener("pointerleave",d)});l.addEventListener("pointerleave",d,a)});return I3(s).forEach(o=>{o.addEventListener("pointerenter",i,a)}),()=>n.abort()}function M3(s){return s==="x"||s==="y"?Vs[s]?null:(Vs[s]=!0,()=>{Vs[s]=!1}):Vs.x||Vs.y?null:(Vs.x=Vs.y=!0,()=>{Vs.x=Vs.y=!1})}const L1=s=>s.pointerType==="mouse"?typeof s.button!="number"||s.button<=0:s.isPrimary!==!1;function no(s){return{point:{x:s.pageX,y:s.pageY}}}const O3=s=>t=>L1(t)&&s(t,no(t));function jr(s,t,r,n={passive:!0}){return s.addEventListener(t,r,n),()=>s.removeEventListener(t,r)}function Br(s,t,r,n){return jr(s,t,O3(r),n)}const Yp=(s,t)=>Math.abs(s-t);function F3(s,t){const r=Yp(s.x,t.x),n=Yp(s.y,t.y);return Math.sqrt(r**2+n**2)}class $1{constructor(t,r,{transformPagePoint:n,contextWindow:a,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=$c(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,x=F3(h.offset,{x:0,y:0})>=3;if(!m&&!x)return;const{point:g}=h,{timestamp:f}=Gt;this.history.push({...g,timestamp:f});const{onStart:v,onMove:y}=this.handlers;m||(v&&v(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,h)},this.handlePointerMove=(h,m)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=Lc(m,this.transformPagePoint),mt.update(this.updatePoint,!0)},this.handlePointerUp=(h,m)=>{this.end();const{onEnd:x,onSessionEnd:g,resumeAnimation:f}=this.handlers;if(this.dragSnapToOrigin&&f&&f(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=$c(h.type==="pointercancel"?this.lastMoveEventInfo:Lc(m,this.transformPagePoint),this.history);this.startEvent&&x&&x(h,v),g&&g(h,v)},!L1(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.contextWindow=a||window;const o=no(t),l=Lc(o,this.transformPagePoint),{point:c}=l,{timestamp:d}=Gt;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=r;u&&u(t,$c(l,this.history)),this.removeListeners=$r(Br(this.contextWindow,"pointermove",this.handlePointerMove),Br(this.contextWindow,"pointerup",this.handlePointerUp),Br(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Gr(this.updatePoint)}}function Lc(s,t){return t?{point:t(s.point)}:s}function Xp(s,t){return{x:s.x-t.x,y:s.y-t.y}}function $c({point:s},t){return{point:s,delta:Xp(s,B1(t)),offset:Xp(s,L3(t)),velocity:$3(t,.1)}}function L3(s){return s[0]}function B1(s){return s[s.length-1]}function $3(s,t){if(s.length<2)return{x:0,y:0};let r=s.length-1,n=null;const a=B1(s);for(;r>=0&&(n=s[r],!(a.timestamp-n.timestamp>wr(t)));)r--;if(!n)return{x:0,y:0};const i=Nr(a.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const o={x:(a.x-n.x)/i,y:(a.y-n.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function ea(s){return s&&typeof s=="object"&&Object.prototype.hasOwnProperty.call(s,"current")}const V1=1e-4,B3=1-V1,V3=1+V1,U1=.01,U3=0-U1,H3=0+U1;function ks(s){return s.max-s.min}function q3(s,t,r){return Math.abs(s-t)<=r}function Jp(s,t,r,n=.5){s.origin=n,s.originPoint=St(t.min,t.max,s.origin),s.scale=ks(r)/ks(t),s.translate=St(r.min,r.max,s.origin)-s.originPoint,(s.scale>=B3&&s.scale<=V3||isNaN(s.scale))&&(s.scale=1),(s.translate>=U3&&s.translate<=H3||isNaN(s.translate))&&(s.translate=0)}function mi(s,t,r,n){Jp(s.x,t.x,r.x,n?n.originX:void 0),Jp(s.y,t.y,r.y,n?n.originY:void 0)}function ef(s,t,r){s.min=r.min+t.min,s.max=s.min+ks(t)}function z3(s,t,r){ef(s.x,t.x,r.x),ef(s.y,t.y,r.y)}function tf(s,t,r){s.min=t.min-r.min,s.max=s.min+ks(t)}function hi(s,t,r){tf(s.x,t.x,r.x),tf(s.y,t.y,r.y)}function W3(s,{min:t,max:r},n){return t!==void 0&&s<t?s=n?St(t,s,n.min):Math.max(s,t):r!==void 0&&s>r&&(s=n?St(r,s,n.max):Math.min(s,r)),s}function sf(s,t,r){return{min:t!==void 0?s.min+t:void 0,max:r!==void 0?s.max+r-(s.max-s.min):void 0}}function K3(s,{top:t,left:r,bottom:n,right:a}){return{x:sf(s.x,r,a),y:sf(s.y,t,n)}}function rf(s,t){let r=t.min-s.min,n=t.max-s.max;return t.max-t.min<s.max-s.min&&([r,n]=[n,r]),{min:r,max:n}}function G3(s,t){return{x:rf(s.x,t.x),y:rf(s.y,t.y)}}function Q3(s,t){let r=.5;const n=ks(s),a=ks(t);return a>n?r=Ca(t.min,t.max-n,s.min):n>a&&(r=Ca(s.min,s.max-a,t.min)),kr(0,1,r)}function Z3(s,t){const r={};return t.min!==void 0&&(r.min=t.min-s.min),t.max!==void 0&&(r.max=t.max-s.min),r}const Zd=.35;function Y3(s=Zd){return s===!1?s=0:s===!0&&(s=Zd),{x:nf(s,"left","right"),y:nf(s,"top","bottom")}}function nf(s,t,r){return{min:af(s,t),max:af(s,r)}}function af(s,t){return typeof s=="number"?s:s[t]||0}const of=()=>({translate:0,scale:1,origin:0,originPoint:0}),ta=()=>({x:of(),y:of()}),lf=()=>({min:0,max:0}),Et=()=>({x:lf(),y:lf()});function Is(s){return[s("x"),s("y")]}function H1({top:s,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:s,max:n}}}function X3({x:s,y:t}){return{top:t.min,right:s.max,bottom:t.max,left:s.min}}function J3(s,t){if(!t)return s;const r=t({x:s.left,y:s.top}),n=t({x:s.right,y:s.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function Bc(s){return s===void 0||s===1}function Yd({scale:s,scaleX:t,scaleY:r}){return!Bc(s)||!Bc(t)||!Bc(r)}function mn(s){return Yd(s)||q1(s)||s.z||s.rotate||s.rotateX||s.rotateY||s.skewX||s.skewY}function q1(s){return cf(s.x)||cf(s.y)}function cf(s){return s&&s!=="0%"}function dl(s,t,r){const n=s-r,a=t*n;return r+a}function df(s,t,r,n,a){return a!==void 0&&(s=dl(s,a,n)),dl(s,r,n)+t}function Xd(s,t=0,r=1,n,a){s.min=df(s.min,t,r,n,a),s.max=df(s.max,t,r,n,a)}function z1(s,{x:t,y:r}){Xd(s.x,t.translate,t.scale,t.originPoint),Xd(s.y,r.translate,r.scale,r.originPoint)}const uf=.999999999999,mf=1.0000000000001;function e$(s,t,r,n=!1){const a=r.length;if(!a)return;t.x=t.y=1;let i,o;for(let l=0;l<a;l++){i=r[l],o=i.projectionDelta;const{visualElement:c}=i.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&ra(s,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,z1(s,o)),n&&mn(i.latestValues)&&ra(s,i.latestValues))}t.x<mf&&t.x>uf&&(t.x=1),t.y<mf&&t.y>uf&&(t.y=1)}function sa(s,t){s.min=s.min+t,s.max=s.max+t}function hf(s,t,r,n,a=.5){const i=St(s.min,s.max,a);Xd(s,t,r,i,n)}function ra(s,t){hf(s.x,t.x,t.scaleX,t.scale,t.originX),hf(s.y,t.y,t.scaleY,t.scale,t.originY)}function W1(s,t){return H1(J3(s.getBoundingClientRect(),t))}function t$(s,t,r){const n=W1(s,r),{scroll:a}=t;return a&&(sa(n.x,a.offset.x),sa(n.y,a.offset.y)),n}const K1=({current:s})=>s?s.ownerDocument.defaultView:null,s$=new WeakMap;class r${constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Et(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(no(u).point)},i=(u,h)=>{const{drag:m,dragPropagation:x,onDragStart:g}=this.getProps();if(m&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=M3(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Is(v=>{let y=this.getAxisMotionValue(v).get()||0;if(lr.test(y)){const{projection:j}=this.visualElement;if(j&&j.layout){const b=j.layout.layoutBox[v];b&&(y=ks(b)*(parseFloat(y)/100))}}this.originPoint[v]=y}),g&&mt.postRender(()=>g(u,h)),Gd(this.visualElement,"transform");const{animationState:f}=this.visualElement;f&&f.setActive("whileDrag",!0)},o=(u,h)=>{const{dragPropagation:m,dragDirectionLock:x,onDirectionLock:g,onDrag:f}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:v}=h;if(x&&this.currentDirection===null){this.currentDirection=n$(v),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,v),this.updateAxis("y",h.point,v),this.visualElement.render(),f&&f(u,h)},l=(u,h)=>this.stop(u,h),c=()=>Is(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new $1(t,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:K1(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:i}=this.getProps();i&&mt.postRender(()=>i(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:a}=this.getProps();if(!n||!jo(t,a,this.currentDirection))return;const i=this.getAxisMotionValue(t);let o=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(o=W3(o,this.constraints[t],this.elastic[t])),i.set(o)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;r&&ea(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&a?this.constraints=K3(a.layoutBox,r):this.constraints=!1,this.elastic=Y3(n),i!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&Is(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Z3(a.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!ea(t))return!1;const n=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=t$(n,a.root,this.visualElement.getTransformPagePoint());let o=G3(a.layout.layoutBox,i);if(r){const l=r(X3(o));this.hasMutatedConstraints=!!l,l&&(o=H1(l))}return o}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:a,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=Is(u=>{if(!jo(u,r,this.currentDirection))return;let h=c&&c[u]||{};o&&(h={min:0,max:0});const m=a?200:1e6,x=a?40:1e7,g={type:"inertia",velocity:n?t[u]:0,bounceStiffness:m,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,g)});return Promise.all(d).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return Gd(this.visualElement,t),n.start(Am(t,n,0,r,this.visualElement,!1))}stopAnimation(){Is(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Is(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),a=n[r];return a||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Is(r=>{const{drag:n}=this.getProps();if(!jo(r,n,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(r);if(a&&a.layout){const{min:o,max:l}=a.layout.layoutBox[r];i.set(t[r]-St(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!ea(r)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Is(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();a[o]=Q3({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Is(o=>{if(!jo(o,t,null))return;const l=this.getAxisMotionValue(o),{min:c,max:d}=this.constraints[o];l.set(St(c,d,a[o]))})}addListeners(){if(!this.visualElement.current)return;s$.set(this.visualElement,this);const t=this.visualElement.current,r=Br(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();ea(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),mt.read(n);const o=jr(window,"resize",()=>this.scalePositionWithinConstraints()),l=a.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Is(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=c[u].translate,h.set(h.get()+c[u].translate))}),this.visualElement.render())});return()=>{o(),r(),i(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:o=Zd,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:a,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function jo(s,t,r){return(t===!0||t===s)&&(r===null||r===s)}function n$(s,t=10){let r=null;return Math.abs(s.y)>t?r="y":Math.abs(s.x)>t&&(r="x"),r}class a$ extends nn{constructor(t){super(t),this.removeGroupControls=ts,this.removeListeners=ts,this.controls=new r$(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ts}unmount(){this.removeGroupControls(),this.removeListeners()}}const pf=s=>(t,r)=>{s&&mt.postRender(()=>s(t,r))};class i$ extends nn{constructor(){super(...arguments),this.removePointerDownListener=ts}onPointerDown(t){this.session=new $1(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:K1(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:pf(t),onStart:pf(r),onMove:n,onEnd:(i,o)=>{delete this.session,a&&mt.postRender(()=>a(i,o))}}}mount(){this.removePointerDownListener=Br(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const tc=p.createContext(null);function o$(){const s=p.useContext(tc);if(s===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=s,a=p.useId();p.useEffect(()=>n(a),[]);const i=p.useCallback(()=>r&&r(a),[a,r]);return!t&&r?[!1,i]:[!0]}const Om=p.createContext({}),G1=p.createContext({}),Mo={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ff(s,t){return t.max===t.min?0:s/(t.max-t.min)*100}const Qa={correct:(s,t)=>{if(!t.target)return s;if(typeof s=="string")if(Ee.test(s))s=parseFloat(s);else return s;const r=ff(s,t.target.x),n=ff(s,t.target.y);return`${r}% ${n}%`}},l$={correct:(s,{treeScale:t,projectionDelta:r})=>{const n=s,a=Qr.parse(s);if(a.length>5)return n;const i=Qr.createTransformer(s),o=typeof a[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;a[0+o]/=l,a[1+o]/=c;const d=St(l,c,.5);return typeof a[2+o]=="number"&&(a[2+o]/=d),typeof a[3+o]=="number"&&(a[3+o]/=d),i(a)}},ul={};function c$(s){Object.assign(ul,s)}const{schedule:Fm,cancel:dU}=ZC(queueMicrotask,!1);class d$ extends p.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:a}=this.props,{projection:i}=t;c$(u$),i&&(r.group&&r.group.add(i),n&&n.register&&a&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Mo.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:a,isPresent:i}=this.props,o=n.projection;return o&&(o.isPresent=i,a||t.layoutDependency!==r||r===void 0?o.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?o.promote():o.relegate()||mt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Fm.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Q1(s){const[t,r]=o$(),n=p.useContext(Om);return e.jsx(d$,{...s,layoutGroup:n,switchLayoutGroup:p.useContext(G1),isPresent:t,safeToRemove:r})}const u$={borderRadius:{...Qa,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Qa,borderTopRightRadius:Qa,borderBottomLeftRadius:Qa,borderBottomRightRadius:Qa,boxShadow:l$},Z1=["TopLeft","TopRight","BottomLeft","BottomRight"],m$=Z1.length,xf=s=>typeof s=="string"?parseFloat(s):s,gf=s=>typeof s=="number"||Ee.test(s);function h$(s,t,r,n,a,i){a?(s.opacity=St(0,r.opacity!==void 0?r.opacity:1,p$(n)),s.opacityExit=St(t.opacity!==void 0?t.opacity:1,0,f$(n))):i&&(s.opacity=St(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let o=0;o<m$;o++){const l=`border${Z1[o]}Radius`;let c=vf(t,l),d=vf(r,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||gf(c)===gf(d)?(s[l]=Math.max(St(xf(c),xf(d),n),0),(lr.test(d)||lr.test(c))&&(s[l]+="%")):s[l]=d}(t.rotate||r.rotate)&&(s.rotate=St(t.rotate||0,r.rotate||0,n))}function vf(s,t){return s[t]!==void 0?s[t]:s.borderRadius}const p$=Y1(0,.5,r1),f$=Y1(.5,.95,ts);function Y1(s,t,r){return n=>n<s?0:n>t?1:r(Ca(s,t,n))}function yf(s,t){s.min=t.min,s.max=t.max}function _s(s,t){yf(s.x,t.x),yf(s.y,t.y)}function jf(s,t){s.translate=t.translate,s.scale=t.scale,s.originPoint=t.originPoint,s.origin=t.origin}function bf(s,t,r,n,a){return s-=t,s=dl(s,1/r,n),a!==void 0&&(s=dl(s,1/a,n)),s}function x$(s,t=0,r=1,n=.5,a,i=s,o=s){if(lr.test(t)&&(t=parseFloat(t),t=St(o.min,o.max,t/100)-o.min),typeof t!="number")return;let l=St(i.min,i.max,n);s===i&&(l-=t),s.min=bf(s.min,t,r,l,a),s.max=bf(s.max,t,r,l,a)}function wf(s,t,[r,n,a],i,o){x$(s,t[r],t[n],t[a],t.scale,i,o)}const g$=["x","scaleX","originX"],v$=["y","scaleY","originY"];function Nf(s,t,r,n){wf(s.x,t,g$,r?r.x:void 0,n?n.x:void 0),wf(s.y,t,v$,r?r.y:void 0,n?n.y:void 0)}function Sf(s){return s.translate===0&&s.scale===1}function X1(s){return Sf(s.x)&&Sf(s.y)}function Cf(s,t){return s.min===t.min&&s.max===t.max}function y$(s,t){return Cf(s.x,t.x)&&Cf(s.y,t.y)}function kf(s,t){return Math.round(s.min)===Math.round(t.min)&&Math.round(s.max)===Math.round(t.max)}function J1(s,t){return kf(s.x,t.x)&&kf(s.y,t.y)}function Tf(s){return ks(s.x)/ks(s.y)}function Pf(s,t){return s.translate===t.translate&&s.scale===t.scale&&s.originPoint===t.originPoint}class j${constructor(){this.members=[]}add(t){_m(this.members,t),t.scheduleRender()}remove(t){if(Im(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let n;for(let a=r;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function b$(s,t,r){let n="";const a=s.x.translate/t.x,i=s.y.translate/t.y,o=(r==null?void 0:r.z)||0;if((a||i||o)&&(n=`translate3d(${a}px, ${i}px, ${o}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:d,rotate:u,rotateX:h,rotateY:m,skewX:x,skewY:g}=r;d&&(n=`perspective(${d}px) ${n}`),u&&(n+=`rotate(${u}deg) `),h&&(n+=`rotateX(${h}deg) `),m&&(n+=`rotateY(${m}deg) `),x&&(n+=`skewX(${x}deg) `),g&&(n+=`skewY(${g}deg) `)}const l=s.x.scale*t.x,c=s.y.scale*t.y;return(l!==1||c!==1)&&(n+=`scale(${l}, ${c})`),n||"none"}const w$=(s,t)=>s.depth-t.depth;class N${constructor(){this.children=[],this.isDirty=!1}add(t){_m(this.children,t),this.isDirty=!0}remove(t){Im(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(w$),this.isDirty=!1,this.children.forEach(t)}}function Oo(s){const t=es(s)?s.get():s;return u3(t)?t.toValue():t}function S$(s,t){const r=cr.now(),n=({timestamp:a})=>{const i=a-r;i>=t&&(Gr(n),s(i-t))};return mt.read(n,!0),()=>Gr(n)}function C$(s){return s instanceof SVGElement&&s.tagName!=="svg"}function k$(s,t,r){const n=es(s)?s:$i(s);return n.start(Am("",n,t,r)),n.animation}const hn={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},ri=typeof window<"u"&&window.MotionDebug!==void 0,Vc=["","X","Y","Z"],T$={visibility:"hidden"},Ef=1e3;let P$=0;function Uc(s,t,r,n){const{latestValues:a}=t;a[s]&&(r[s]=a[s],t.setStaticValue(s,0),n&&(n[s]=0))}function ek(s){if(s.hasCheckedOptimisedAppear=!0,s.root===s)return;const{visualElement:t}=s.options;if(!t)return;const r=R1(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:a,layoutId:i}=s.options;window.MotionCancelOptimisedAnimation(r,"transform",mt,!(a||i))}const{parent:n}=s;n&&!n.hasCheckedOptimisedAppear&&ek(n)}function tk({attachResizeListener:s,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(o={},l=t==null?void 0:t()){this.id=P$++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ri&&(hn.totalNodes=hn.resolvedTargetDeltas=hn.recalculatedProjection=0),this.nodes.forEach(A$),this.nodes.forEach(O$),this.nodes.forEach(F$),this.nodes.forEach(_$),ri&&window.MotionDebug.record(hn)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new N$)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Rm),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=C$(o),this.instance=o;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),s){let h;const m=()=>this.root.updateBlockedByResize=!1;s(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=S$(m,250),Mo.hasAnimatedSinceResize&&(Mo.hasAnimatedSinceResize=!1,this.nodes.forEach(Af))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:m,hasRelativeTargetChanged:x,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const f=this.options.transition||u.getDefaultTransition()||U$,{onLayoutAnimationStart:v,onLayoutAnimationComplete:y}=u.getProps(),j=!this.targetLayout||!J1(this.targetLayout,g)||x,b=!m&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||m&&(j||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,b);const k={...gm(f,"layout"),onPlay:v,onComplete:y};(u.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k)}else m||Af(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Gr(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(L$),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&ek(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Df);return}this.isUpdating||this.nodes.forEach(R$),this.isUpdating=!1,this.nodes.forEach(M$),this.nodes.forEach(E$),this.nodes.forEach(D$),this.clearAllSnapshots();const l=cr.now();Gt.delta=kr(0,1e3/60,l-Gt.timestamp),Gt.timestamp=l,Gt.isProcessing=!0,Ic.update.process(Gt),Ic.preRender.process(Gt),Ic.render.process(Gt),Gt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Fm.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(I$),this.sharedNodes.forEach($$)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,mt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){mt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Et(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!a)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!X1(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;o&&(l||mn(this.latestValues)||u)&&(a(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),H$(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Et();const c=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(q$))){const{scroll:u}=this.root;u&&(sa(c.x,u.offset.x),sa(c.y,u.offset.y))}return c}removeElementScroll(o){var l;const c=Et();if(_s(c,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return c;for(let d=0;d<this.path.length;d++){const u=this.path[d],{scroll:h,options:m}=u;u!==this.root&&h&&m.layoutScroll&&(h.wasRoot&&_s(c,o),sa(c.x,h.offset.x),sa(c.y,h.offset.y))}return c}applyTransform(o,l=!1){const c=Et();_s(c,o);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&ra(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),mn(u.latestValues)&&ra(c,u.latestValues)}return mn(this.latestValues)&&ra(c,this.latestValues),c}removeTransform(o){const l=Et();_s(l,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!mn(d.latestValues))continue;Yd(d.latestValues)&&d.updateSnapshot();const u=Et(),h=d.measurePageBox();_s(u,h),Nf(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return mn(this.latestValues)&&Nf(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Gt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:m}=this.options;if(!(!this.layout||!(h||m))){if(this.resolvedRelativeTargetAt=Gt.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Et(),this.relativeTargetOrigin=Et(),hi(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),_s(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Et(),this.targetWithTransforms=Et()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),z3(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):_s(this.target,this.layout.layoutBox),z1(this.target,this.targetDelta)):_s(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Et(),this.relativeTargetOrigin=Et(),hi(this.relativeTargetOrigin,this.target,x.target),_s(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ri&&hn.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Yd(this.parent.latestValues)||q1(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Gt.timestamp&&(d=!1),d)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;_s(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,x=this.treeScale.y;e$(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Et());const{target:g}=l;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(jf(this.prevProjectionDelta.x,this.projectionDelta.x),jf(this.prevProjectionDelta.y,this.projectionDelta.y)),mi(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==x||!Pf(this.projectionDelta.x,this.prevProjectionDelta.x)||!Pf(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),ri&&hn.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ta(),this.projectionDelta=ta(),this.projectionDeltaWithTransform=ta()}setAnimationOrigin(o,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},h=ta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=Et(),x=c?c.source:void 0,g=this.layout?this.layout.source:void 0,f=x!==g,v=this.getStack(),y=!v||v.members.length<=1,j=!!(f&&!y&&this.options.crossfade===!0&&!this.path.some(V$));this.animationProgress=0;let b;this.mixTargetDelta=k=>{const S=k/1e3;_f(h.x,o.x,S),_f(h.y,o.y,S),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(hi(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),B$(this.relativeTarget,this.relativeTargetOrigin,m,S),b&&y$(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=Et()),_s(b,this.relativeTarget)),f&&(this.animationValues=u,h$(u,d,this.latestValues,S,j,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Gr(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=mt.update(()=>{Mo.hasAnimatedSinceResize=!0,this.currentAnimation=k$(0,Ef,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Ef),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=o;if(!(!l||!c||!d)){if(this!==o&&this.layout&&d&&sk(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||Et();const h=ks(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+h;const m=ks(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+m}_s(l,c),ra(l,u),mi(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new j$),this.sharedNodes.get(o).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const d={};c.z&&Uc("z",o,d,this.animationValues);for(let u=0;u<Vc.length;u++)Uc(`rotate${Vc[u]}`,o,d,this.animationValues),Uc(`skew${Vc[u]}`,o,d,this.animationValues);o.render();for(const u in d)o.setStaticValue(u,d[u]),this.animationValues&&(this.animationValues[u]=d[u]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return T$;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=Oo(o==null?void 0:o.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const f={};return this.options.layoutId&&(f.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,f.pointerEvents=Oo(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!mn(this.latestValues)&&(f.transform=u?u({},""):"none",this.hasProjected=!1),f}const m=h.animationValues||h.latestValues;this.applyTransformsToTarget(),d.transform=b$(this.projectionDeltaWithTransform,this.treeScale,m),u&&(d.transform=u(m,d.transform));const{x,y:g}=this.projectionDelta;d.transformOrigin=`${x.origin*100}% ${g.origin*100}% 0`,h.animationValues?d.opacity=h===this?(c=(l=m.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:d.opacity=h===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const f in ul){if(m[f]===void 0)continue;const{correct:v,applyTo:y}=ul[f],j=d.transform==="none"?m[f]:v(m[f],h);if(y){const b=y.length;for(let k=0;k<b;k++)d[y[k]]=j}else d[f]=j}return this.options.layoutId&&(d.pointerEvents=h===this?Oo(o==null?void 0:o.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(Df),this.root.sharedNodes.clear()}}}function E$(s){s.updateLayout()}function D$(s){var t;const r=((t=s.resumeFrom)===null||t===void 0?void 0:t.snapshot)||s.snapshot;if(s.isLead()&&s.layout&&r&&s.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=s.layout,{animationType:i}=s.options,o=r.source!==s.layout.source;i==="size"?Is(h=>{const m=o?r.measuredBox[h]:r.layoutBox[h],x=ks(m);m.min=n[h].min,m.max=m.min+x}):sk(i,r.layoutBox,n)&&Is(h=>{const m=o?r.measuredBox[h]:r.layoutBox[h],x=ks(n[h]);m.max=m.min+x,s.relativeTarget&&!s.currentAnimation&&(s.isProjectionDirty=!0,s.relativeTarget[h].max=s.relativeTarget[h].min+x)});const l=ta();mi(l,n,r.layoutBox);const c=ta();o?mi(c,s.applyTransform(a,!0),r.measuredBox):mi(c,n,r.layoutBox);const d=!X1(l);let u=!1;if(!s.resumeFrom){const h=s.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:m,layout:x}=h;if(m&&x){const g=Et();hi(g,r.layoutBox,m.layoutBox);const f=Et();hi(f,n,x.layoutBox),J1(g,f)||(u=!0),h.options.layoutRoot&&(s.relativeTarget=f,s.relativeTargetOrigin=g,s.relativeParent=h)}}}s.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(s.isLead()){const{onExitComplete:n}=s.options;n&&n()}s.options.transition=void 0}function A$(s){ri&&hn.totalNodes++,s.parent&&(s.isProjecting()||(s.isProjectionDirty=s.parent.isProjectionDirty),s.isSharedProjectionDirty||(s.isSharedProjectionDirty=!!(s.isProjectionDirty||s.parent.isProjectionDirty||s.parent.isSharedProjectionDirty)),s.isTransformDirty||(s.isTransformDirty=s.parent.isTransformDirty))}function _$(s){s.isProjectionDirty=s.isSharedProjectionDirty=s.isTransformDirty=!1}function I$(s){s.clearSnapshot()}function Df(s){s.clearMeasurements()}function R$(s){s.isLayoutDirty=!1}function M$(s){const{visualElement:t}=s.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),s.resetTransform()}function Af(s){s.finishAnimation(),s.targetDelta=s.relativeTarget=s.target=void 0,s.isProjectionDirty=!0}function O$(s){s.resolveTargetDelta()}function F$(s){s.calcProjection()}function L$(s){s.resetSkewAndRotation()}function $$(s){s.removeLeadSnapshot()}function _f(s,t,r){s.translate=St(t.translate,0,r),s.scale=St(t.scale,1,r),s.origin=t.origin,s.originPoint=t.originPoint}function If(s,t,r,n){s.min=St(t.min,r.min,n),s.max=St(t.max,r.max,n)}function B$(s,t,r,n){If(s.x,t.x,r.x,n),If(s.y,t.y,r.y,n)}function V$(s){return s.animationValues&&s.animationValues.opacityExit!==void 0}const U$={duration:.45,ease:[.4,0,.1,1]},Rf=s=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(s),Mf=Rf("applewebkit/")&&!Rf("chrome/")?Math.round:ts;function Of(s){s.min=Mf(s.min),s.max=Mf(s.max)}function H$(s){Of(s.x),Of(s.y)}function sk(s,t,r){return s==="position"||s==="preserve-aspect"&&!q3(Tf(t),Tf(r),.2)}function q$(s){var t;return s!==s.root&&((t=s.scroll)===null||t===void 0?void 0:t.wasRoot)}const z$=tk({attachResizeListener:(s,t)=>jr(s,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Hc={current:void 0},rk=tk({measureScroll:s=>({x:s.scrollLeft,y:s.scrollTop}),defaultParent:()=>{if(!Hc.current){const s=new z$({});s.mount(window),s.setOptions({layoutScroll:!0}),Hc.current=s}return Hc.current},resetTransform:(s,t)=>{s.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:s=>window.getComputedStyle(s).position==="fixed"}),W$={pan:{Feature:i$},drag:{Feature:a$,ProjectionNode:rk,MeasureLayout:Q1}};function Ff(s,t,r){const{props:n}=s;s.animationState&&n.whileHover&&s.animationState.setActive("whileHover",r);const a=n[r?"onHoverStart":"onHoverEnd"];a&&mt.postRender(()=>a(t,no(t)))}class K$ extends nn{mount(){const{current:t,props:r}=this.node;t&&(this.unmount=R3(t,n=>(Ff(this.node,n,!0),a=>Ff(this.node,a,!1)),{passive:!r.onHoverStart&&!r.onHoverEnd}))}unmount(){}}class G$ extends nn{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=$r(jr(this.node.current,"focus",()=>this.onFocus()),jr(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const nk=(s,t)=>t?s===t?!0:nk(s,t.parentElement):!1;function qc(s,t){if(!t)return;const r=new PointerEvent("pointer"+s);t(r,no(r))}class Q$ extends nn{constructor(){super(...arguments),this.removeStartListeners=ts,this.removeEndListeners=ts,this.removeAccessibleListeners=ts,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=Br(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:u,globalTapTarget:h}=this.node.getProps(),m=!h&&!nk(this.node.current,l.target)?u:d;m&&mt.update(()=>m(l,c))},{passive:!(n.onTap||n.onPointerUp)}),o=Br(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=$r(i,o),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||qc("up",(c,d)=>{const{onTap:u}=this.node.getProps();u&&mt.postRender(()=>u(c,d))})};this.removeEndListeners(),this.removeEndListeners=jr(this.node.current,"keyup",o),qc("down",(l,c)=>{this.startPress(l,c)})},r=jr(this.node.current,"keydown",t),n=()=>{this.isPressing&&qc("cancel",(i,o)=>this.cancelPress(i,o))},a=jr(this.node.current,"blur",n);this.removeAccessibleListeners=$r(r,a)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:a}=this.node.getProps();a&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&mt.postRender(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!F1()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&mt.postRender(()=>n(t,r))}mount(){const t=this.node.getProps(),r=Br(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=jr(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=$r(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Jd=new WeakMap,zc=new WeakMap,Z$=s=>{const t=Jd.get(s.target);t&&t(s)},Y$=s=>{s.forEach(Z$)};function X$({root:s,...t}){const r=s||document;zc.has(r)||zc.set(r,{});const n=zc.get(r),a=JSON.stringify(t);return n[a]||(n[a]=new IntersectionObserver(Y$,{root:s,...t})),n[a]}function J$(s,t,r){const n=X$(t);return Jd.set(s,r),n.observe(s),()=>{Jd.delete(s),n.unobserve(s)}}const eB={some:0,all:1};class tB extends nn{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:a="some",once:i}=t,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:eB[a]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),m=d?u:h;m&&m(c)};return J$(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(sB(t,r))&&this.startObserver()}unmount(){}}function sB({viewport:s={}},{viewport:t={}}={}){return r=>s[r]!==t[r]}const rB={inView:{Feature:tB},tap:{Feature:Q$},focus:{Feature:G$},hover:{Feature:K$}},nB={layout:{ProjectionNode:rk,MeasureLayout:Q1}},Lm=p.createContext({transformPagePoint:s=>s,isStatic:!1,reducedMotion:"never"}),sc=p.createContext({}),$m=typeof window<"u",ak=$m?p.useLayoutEffect:p.useEffect,ik=p.createContext({strict:!1});function aB(s,t,r,n,a){var i,o;const{visualElement:l}=p.useContext(sc),c=p.useContext(ik),d=p.useContext(tc),u=p.useContext(Lm).reducedMotion,h=p.useRef();n=n||c.renderer,!h.current&&n&&(h.current=n(s,{visualState:t,parent:l,props:r,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:u}));const m=h.current,x=p.useContext(G1);m&&!m.projection&&a&&(m.type==="html"||m.type==="svg")&&iB(h.current,r,a,x);const g=p.useRef(!1);p.useInsertionEffect(()=>{m&&g.current&&m.update(r,d)});const f=r[I1],v=p.useRef(!!f&&!(!((i=window.MotionHandoffIsComplete)===null||i===void 0)&&i.call(window,f))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,f)));return ak(()=>{m&&(g.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),Fm.render(m.render),v.current&&m.animationState&&m.animationState.animateChanges())}),p.useEffect(()=>{m&&(!v.current&&m.animationState&&m.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var y;(y=window.MotionHandoffMarkAsComplete)===null||y===void 0||y.call(window,f)}),v.current=!1))}),m}function iB(s,t,r,n){const{layoutId:a,layout:i,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:d}=t;s.projection=new r(s.latestValues,t["data-framer-portal-id"]?void 0:ok(s.parent)),s.projection.setOptions({layoutId:a,layout:i,alwaysMeasureLayout:!!o||l&&ea(l),visualElement:s,animationType:typeof i=="string"?i:"both",initialPromotionConfig:n,layoutScroll:c,layoutRoot:d})}function ok(s){if(s)return s.options.allowProjection!==!1?s.projection:ok(s.parent)}function oB(s,t,r){return p.useCallback(n=>{n&&s.mount&&s.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):ea(r)&&(r.current=n))},[t])}function rc(s){return Xl(s.animate)||xm.some(t=>Oi(s[t]))}function lk(s){return!!(rc(s)||s.variants)}function lB(s,t){if(rc(s)){const{initial:r,animate:n}=s;return{initial:r===!1||Oi(r)?r:void 0,animate:Oi(n)?n:void 0}}return s.inherit!==!1?t:{}}function cB(s){const{initial:t,animate:r}=lB(s,p.useContext(sc));return p.useMemo(()=>({initial:t,animate:r}),[Lf(t),Lf(r)])}function Lf(s){return Array.isArray(s)?s.join(" "):s}const $f={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ka={};for(const s in $f)ka[s]={isEnabled:t=>$f[s].some(r=>!!t[r])};function dB(s){for(const t in s)ka[t]={...ka[t],...s[t]}}const uB=Symbol.for("motionComponentSymbol");function mB({preloadedFeatures:s,createVisualElement:t,useRender:r,useVisualState:n,Component:a}){s&&dB(s);function i(l,c){let d;const u={...p.useContext(Lm),...l,layoutId:hB(l)},{isStatic:h}=u,m=cB(l),x=n(l,h);if(!h&&$m){pB();const g=fB(u);d=g.MeasureLayout,m.visualElement=aB(a,x,u,t,g.ProjectionNode)}return e.jsxs(sc.Provider,{value:m,children:[d&&m.visualElement?e.jsx(d,{visualElement:m.visualElement,...u}):null,r(a,l,oB(x,m.visualElement,c),x,h,m.visualElement)]})}const o=p.forwardRef(i);return o[uB]=a,o}function hB({layoutId:s}){const t=p.useContext(Om).id;return t&&s!==void 0?t+"-"+s:s}function pB(s,t){p.useContext(ik).strict}function fB(s){const{drag:t,layout:r}=ka;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(s)||r!=null&&r.isEnabled(s)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const xB=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Bm(s){return typeof s!="string"||s.includes("-")?!1:!!(xB.indexOf(s)>-1||/[A-Z]/u.test(s))}function ck(s,{style:t,vars:r},n,a){Object.assign(s.style,t,a&&a.getProjectionStyles(n));for(const i in r)s.style.setProperty(i,r[i])}const dk=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function uk(s,t,r,n){ck(s,t,void 0,n);for(const a in t.attrs)s.setAttribute(dk.has(a)?a:Mm(a),t.attrs[a])}function mk(s,{layout:t,layoutId:r}){return Un.has(s)||s.startsWith("origin")||(t||r!==void 0)&&(!!ul[s]||s==="opacity")}function Vm(s,t,r){var n;const{style:a}=s,i={};for(const o in a)(es(a[o])||t.style&&es(t.style[o])||mk(o,s)||((n=r==null?void 0:r.getValue(o))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(i[o]=a[o]);return i}function hk(s,t,r){const n=Vm(s,t,r);for(const a in s)if(es(s[a])||es(t[a])){const i=to.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;n[i]=s[a]}return n}function Um(s){const t=p.useRef(null);return t.current===null&&(t.current=s()),t.current}function gB({scrapeMotionValuesFromProps:s,createRenderState:t,onMount:r},n,a,i){const o={latestValues:vB(n,a,i,s),renderState:t()};return r&&(o.mount=l=>r(n,l,o)),o}const pk=s=>(t,r)=>{const n=p.useContext(sc),a=p.useContext(tc),i=()=>gB(s,t,n,a);return r?i():Um(i)};function vB(s,t,r,n){const a={},i=n(s,{});for(const m in i)a[m]=Oo(i[m]);let{initial:o,animate:l}=s;const c=rc(s),d=lk(s);t&&d&&!c&&s.inherit!==!1&&(o===void 0&&(o=t.initial),l===void 0&&(l=t.animate));let u=r?r.initial===!1:!1;u=u||o===!1;const h=u?l:o;if(h&&typeof h!="boolean"&&!Xl(h)){const m=Array.isArray(h)?h:[h];for(let x=0;x<m.length;x++){const g=pm(s,m[x]);if(g){const{transitionEnd:f,transition:v,...y}=g;for(const j in y){let b=y[j];if(Array.isArray(b)){const k=u?b.length-1:0;b=b[k]}b!==null&&(a[j]=b)}for(const j in f)a[j]=f[j]}}}return a}const Hm=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),fk=()=>({...Hm(),attrs:{}}),xk=(s,t)=>t&&typeof s=="number"?t.transform(s):s,yB={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},jB=to.length;function bB(s,t,r){let n="",a=!0;for(let i=0;i<jB;i++){const o=to[i],l=s[o];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(o.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||r){const d=xk(l,Sm[o]);if(!c){a=!1;const u=yB[o]||o;n+=`${u}(${d}) `}r&&(t[o]=d)}}return n=n.trim(),r?n=r(t,a?"":n):a&&(n="none"),n}function qm(s,t,r){const{style:n,vars:a,transformOrigin:i}=s;let o=!1,l=!1;for(const c in t){const d=t[c];if(Un.has(c)){o=!0;continue}else if(l1(c)){a[c]=d;continue}else{const u=xk(d,Sm[c]);c.startsWith("origin")?(l=!0,i[c]=u):n[c]=u}}if(t.transform||(o||r?n.transform=bB(t,s.transform,r):n.transform&&(n.transform="none")),l){const{originX:c="50%",originY:d="50%",originZ:u=0}=i;n.transformOrigin=`${c} ${d} ${u}`}}function Bf(s,t,r){return typeof s=="string"?s:Ee.transform(t+r*s)}function wB(s,t,r){const n=Bf(t,s.x,s.width),a=Bf(r,s.y,s.height);return`${n} ${a}`}const NB={offset:"stroke-dashoffset",array:"stroke-dasharray"},SB={offset:"strokeDashoffset",array:"strokeDasharray"};function CB(s,t,r=1,n=0,a=!0){s.pathLength=1;const i=a?NB:SB;s[i.offset]=Ee.transform(-n);const o=Ee.transform(t),l=Ee.transform(r);s[i.array]=`${o} ${l}`}function zm(s,{attrX:t,attrY:r,attrScale:n,originX:a,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...d},u,h){if(qm(s,d,h),u){s.style.viewBox&&(s.attrs.viewBox=s.style.viewBox);return}s.attrs=s.style,s.style={};const{attrs:m,style:x,dimensions:g}=s;m.transform&&(g&&(x.transform=m.transform),delete m.transform),g&&(a!==void 0||i!==void 0||x.transform)&&(x.transformOrigin=wB(g,a!==void 0?a:.5,i!==void 0?i:.5)),t!==void 0&&(m.x=t),r!==void 0&&(m.y=r),n!==void 0&&(m.scale=n),o!==void 0&&CB(m,o,l,c,!1)}const Wm=s=>typeof s=="string"&&s.toLowerCase()==="svg",kB={useVisualState:pk({scrapeMotionValuesFromProps:hk,createRenderState:fk,onMount:(s,t,{renderState:r,latestValues:n})=>{mt.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),mt.render(()=>{zm(r,n,Wm(t.tagName),s.transformTemplate),uk(t,r)})}})},TB={useVisualState:pk({scrapeMotionValuesFromProps:Vm,createRenderState:Hm})};function gk(s,t,r){for(const n in t)!es(t[n])&&!mk(n,r)&&(s[n]=t[n])}function PB({transformTemplate:s},t){return p.useMemo(()=>{const r=Hm();return qm(r,t,s),Object.assign({},r.vars,r.style)},[t])}function EB(s,t){const r=s.style||{},n={};return gk(n,r,s),Object.assign(n,PB(s,t)),n}function DB(s,t){const r={},n=EB(s,t);return s.drag&&s.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=s.drag===!0?"none":`pan-${s.drag==="x"?"y":"x"}`),s.tabIndex===void 0&&(s.onTap||s.onTapStart||s.whileTap)&&(r.tabIndex=0),r.style=n,r}const AB=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ml(s){return s.startsWith("while")||s.startsWith("drag")&&s!=="draggable"||s.startsWith("layout")||s.startsWith("onTap")||s.startsWith("onPan")||s.startsWith("onLayout")||AB.has(s)}let vk=s=>!ml(s);function _B(s){s&&(vk=t=>t.startsWith("on")?!ml(t):s(t))}try{_B(require("@emotion/is-prop-valid").default)}catch{}function IB(s,t,r){const n={};for(const a in s)a==="values"&&typeof s.values=="object"||(vk(a)||r===!0&&ml(a)||!t&&!ml(a)||s.draggable&&a.startsWith("onDrag"))&&(n[a]=s[a]);return n}function RB(s,t,r,n){const a=p.useMemo(()=>{const i=fk();return zm(i,t,Wm(n),s.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(s.style){const i={};gk(i,s.style,s),a.style={...i,...a.style}}return a}function MB(s=!1){return(r,n,a,{latestValues:i},o)=>{const c=(Bm(r)?RB:DB)(n,i,o,r),d=IB(n,typeof r=="string",s),u=r!==p.Fragment?{...d,...c,ref:a}:{},{children:h}=n,m=p.useMemo(()=>es(h)?h.get():h,[h]);return p.createElement(r,{...u,children:m})}}function OB(s,t){return function(n,{forwardMotionProps:a}={forwardMotionProps:!1}){const o={...Bm(n)?kB:TB,preloadedFeatures:s,useRender:MB(a),createVisualElement:t,Component:n};return mB(o)}}const eu={current:null},yk={current:!1};function FB(){if(yk.current=!0,!!$m)if(window.matchMedia){const s=window.matchMedia("(prefers-reduced-motion)"),t=()=>eu.current=s.matches;s.addListener(t),t()}else eu.current=!1}function LB(s,t,r){for(const n in t){const a=t[n],i=r[n];if(es(a))s.addValue(n,a);else if(es(i))s.addValue(n,$i(a,{owner:s}));else if(i!==a)if(s.hasValue(n)){const o=s.getValue(n);o.liveStyle===!0?o.jump(a):o.hasAnimated||o.set(a)}else{const o=s.getStaticValue(n);s.addValue(n,$i(o!==void 0?o:a,{owner:s}))}}for(const n in r)t[n]===void 0&&s.removeValue(n);return t}const Vf=new WeakMap,$B=[...u1,Xt,Qr],BB=s=>$B.find(d1(s)),Uf=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VB{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:a,blockInitialAnimation:i,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=bm,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=cr.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,mt.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=d,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=l,this.blockInitialAnimation=!!i,this.isControllingVariants=rc(r),this.isVariantNode=lk(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const m in h){const x=h[m];c[m]!==void 0&&es(x)&&x.set(c[m],!1)}}mount(t){this.current=t,Vf.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),yk.current||FB(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:eu.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Vf.delete(this.current),this.projection&&this.projection.unmount(),Gr(this.notifyUpdate),Gr(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Un.has(t),a=r.on("change",l=>{this.latestValues[t]=l,this.props.onUpdate&&mt.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{a(),i(),o&&o(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in ka){const r=ka[t];if(!r)continue;const{isEnabled:n,Feature:a}=r;if(!this.features[t]&&a&&n(this.props)&&(this.features[t]=new a(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Et()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<Uf.length;n++){const a=Uf[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i="on"+a,o=t[i];o&&(this.propEventSubscriptions[a]=this.on(a,o))}this.prevMotionValues=LB(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=$i(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){var n;let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(n=this.getBaseTargetFromProps(this.props,t))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(i1(a)||a1(a))?a=parseFloat(a):!BB(a)&&Qr.test(r)&&(a=y1(t,r)),this.setBaseTarget(t,es(a)?a.get():a)),es(a)?a.get():a}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props;let a;if(typeof n=="string"||typeof n=="object"){const o=pm(this.props,n,(r=this.presenceContext)===null||r===void 0?void 0:r.custom);o&&(a=o[t])}if(n&&a!==void 0)return a;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!es(i)?i:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Rm),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class jk extends VB{constructor(){super(...arguments),this.KeyframeResolver=j1}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;es(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function UB(s){return window.getComputedStyle(s)}class HB extends jk{constructor(){super(...arguments),this.type="html",this.renderInstance=ck}readValueFromInstance(t,r){if(Un.has(r)){const n=Cm(r);return n&&n.default||0}else{const n=UB(t),a=(l1(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return W1(t,r)}build(t,r,n){qm(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return Vm(t,r,n)}}class qB extends jk{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Et}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Un.has(r)){const n=Cm(r);return n&&n.default||0}return r=dk.has(r)?r:Mm(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return hk(t,r,n)}build(t,r,n){zm(t,r,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,n,a){uk(t,r,n,a)}mount(t){this.isSVGTag=Wm(t.tagName),super.mount(t)}}const zB=(s,t)=>Bm(s)?new qB(t):new HB(t,{allowProjection:s!==p.Fragment}),WB=OB({..._3,...rB,...W$,...nB},zB),Wc=D5(WB);class KB extends p.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function GB({children:s,isPresent:t}){const r=p.useId(),n=p.useRef(null),a=p.useRef({width:0,height:0,top:0,left:0}),{nonce:i}=p.useContext(Lm);return p.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:d}=a.current;if(t||!n.current||!o||!l)return;n.current.dataset.motionPopId=r;const u=document.createElement("style");return i&&(u.nonce=i),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${c}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),e.jsx(KB,{isPresent:t,childRef:n,sizeRef:a,children:p.cloneElement(s,{ref:n})})}const QB=({children:s,initial:t,isPresent:r,onExitComplete:n,custom:a,presenceAffectsLayout:i,mode:o})=>{const l=Um(ZB),c=p.useId(),d=p.useCallback(h=>{l.set(h,!0);for(const m of l.values())if(!m)return;n&&n()},[l,n]),u=p.useMemo(()=>({id:c,initial:t,isPresent:r,custom:a,onExitComplete:d,register:h=>(l.set(h,!1),()=>l.delete(h))}),i?[Math.random(),d]:[r,d]);return p.useMemo(()=>{l.forEach((h,m)=>l.set(m,!1))},[r]),p.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),o==="popLayout"&&(s=e.jsx(GB,{isPresent:r,children:s})),e.jsx(tc.Provider,{value:u,children:s})};function ZB(){return new Map}const bo=s=>s.key||"";function Hf(s){const t=[];return p.Children.forEach(s,r=>{p.isValidElement(r)&&t.push(r)}),t}const YB=({children:s,exitBeforeEnter:t,custom:r,initial:n=!0,onExitComplete:a,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const l=p.useMemo(()=>Hf(s),[s]),c=l.map(bo),d=p.useRef(!0),u=p.useRef(l),h=Um(()=>new Map),[m,x]=p.useState(l),[g,f]=p.useState(l);ak(()=>{d.current=!1,u.current=l;for(let j=0;j<g.length;j++){const b=bo(g[j]);c.includes(b)?h.delete(b):h.get(b)!==!0&&h.set(b,!1)}},[g,c.length,c.join("-")]);const v=[];if(l!==m){let j=[...l];for(let b=0;b<g.length;b++){const k=g[b],S=bo(k);c.includes(S)||(j.splice(b,0,k),v.push(k))}o==="wait"&&v.length&&(j=v),f(Hf(j)),x(l);return}const{forceRender:y}=p.useContext(Om);return e.jsx(e.Fragment,{children:g.map(j=>{const b=bo(j),k=l===g||c.includes(b),S=()=>{if(h.has(b))h.set(b,!0);else return;let A=!0;h.forEach(T=>{T||(A=!1)}),A&&(y==null||y(),f(u.current),a&&a())};return e.jsx(QB,{isPresent:k,initial:!d.current||n?void 0:!1,custom:k?void 0:r,presenceAffectsLayout:i,mode:o,onExitComplete:k?void 0:S,children:j},b)})})},Kn=UF,XB={pending:"Ready to be ordered",processed:"Order processed",ordered:"Order placed with supplier",arrived:"Materials arrived",frame_cut:"Frame cutting complete",mat_cut:"Mat cutting complete",prepped:"Materials prepped",completed:"Order completed",delayed:"Order delayed",canceled:"Order canceled"},JB=({status:s})=>{switch(s){case"pending":return e.jsx(vt,{className:"h-5 w-5"});case"processed":return e.jsx(Qc,{className:"h-5 w-5"});case"ordered":return e.jsx(Qc,{className:"h-5 w-5"});case"arrived":return e.jsx(Yr,{className:"h-5 w-5"});case"frame_cut":return e.jsx(No,{className:"h-5 w-5"});case"mat_cut":return e.jsx(No,{className:"h-5 w-5"});case"prepped":return e.jsx(No,{className:"h-5 w-5"});case"completed":return e.jsx(ls,{className:"h-5 w-5"});case"delayed":return e.jsx(vt,{className:"h-5 w-5"});case"canceled":return e.jsx(Bn,{className:"h-5 w-5"});default:return e.jsx(q2,{className:"h-5 w-5"})}},e6=({status:s,className:t})=>{const[r,n]=p.useState(0);p.useEffect(()=>{if(s==="canceled"){n(100);return}if(s==="delayed"){n(50);return}const i=Kn.filter(l=>l!=="canceled"&&l!=="delayed"),o=i.findIndex(l=>l===s);if(o===-1)n(0);else{const l=(o+1)/i.length*100;let c=0;(()=>{const u=setInterval(()=>{c+=2,n(Math.min(c,l)),c>=l&&clearInterval(u)},20);return()=>clearInterval(u)})()}},[s]);const a=i=>{switch(i){case"pending":return"bg-yellow-500";case"processed":return"bg-blue-300";case"ordered":return"bg-blue-500";case"arrived":return"bg-purple-500";case"frame_cut":return"bg-indigo-500";case"mat_cut":return"bg-teal-500";case"prepped":return"bg-cyan-500";case"completed":return"bg-green-500";case"delayed":return"bg-orange-500";case"canceled":return"bg-red-500";default:return"bg-gray-500"}};return e.jsxs("div",{className:J("space-y-4",t),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(JB,{status:s}),e.jsx(ue,{className:a(s),children:s.replace("_"," ")}),e.jsx(Wc.span,{className:"text-sm font-medium",initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.3},children:XB[s]})]}),e.jsx(oa,{value:r,className:J("h-2 w-full",{"bg-red-200":s==="canceled","bg-orange-200":s==="delayed"})}),e.jsx("div",{className:"flex justify-between text-xs text-muted-foreground",children:e.jsx(YB,{children:Kn.filter(i=>i!=="canceled"&&i!=="delayed").map((i,o)=>e.jsxs(Wc.div,{className:J("flex flex-col items-center",{"text-primary font-medium":s===i,"text-muted-foreground":s!==i}),initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:o*.1},children:[e.jsx("div",{className:"flex items-center mb-1",children:e.jsx("div",{className:J("size-2 rounded-full",{"bg-primary":Kn.indexOf(i)<=Kn.indexOf(s),"bg-muted-foreground":Kn.indexOf(i)>Kn.indexOf(s)})})}),e.jsx("span",{className:"capitalize",children:i.replace("_"," ")})]},i))})}),(s==="canceled"||s==="delayed")&&e.jsx(Wc.div,{className:"text-sm p-2 rounded-md bg-muted",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3},children:e.jsx("p",{className:"font-medium",children:s==="canceled"?"This order has been canceled":"This order is delayed"})})]})};function Us({className:s,...t}){return e.jsx("div",{className:J("animate-pulse rounded-md bg-muted",s),...t})}function t6({refreshTrigger:s=0}){const{toast:t}=Be(),[r,n]=p.useState(!1),{data:a,isLoading:i,isError:o,refetch:l}=me({queryKey:["/api/hub/connection-status",s],queryFn:async()=>{try{return await new Promise(d=>setTimeout(d,1e3)),{connected:!1,error:"Missing HUB_API_KEY environment variable",lastChecked:new Date().toISOString()}}catch{throw new Error("Failed to check connection status")}},refetchInterval:r?6e4:!1}),c=Ce({mutationFn:async()=>{throw await new Promise(d=>setTimeout(d,1500)),new Error("Connection failed: API key not found")},onSuccess:()=>{t({title:"Connection Test Successful",description:"Successfully connected to Jays Frames Hub",variant:"default"}),l()},onError:d=>{t({title:"Connection Test Failed",description:d.message||"Failed to connect to Jays Frames Hub",variant:"destructive"})}});return e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center",children:[e.jsx(pu,{className:"mr-2 h-5 w-5"}),"Hub Connection Status"]}),e.jsx(te,{children:"Connection information for Jays Frames Hub integration"})]}),e.jsx(q,{children:i?e.jsxs("div",{className:"space-y-2",children:[e.jsx(Us,{className:"h-4 w-[250px]"}),e.jsx(Us,{className:"h-4 w-[200px]"}),e.jsx(Us,{className:"h-4 w-[150px]"})]}):o?e.jsxs(hs,{variant:"destructive",children:[e.jsx(At,{className:"h-4 w-4"}),e.jsx(Ys,{children:"Connection Error"}),e.jsx(ps,{children:"Failed to check Hub connection status. Please try again."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Connection Status:"}),a!=null&&a.connected?e.jsx(ue,{className:"bg-green-500",children:"Connected"}):e.jsx(ue,{className:"bg-red-500",children:"Disconnected"})]}),a!=null&&a.connected?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Hub Name:"}),e.jsx("span",{children:a.hubName})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"API Version:"}),e.jsx("span",{children:a.apiVersion})]})]}):e.jsxs(hs,{variant:"destructive",className:"mt-4",children:[e.jsx(At,{className:"h-4 w-4"}),e.jsx(Ys,{children:"Connection Issue"}),e.jsx(ps,{children:(a==null?void 0:a.error)||"Failed to connect to Jays Frames Hub. Please check your API credentials."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Last Checked:"}),e.jsx("span",{children:a!=null&&a.lastChecked?new Date(a.lastChecked).toLocaleString():"Never"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(br,{id:"auto-sync",checked:r,onCheckedChange:n}),e.jsx(M,{htmlFor:"auto-sync",children:"Auto-refresh connection status"})]}),e.jsxs("div",{className:"mt-4 p-3 bg-muted rounded-md",children:[e.jsx("h4",{className:"font-medium mb-1",children:"System Integration Info"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"This POS system functions as part of the Hub ecosystem, handling customer orders and inventory management."}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"POS Role:"})," Primary point of sale and custom framing calculation engine"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Production Link:"})," ",e.jsx(Mt,{to:"/production",className:"text-primary hover:underline",children:"Production Kanban"})," connects directly to Hub's production system"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Materials Link:"})," ",e.jsx(Mt,{to:"/materials",className:"text-primary hover:underline",children:"Materials Page"})," syncs with Hub's inventory management"]})]})]})]})}),e.jsxs(ht,{className:"flex justify-between",children:[e.jsxs(P,{variant:"outline",onClick:()=>l(),children:[e.jsx(z2,{className:"mr-2 h-4 w-4"}),"Refresh Status"]}),e.jsxs(P,{onClick:()=>c.mutate(),disabled:c.isPending,children:[c.isPending?e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Gs,{className:"mr-2 h-4 w-4"}),"Test Connection"]})]})]})}const s6=s=>{switch(s){case"synced":return"bg-green-500";case"failed":return"bg-red-500";case"not_synced":return"bg-yellow-500";default:return"bg-gray-500"}};function r6(){const s=Zt(),{toast:t}=Be(),[r,n]=p.useState(null),[a,i]=p.useState(!1),[o,l]=p.useState("all"),[c,d]=p.useState(0);p.useState(""),p.useState(!1),p.useState("unknown");const[u,h]=p.useState(""),[m,x]=p.useState(""),[g,f]=p.useState(!1),[v,y]=p.useState("not_configured"),{data:j,isLoading:b,isError:k,error:S}=me({queryKey:["/api/hub/material-orders"],queryFn:()=>ce("GET","/api/hub/material-orders").then(_=>_.json())}),A=Ce({mutationFn:_=>ce("POST",`/api/hub/material-orders/${_}/sync`).then(F=>F.json()),onSuccess:()=>{s.invalidateQueries({queryKey:["/api/hub/material-orders"]}),t({title:"Order synced with Jays Frames Hub",description:"The material order has been successfully synced with the Hub",variant:"default"})},onError:_=>{t({title:"Sync failed",description:_.message||"Failed to sync order with Jays Frames Hub",variant:"destructive"})}}),T=Ce({mutationFn:()=>ce("POST","/api/hub/material-orders/sync-all").then(_=>_.json()),onSuccess:_=>{s.invalidateQueries({queryKey:["/api/hub/material-orders"]}),t({title:"Bulk sync completed",description:`Successfully synced ${_.succeeded} out of ${_.total} orders with the Hub`,variant:"default"})},onError:_=>{t({title:"Bulk sync failed",description:_.message||"Failed to sync orders with Jays Frames Hub",variant:"destructive"})}}),C=Ce({mutationFn:_=>ce("GET",`/api/hub/material-orders/${_}/status`).then(F=>F.json()),onSuccess:_=>{s.invalidateQueries({queryKey:["/api/hub/material-orders"]}),_.order&&(n(_.order),i(!0)),t({title:"Status updated",description:"The latest status has been retrieved from Jays Frames Hub",variant:"default"})},onError:_=>{t({title:"Status update failed",description:_.message||"Failed to get order status from Jays Frames Hub",variant:"destructive"})}}),E=async()=>{if(!u||!m){t({title:"Missing Configuration",description:"Please provide both Kanban API URL and API Key",variant:"destructive"});return}f(!0);try{const _=await fetch("/api/integration/configure-kanban",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kanbanApiUrl:u,kanbanApiKey:m})});if(!_.ok)throw new Error("Failed to configure Kanban connection");const F=await _.json();if(F.success)y("connected"),t({title:"Kanban Connected",description:"Successfully connected to Kanban app for order fetching."});else throw new Error(F.error||"Failed to configure Kanban connection")}catch(_){console.error("Error configuring Kanban:",_),y("error"),t({title:"Configuration Failed",description:_.message||"Failed to configure Kanban connection",variant:"destructive"})}finally{f(!1)}},D=async()=>{try{const F=await(await fetch("/api/kanban/external/test-connection",{method:"POST",headers:{"Content-Type":"application/json"}})).json();F.success?(y("connected"),t({title:"Kanban Connection Test",description:`Successfully connected! Found ${F.ordersTest.orderCount} orders.`})):(y("error"),t({title:"Connection Test Failed",description:F.error||"Failed to connect to Kanban API",variant:"destructive"}))}catch(_){y("error"),t({title:"Connection Test Failed",description:_.message||"Failed to test Kanban connection",variant:"destructive"})}},N=(()=>{if(!j)return[];switch(o){case"not_synced":return j.filter(_=>!_.hubOrderId||_.hubSyncStatus==="not_synced");case"synced":return j.filter(_=>_.hubSyncStatus==="synced");case"failed":return j.filter(_=>_.hubSyncStatus==="failed");case"pending":return j.filter(_=>_.status==="pending");default:return j}})();return b?e.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("span",{className:"ml-2",children:"Loading Hub integration data..."})]}):k?e.jsxs(hs,{variant:"destructive",className:"max-w-2xl mx-auto mt-8",children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(Ys,{children:"Error loading data"}),e.jsx(ps,{children:S instanceof Error?S.message:"Failed to load material orders"})]}):e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Jays Frames Hub Integration"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage material orders integration with Jays Frames Hub. This POS system automatically synchronizes orders, inventory, and statuses with the Hub."})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(P,{variant:"outline",onClick:()=>{s.invalidateQueries({queryKey:["/api/hub/material-orders"]}),d(_=>_+1)},disabled:b,children:[e.jsx(ir,{className:"mr-2 h-4 w-4"}),"Refresh"]}),e.jsxs(P,{onClick:()=>T.mutate(),disabled:T.isPending||!(j!=null&&j.some(_=>!_.hubOrderId||_.hubSyncStatus==="not_synced")),children:[T.isPending?e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Or,{className:"mr-2 h-4 w-4"}),"Sync All Pending Orders"]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx(t6,{refreshTrigger:c})}),e.jsxs(qt,{defaultValue:"all",className:"mb-6",onValueChange:l,children:[e.jsxs($t,{className:"grid grid-cols-5 w-full max-w-md mb-2",children:[e.jsx(ve,{value:"all",children:"All Orders"}),e.jsx(ve,{value:"not_synced",children:"Not Synced"}),e.jsx(ve,{value:"synced",children:"Synced"}),e.jsx(ve,{value:"failed",children:"Failed"}),e.jsx(ve,{value:"pending",children:"Pending"})]}),e.jsx(Ae,{value:o,children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{children:["Material Orders ",o!=="all"&&`- ${o.replace("_"," ")}`]}),e.jsxs(te,{children:[N.length," ",N.length===1?"order":"orders"," found"]})]}),e.jsx(q,{children:N.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No material orders found with the selected filter."}):e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{children:"ID"}),e.jsx(de,{children:"Material"}),e.jsx(de,{children:"Status"}),e.jsx(de,{children:"Hub Status"}),e.jsx(de,{children:"Last Synced"}),e.jsx(de,{className:"text-right",children:"Actions"})]})}),e.jsx(ys,{children:N.map(_=>e.jsxs(tt,{children:[e.jsx(ie,{className:"font-medium",children:_.id}),e.jsx(ie,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:_.materialName}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[_.materialType," - ",_.materialId]})]})}),e.jsx(ie,{children:e.jsx(ue,{variant:"outline",className:`px-2 ${qf(_.status)}`,children:zf(_.status)})}),e.jsxs(ie,{children:[e.jsx(ue,{variant:"outline",className:`px-2 ${s6(_.hubSyncStatus||"not_synced")}`,children:_.hubSyncStatus?_.hubSyncStatus.replace("_"," "):"Not Synced"}),_.hubOrderId&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Hub ID: ",_.hubOrderId]})]}),e.jsx(ie,{children:_.hubLastSyncDate?new Date(_.hubLastSyncDate).toLocaleString():"Never"}),e.jsx(ie,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>C.mutate(_.id),disabled:C.isPending||!_.hubOrderId,title:_.hubOrderId?"Check status from Hub":"Order not yet synced with Hub",children:C.isPending&&C.variables===_.id?e.jsx(Xe,{className:"h-4 w-4 animate-spin"}):e.jsx(xn,{className:"h-4 w-4"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>A.mutate(_.id),disabled:A.isPending,children:A.isPending&&A.variables===_.id?e.jsx(Xe,{className:"h-4 w-4 animate-spin"}):e.jsx(Or,{className:"h-4 w-4"})})]})})]},_.id))})]})})]})})]}),e.jsx(Bt,{open:a,onOpenChange:i,children:e.jsxs(Lt,{className:"sm:max-w-md",children:[e.jsxs(Vt,{children:[e.jsx(Ut,{children:"Material Order Status"}),e.jsx(bs,{children:"Current status information from Jays Frames Hub"})]}),r&&e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"Order ID:"}),e.jsx("span",{children:r.id})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"Material:"}),e.jsx("span",{children:r.materialName})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"Hub Order ID:"}),e.jsx("span",{children:r.hubOrderId||"Not synced"})]}),e.jsx(Ot,{className:"my-4"}),e.jsx("div",{className:"mb-4",children:e.jsx(e6,{status:r.status})}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"Status:"}),e.jsx(ue,{variant:"outline",className:`px-2 ${qf(r.status)}`,children:zf(r.status)})]}),r.expectedArrival&&e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"Expected Arrival:"}),e.jsx("span",{children:new Date(r.expectedArrival).toLocaleDateString()})]}),r.hubTrackingInfo&&e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"Tracking:"}),e.jsx("span",{children:r.hubTrackingInfo})]}),r.hubSupplierNotes&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Supplier Notes:"}),e.jsx("p",{className:"mt-1 text-sm bg-muted p-2 rounded",children:r.hubSupplierNotes})]})]})]})}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(Nl,{className:"h-5 w-5"}),"Kanban App Integration"]}),e.jsx(te,{children:"Connect to your external Kanban app to fetch real-world orders"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"kanban-url",children:"Kanban API URL"}),e.jsx(U,{id:"kanban-url",value:u,onChange:_=>h(_.target.value),placeholder:"https://your-kanban-app.replit.app"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"kanban-key",children:"Kanban API Key"}),e.jsx(U,{id:"kanban-key",type:"password",value:m,onChange:_=>x(_.target.value),placeholder:"Enter Kanban API key"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(P,{onClick:E,disabled:g||!u||!m,className:"w-full",children:g?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"h-4 w-4 mr-2 animate-spin"}),"Configuring..."]}):e.jsxs(e.Fragment,{children:[e.jsx(gi,{className:"h-4 w-4 mr-2"}),"Configure Kanban Connection"]})}),e.jsx(P,{onClick:D,variant:"outline",className:"w-full",children:"Test Connection"})]}),e.jsxs(hs,{children:[e.jsx(yi,{className:"h-4 w-4"}),e.jsx(Ys,{children:"Kanban Integration"}),e.jsx(ps,{children:"When configured, the system will automatically fetch orders from your Kanban app instead of using local storage. This allows you to see real-world production orders in the system."})]})]})]})]})}function qf(s){switch(s){case"pending":return"bg-yellow-500";case"processed":return"bg-blue-500";case"ordered":return"bg-purple-500";case"arrived":return"bg-indigo-500";case"frame_cut":return"bg-teal-500";case"mat_cut":return"bg-cyan-500";case"prepped":return"bg-lime-500";case"completed":return"bg-green-500";case"delayed":return"bg-orange-500";case"canceled":return"bg-red-500";default:return"bg-gray-500"}}function zf(s){return s.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}async function n6(){try{return await(await ce("POST","/api/admin/generate-api-key")).json()}catch(s){throw console.error("Error generating API key:",s),s}}async function a6(){try{return await(await ce("GET","/api/admin/integration-status")).json()}catch(s){throw console.error("Error getting integration status:",s),s}}async function i6(){try{return await(await ce("GET","/api/admin/integration-docs")).json()}catch(s){throw console.error("Error getting integration documentation:",s),s}}async function o6(s){try{return await(await ce("POST","/api/admin/test-webhook",{webhookUrl:s})).json()}catch(t){throw console.error("Error testing webhook:",t),t}}async function l6(){try{return await(await ce("GET","/api/webhooks")).json()}catch(s){throw console.error("Error getting webhook endpoints:",s),s}}async function c6(s){try{return await(await ce("POST","/api/webhooks",s)).json()}catch(t){throw console.error("Error creating webhook endpoint:",t),t}}async function d6(s){try{return await(await ce("DELETE",`/api/webhooks/${s}`)).json()}catch(t){throw console.error("Error deleting webhook endpoint:",t),t}}function u6(s,t){return p.useReducer((r,n)=>t[r][n]??r,s)}var Km="ScrollArea",[bk,mU]=fs(Km),[m6,Ls]=bk(Km),wk=p.forwardRef((s,t)=>{const{__scopeScrollArea:r,type:n="hover",dir:a,scrollHideDelay:i=600,...o}=s,[l,c]=p.useState(null),[d,u]=p.useState(null),[h,m]=p.useState(null),[x,g]=p.useState(null),[f,v]=p.useState(null),[y,j]=p.useState(0),[b,k]=p.useState(0),[S,A]=p.useState(!1),[T,C]=p.useState(!1),E=Ge(t,w=>c(w)),D=Ln(a);return e.jsx(m6,{scope:r,type:n,dir:D,scrollHideDelay:i,scrollArea:l,viewport:d,onViewportChange:u,content:h,onContentChange:m,scrollbarX:x,onScrollbarXChange:g,scrollbarXEnabled:S,onScrollbarXEnabledChange:A,scrollbarY:f,onScrollbarYChange:v,scrollbarYEnabled:T,onScrollbarYEnabledChange:C,onCornerWidthChange:j,onCornerHeightChange:k,children:e.jsx(Se.div,{dir:D,...o,ref:E,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":b+"px",...s.style}})})});wk.displayName=Km;var Nk="ScrollAreaViewport",Sk=p.forwardRef((s,t)=>{const{__scopeScrollArea:r,children:n,asChild:a,nonce:i,...o}=s,l=Ls(Nk,r),c=p.useRef(null),d=Ge(t,c,l.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:i}),e.jsx(Se.div,{"data-radix-scroll-area-viewport":"",...o,asChild:a,ref:d,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...s.style},children:w6({asChild:a,children:n},u=>e.jsx("div",{"data-radix-scroll-area-content":"",ref:l.onContentChange,style:{minWidth:l.scrollbarXEnabled?"fit-content":void 0},children:u}))})]})});Sk.displayName=Nk;var pr="ScrollAreaScrollbar",Gm=p.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=Ls(pr,s.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,l=s.orientation==="horizontal";return p.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),a.type==="hover"?e.jsx(h6,{...n,ref:t,forceMount:r}):a.type==="scroll"?e.jsx(p6,{...n,ref:t,forceMount:r}):a.type==="auto"?e.jsx(Ck,{...n,ref:t,forceMount:r}):a.type==="always"?e.jsx(Qm,{...n,ref:t}):null});Gm.displayName=pr;var h6=p.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=Ls(pr,s.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const l=a.scrollArea;let c=0;if(l){const d=()=>{window.clearTimeout(c),o(!0)},u=()=>{c=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return l.addEventListener("pointerenter",d),l.addEventListener("pointerleave",u),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",d),l.removeEventListener("pointerleave",u)}}},[a.scrollArea,a.scrollHideDelay]),e.jsx(ds,{present:r||i,children:e.jsx(Ck,{"data-state":i?"visible":"hidden",...n,ref:t})})}),p6=p.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=Ls(pr,s.__scopeScrollArea),i=s.orientation==="horizontal",o=ac(()=>c("SCROLL_END"),100),[l,c]=u6("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(l==="idle"){const d=window.setTimeout(()=>c("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(d)}},[l,a.scrollHideDelay,c]),p.useEffect(()=>{const d=a.viewport,u=i?"scrollLeft":"scrollTop";if(d){let h=d[u];const m=()=>{const x=d[u];h!==x&&(c("SCROLL"),o()),h=x};return d.addEventListener("scroll",m),()=>d.removeEventListener("scroll",m)}},[a.viewport,i,c,o]),e.jsx(ds,{present:r||l!=="hidden",children:e.jsx(Qm,{"data-state":l==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:ge(s.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:ge(s.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),Ck=p.forwardRef((s,t)=>{const r=Ls(pr,s.__scopeScrollArea),{forceMount:n,...a}=s,[i,o]=p.useState(!1),l=s.orientation==="horizontal",c=ac(()=>{if(r.viewport){const d=r.viewport.offsetWidth<r.viewport.scrollWidth,u=r.viewport.offsetHeight<r.viewport.scrollHeight;o(l?d:u)}},10);return Ta(r.viewport,c),Ta(r.content,c),e.jsx(ds,{present:n||i,children:e.jsx(Qm,{"data-state":i?"visible":"hidden",...a,ref:t})})}),Qm=p.forwardRef((s,t)=>{const{orientation:r="vertical",...n}=s,a=Ls(pr,s.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[l,c]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=Dk(l.viewport,l.content),u={...n,sizes:l,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:m=>i.current=m,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:m=>o.current=m};function h(m,x){return j6(m,o.current,l,x)}return r==="horizontal"?e.jsx(f6,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const m=a.viewport.scrollLeft,x=Wf(m,l,a.dir);i.current.style.transform=`translate3d(${x}px, 0, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollLeft=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollLeft=h(m,a.dir))}}):r==="vertical"?e.jsx(x6,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const m=a.viewport.scrollTop,x=Wf(m,l);i.current.style.transform=`translate3d(0, ${x}px, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollTop=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollTop=h(m))}}):null}),f6=p.forwardRef((s,t)=>{const{sizes:r,onSizesChange:n,...a}=s,i=Ls(pr,s.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),d=Ge(t,c,i.onScrollbarXChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),e.jsx(Tk,{"data-orientation":"horizontal",...a,ref:d,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":nc(r)+"px",...s.style},onThumbPointerDown:u=>s.onThumbPointerDown(u.x),onDragScroll:u=>s.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(i.viewport){const m=i.viewport.scrollLeft+u.deltaX;s.onWheelScroll(m),_k(m,h)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:pl(o.paddingLeft),paddingEnd:pl(o.paddingRight)}})}})}),x6=p.forwardRef((s,t)=>{const{sizes:r,onSizesChange:n,...a}=s,i=Ls(pr,s.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),d=Ge(t,c,i.onScrollbarYChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),e.jsx(Tk,{"data-orientation":"vertical",...a,ref:d,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":nc(r)+"px",...s.style},onThumbPointerDown:u=>s.onThumbPointerDown(u.y),onDragScroll:u=>s.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(i.viewport){const m=i.viewport.scrollTop+u.deltaY;s.onWheelScroll(m),_k(m,h)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:pl(o.paddingTop),paddingEnd:pl(o.paddingBottom)}})}})}),[g6,kk]=bk(pr),Tk=p.forwardRef((s,t)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:u,onResize:h,...m}=s,x=Ls(pr,r),[g,f]=p.useState(null),v=Ge(t,E=>f(E)),y=p.useRef(null),j=p.useRef(""),b=x.viewport,k=n.content-n.viewport,S=as(u),A=as(c),T=ac(h,10);function C(E){if(y.current){const D=E.clientX-y.current.left,w=E.clientY-y.current.top;d({x:D,y:w})}}return p.useEffect(()=>{const E=D=>{const w=D.target;(g==null?void 0:g.contains(w))&&S(D,k)};return document.addEventListener("wheel",E,{passive:!1}),()=>document.removeEventListener("wheel",E,{passive:!1})},[b,g,k,S]),p.useEffect(A,[n,A]),Ta(g,T),Ta(x.content,T),e.jsx(g6,{scope:r,scrollbar:g,hasThumb:a,onThumbChange:as(i),onThumbPointerUp:as(o),onThumbPositionChange:A,onThumbPointerDown:as(l),children:e.jsx(Se.div,{...m,ref:v,style:{position:"absolute",...m.style},onPointerDown:ge(s.onPointerDown,E=>{E.button===0&&(E.target.setPointerCapture(E.pointerId),y.current=g.getBoundingClientRect(),j.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",x.viewport&&(x.viewport.style.scrollBehavior="auto"),C(E))}),onPointerMove:ge(s.onPointerMove,C),onPointerUp:ge(s.onPointerUp,E=>{const D=E.target;D.hasPointerCapture(E.pointerId)&&D.releasePointerCapture(E.pointerId),document.body.style.webkitUserSelect=j.current,x.viewport&&(x.viewport.style.scrollBehavior=""),y.current=null})})})}),hl="ScrollAreaThumb",Pk=p.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=kk(hl,s.__scopeScrollArea);return e.jsx(ds,{present:r||a.hasThumb,children:e.jsx(v6,{ref:t,...n})})}),v6=p.forwardRef((s,t)=>{const{__scopeScrollArea:r,style:n,...a}=s,i=Ls(hl,r),o=kk(hl,r),{onThumbPositionChange:l}=o,c=Ge(t,h=>o.onThumbChange(h)),d=p.useRef(),u=ac(()=>{d.current&&(d.current(),d.current=void 0)},100);return p.useEffect(()=>{const h=i.viewport;if(h){const m=()=>{if(u(),!d.current){const x=b6(h,l);d.current=x,l()}};return l(),h.addEventListener("scroll",m),()=>h.removeEventListener("scroll",m)}},[i.viewport,u,l]),e.jsx(Se.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:ge(s.onPointerDownCapture,h=>{const x=h.target.getBoundingClientRect(),g=h.clientX-x.left,f=h.clientY-x.top;o.onThumbPointerDown({x:g,y:f})}),onPointerUp:ge(s.onPointerUp,o.onThumbPointerUp)})});Pk.displayName=hl;var Zm="ScrollAreaCorner",Ek=p.forwardRef((s,t)=>{const r=Ls(Zm,s.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?e.jsx(y6,{...s,ref:t}):null});Ek.displayName=Zm;var y6=p.forwardRef((s,t)=>{const{__scopeScrollArea:r,...n}=s,a=Ls(Zm,r),[i,o]=p.useState(0),[l,c]=p.useState(0),d=!!(i&&l);return Ta(a.scrollbarX,()=>{var h;const u=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(u),c(u)}),Ta(a.scrollbarY,()=>{var h;const u=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(u),o(u)}),d?e.jsx(Se.div,{...n,ref:t,style:{width:i,height:l,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...s.style}}):null});function pl(s){return s?parseInt(s,10):0}function Dk(s,t){const r=s/t;return isNaN(r)?0:r}function nc(s){const t=Dk(s.viewport,s.content),r=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,n=(s.scrollbar.size-r)*t;return Math.max(n,18)}function j6(s,t,r,n="ltr"){const a=nc(r),i=a/2,o=t||i,l=a-o,c=r.scrollbar.paddingStart+o,d=r.scrollbar.size-r.scrollbar.paddingEnd-l,u=r.content-r.viewport,h=n==="ltr"?[0,u]:[u*-1,0];return Ak([c,d],h)(s)}function Wf(s,t,r="ltr"){const n=nc(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-a,o=t.content-t.viewport,l=i-n,c=r==="ltr"?[0,o]:[o*-1,0],d=ji(s,c);return Ak([0,o],[0,l])(d)}function Ak(s,t){return r=>{if(s[0]===s[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(s[1]-s[0]);return t[0]+n*(r-s[0])}}function _k(s,t){return s>0&&s<t}var b6=(s,t=()=>{})=>{let r={left:s.scrollLeft,top:s.scrollTop},n=0;return function a(){const i={left:s.scrollLeft,top:s.scrollTop},o=r.left!==i.left,l=r.top!==i.top;(o||l)&&t(),r=i,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function ac(s,t){const r=as(s),n=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(n.current),[]),p.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function Ta(s,t){const r=as(t);Ss(()=>{let n=0;if(s){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return a.observe(s),()=>{window.cancelAnimationFrame(n),a.unobserve(s)}}},[s,r])}function w6(s,t){const{asChild:r,children:n}=s;if(!r)return typeof t=="function"?t(n):t;const a=p.Children.only(n);return p.cloneElement(a,{children:typeof t=="function"?t(a.props.children):t})}var Ik=wk,N6=Sk,S6=Ek;const na=p.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(Ik,{ref:n,className:J("relative overflow-hidden",s),...r,children:[e.jsx(N6,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(Rk,{}),e.jsx(S6,{})]}));na.displayName=Ik.displayName;const Rk=p.forwardRef(({className:s,orientation:t="vertical",...r},n)=>e.jsx(Gm,{ref:n,orientation:t,className:J("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...r,children:e.jsx(Pk,{className:"relative flex-1 rounded-full bg-border"})}));Rk.displayName=Gm.displayName;function C6(){const s=Zt(),{toast:t}=Be(),[r,n]=p.useState(null),[a,i]=p.useState(""),[o,l]=p.useState(""),[c,d]=p.useState(["order.created"]),[u,h]=p.useState(!1),[m,x]=p.useState("webhooks"),{data:g,isLoading:f}=me({queryKey:["/api/admin/integration-status"],queryFn:a6}),{data:v,isLoading:y}=me({queryKey:["/api/webhooks"],queryFn:l6}),{data:j,isLoading:b}=me({queryKey:["/api/admin/integration-docs"],queryFn:i6}),k=Ce({mutationFn:n6,onSuccess:w=>{n(w),t({title:"API Key Generated",description:"Your new API key has been created. Make sure to save it securely."})},onError:w=>{t({title:"Error Generating API Key",description:w.message||"Failed to generate API key",variant:"destructive"})}}),S=Ce({mutationFn:w=>o6(w),onSuccess:()=>{t({title:"Webhook Test Success",description:"The webhook endpoint responded successfully."})},onError:w=>{t({title:"Webhook Test Failed",description:w.message||"Failed to test webhook",variant:"destructive"})}}),A=Ce({mutationFn:w=>c6(w),onSuccess:()=>{s.invalidateQueries({queryKey:["/api/webhooks"]}),t({title:"Webhook Created",description:"Your webhook endpoint has been created successfully."}),i(""),l("")},onError:w=>{t({title:"Error Creating Webhook",description:w.message||"Failed to create webhook endpoint",variant:"destructive"})}}),T=Ce({mutationFn:w=>d6(w),onSuccess:()=>{s.invalidateQueries({queryKey:["/api/webhooks"]}),t({title:"Webhook Deleted",description:"The webhook endpoint has been removed."})},onError:w=>{t({title:"Error Deleting Webhook",description:w.message||"Failed to delete webhook endpoint",variant:"destructive"})}});p.useEffect(()=>{g!=null&&g.apiKey&&n(g.apiKey)},[g]);const C=()=>{r&&(navigator.clipboard.writeText(r.key),h(!0),setTimeout(()=>h(!1),2e3))},E=w=>{if(w.preventDefault(),!a||!o){t({title:"Missing Information",description:"Please provide both a name and URL for the webhook.",variant:"destructive"});return}A.mutate({name:o,url:a,events:c})},D=w=>{d(N=>N.includes(w)?N.filter(_=>_!==w):[...N,w])};return e.jsxs("div",{className:"container mx-auto py-10",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"API & Webhook Integration"}),e.jsx("p",{className:"text-gray-500 mb-8",children:"Configure API access and webhook endpoints to integrate with external systems."}),e.jsxs(qt,{value:m,onValueChange:x,className:"w-full",children:[e.jsxs($t,{className:"mb-4",children:[e.jsx(ve,{value:"webhooks",children:"Webhooks"}),e.jsx(ve,{value:"api-keys",children:"API Keys"}),e.jsx(ve,{value:"documentation",children:"Documentation"})]}),e.jsx(Ae,{value:"webhooks",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Webhook Endpoints"}),e.jsx(te,{children:"Configure webhook endpoints to receive notifications from Jay's Frames."})]}),e.jsx(q,{children:y?e.jsx("div",{className:"py-4 text-center",children:"Loading webhook endpoints..."}):v&&v.length>0?e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{children:"Name"}),e.jsx(de,{children:"Status"}),e.jsx(de,{children:"Actions"})]})}),e.jsx(ys,{children:v.map(w=>e.jsxs(tt,{children:[e.jsxs(ie,{children:[e.jsx("div",{className:"font-medium",children:w.name}),e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-[200px]",children:w.url})]}),e.jsx(ie,{children:e.jsx(ue,{variant:w.active?"default":"secondary",children:w.active?"Active":"Inactive"})}),e.jsxs(ie,{className:"space-x-2",children:[e.jsx(P,{size:"sm",variant:"outline",onClick:()=>S.mutate(w.url),children:"Test"}),e.jsx(P,{size:"sm",variant:"destructive",onClick:()=>T.mutate(w.id),children:e.jsx(Sl,{className:"h-4 w-4"})})]})]},w.id))})]}):e.jsx("div",{className:"py-4 text-center",children:"No webhook endpoints configured. Add one below."})})]}),e.jsx(V,{children:e.jsxs("form",{onSubmit:E,children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Add New Webhook"}),e.jsx(te,{children:"Create a new webhook endpoint to receive event notifications."})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"webhookName",children:"Webhook Name"}),e.jsx(U,{id:"webhookName",placeholder:"My Application Webhook",value:o,onChange:w=>l(w.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"webhookUrl",children:"Webhook URL"}),e.jsx(U,{id:"webhookUrl",placeholder:"https://example.com/webhook",value:a,onChange:w=>i(w.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Events to Subscribe"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["order.created","order.updated","order.completed","payment.received","material.ordered","material.arrived"].map(w=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(br,{id:`event-${w}`,checked:c.includes(w),onCheckedChange:()=>D(w)}),e.jsx(M,{htmlFor:`event-${w}`,children:w})]},w))})]})]}),e.jsxs(ht,{className:"flex justify-between",children:[e.jsx(P,{variant:"outline",type:"button",onClick:()=>S.mutate(a),children:"Test Endpoint"}),e.jsxs(P,{type:"submit",children:[e.jsx(Vr,{className:"mr-2 h-4 w-4"}),"Add Webhook"]})]})]})})]})}),e.jsx(Ae,{value:"api-keys",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"API Keys"}),e.jsx(te,{children:"Generate and manage API keys for external applications to authenticate with Jay's Frames API."})]}),e.jsx(q,{className:"space-y-4",children:r?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"apiKey",children:"Your API Key"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(U,{id:"apiKey",value:r.key,readOnly:!0,type:"password"}),e.jsx(P,{variant:"outline",onClick:C,children:u?e.jsx(ls,{className:"h-4 w-4"}):e.jsx(pj,{className:"h-4 w-4"})})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Created: ",new Date(r.createdAt).toLocaleString(),r.lastUsed&&` • Last used: ${new Date(r.lastUsed).toLocaleString()}`]})]}),e.jsx("div",{className:"pt-2 pb-2",children:e.jsxs("p",{className:"text-sm text-gray-500",children:[e.jsx(Ht,{className:"h-4 w-4 inline mr-1"}),"For security reasons, the API key is only shown once when generated. Store it securely."]})})]}):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500 mb-4",children:"No API key has been generated yet."})})}),e.jsx(ht,{children:e.jsx(P,{onClick:()=>k.mutate(),className:"w-full",children:r?"Regenerate API Key":"Generate New API Key"})})]})}),e.jsx(Ae,{value:"documentation",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"API Documentation"}),e.jsx(te,{children:"Reference documentation for the Jay's Frames API and webhook events."})]}),e.jsx(q,{children:b?e.jsx("div",{className:"py-4 text-center",children:"Loading documentation..."}):e.jsx(na,{className:"h-[500px] w-full rounded-md border p-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Authentication"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"All API requests require authentication using an API key in the request header."}),e.jsx("div",{className:"mt-2 p-3 bg-gray-100 rounded-md",children:e.jsx("code",{className:"text-sm",children:"Authorization: Bearer YOUR_API_KEY"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Endpoints"}),e.jsxs("div",{className:"mt-2 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Orders"}),e.jsxs("div",{className:"mt-1 space-y-2",children:[e.jsxs("div",{className:"p-2 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"font-medium",children:"GET /api/integration/orders"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Get all orders with QR codes"})]}),e.jsxs("div",{className:"p-2 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"font-medium",children:"GET /api/integration/orders/:id"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Get order information with QR code"})]}),e.jsxs("div",{className:"p-2 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"font-medium",children:"PATCH /api/integration/orders/:id/status"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Update order status from external system"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Webhooks"}),e.jsx("div",{className:"mt-1 space-y-2",children:e.jsxs("div",{className:"p-2 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"font-medium",children:"POST /api/integration/webhook"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Receive webhook notifications from external systems"})]})})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Webhook Events"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"p-2 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"font-medium",children:"order.created"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Triggered when a new order is created"})]}),e.jsxs("div",{className:"p-2 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"font-medium",children:"order.updated"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Triggered when an order is updated"})]}),e.jsxs("div",{className:"p-2 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"font-medium",children:"order.completed"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Triggered when an order is marked as completed"})]}),e.jsxs("div",{className:"p-2 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"font-medium",children:"payment.received"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Triggered when a payment is received"})]}),e.jsxs("div",{className:"p-2 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"font-medium",children:"material.ordered"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Triggered when materials are ordered"})]}),e.jsxs("div",{className:"p-2 bg-gray-100 rounded-md",children:[e.jsx("div",{className:"font-medium",children:"material.arrived"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Triggered when ordered materials arrive"})]})]})]})]})})}),e.jsx(ht,{children:e.jsx("a",{href:"https://docs.jaysframes.com/api",target:"_blank",rel:"noopener noreferrer",className:"w-full",children:e.jsxs(P,{variant:"outline",className:"w-full",children:[e.jsx(gj,{className:"mr-2 h-4 w-4"}),"View Full API Documentation"]})})})]})})]})]})}const k6=()=>{const[s,t]=p.useState(!1),r=()=>{t(!s)};return e.jsxs("div",{style:{padding:"20px",maxWidth:"600px",margin:"0 auto"},children:[e.jsx("h1",{style:{fontSize:"24px",marginBottom:"20px",color:"#333"},children:"Mat Options Test Page"}),e.jsxs("div",{style:{backgroundColor:"#f0f4ff",padding:"20px",borderRadius:"8px",border:"2px solid #3b82f6",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px"},children:"Bottom Mat Option"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",backgroundColor:"white",padding:"15px",borderRadius:"6px",border:"1px solid #ddd"},children:[e.jsx("input",{type:"checkbox",id:"bottomMatToggle",checked:s,onChange:r,style:{width:"24px",height:"24px",marginRight:"12px",cursor:"pointer"}}),e.jsxs("label",{htmlFor:"bottomMatToggle",style:{fontWeight:"bold",fontSize:"16px",cursor:"pointer",display:"flex",alignItems:"center"},children:[e.jsx(vj,{style:{marginRight:"8px"}}),"Add Bottom Mat (Double Matting)"]})]}),s&&e.jsx("div",{style:{marginTop:"15px",padding:"15px",backgroundColor:"white",borderRadius:"6px"},children:e.jsx("p",{children:"Bottom mat settings would appear here"})})]}),e.jsx("div",{children:e.jsxs("p",{children:["Status: Bottom mat is ",s?"enabled":"disabled"]})})]})},er="/api/inventory",T6=async()=>(await ce("GET",`${er}/items`)).json(),P6=async s=>(await ce("POST",`${er}/items`,s)).json(),E6=async(s,t)=>(await ce("PATCH",`${er}/items/${s}`,t)).json(),D6=async s=>{await ce("DELETE",`${er}/items/${s}`)},A6=async()=>(await ce("GET",`${er}/items/low-stock`)).json(),_6=async()=>(await ce("GET",`${er}/suppliers`)).json(),I6=async s=>(await ce("GET",`${er}/suppliers/${s}`)).json(),R6=async()=>(await ce("GET",`${er}/locations`)).json(),M6=async s=>(await ce("GET",`${er}/locations/${s}`)).json(),O6=async()=>(await ce("GET",`${er}/metrics`)).json(),F6=async(s="month")=>(await ce("GET",`${er}/activity?timeframe=${s}`)).json(),Bi="/api/inventory/items",Mk="/api/inventory/suppliers",Ok="/api/inventory/locations",L6="/api/inventory/items/low-stock",$6="/api/inventory/metrics",B6="/api/inventory/activity",Fk=()=>me({queryKey:[Bi],queryFn:T6}),V6=()=>{const s=Zt();return Ce({mutationFn:t=>P6(t),onSuccess:()=>{s.invalidateQueries({queryKey:[Bi]}),js({title:"Item created",description:"Inventory item has been successfully created."})},onError:t=>{js({title:"Error creating item",description:t.message,variant:"destructive"})}})},U6=s=>{const t=Zt();return Ce({mutationFn:r=>E6(s,r),onSuccess:()=>{t.invalidateQueries({queryKey:[Bi,s]}),t.invalidateQueries({queryKey:[Bi]}),js({title:"Item updated",description:"Inventory item has been successfully updated."})},onError:r=>{js({title:"Error updating item",description:r.message,variant:"destructive"})}})},Lk=()=>{const s=Zt();return Ce({mutationFn:t=>D6(t),onSuccess:()=>{s.invalidateQueries({queryKey:[Bi]}),js({title:"Item deleted",description:"Inventory item has been successfully deleted."})},onError:t=>{js({title:"Error deleting item",description:t.message,variant:"destructive"})}})},$k=()=>me({queryKey:[L6],queryFn:A6}),Bk=()=>me({queryKey:[Mk],queryFn:_6}),H6=s=>me({queryKey:[Mk,s],queryFn:()=>I6(s),enabled:!!s}),Vk=()=>me({queryKey:[Ok],queryFn:R6}),q6=s=>me({queryKey:[Ok,s],queryFn:()=>M6(s),enabled:!!s}),z6=()=>me({queryKey:[$6],queryFn:O6}),W6=(s="month")=>me({queryKey:[B6,s],queryFn:()=>F6(s)});var Uk="AlertDialog",[K6,hU]=fs(Uk,[rj]),Pr=rj(),Hk=s=>{const{__scopeAlertDialog:t,...r}=s,n=Pr(t);return e.jsx(du,{...n,...r,modal:!0})};Hk.displayName=Uk;var G6="AlertDialogTrigger",qk=p.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,a=Pr(r);return e.jsx(uu,{...a,...n,ref:t})});qk.displayName=G6;var Q6="AlertDialogPortal",zk=s=>{const{__scopeAlertDialog:t,...r}=s,n=Pr(t);return e.jsx(cu,{...n,...r})};zk.displayName=Q6;var Z6="AlertDialogOverlay",Wk=p.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,a=Pr(r);return e.jsx(Ui,{...a,...n,ref:t})});Wk.displayName=Z6;var ma="AlertDialogContent",[Y6,X6]=K6(ma),Kk=p.forwardRef((s,t)=>{const{__scopeAlertDialog:r,children:n,...a}=s,i=Pr(r),o=p.useRef(null),l=Ge(t,o),c=p.useRef(null);return e.jsx(g2,{contentName:ma,titleName:Gk,docsSlug:"alert-dialog",children:e.jsx(Y6,{scope:r,cancelRef:c,children:e.jsxs(Hi,{role:"alertdialog",...i,...a,ref:l,onOpenAutoFocus:ge(a.onOpenAutoFocus,d=>{var u;d.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[e.jsx(nj,{children:n}),e.jsx(e8,{contentRef:o})]})})})});Kk.displayName=ma;var Gk="AlertDialogTitle",Qk=p.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,a=Pr(r);return e.jsx(qi,{...a,...n,ref:t})});Qk.displayName=Gk;var Zk="AlertDialogDescription",Yk=p.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,a=Pr(r);return e.jsx(zi,{...a,...n,ref:t})});Yk.displayName=Zk;var J6="AlertDialogAction",Xk=p.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,a=Pr(r);return e.jsx(Da,{...a,...n,ref:t})});Xk.displayName=J6;var Jk="AlertDialogCancel",eT=p.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,{cancelRef:a}=X6(Jk,r),i=Pr(r),o=Ge(t,a);return e.jsx(Da,{...i,...n,ref:o})});eT.displayName=Jk;var e8=({contentRef:s})=>{const t=`\`${ma}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${ma}\` by passing a \`${Zk}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${ma}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var n;document.getElementById((n=s.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,s]),null},t8=Hk,s8=qk,r8=zk,tT=Wk,sT=Kk,rT=Xk,nT=eT,aT=Qk,iT=Yk;const aa=t8,ia=s8,n8=r8,oT=p.forwardRef(({className:s,...t},r)=>e.jsx(tT,{className:J("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:r}));oT.displayName=tT.displayName;const jn=p.forwardRef(({className:s,...t},r)=>e.jsxs(n8,{children:[e.jsx(oT,{}),e.jsx(sT,{ref:r,className:J("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));jn.displayName=sT.displayName;const bn=({className:s,...t})=>e.jsx("div",{className:J("flex flex-col space-y-2 text-center sm:text-left",s),...t});bn.displayName="AlertDialogHeader";const wn=({className:s,...t})=>e.jsx("div",{className:J("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});wn.displayName="AlertDialogFooter";const Nn=p.forwardRef(({className:s,...t},r)=>e.jsx(aT,{ref:r,className:J("text-lg font-semibold",s),...t}));Nn.displayName=aT.displayName;const Sn=p.forwardRef(({className:s,...t},r)=>e.jsx(iT,{ref:r,className:J("text-sm text-muted-foreground",s),...t}));Sn.displayName=iT.displayName;const Cn=p.forwardRef(({className:s,...t},r)=>e.jsx(rT,{ref:r,className:J(ju(),s),...t}));Cn.displayName=rT.displayName;const kn=p.forwardRef(({className:s,...t},r)=>e.jsx(nT,{ref:r,className:J(ju({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));kn.displayName=nT.displayName;function a8({onAdd:s,onEdit:t,onView:r}){const[n,a]=p.useState(""),[i,o]=p.useState(1),[l,c]=p.useState(10),[d,u]=p.useState("name"),[h,m]=p.useState("asc"),[x,g]=p.useState(null),{data:f=[],isLoading:v,error:y}=Fk(),j=Lk(),b=De.useMemo(()=>{const w=new Set;return f.forEach(N=>{N.categoryId&&w.add(N.categoryId.toString())}),Array.from(w)},[f]),k=De.useMemo(()=>f.filter(w=>{var F;const N=n===""||w.name.toLowerCase().includes(n.toLowerCase())||w.sku.toLowerCase().includes(n.toLowerCase())||w.description&&w.description.toLowerCase().includes(n.toLowerCase()),_=x===null||((F=w.categoryId)==null?void 0:F.toString())===x;return N&&_}),[f,n,x]),S=De.useMemo(()=>[...k].sort((w,N)=>{const _=w[d],F=N[d];return _==null?h==="asc"?-1:1:F==null?h==="asc"?1:-1:typeof _=="string"&&typeof F=="string"?h==="asc"?_.localeCompare(F):F.localeCompare(_):_<F?h==="asc"?-1:1:_>F?h==="asc"?1:-1:0}),[k,d,h]),A=Math.ceil(S.length/l),T=S.slice((i-1)*l,i*l),C=w=>{w===d?m(h==="asc"?"desc":"asc"):(u(w),m("asc"))},E=w=>{j.mutate(w)},D=()=>{a(""),g(null),u("name"),m("asc"),o(1)};return v?e.jsx("div",{className:"flex justify-center p-8",children:"Loading inventory items..."}):y?e.jsxs("div",{className:"text-destructive p-8",children:["Error loading inventory items: ",y.message]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Zr,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(U,{placeholder:"Search by name, SKU, or description...",value:n,onChange:w=>a(w.target.value),className:"pl-8"}),n&&e.jsx(P,{variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-7 w-7 p-0",onClick:()=>a(""),children:e.jsx($n,{className:"h-4 w-4"})})]}),e.jsxs(We,{value:x||"all",onValueChange:w=>g(w==="all"?null:w),children:[e.jsx(He,{className:"w-[180px]",children:e.jsx(Ke,{placeholder:"All Categories"})}),e.jsxs(qe,{children:[e.jsx(se,{value:"all",children:"All Categories"}),b.map(w=>e.jsxs(se,{value:w,children:["Category ",w]},w))]})]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:D,children:[e.jsx(lj,{className:"h-4 w-4 mr-1"}),"Reset"]})]}),e.jsxs(P,{onClick:s,children:[e.jsx(Vr,{className:"h-4 w-4 mr-1"}),"Add Item"]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{className:"w-[100px]",children:e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>C("sku"),children:["SKU",e.jsx(za,{className:"ml-1 h-4 w-4"})]})}),e.jsx(de,{children:e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>C("name"),children:["Name",e.jsx(za,{className:"ml-1 h-4 w-4"})]})}),e.jsx(de,{children:"Category"}),e.jsx(de,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end cursor-pointer",onClick:()=>C("costPerUnit"),children:["Cost",e.jsx(za,{className:"ml-1 h-4 w-4"})]})}),e.jsx(de,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end cursor-pointer",onClick:()=>C("retailPrice"),children:["Retail Price",e.jsx(za,{className:"ml-1 h-4 w-4"})]})}),e.jsx(de,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center cursor-pointer",onClick:()=>C("minimumStockLevel"),children:["Stock Level",e.jsx(za,{className:"ml-1 h-4 w-4"})]})}),e.jsx(de,{className:"text-right",children:"Actions"})]})}),e.jsx(ys,{children:T.length===0?e.jsx(tt,{children:e.jsx(ie,{colSpan:7,className:"text-center py-8",children:"No inventory items found."})}):T.map(w=>e.jsxs(tt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>r(w),children:[e.jsx(ie,{className:"font-medium",children:w.sku}),e.jsx(ie,{children:w.name}),e.jsx(ie,{children:w.categoryId||"-"}),e.jsxs(ie,{className:"text-right",children:["$",parseFloat(w.costPerUnit.toString()).toFixed(2)]}),e.jsx(ie,{className:"text-right",children:w.retailPrice?`$${parseFloat(w.retailPrice.toString()).toFixed(2)}`:"-"}),e.jsx(ie,{className:"text-center",children:e.jsx(ue,{variant:o8(w),children:i8(w)})}),e.jsx(ie,{className:"text-right",children:e.jsxs(Qn,{children:[e.jsx(Zn,{asChild:!0,onClick:N=>N.stopPropagation(),children:e.jsxs(P,{variant:"ghost",size:"sm",children:[e.jsx(W2,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Actions"})]})}),e.jsxs(pn,{align:"end",children:[e.jsx(KC,{children:"Actions"}),e.jsx(Ms,{onClick:N=>{N.stopPropagation(),r(w)},children:"View details"}),e.jsxs(Ms,{onClick:N=>{N.stopPropagation(),t(w)},children:[e.jsx(Aa,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsx(GC,{}),e.jsxs(aa,{children:[e.jsx(ia,{asChild:!0,children:e.jsxs(Ms,{className:"text-destructive focus:text-destructive",onClick:N=>N.stopPropagation(),children:[e.jsx(Sl,{className:"h-4 w-4 mr-2"}),"Delete"]})}),e.jsxs(jn,{onClick:N=>N.stopPropagation(),children:[e.jsxs(bn,{children:[e.jsx(Nn,{children:"Are you absolutely sure?"}),e.jsxs(Sn,{children:['This action cannot be undone. This will permanently delete the inventory item "',w.name,'" and remove its data from the server.']})]}),e.jsxs(wn,{children:[e.jsx(kn,{children:"Cancel"}),e.jsx(Cn,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>E(w.id),children:"Delete"})]})]})]})]})]})})]},w.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",T.length," of ",k.length," items"]}),e.jsxs(We,{value:l.toString(),onValueChange:w=>{c(parseInt(w,10)),o(1)},children:[e.jsx(He,{className:"w-[100px]",children:e.jsx(Ke,{placeholder:"10 items"})}),e.jsxs(qe,{children:[e.jsx(se,{value:"5",children:"5 items"}),e.jsx(se,{value:"10",children:"10 items"}),e.jsx(se,{value:"20",children:"20 items"}),e.jsx(se,{value:"50",children:"50 items"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>o(w=>Math.max(1,w-1)),disabled:i===1,children:[e.jsx(yj,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous page"})]}),e.jsxs("p",{className:"text-sm font-medium",children:["Page ",i," of ",A||1]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>o(w=>Math.min(A,w+1)),disabled:i===A||A===0,children:[e.jsx(kl,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next page"})]})]})]})]})}function i8(s){return`${s.minimumStockLevel.toString()}`}function o8(s){const t=parseFloat(s.minimumStockLevel.toString()),r=parseFloat(s.reorderLevel.toString());return t<=r*.5?"destructive":t<=r?"secondary":"default"}var l8=function(s,t){for(var r={};s.length;){var n=s[0],a=n.code,i=n.message,o=n.path.join(".");if(!r[o])if("unionErrors"in n){var l=n.unionErrors[0].errors[0];r[o]={message:l.message,type:l.code}}else r[o]={message:i,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(u){return u.errors.forEach(function(h){return s.push(h)})}),t){var c=r[o].types,d=c&&c[n.code];r[o]=lP(o,t,r,a,d?[].concat(d,n.message):n.message)}s.shift()}return r},lT=function(s,t,r){return r===void 0&&(r={}),function(n,a,i){try{return Promise.resolve(function(o,l){try{var c=Promise.resolve(s[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(d){return i.shouldUseNativeValidation&&iP({},i),{errors:{},values:r.raw?n:d}})}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c}(0,function(o){if(function(l){return Array.isArray(l==null?void 0:l.errors)}(o))return{values:{},errors:oP(l8(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}};const cT=dP,dT=p.createContext({}),dt=({...s})=>e.jsx(dT.Provider,{value:{name:s.name},children:e.jsx(uP,{...s})}),ic=()=>{const s=p.useContext(dT),t=p.useContext(uT),{getFieldState:r,formState:n}=cP(),a=r(s.name,n);if(!s)throw new Error("useFormField should be used within <FormField>");const{id:i}=t;return{id:i,name:s.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...a}},uT=p.createContext({}),ot=p.forwardRef(({className:s,...t},r)=>{const n=p.useId();return e.jsx(uT.Provider,{value:{id:n},children:e.jsx("div",{ref:r,className:J("space-y-2",s),...t})})});ot.displayName="FormItem";const lt=p.forwardRef(({className:s,...t},r)=>{const{error:n,formItemId:a}=ic();return e.jsx(M,{ref:r,className:J(n&&"text-destructive",s),htmlFor:a,...t})});lt.displayName="FormLabel";const ct=p.forwardRef(({...s},t)=>{const{error:r,formItemId:n,formDescriptionId:a,formMessageId:i}=ic();return e.jsx(gl,{ref:t,id:n,"aria-describedby":r?`${a} ${i}`:`${a}`,"aria-invalid":!!r,...s})});ct.displayName="FormControl";const rr=p.forwardRef(({className:s,...t},r)=>{const{formDescriptionId:n}=ic();return e.jsx("p",{ref:r,id:n,className:J("text-sm text-muted-foreground",s),...t})});rr.displayName="FormDescription";const pt=p.forwardRef(({className:s,children:t,...r},n)=>{const{error:a,formMessageId:i}=ic(),o=a?String(a==null?void 0:a.message):t;return o?e.jsx("p",{ref:n,id:i,className:J("text-sm font-medium text-destructive",s),...r,children:o}):null});pt.displayName="FormMessage";const c8=Ze.object({sku:Ze.string().min(1,"SKU is required"),name:Ze.string().min(1,"Name is required"),description:Ze.string().optional(),categoryId:Ze.number().optional().nullable(),supplierId:Ze.number().optional().nullable(),supplierSku:Ze.string().optional(),unitOfMeasure:Ze.enum(["each","inch","foot","united_inch","square_inch","sheet","roll","pound","liter","gallon"]),costPerUnit:Ze.string().min(1,"Cost per unit is required"),retailPrice:Ze.string().optional(),minimumStockLevel:Ze.string().min(1,"Minimum stock level is required"),reorderLevel:Ze.string().min(1,"Reorder level is required"),reorderQuantity:Ze.string().optional(),locationId:Ze.number().optional().nullable(),barcode:Ze.string().optional(),notes:Ze.string().optional(),tags:Ze.array(Ze.string()).optional(),isActive:Ze.boolean().default(!0),autoBatchReorder:Ze.boolean().default(!1),materialType:Ze.string().optional(),materialId:Ze.string().optional()});function d8({isOpen:s,onClose:t,onSubmit:r,editItem:n,categories:a,isSubmitting:i}){var u,h;const{data:o=[]}=Bk(),{data:l=[]}=Vk(),c=Nj({resolver:lT(c8),defaultValues:n?{...n,costPerUnit:n.costPerUnit.toString(),retailPrice:((u=n.retailPrice)==null?void 0:u.toString())||"",minimumStockLevel:n.minimumStockLevel.toString(),reorderLevel:n.reorderLevel.toString(),reorderQuantity:((h=n.reorderQuantity)==null?void 0:h.toString())||"",tags:n.tags||[]}:{sku:"",name:"",description:"",categoryId:null,supplierId:null,supplierSku:"",unitOfMeasure:"each",costPerUnit:"0",retailPrice:"",minimumStockLevel:"0",reorderLevel:"5",reorderQuantity:"10",locationId:null,barcode:"",notes:"",tags:[],isActive:!0,autoBatchReorder:!1,materialType:"",materialId:""}}),d=m=>{const x={...m,costPerUnit:parseFloat(m.costPerUnit),retailPrice:m.retailPrice?parseFloat(m.retailPrice):null,minimumStockLevel:parseFloat(m.minimumStockLevel),reorderLevel:parseFloat(m.reorderLevel),reorderQuantity:m.reorderQuantity?parseFloat(m.reorderQuantity):null};r(x)};return e.jsx(Bt,{open:s,onOpenChange:m=>!m&&t(),children:e.jsxs(Lt,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto text-foreground bg-background light-form-text",children:[e.jsxs(Vt,{children:[e.jsx(Ut,{className:"text-foreground",children:n?"Edit Inventory Item":"Add New Inventory Item"}),e.jsx(bs,{className:"text-muted-foreground",children:n?"Update the details of this inventory item.":"Fill in the details for the new inventory item."})]}),e.jsx(cT,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(d),className:"space-y-4 py-2 text-foreground form-labels",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(dt,{control:c.control,name:"sku",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"SKU*"}),e.jsx(ct,{children:e.jsx(U,{placeholder:"Enter SKU",...m})}),e.jsx(pt,{})]})}),e.jsx(dt,{control:c.control,name:"name",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Name*"}),e.jsx(ct,{children:e.jsx(U,{placeholder:"Enter name",...m})}),e.jsx(pt,{})]})})]}),e.jsx(dt,{control:c.control,name:"description",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Description"}),e.jsx(ct,{children:e.jsx(Zs,{placeholder:"Enter description",...m,value:m.value||""})}),e.jsx(pt,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(dt,{control:c.control,name:"categoryId",render:({field:m})=>{var x;return e.jsxs(ot,{children:[e.jsx(lt,{children:"Category"}),e.jsxs(We,{onValueChange:g=>m.onChange(g==="none"?null:g?parseInt(g,10):null),value:((x=m.value)==null?void 0:x.toString())||"none",children:[e.jsx(ct,{children:e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select category"})})}),e.jsxs(qe,{children:[e.jsx(se,{value:"none",children:"None"}),a.map(g=>e.jsx(se,{value:g.id.toString(),children:g.name},g.id))]})]}),e.jsx(pt,{})]})}}),e.jsx(dt,{control:c.control,name:"unitOfMeasure",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Unit of Measure*"}),e.jsxs(We,{onValueChange:m.onChange,value:m.value,children:[e.jsx(ct,{children:e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select unit"})})}),e.jsxs(qe,{children:[e.jsx(se,{value:"each",children:"Each"}),e.jsx(se,{value:"inch",children:"Inch"}),e.jsx(se,{value:"foot",children:"Foot"}),e.jsx(se,{value:"united_inch",children:"United Inch"}),e.jsx(se,{value:"square_inch",children:"Square Inch"}),e.jsx(se,{value:"sheet",children:"Sheet"}),e.jsx(se,{value:"roll",children:"Roll"}),e.jsx(se,{value:"pound",children:"Pound"}),e.jsx(se,{value:"liter",children:"Liter"}),e.jsx(se,{value:"gallon",children:"Gallon"})]})]}),e.jsx(pt,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(dt,{control:c.control,name:"supplierId",render:({field:m})=>{var x;return e.jsxs(ot,{children:[e.jsx(lt,{children:"Supplier"}),e.jsxs(We,{onValueChange:g=>m.onChange(g==="none"?null:g?parseInt(g,10):null),value:((x=m.value)==null?void 0:x.toString())||"none",children:[e.jsx(ct,{children:e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select supplier"})})}),e.jsxs(qe,{children:[e.jsx(se,{value:"none",children:"None"}),o.map(g=>e.jsx(se,{value:g.id.toString(),children:g.name},g.id))]})]}),e.jsx(pt,{})]})}}),e.jsx(dt,{control:c.control,name:"supplierSku",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Supplier SKU"}),e.jsx(ct,{children:e.jsx(U,{placeholder:"Enter supplier SKU",...m,value:m.value||""})}),e.jsx(pt,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(dt,{control:c.control,name:"costPerUnit",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Cost Per Unit*"}),e.jsx(ct,{children:e.jsx(U,{type:"number",step:"0.01",placeholder:"0.00",...m})}),e.jsx(pt,{})]})}),e.jsx(dt,{control:c.control,name:"retailPrice",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Retail Price"}),e.jsx(ct,{children:e.jsx(U,{type:"number",step:"0.01",placeholder:"0.00",...m,value:m.value||""})}),e.jsx(pt,{})]})}),e.jsx(dt,{control:c.control,name:"barcode",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Barcode"}),e.jsx(ct,{children:e.jsx(U,{placeholder:"Enter barcode",...m,value:m.value||""})}),e.jsx(pt,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(dt,{control:c.control,name:"minimumStockLevel",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Minimum Stock*"}),e.jsx(ct,{children:e.jsx(U,{type:"number",step:"1",placeholder:"0",...m})}),e.jsx(pt,{})]})}),e.jsx(dt,{control:c.control,name:"reorderLevel",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Reorder Level*"}),e.jsx(ct,{children:e.jsx(U,{type:"number",step:"1",placeholder:"5",...m})}),e.jsx(pt,{})]})}),e.jsx(dt,{control:c.control,name:"reorderQuantity",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Reorder Quantity"}),e.jsx(ct,{children:e.jsx(U,{type:"number",step:"1",placeholder:"10",...m,value:m.value||""})}),e.jsx(pt,{})]})})]}),e.jsx(dt,{control:c.control,name:"locationId",render:({field:m})=>{var x;return e.jsxs(ot,{children:[e.jsx(lt,{children:"Storage Location"}),e.jsxs(We,{onValueChange:g=>m.onChange(g==="none"?null:g?parseInt(g,10):null),value:((x=m.value)==null?void 0:x.toString())||"none",children:[e.jsx(ct,{children:e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select location"})})}),e.jsxs(qe,{children:[e.jsx(se,{value:"none",children:"None"}),l.map(g=>e.jsx(se,{value:g.id.toString(),children:g.name},g.id))]})]}),e.jsx(pt,{})]})}}),e.jsx(dt,{control:c.control,name:"notes",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Notes"}),e.jsx(ct,{children:e.jsx(Zs,{placeholder:"Enter notes",...m,value:m.value||""})}),e.jsx(pt,{})]})}),c.watch("materialType")&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(dt,{control:c.control,name:"materialType",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Material Type"}),e.jsxs(We,{onValueChange:x=>m.onChange(x==="none"?null:x),value:m.value||"none",children:[e.jsx(ct,{children:e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select material type"})})}),e.jsxs(qe,{children:[e.jsx(se,{value:"none",children:"None"}),e.jsx(se,{value:"frame",children:"Frame"}),e.jsx(se,{value:"matboard",children:"Matboard"}),e.jsx(se,{value:"glass",children:"Glass"}),e.jsx(se,{value:"backing_board",children:"Backing Board"}),e.jsx(se,{value:"hardware",children:"Hardware"}),e.jsx(se,{value:"specialty_materials",children:"Specialty Materials"})]})]}),e.jsx(pt,{})]})}),e.jsx(dt,{control:c.control,name:"materialId",render:({field:m})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Material ID"}),e.jsx(ct,{children:e.jsx(U,{placeholder:"Enter material ID",...m,value:m.value||""})}),e.jsx(pt,{})]})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(dt,{control:c.control,name:"isActive",render:({field:m})=>e.jsxs(ot,{className:"flex flex-row items-center space-x-2 space-y-0",children:[e.jsx(ct,{children:e.jsx(os,{checked:m.value,onCheckedChange:m.onChange})}),e.jsx(lt,{className:"font-normal",children:"Active"})]})}),e.jsx(dt,{control:c.control,name:"autoBatchReorder",render:({field:m})=>e.jsxs(ot,{className:"flex flex-row items-center space-x-2 space-y-0",children:[e.jsx(ct,{children:e.jsx(os,{checked:m.value,onCheckedChange:m.onChange})}),e.jsx(lt,{className:"font-normal",children:"Add to batch reorders"})]})})]}),e.jsxs(_n,{children:[e.jsx(P,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),e.jsxs(P,{type:"submit",disabled:i,children:[i&&e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),n?"Update":"Create"]})]})]})})]})})}function u8({item:s,isOpen:t,onClose:r,onEdit:n,onDelete:a}){const{data:i}=H6(s.supplierId||0),{data:o}=q6(s.locationId||0);return e.jsx(Bt,{open:t,onOpenChange:l=>!l&&r(),children:e.jsxs(Lt,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Vt,{children:[e.jsxs(Ut,{className:"flex items-center",children:[e.jsx(Qs,{className:"h-5 w-5 mr-2"}),s.name]}),e.jsx(bs,{children:"Item details and inventory information"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"SKU:"}),e.jsx("span",{className:"text-sm ml-2",children:s.sku})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Status:"}),e.jsx(ue,{className:"ml-2",variant:s.isActive?"default":"secondary",children:s.isActive?"Active":"Inactive"})]}),s.barcode&&e.jsxs("div",{className:"col-span-2 flex items-center",children:[e.jsx(K2,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Barcode:"}),e.jsx("span",{className:"text-sm ml-2",children:s.barcode})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Description:"}),e.jsx("p",{className:"text-sm mt-1",children:s.description||"No description provided."})]})]})]}),e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Pricing Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Dn,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Cost Per Unit:"}),e.jsxs("span",{className:"text-sm ml-2",children:["$",parseFloat(s.costPerUnit.toString()).toFixed(2)]})]}),s.retailPrice&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(Dn,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Retail Price:"}),e.jsxs("span",{className:"text-sm ml-2",children:["$",parseFloat(s.retailPrice.toString()).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Unit of Measure:"}),e.jsx("span",{className:"text-sm ml-2",children:m8(s.unitOfMeasure)})]}),s.retailPrice&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Margin:"}),e.jsxs("span",{className:"text-sm ml-2",children:[h8(s.costPerUnit.toString(),s.retailPrice.toString()),"%"]})]})]})]}),e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Stock Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Minimum Stock Level:"}),e.jsx("span",{className:"text-sm ml-2",children:s.minimumStockLevel.toString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Reorder Level:"}),e.jsx("span",{className:"text-sm ml-2",children:s.reorderLevel.toString()})]}),s.reorderQuantity&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Reorder Quantity:"}),e.jsx("span",{className:"text-sm ml-2",children:s.reorderQuantity.toString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Auto Batch Reorder:"}),e.jsx("span",{className:"text-sm ml-2",children:s.autoBatchReorder?"Yes":"No"})]})]})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-medium text-muted-foreground flex items-center",children:[e.jsx(Yr,{className:"h-4 w-4 mr-2"}),"Supplier Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Supplier:"}),e.jsx("span",{className:"text-sm ml-2",children:i.name})]}),s.supplierSku&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Supplier SKU:"}),e.jsx("span",{className:"text-sm ml-2",children:s.supplierSku})]}),i.email&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Email:"}),e.jsx("span",{className:"text-sm ml-2",children:i.email})]}),i.phone&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Phone:"}),e.jsx("span",{className:"text-sm ml-2",children:i.phone})]})]})]})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-medium text-muted-foreground flex items-center",children:[e.jsx(vi,{className:"h-4 w-4 mr-2"}),"Storage Location"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Location:"}),e.jsx("span",{className:"text-sm ml-2",children:o.name})]}),o.description&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Details:"}),e.jsx("span",{className:"text-sm ml-2",children:o.description})]})]})]})]}),(s.notes||s.tags&&s.tags.length>0||s.lastCountDate)&&e.jsxs(e.Fragment,{children:[e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Additional Information"}),e.jsxs("div",{className:"space-y-2",children:[s.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Notes:"}),e.jsx("p",{className:"text-sm mt-1",children:s.notes})]}),s.tags&&Array.isArray(s.tags)&&s.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(G2,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Tags:"}),s.tags.map((l,c)=>e.jsx(ue,{variant:"outline",children:l},c))]}),s.lastCountDate&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(mj,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Last Counted:"}),e.jsx("span",{className:"text-sm ml-2",children:new Date(s.lastCountDate).toLocaleDateString()})]})]})]})]})]}),e.jsxs(_n,{className:"flex justify-between sm:justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{onClick:n,variant:"outline",size:"sm",children:[e.jsx(Aa,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(aa,{children:[e.jsx(ia,{asChild:!0,children:e.jsxs(P,{variant:"destructive",size:"sm",children:[e.jsx(Sl,{className:"h-4 w-4 mr-1"}),"Delete"]})}),e.jsxs(jn,{children:[e.jsxs(bn,{children:[e.jsx(Nn,{children:"Are you absolutely sure?"}),e.jsxs(Sn,{children:['This action cannot be undone. This will permanently delete the inventory item "',s.name,'" and remove its data from the server.']})]}),e.jsxs(wn,{children:[e.jsx(kn,{children:"Cancel"}),e.jsx(Cn,{className:"bg-destructive hover:bg-destructive/90",onClick:a,children:"Delete"})]})]})]})]}),e.jsx(P,{onClick:r,variant:"secondary",children:"Close"})]})]})})}function m8(s){return{each:"Each",inch:"Inch",foot:"Foot",united_inch:"United Inch",square_inch:"Square Inch",sheet:"Sheet",roll:"Roll",pound:"Pound",liter:"Liter",gallon:"Gallon"}[s]||s}function h8(s,t){const r=parseFloat(s),n=parseFloat(t);return!r||!n||r===0?"0":((n-r)/n*100).toFixed(2)}const wo=["#00ADB5","#3A55D9","#FF5722","#7C4DFF","#4CAF50","#FFC107"],p8=()=>{var m,x,g;const[s,t]=p.useState("month"),{data:r,isLoading:n}=z6(),{data:a,isLoading:i}=$k(),{data:o,isLoading:l}=W6(s),c=r!=null&&r.totalValue&&(r!=null&&r.averageDailyUsage)?Math.round(r.totalValue/(r.averageDailyUsage||1)):0,d=((m=r==null?void 0:r.categoryDistribution)==null?void 0:m.map(f=>({name:f.name,value:f.itemCount})))||[],u=((x=r==null?void 0:r.locationValues)==null?void 0:x.map(f=>({name:f.name,value:f.totalValue})))||[],h=((g=o==null?void 0:o.dailyActivity)==null?void 0:g.map(f=>({date:f.date,received:f.received,consumed:f.consumed,net:f.received-f.consumed})))||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Items"}),n?e.jsx(Us,{className:"h-9 w-20 mt-1"}):e.jsx("h3",{className:"text-3xl font-bold",children:(r==null?void 0:r.totalItems)||0})]}),e.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:e.jsx(Q2,{className:"h-6 w-6 text-primary"})})]})})}),e.jsx(V,{children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Inventory Value"}),n?e.jsx(Us,{className:"h-9 w-24 mt-1"}):e.jsx("h3",{className:"text-3xl font-bold",children:An((r==null?void 0:r.totalValue)||0)})]}),e.jsx("div",{className:"p-2 bg-secondary/10 rounded-full",children:e.jsx(Dn,{className:"h-6 w-6 text-secondary"})})]})})}),e.jsx(V,{children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Days of Inventory"}),n?e.jsx(Us,{className:"h-9 w-16 mt-1"}):e.jsx("h3",{className:"text-3xl font-bold",children:c})]}),e.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:e.jsx(Ur,{className:"h-6 w-6 text-primary"})})]})})}),e.jsx(V,{children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Low Stock Items"}),i?e.jsx(Us,{className:"h-9 w-16 mt-1"}):e.jsx("h3",{className:"text-3xl font-bold",children:(a==null?void 0:a.length)||0})]}),e.jsx("div",{className:"p-2 bg-destructive/10 rounded-full",children:e.jsx(At,{className:"h-6 w-6 text-destructive"})})]})})})]}),e.jsxs(V,{children:[e.jsx(G,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(Q,{children:"Inventory Activity"}),e.jsx(te,{children:"Tracking receiving and consumption over time"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(P,{variant:s==="week"?"default":"outline",size:"sm",onClick:()=>t("week"),children:"Week"}),e.jsx(P,{variant:s==="month"?"default":"outline",size:"sm",onClick:()=>t("month"),children:"Month"}),e.jsx(P,{variant:s==="quarter"?"default":"outline",size:"sm",onClick:()=>t("quarter"),children:"Quarter"})]})]})}),e.jsx(q,{children:l?e.jsx(Us,{className:"h-80 w-full"}):e.jsx(Ir,{width:"100%",height:320,children:e.jsxs(bj,{data:h,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(oi,{dataKey:"date"}),e.jsx(Yn,{}),e.jsx(Rr,{}),e.jsx(wj,{}),e.jsx(li,{type:"monotone",dataKey:"received",stroke:"#00ADB5",name:"Received",strokeWidth:2}),e.jsx(li,{type:"monotone",dataKey:"consumed",stroke:"#FF5722",name:"Consumed",strokeWidth:2}),e.jsx(li,{type:"monotone",dataKey:"net",stroke:"#3A55D9",name:"Net Change",strokeWidth:2})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Category Distribution"}),e.jsx(te,{children:"Breakdown of inventory items by category"})]}),e.jsx(q,{children:n?e.jsx(Us,{className:"h-64 w-full"}):e.jsx(Ir,{width:"100%",height:300,children:e.jsxs(ed,{children:[e.jsx(td,{data:d,cx:"50%",cy:"50%",labelLine:!0,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:f,percent:v})=>`${f}: ${(v*100).toFixed(0)}%`,children:d.map((f,v)=>e.jsx(Vo,{fill:wo[v%wo.length]},`cell-${v}`))}),e.jsx(Rr,{formatter:f=>[`${f} items`,"Count"]})]})})})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Value by Location"}),e.jsx(te,{children:"Distribution of inventory value across locations"})]}),e.jsx(q,{children:n?e.jsx(Us,{className:"h-64 w-full"}):e.jsx(Ir,{width:"100%",height:300,children:e.jsxs(Xc,{data:u,children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(oi,{dataKey:"name"}),e.jsx(Yn,{tickFormatter:f=>`$${f}`}),e.jsx(Rr,{formatter:f=>[`$${f}`,"Value"]}),e.jsx(Jc,{dataKey:"value",fill:"#3A55D9",children:u.map((f,v)=>e.jsx(Vo,{fill:wo[v%wo.length]},`cell-${v}`))})]})})})]})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Low Stock Items"}),e.jsx(te,{children:"Items that need reordering soon"})]}),e.jsxs(q,{children:[i?e.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((f,v)=>e.jsx(Us,{className:"h-12 w-full"},v))}):(a==null?void 0:a.length)===0?e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(No,{className:"h-12 w-12 mx-auto mb-2"}),e.jsx("p",{children:"All items have adequate stock levels"})]}):e.jsx("div",{className:"rounded-md border",children:e.jsxs("table",{className:"min-w-full divide-y divide-border",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted/50",children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Current Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Minimum Level"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Reorder Level"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Status"})]})}),e.jsx("tbody",{className:"bg-popover divide-y divide-border",children:a==null?void 0:a.slice(0,5).map(f=>e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:f.name}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[f.currentQuantity," ",f.unitOfMeasure]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:f.minimumStockLevel}),e.jsx("td",{className:"px-4 py-3 text-sm",children:f.reorderLevel}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx(ue,{variant:f.currentQuantity<=f.minimumStockLevel?"destructive":f.currentQuantity<=f.reorderLevel?"secondary":"outline",children:f.currentQuantity<=f.minimumStockLevel?"Critical":f.currentQuantity<=f.reorderLevel?"Reorder Now":"Adequate"})})]},f.id))})]})}),a&&a.length>5&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs(P,{variant:"link",children:["View all ",a.length," low stock items"]})})]})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Procurement Status"}),e.jsx(te,{children:"Status of recent and pending purchase orders"})]}),e.jsx(q,{children:e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(Yr,{className:"h-12 w-12 mx-auto mb-2"}),e.jsx("p",{children:"Purchase order data will be displayed here"})]})})]})]})};function f8(){const[s,t]=p.useState(!1),[r,n]=p.useState(!1),[a,i]=p.useState(null),[o,l]=p.useState("inventory");Fk();const{data:c,isLoading:d}=$k(),{data:u,isLoading:h}=Bk(),{data:m,isLoading:x}=Vk(),g=Array.isArray(c)?c:[],f=Array.isArray(u)?u:[],v=Array.isArray(m)?m:[],y=V6(),j=U6((a==null?void 0:a.id)||0),b=Lk(),{toast:k}=Be(),S=()=>{i(null),t(!0)},A=N=>{i(N),t(!0)},T=N=>{i(N),n(!0)},C=()=>{t(!1)},E=()=>{n(!1)},D=N=>{a?j.mutate(N,{onSuccess:()=>{t(!1),i(null),k({title:"Item updated",description:"The inventory item has been successfully updated."})}}):y.mutate(N,{onSuccess:()=>{t(!1),k({title:"Item created",description:"The inventory item has been successfully created."})}})},w=()=>{a&&b.mutate(a.id,{onSuccess:()=>{n(!1),i(null),k({title:"Item deleted",description:"The inventory item has been permanently deleted."})}})};return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Inventory Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your inventory items, suppliers, and locations"})]}),e.jsxs(P,{onClick:S,children:[e.jsx(Vr,{className:"h-4 w-4 mr-2"}),"Add New Item"]})]}),e.jsxs(qt,{value:o,onValueChange:l,children:[e.jsxs($t,{className:"mb-4",children:[e.jsxs(ve,{value:"dashboard",className:"flex items-center",children:[e.jsx(hu,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),e.jsxs(ve,{value:"inventory",className:"flex items-center",children:[e.jsx(Qs,{className:"h-4 w-4 mr-2"}),"Inventory Items"]}),e.jsxs(ve,{value:"low-stock",className:"flex items-center",children:[e.jsx(Ht,{className:"h-4 w-4 mr-2"}),"Low Stock (",g.length,")"]}),e.jsxs(ve,{value:"suppliers",className:"flex items-center",children:[e.jsx(Yr,{className:"h-4 w-4 mr-2"}),"Suppliers (",f.length,")"]}),e.jsxs(ve,{value:"locations",className:"flex items-center",children:[e.jsx(vi,{className:"h-4 w-4 mr-2"}),"Storage Locations (",v.length,")"]})]}),e.jsx(Ae,{value:"dashboard",children:e.jsx(p8,{})}),e.jsx(Ae,{value:"inventory",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Inventory Items"}),e.jsx(te,{children:"View and manage all inventory items in your database"})]}),e.jsx(q,{children:e.jsx(a8,{onAdd:S,onEdit:A,onView:T})})]})}),e.jsx(Ae,{value:"low-stock",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Low Stock Items"}),e.jsx(te,{children:"Items that are at or below their reorder level"})]}),e.jsx(q,{children:d?e.jsx("div",{className:"flex justify-center p-8",children:"Loading low stock items..."}):g.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No items are currently at or below their reorder level."}):e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2",children:"SKU"}),e.jsx("th",{className:"text-left py-2",children:"Name"}),e.jsx("th",{className:"text-right py-2",children:"Current Stock"}),e.jsx("th",{className:"text-right py-2",children:"Reorder Level"}),e.jsx("th",{className:"text-right py-2",children:"Reorder Quantity"}),e.jsx("th",{className:"text-right py-2",children:"Actions"})]})}),e.jsx("tbody",{children:g.map(N=>{var _;return e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-2",children:N.sku}),e.jsx("td",{className:"py-2",children:N.name}),e.jsx("td",{className:"text-right py-2",children:N.minimumStockLevel.toString()}),e.jsx("td",{className:"text-right py-2",children:N.reorderLevel.toString()}),e.jsx("td",{className:"text-right py-2",children:((_=N.reorderQuantity)==null?void 0:_.toString())||"-"}),e.jsx("td",{className:"text-right py-2",children:e.jsx(P,{variant:"outline",size:"sm",onClick:()=>T(N),children:"View"})})]},N.id)})})]})})]})}),e.jsx(Ae,{value:"suppliers",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Suppliers"}),e.jsx(te,{children:"View and manage your suppliers"})]}),e.jsx(q,{children:h?e.jsx("div",{className:"flex justify-center p-8",children:"Loading suppliers..."}):f.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No suppliers found. Add suppliers to track inventory from different vendors."}):e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2",children:"Name"}),e.jsx("th",{className:"text-left py-2",children:"Contact Person"}),e.jsx("th",{className:"text-left py-2",children:"Email"}),e.jsx("th",{className:"text-left py-2",children:"Phone"}),e.jsx("th",{className:"text-right py-2",children:"Actions"})]})}),e.jsx("tbody",{children:f.map(N=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-2",children:N.name}),e.jsx("td",{className:"py-2",children:N.contactName||"-"}),e.jsx("td",{className:"py-2",children:N.email||"-"}),e.jsx("td",{className:"py-2",children:N.phone||"-"}),e.jsx("td",{className:"text-right py-2",children:e.jsx(P,{variant:"outline",size:"sm",children:"View"})})]},N.id))})]})})]})}),e.jsx(Ae,{value:"locations",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Storage Locations"}),e.jsx(te,{children:"Manage storage locations in your facility"})]}),e.jsx(q,{children:x?e.jsx("div",{className:"flex justify-center p-8",children:"Loading storage locations..."}):v.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No storage locations found. Define locations to better organize your inventory."}):e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2",children:"Name"}),e.jsx("th",{className:"text-left py-2",children:"Type"}),e.jsx("th",{className:"text-left py-2",children:"Description"}),e.jsx("th",{className:"text-center py-2",children:"Status"}),e.jsx("th",{className:"text-right py-2",children:"Actions"})]})}),e.jsx("tbody",{children:v.map(N=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-2",children:N.name}),e.jsx("td",{className:"py-2",children:N.type||"-"}),e.jsx("td",{className:"py-2",children:N.description||"-"}),e.jsx("td",{className:"text-center py-2",children:e.jsx("span",{className:`inline-block h-2 w-2 rounded-full ${N.active?"bg-green-500":"bg-gray-300"}`})}),e.jsx("td",{className:"text-right py-2",children:e.jsx(P,{variant:"outline",size:"sm",children:"View"})})]},N.id))})]})})]})})]}),s&&e.jsx(d8,{isOpen:s,onClose:C,onSubmit:D,editItem:a||void 0,categories:[],isSubmitting:y.isPending||j.isPending}),r&&a&&e.jsx(u8,{item:a,isOpen:r,onClose:E,onEdit:()=>{n(!1),t(!0)},onDelete:w})]})}function Kf({type:s="inventory_location",entityId:t="",title:r="",description:n="",onGenerate:a,className:i}){const[o,l]=p.useState(""),[c,d]=p.useState(r),[u,h]=p.useState(n),[m,x]=p.useState(s),[g,f]=p.useState(t),[v,y]=p.useState(!1),[j,b]=p.useState(!1),[k,S]=p.useState(null),{toast:A}=Be(),T=async()=>{if(!c.trim()){A({title:"Error",description:"Please enter a title for the QR code",variant:"destructive"});return}if(!g.trim()){A({title:"Error",description:"Please enter an entity ID",variant:"destructive"});return}try{y(!0);const D=await ce("POST","/api/qr-codes",{type:m,entityId:g,title:c,description:u});if(!D.ok)throw new Error("Failed to generate QR code");const w=await D.json();S(w),l(w.code),b(!0),a&&a(w),A({title:"QR Code Generated",description:`QR code for "${c}" has been created successfully.`})}catch(D){console.error("Error generating QR code:",D),A({title:"Error",description:`Failed to generate QR code: ${D.message}`,variant:"destructive"})}finally{y(!1)}},C=()=>{const D=document.getElementById("qr-code-svg");if(D){const w=new XMLSerializer().serializeToString(D),N=new Blob([w],{type:"image/svg+xml;charset=utf-8"}),_=URL.createObjectURL(N),F=document.createElement("a");F.href=_,F.download=`qrcode-${m}-${g}.svg`,document.body.appendChild(F),F.click(),document.body.removeChild(F)}},E=()=>{const D=window.open("","_blank");if(D){const w=document.getElementById("qr-code-svg");if(w){const N=new XMLSerializer().serializeToString(w);D.document.write(`
          <!DOCTYPE html>
          <html>
            <head>
              <title>QR Code: ${c}</title>
              <style>
                body {
                  font-family: Arial, sans-serif;
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  justify-content: center;
                  padding: 20px;
                }
                .container {
                  max-width: 400px;
                  text-align: center;
                }
                .qr-code {
                  margin: 20px 0;
                }
                .title {
                  font-size: 18px;
                  font-weight: bold;
                  margin-bottom: 8px;
                }
                .code {
                  font-family: monospace;
                  margin-bottom: 10px;
                }
                .description {
                  color: #555;
                  margin-bottom: 10px;
                }
                .type {
                  font-size: 12px;
                  color: #777;
                }
                @media print {
                  body {
                    margin: 0;
                    padding: 0;
                  }
                  button {
                    display: none;
                  }
                }
              </style>
            </head>
            <body>
              <div class="container">
                <div class="title">${c}</div>
                <div class="code">${o}</div>
                <div class="qr-code">${N}</div>
                <div class="description">${u}</div>
                <div class="type">Type: ${m}</div>
                <button onclick="window.print();return false;">Print</button>
              </div>
              <script>
                // Auto-print
                setTimeout(() => {
                  window.print();
                }, 500);
              <\/script>
            </body>
          </html>
        `),D.document.close()}}};return e.jsxs(V,{className:i,children:[e.jsx(G,{children:e.jsx(Q,{children:"QR Code Generator"})}),e.jsx(q,{children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(M,{htmlFor:"qr-type",children:"QR Code Type"}),e.jsxs(We,{value:m,onValueChange:D=>x(D),children:[e.jsx(He,{id:"qr-type",children:e.jsx(Ke,{placeholder:"Select type"})}),e.jsx(qe,{children:GF.map(D=>e.jsx(se,{value:D,children:D.replace("_"," ").replace(/\b\w/g,w=>w.toUpperCase())},D))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(M,{htmlFor:"qr-entity-id",children:"Entity ID"}),e.jsx(U,{id:"qr-entity-id",placeholder:"Enter entity ID",value:g,onChange:D=>f(D.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(M,{htmlFor:"qr-title",children:"Title"}),e.jsx(U,{id:"qr-title",placeholder:"Enter QR code title",value:c,onChange:D=>d(D.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(M,{htmlFor:"qr-description",children:"Description (Optional)"}),e.jsx(U,{id:"qr-description",placeholder:"Enter description",value:u,onChange:D=>h(D.target.value)})]}),j&&o&&e.jsxs("div",{className:"flex flex-col items-center mt-4",children:[e.jsx("div",{id:"qr-code-container",className:"bg-white p-4 rounded-md",children:e.jsx(Du,{id:"qr-code-svg",value:o,size:200,level:"H"})}),e.jsx("div",{className:"text-center mt-2 font-mono text-sm",children:o})]})]})}),e.jsxs(ht,{className:"flex justify-between",children:[e.jsx(P,{variant:"outline",onClick:()=>b(!1),disabled:!j||v,children:"Reset"}),j?e.jsxs("div",{className:"space-x-2",children:[e.jsx(P,{variant:"outline",onClick:E,disabled:v,children:"Print"}),e.jsx(P,{variant:"secondary",onClick:C,disabled:v,children:"Download"})]}):e.jsx(P,{onClick:T,disabled:v,children:v?"Generating...":"Generate QR Code"})]})]})}function x8({onScan:s,className:t}){const[r,n]=p.useState(!1),[a,i]=p.useState(null),o=p.useRef(null),l=p.useRef(null),{toast:c}=Be(),[d,u]=p.useState(!1),[h,m]=p.useState(null),[x,g]=p.useState(null);p.useEffect(()=>()=>{a&&a.getTracks().forEach(S=>S.stop())},[a]);const f=async()=>{try{const S=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}}});i(S),n(!0),o.current&&(o.current.srcObject=S,o.current.play()),y()}catch(S){console.error("Error accessing camera:",S),c({title:"Camera Error",description:"Could not access your camera. Please check permissions.",variant:"destructive"})}},v=()=>{n(!1),a&&(a.getTracks().forEach(S=>S.stop()),i(null))},y=()=>{if(!r||!o.current||!l.current)return;const S=l.current,A=o.current;if(A.readyState===A.HAVE_ENOUGH_DATA){S.width=A.videoWidth,S.height=A.videoHeight;const T=S.getContext("2d");T&&T.drawImage(A,0,0,S.width,S.height)}r&&requestAnimationFrame(y)},j=()=>{if(!l.current)return;l.current.toDataURL("image/jpeg");const A=prompt("Scanning functionality requires a QR code reader library. For now, please enter the QR code manually:");A&&k(A)},b=S=>{if(!S.target.files||S.target.files.length===0)return;const A=S.target.files[0],T=new FileReader;T.onload=C=>{if(!C.target)return;const E=prompt("Enter the QR code from the uploaded image:");E&&k(E)},T.readAsDataURL(A)},k=async S=>{try{m(S),u(!0);const A=await ce("GET",`/api/qr-codes/${encodeURIComponent(S)}`);if(!A.ok)throw new Error("QR code not found or invalid");let T;const C=A.headers.get("content-type");if(C&&C.includes("application/json"))T=await A.json();else{const E=await A.text();throw new Error("Invalid response format. Expected JSON but got: "+(E.substring(0,50)+(E.length>50?"...":"")))}g(T),await ce("POST","/api/qr-codes/scan",{qrCodeId:T.id,location:"POS System"}),s&&s(T),c({title:"QR Code Scanned",description:`Successfully scanned: ${T.title}`})}catch(A){console.error("Error processing QR code:",A),c({title:"Error",description:`Failed to process QR code: ${A.message}`,variant:"destructive"})}finally{u(!1)}};return e.jsxs(V,{className:t,children:[e.jsx(G,{children:e.jsx(Q,{children:"QR Code Scanner"})}),e.jsx(q,{children:e.jsxs("div",{className:"grid gap-4",children:[r?e.jsxs("div",{className:"relative",children:[e.jsx("video",{ref:o,style:{width:"100%",borderRadius:"8px"},autoPlay:!0,playsInline:!0,muted:!0}),e.jsx("canvas",{ref:l,style:{display:"none"}}),e.jsx("div",{className:"absolute inset-0 pointer-events-none border-2 border-dashed border-primary rounded-lg"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-10 border-2 border-dashed border-border rounded-lg",children:[e.jsx("p",{className:"mb-4 text-center text-sm text-muted-foreground",children:"Start the camera to scan a QR code, or upload an image containing a QR code."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>{var S;return(S=document.getElementById("qr-file-input"))==null?void 0:S.click()},children:"Upload Image"}),e.jsx("input",{id:"qr-file-input",type:"file",accept:"image/*",className:"hidden",onChange:b})]})]}),d&&e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"})}),x&&!d&&e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:x.title}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",x.type.replace("_"," ").replace(/\b\w/g,S=>S.toUpperCase())]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Code:"})," ",x.code]}),x.description&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Description:"})," ",x.description]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Scan Count:"})," ",x.scanCount]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Last Scanned:"})," ",x.lastScanned?new Date(x.lastScanned).toLocaleString():"Never"]})]})]})]})}),e.jsx(ht,{className:"flex justify-between",children:r?e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx(P,{variant:"outline",className:"flex-1",onClick:v,children:"Stop Camera"}),e.jsx(P,{className:"flex-1",onClick:j,children:"Capture & Analyze"})]}):e.jsx(P,{className:"w-full",onClick:f,disabled:d,children:"Start Camera"})})]})}const g8=()=>{const[s,t]=p.useState("locations"),[r,n]=p.useState(""),[a,i]=p.useState("all"),[o,l]=p.useState("all"),[c,d]=p.useState(!1),[u,h]=p.useState(null),{toast:m}=Be(),x=Zt(),{data:g,isLoading:f,error:v}=me({queryKey:["/api/inventory/locations"],queryFn:_({endpoint:"/api/inventory/locations"})}),{data:y,isLoading:j,error:b}=me({queryKey:["/api/inventory/items"],queryFn:_({endpoint:"/api/inventory/items"})}),{data:k,isLoading:S,error:A}=me({queryKey:["/api/inventory/suppliers"],queryFn:_({endpoint:"/api/inventory/suppliers"})}),{data:T,isLoading:C,error:E}=me({queryKey:["/api/inventory/items/low-stock"],queryFn:_({endpoint:"/api/inventory/items/low-stock"})}),{data:D,isLoading:w,error:N}=me({queryKey:["qrCodes"],queryFn:_({endpoint:"/api/qr-codes"}),retry:2,retryDelay:1e3,onError:O=>{console.error("Error fetching QR codes:",O)}});function _({endpoint:O}){return async()=>{try{const ne=await ce("GET",O);if(!ne.ok){let Pe;try{Pe=(await ne.json()).message||`Error fetching data from ${O}: ${ne.status} ${ne.statusText}`}catch{Pe=`Error fetching data from ${O}: ${ne.status} ${ne.statusText}`}throw new Error(Pe)}return await ne.json()}catch(ne){return console.error(`Error loading data from ${O}:`,ne),m({title:"Error loading data",description:ne.message||"Unknown error occurred",variant:"destructive"}),[]}}}Ce({mutationFn:async O=>{const ne=await ce("POST","/api/inventory/locations",O);if(!ne.ok){const Pe=await ne.json();throw new Error(Pe.message||"Failed to create location")}return await ne.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["/api/inventory/locations"]}),m({title:"Location Created",description:"New inventory location has been created successfully."})},onError:O=>{m({title:"Error",description:O.message,variant:"destructive"})}}),Ce({mutationFn:async O=>{const ne=await ce("POST","/api/qr-codes",O);if(!ne.ok){const Pe=await ne.json();throw new Error(Pe.message||"Failed to create QR code")}return await ne.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["/api/qr-codes"]}),m({title:"QR Code Created",description:"New QR code has been generated successfully."}),d(!1)},onError:O=>{m({title:"Error",description:O.message,variant:"destructive"})}});const F=async O=>{if(!(!O||!O.code))try{const ne=O.type,Pe=O.entityId;ne==="inventory_location"&&m({title:"Location Found",description:`Scanned location: ${O.title}`})}catch(ne){console.error("Error processing scanned QR code:",ne),m({title:"Error",description:"Could not process the scanned QR code",variant:"destructive"})}},W=(O,ne)=>{h({entity:O,type:ne,title:O.name||`${ne} #${O.id}`,entityId:O.id.toString()}),d(!0)},Z=()=>{let O=[];switch(s){case"locations":O=g||[];break;case"inventory":O=y||[];break;case"suppliers":O=k||[];break;case"qrcodes":O=D||[];break;default:O=[]}if(r.trim()){const ne=r.toLowerCase();O=O.filter(Pe=>Object.values(Pe).map(rt=>rt?String(rt).toLowerCase():"").some(rt=>rt.includes(ne)))}return O},$=f||j||S||w,ae=v||b||A||N;return $?e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"})}):ae?e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[e.jsx("p",{className:"font-bold",children:"Error loading data"}),e.jsx("p",{children:ae.message})]})}):e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Inventory Tracking System"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage inventory locations, items, suppliers, and QR code tracking"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Bt,{children:[e.jsx(va,{asChild:!0,children:e.jsxs(P,{variant:"outline",children:[e.jsx(qs,{className:"h-4 w-4 mr-2"}),"Generate QR Code"]})}),e.jsxs(Lt,{className:"sm:max-w-[425px]",children:[e.jsxs(Vt,{children:[e.jsx(Ut,{children:"Generate QR Code"}),e.jsx(bs,{children:"Create a new QR code for inventory tracking."})]}),e.jsx(Kf,{})]})]}),e.jsxs(Bt,{children:[e.jsx(va,{asChild:!0,children:e.jsxs(P,{children:[e.jsx(qs,{className:"h-4 w-4 mr-2"}),"Scan QR Code"]})}),e.jsxs(Lt,{className:"sm:max-w-[425px]",children:[e.jsxs(Vt,{children:[e.jsx(Ut,{children:"Scan QR Code"}),e.jsx(bs,{children:"Scan a QR code to look up inventory items or locations."})]}),e.jsx(x8,{onScan:F})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(V,{children:[e.jsx(G,{className:"pb-2",children:e.jsx(Q,{children:"Inventory Locations"})}),e.jsx(q,{children:e.jsx("div",{className:"text-2xl font-bold",children:(g==null?void 0:g.length)||0})})]}),e.jsxs(V,{children:[e.jsx(G,{className:"pb-2",children:e.jsx(Q,{children:"Inventory Items"})}),e.jsx(q,{children:e.jsx("div",{className:"text-2xl font-bold",children:(y==null?void 0:y.length)||0})})]}),e.jsxs(V,{children:[e.jsx(G,{className:"pb-2",children:e.jsx(Q,{children:"Low Stock Items"})}),e.jsx(q,{children:e.jsx("div",{className:"text-2xl font-bold",children:(T==null?void 0:T.length)||0})})]}),e.jsxs(V,{children:[e.jsx(G,{className:"pb-2",children:e.jsx(Q,{children:"QR Codes"})}),e.jsx(q,{children:e.jsx("div",{className:"text-2xl font-bold",children:(D==null?void 0:D.length)||0})})]})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Inventory Management"}),e.jsx(te,{children:"Manage your inventory locations, items, suppliers, and QR codes"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mt-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Zr,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(U,{placeholder:"Search...",className:"pl-8",value:r,onChange:O=>n(O.target.value)})]}),s==="locations"&&e.jsxs(We,{value:a,onValueChange:i,children:[e.jsx(He,{className:"w-[180px]",children:e.jsx(Ke,{placeholder:"Filter by type"})}),e.jsxs(qe,{children:[e.jsx(se,{value:"all",children:"All Locations"}),e.jsx(se,{value:"storage",children:"Storage"}),e.jsx(se,{value:"display",children:"Display"}),e.jsx(se,{value:"production",children:"Production"})]})]}),s==="qrcodes"&&e.jsxs(We,{value:o,onValueChange:l,children:[e.jsx(He,{className:"w-[180px]",children:e.jsx(Ke,{placeholder:"Filter by type"})}),e.jsxs(qe,{children:[e.jsx(se,{value:"all",children:"All Types"}),e.jsx(se,{value:"inventory_location",children:"Locations"}),e.jsx(se,{value:"inventory_item",children:"Items"}),e.jsx(se,{value:"material_order",children:"Orders"}),e.jsx(se,{value:"customer_order",children:"Customer Orders"})]})]})]})]}),e.jsx(q,{children:e.jsxs(qt,{defaultValue:"locations",value:s,onValueChange:t,children:[e.jsxs($t,{className:"mb-4",children:[e.jsx(ve,{value:"locations",children:"Locations"}),e.jsx(ve,{value:"inventory",children:"Inventory"}),e.jsx(ve,{value:"suppliers",children:"Suppliers"}),e.jsx(ve,{value:"qrcodes",children:"QR Codes"})]}),e.jsx(Ae,{value:"locations",children:e.jsx(na,{className:"h-[500px]",children:e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{children:"Name"}),e.jsx(de,{children:"Type"}),e.jsx(de,{children:"Description"}),e.jsx(de,{children:"QR Code"}),e.jsx(de,{children:"Actions"})]})}),e.jsx(ys,{children:Z().length>0?Z().map(O=>e.jsxs(tt,{children:[e.jsx(ie,{className:"font-medium",children:O.name}),e.jsx(ie,{children:O.type}),e.jsx(ie,{children:O.description}),e.jsx(ie,{children:O.qrCodeId?e.jsxs(ue,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(qs,{className:"h-3 w-3"}),"Assigned"]}):e.jsx(ue,{variant:"outline",className:"bg-muted",children:"None"})}),e.jsx(ie,{children:e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>W(O,"inventory_location"),children:[e.jsx(qs,{className:"h-3 w-3 mr-1"}),"Generate QR"]})})]},O.id)):e.jsx(tt,{children:e.jsx(ie,{colSpan:5,className:"text-center py-4 text-muted-foreground",children:"No locations found."})})})]})})}),e.jsx(Ae,{value:"inventory",children:e.jsx(na,{className:"h-[500px]",children:e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{children:"Name"}),e.jsx(de,{children:"SKU"}),e.jsx(de,{children:"Category"}),e.jsx(de,{children:"Quantity"}),e.jsx(de,{children:"Location"}),e.jsx(de,{children:"QR Code"}),e.jsx(de,{children:"Actions"})]})}),e.jsx(ys,{children:Z().length>0?Z().map(O=>e.jsxs(tt,{children:[e.jsx(ie,{className:"font-medium",children:O.name}),e.jsx(ie,{children:O.sku}),e.jsx(ie,{children:O.categoryName}),e.jsxs(ie,{children:[O.currentStock," ",O.unitOfMeasure,O.currentStock<=O.reorderPoint&&e.jsx(ue,{variant:"destructive",className:"ml-2",children:"Low Stock"})]}),e.jsx(ie,{children:O.locationName}),e.jsx(ie,{children:O.qrCodeId?e.jsxs(ue,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(qs,{className:"h-3 w-3"}),"Assigned"]}):e.jsx(ue,{variant:"outline",className:"bg-muted",children:"None"})}),e.jsx(ie,{children:e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>W(O,"inventory_item"),children:[e.jsx(qs,{className:"h-3 w-3 mr-1"}),"Generate QR"]})})]},O.id)):e.jsx(tt,{children:e.jsx(ie,{colSpan:7,className:"text-center py-4 text-muted-foreground",children:"No inventory items found."})})})]})})}),e.jsx(Ae,{value:"suppliers",children:e.jsx(na,{className:"h-[500px]",children:e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{children:"Name"}),e.jsx(de,{children:"Contact"}),e.jsx(de,{children:"Email"}),e.jsx(de,{children:"Phone"}),e.jsx(de,{children:"Status"}),e.jsx(de,{children:"Last Order"}),e.jsx(de,{children:"Actions"})]})}),e.jsx(ys,{children:Z().length>0?Z().map(O=>e.jsxs(tt,{children:[e.jsx(ie,{className:"font-medium",children:O.name}),e.jsx(ie,{children:O.contactName}),e.jsx(ie,{children:O.email}),e.jsx(ie,{children:O.phone}),e.jsx(ie,{children:e.jsx(ue,{variant:O.active?"success":"secondary",children:O.active?"Active":"Inactive"})}),e.jsx(ie,{children:O.lastOrderDate?dr(new Date(O.lastOrderDate),"MMM d, yyyy"):"Never"}),e.jsx(ie,{children:e.jsx(P,{variant:"outline",size:"sm",children:"View Details"})})]},O.id)):e.jsx(tt,{children:e.jsx(ie,{colSpan:7,className:"text-center py-4 text-muted-foreground",children:"No suppliers found."})})})]})})}),e.jsx(Ae,{value:"qrcodes",children:e.jsx(na,{className:"h-[500px]",children:e.jsxs(gs,{children:[e.jsx(vs,{children:e.jsxs(tt,{children:[e.jsx(de,{children:"Title"}),e.jsx(de,{children:"Code"}),e.jsx(de,{children:"Type"}),e.jsx(de,{children:"Scans"}),e.jsx(de,{children:"Last Scanned"}),e.jsx(de,{children:"Actions"})]})}),e.jsx(ys,{children:Z().length>0?Z().map(O=>e.jsxs(tt,{children:[e.jsx(ie,{className:"font-medium",children:O.title}),e.jsx(ie,{children:e.jsx("code",{className:"bg-muted px-1 py-0.5 rounded text-sm",children:O.code})}),e.jsx(ie,{children:O.type}),e.jsx(ie,{children:O.scanCount}),e.jsx(ie,{children:O.lastScanned?dr(new Date(O.lastScanned),"MMM d, yyyy HH:mm"):"Never"}),e.jsx(ie,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(P,{variant:"outline",size:"sm",children:[e.jsx(qs,{className:"h-3 w-3 mr-1"}),"View"]}),e.jsxs(P,{variant:"outline",size:"sm",children:[e.jsx(Lo,{className:"h-3 w-3 mr-1"}),"Print"]})]})})]},O.id)):e.jsx(tt,{children:e.jsx(ie,{colSpan:6,className:"text-center py-4 text-muted-foreground",children:"No QR codes found."})})})]})})})]})})]}),u&&e.jsx(Bt,{open:c,onOpenChange:d,children:e.jsxs(Lt,{children:[e.jsxs(Vt,{children:[e.jsx(Ut,{children:"Generate QR Code"}),e.jsxs(bs,{children:["Create a QR code for ",u.title]})]}),e.jsx(Kf,{type:u.type,entityId:u.entityId,title:u.title,onGenerate:O=>{m({title:"QR Code Generated",description:`QR code for ${u.title} has been created.`}),d(!1)}})]})})]})},v8=fC({frameId:vr().optional(),matColorId:vr().optional(),glassOptionId:vr().optional(),artworkWidth:vr().transform(s=>parseFloat(s)).refine(s=>!isNaN(s)&&s>0,{message:"Width must be a positive number"}),artworkHeight:vr().transform(s=>parseFloat(s)).refine(s=>!isNaN(s)&&s>0,{message:"Height must be a positive number"}),matWidth:vr().transform(s=>parseFloat(s)).refine(s=>!isNaN(s)&&s>=0,{message:"Mat width must be a non-negative number"}),quantity:vr().transform(s=>parseInt(s)).refine(s=>!isNaN(s)&&s>0,{message:"Quantity must be a positive integer"}),includeWholesalePrices:nl().default(!1),addToWholesaleOrder:nl().default(!0)});function y8(){const{toast:s}=Be(),[t,r]=p.useState(null),n=Nj({resolver:lT(v8),defaultValues:{frameId:"",matColorId:"",glassOptionId:"",artworkWidth:"16",artworkHeight:"20",matWidth:"2",quantity:"1",includeWholesalePrices:!0,addToWholesaleOrder:!0}}),{data:a=[],isLoading:i}=me({queryKey:["/api/frames"]}),{data:o=[],isLoading:l}=me({queryKey:["/api/larson-catalog/crescent"]}),{data:c=[],isLoading:d}=me({queryKey:["/api/glass-options"],queryFn:async()=>[{id:"regular",name:"Regular Glass",price:"0.08"},{id:"non-glare",name:"Non-glare Glass",price:"0.15"},{id:"museum",name:"Museum Glass",price:"0.30"},{id:"uv",name:"Museum Non-glare",price:"0.40"}]}),u=Ce({mutationFn:async x=>{const g=await ce("POST","/api/pricing/calculate",{...x,include_wholesale_prices:x.includeWholesalePrices});if(!g.ok){const f=await g.json();throw new Error(f.message||"Failed to calculate price")}return g.json()},onSuccess:x=>{r(x),s({title:"Price calculation successful",description:"The pricing has been calculated based on Houston Heights specifications."})},onError:x=>{s({title:"Error calculating price",description:x.message,variant:"destructive"})}}),h=x=>{u.mutate(x)},m=i||l||d||u.isPending;return e.jsxs("div",{className:"container max-w-6xl mx-auto py-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center",children:"Houston Heights Custom Framing Price Calculator"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Frame Specifications"}),e.jsx(te,{children:"Enter the artwork dimensions and select materials for accurate pricing"})]}),e.jsx(q,{children:e.jsx(cT,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(h),className:"space-y-4",children:[e.jsx(dt,{control:n.control,name:"frameId",render:({field:x})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Frame Style"}),e.jsxs(We,{onValueChange:x.onChange,defaultValue:x.value,children:[e.jsx(ct,{children:e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a frame style"})})}),e.jsxs(qe,{children:[e.jsx(se,{value:"none",children:"No Frame"}),a.map(g=>e.jsxs(se,{value:g.id,children:[g.name," ($",g.price,"/ft)"]},g.id))]})]}),e.jsx(rr,{children:"Choose from our selection of frames or select none"}),e.jsx(pt,{})]})}),e.jsx(dt,{control:n.control,name:"matColorId",render:({field:x})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Mat Color"}),e.jsxs(We,{onValueChange:x.onChange,defaultValue:x.value,children:[e.jsx(ct,{children:e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a mat color"})})}),e.jsxs(qe,{children:[e.jsx(se,{value:"none",children:"No Mat"}),o.map(g=>e.jsx(se,{value:g.id,children:g.name},g.id))]})]}),e.jsx(rr,{children:"Choose a mat color for your artwork"}),e.jsx(pt,{})]})}),e.jsx(dt,{control:n.control,name:"glassOptionId",render:({field:x})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Glass Option"}),e.jsxs(We,{onValueChange:x.onChange,defaultValue:x.value,children:[e.jsx(ct,{children:e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a glass option"})})}),e.jsxs(qe,{children:[e.jsx(se,{value:"none",children:"No Glass"}),c.map(g=>e.jsx(se,{value:g.id,children:g.name},g.id))]})]}),e.jsx(rr,{children:"Choose the type of glass for your frame"}),e.jsx(pt,{})]})}),e.jsx(dt,{control:n.control,name:"artworkWidth",render:({field:x})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Artwork Width (inches)"}),e.jsx(ct,{children:e.jsx(U,{type:"number",step:"0.25",...x})}),e.jsx(rr,{children:"Enter the width of your artwork in inches"}),e.jsx(pt,{})]})}),e.jsx(dt,{control:n.control,name:"artworkHeight",render:({field:x})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Artwork Height (inches)"}),e.jsx(ct,{children:e.jsx(U,{type:"number",step:"0.25",...x})}),e.jsx(rr,{children:"Enter the height of your artwork in inches"}),e.jsx(pt,{})]})}),e.jsx(dt,{control:n.control,name:"matWidth",render:({field:x})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Mat Width (inches)"}),e.jsx(ct,{children:e.jsx(U,{type:"number",step:"0.25",...x})}),e.jsx(rr,{children:"Enter the width of the mat border in inches"}),e.jsx(pt,{})]})}),e.jsx(dt,{control:n.control,name:"quantity",render:({field:x})=>e.jsxs(ot,{children:[e.jsx(lt,{children:"Quantity"}),e.jsx(ct,{children:e.jsx(U,{type:"number",min:"1",step:"1",...x})}),e.jsx(rr,{children:"Enter the number of frames to order"}),e.jsx(pt,{})]})}),e.jsx(dt,{control:n.control,name:"includeWholesalePrices",render:({field:x})=>e.jsxs(ot,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(lt,{children:"Show Wholesale Prices"}),e.jsx(rr,{children:"Include wholesale price details in calculation"})]}),e.jsx(ct,{children:e.jsx("input",{type:"checkbox",checked:x.value,onChange:x.onChange,className:"accent-primary h-4 w-4"})})]})}),e.jsx(dt,{control:n.control,name:"addToWholesaleOrder",render:({field:x})=>e.jsxs(ot,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-primary/10",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(lt,{className:"font-bold",children:"Add to Wholesale Order"}),e.jsx(rr,{children:"This will create a material order for the frame shop"})]}),e.jsx(ct,{children:e.jsx("input",{type:"checkbox",checked:x.value,onChange:x.onChange,className:"accent-primary h-4 w-4",disabled:!0})})]})}),e.jsx(P,{type:"submit",disabled:m,className:"w-full",children:m?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Calculating..."]}):"Calculate Price"})]})})})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Pricing Results"}),e.jsx(te,{children:"Houston Heights location-specific price calculation"})]}),e.jsx(q,{children:t?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"text-sm font-medium",children:"Frame Price:"}),e.jsxs("div",{className:"text-sm font-mono text-right",children:["$",t.framePrice.toFixed(2)]}),e.jsx("div",{className:"text-sm font-medium",children:"Mat Price:"}),e.jsxs("div",{className:"text-sm font-mono text-right",children:["$",t.matPrice.toFixed(2)]}),e.jsx("div",{className:"text-sm font-medium",children:"Glass Price:"}),e.jsxs("div",{className:"text-sm font-mono text-right",children:["$",t.glassPrice.toFixed(2)]}),e.jsx("div",{className:"text-sm font-medium",children:"Labor Cost:"}),e.jsxs("div",{className:"text-sm font-mono text-right",children:["$",t.laborCost.toFixed(2)]}),e.jsx("div",{className:"text-sm font-medium",children:"Material Cost:"}),e.jsxs("div",{className:"text-sm font-mono text-right",children:["$",t.materialCost.toFixed(2)]}),e.jsx("div",{className:"border-t pt-2 text-base font-semibold",children:"Subtotal:"}),e.jsxs("div",{className:"border-t pt-2 text-base font-semibold font-mono text-right",children:["$",t.subtotal.toFixed(2)]}),e.jsx("div",{className:"text-base font-bold",children:"Total Price:"}),e.jsxs("div",{className:"text-base font-bold font-mono text-right",children:["$",t.totalPrice.toFixed(2)]})]}),t.wholesalePrices&&e.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[e.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Wholesale Prices"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsx("div",{children:"Frame Wholesale:"}),e.jsxs("div",{className:"font-mono text-right",children:["$",t.wholesalePrices.frame]}),e.jsx("div",{children:"Mat Wholesale:"}),e.jsxs("div",{className:"font-mono text-right",children:["$",t.wholesalePrices.mat]}),e.jsx("div",{children:"Glass Wholesale:"}),e.jsxs("div",{className:"font-mono text-right",children:["$",t.wholesalePrices.glass]})]})]}),t.laborRates&&e.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[e.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Labor Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsx("div",{children:"Base Rate:"}),e.jsxs("div",{className:"font-mono text-right",children:["$",t.laborRates.baseRate.toFixed(2),"/hour"]}),e.jsx("div",{children:"Regional Factor:"}),e.jsxs("div",{className:"font-mono text-right",children:[t.laborRates.regionalFactor.toFixed(2),"x"]}),e.jsx("div",{className:"col-span-2 mt-2 mb-1 text-xs font-medium",children:"Time Estimates:"}),e.jsx("div",{children:"Frame Assembly:"}),e.jsxs("div",{className:"font-mono text-right",children:[(t.laborRates.estimates.frameAssembly*60).toFixed(0)," min"]}),e.jsx("div",{children:"Mat Cutting:"}),e.jsxs("div",{className:"font-mono text-right",children:[(t.laborRates.estimates.matCutting*60).toFixed(0)," min"]}),e.jsx("div",{children:"Glass Cutting:"}),e.jsxs("div",{className:"font-mono text-right",children:[(t.laborRates.estimates.glassCutting*60).toFixed(0)," min"]}),e.jsx("div",{children:"Fitting:"}),e.jsxs("div",{className:"font-mono text-right",children:[(t.laborRates.estimates.fitting*60).toFixed(0)," min"]}),e.jsx("div",{children:"Finishing:"}),e.jsxs("div",{className:"font-mono text-right",children:[(t.laborRates.estimates.finishing*60).toFixed(0)," min"]})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center text-muted-foreground",children:[e.jsx("p",{className:"mb-4",children:'Enter frame specifications and click "Calculate Price" to see pricing details.'}),e.jsx("p",{className:"text-sm",children:"All prices are calculated using Houston Heights location-specific pricing formulas."})]})}),e.jsxs(ht,{className:"flex justify-between",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Prices updated: April 25, 2025"}),t&&e.jsx(P,{variant:"outline",onClick:()=>window.print(),children:"Print Quote"})]})]})]})]})}function j8(){const[s,t]=p.useState(!1),[r,n]=p.useState({larsonApiKey:"",larsonApiSecret:"",romaApiKey:"",romaApiSecret:"",bellaApiKey:"",bellaApiSecret:""}),[a,i]=p.useState({larson:{connected:!1,message:"Not connected"},roma:{connected:!1,message:"Not connected"},bella:{connected:!1,message:"Not connected"}}),{toast:o}=Be();p.useEffect(()=>{(async()=>{try{const m=await(await ce("GET","/api/vendor-api/settings")).json(),x={...r};m.larsonApiKey&&(x.larsonApiKey=m.larsonApiKey),m.larsonApiSecret&&(x.larsonApiSecret="••••••••"),m.romaApiKey&&(x.romaApiKey=m.romaApiKey),m.romaApiSecret&&(x.romaApiSecret="••••••••"),m.bellaApiKey&&(x.bellaApiKey=m.bellaApiKey),m.bellaApiSecret&&(x.bellaApiSecret="••••••••"),n(x),i({larson:{connected:!!m.larsonApiKey&&m.larsonStatus==="connected",message:m.larsonStatus==="connected"?"Connected":"Not connected"},roma:{connected:!!m.romaApiKey&&m.romaStatus==="connected",message:m.romaStatus==="connected"?"Connected":"Not connected"},bella:{connected:!!m.bellaApiKey&&m.bellaStatus==="connected",message:m.bellaStatus==="connected"?"Connected":"Not connected"}})}catch(h){console.error("Failed to fetch vendor API settings:",h),o({title:"Error",description:"Failed to load vendor API settings",variant:"destructive"})}})()},[]);const l=u=>{const{name:h,value:m}=u.target;n(x=>({...x,[h]:m}))},c=async u=>{t(!0);try{const h={};switch(u){case"larson":h.larsonApiKey=r.larsonApiKey,r.larsonApiSecret&&r.larsonApiSecret!=="••••••••"&&(h.larsonApiSecret=r.larsonApiSecret);break;case"roma":h.romaApiKey=r.romaApiKey,r.romaApiSecret&&r.romaApiSecret!=="••••••••"&&(h.romaApiSecret=r.romaApiSecret);break;case"bella":h.bellaApiKey=r.bellaApiKey,r.bellaApiSecret&&r.bellaApiSecret!=="••••••••"&&(h.bellaApiSecret=r.bellaApiSecret);break}const x=await(await ce("POST","/api/vendor-api/settings",h)).json();i(g=>({...g,[u]:{connected:x[`${u}Status`]==="connected",message:x[`${u}Status`]==="connected"?"Connected":"Not connected"}})),o({title:"Settings Saved",description:`${u.charAt(0).toUpperCase()+u.slice(1)} API settings updated successfully!`}),await d(u)}catch(h){console.error(`Failed to save ${u} API settings:`,h),o({title:"Error",description:`Failed to save ${u} API settings. Please try again.`,variant:"destructive"})}finally{t(!1)}},d=async u=>{try{const m=await(await ce("POST",`/api/vendor-api/test-connection/${u}`)).json();i(x=>({...x,[u]:{connected:m.success,message:m.success?"Connected":m.message||"Connection failed"}})),m.success?o({title:"Connection Successful",description:`Connected to ${u.charAt(0).toUpperCase()+u.slice(1)} API successfully!`}):o({title:"Connection Failed",description:m.message||`Failed to connect to ${u.charAt(0).toUpperCase()+u.slice(1)} API.`,variant:"destructive"})}catch(h){console.error(`Failed to test ${u} API connection:`,h),o({title:"Connection Error",description:`Failed to test ${u} API connection. Please check your settings.`,variant:"destructive"}),i(m=>({...m,[u]:{connected:!1,message:"Connection failed"}}))}};return e.jsxs("div",{className:"container mx-auto py-10",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Vendor API Settings"}),e.jsx("p",{className:"text-gray-500 mb-8",children:"Configure API connections to frame vendor catalogs to access complete product data and wholesale pricing."}),e.jsxs(qt,{defaultValue:"larson",className:"w-full",children:[e.jsxs($t,{className:"mb-4",children:[e.jsx(ve,{value:"larson",children:"Larson-Juhl"}),e.jsx(ve,{value:"roma",children:"Roma Moulding"}),e.jsx(ve,{value:"bella",children:"Bella Moulding"})]}),e.jsx(Ae,{value:"larson",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center",children:["Larson-Juhl API Connection",a.larson.connected?e.jsx(ls,{className:"ml-2 h-5 w-5 text-green-500"}):e.jsx(At,{className:"ml-2 h-5 w-5 text-amber-500"})]}),e.jsxs(te,{children:["Connect to Larson-Juhl's API for real-time frame catalog data and pricing. Status: ",e.jsx("span",{className:a.larson.connected?"text-green-500":"text-amber-500",children:a.larson.message})]})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"larsonApiKey",children:"API Key"}),e.jsx(U,{id:"larsonApiKey",name:"larsonApiKey",placeholder:"Enter your Larson-Juhl API key",value:r.larsonApiKey,onChange:l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"larsonApiSecret",children:"API Secret"}),e.jsx(U,{id:"larsonApiSecret",name:"larsonApiSecret",type:"password",placeholder:"Enter your Larson-Juhl API secret",value:r.larsonApiSecret,onChange:l})]})]}),e.jsxs(ht,{className:"flex justify-between",children:[e.jsx(P,{variant:"outline",onClick:()=>d("larson"),disabled:s,children:"Test Connection"}),e.jsx(P,{onClick:()=>c("larson"),disabled:s,children:"Save Settings"})]})]})}),e.jsx(Ae,{value:"roma",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center",children:["Roma Moulding API Connection",a.roma.connected?e.jsx(ls,{className:"ml-2 h-5 w-5 text-green-500"}):e.jsx(At,{className:"ml-2 h-5 w-5 text-amber-500"})]}),e.jsxs(te,{children:["Connect to Roma Moulding's API for real-time frame catalog data and pricing. Status: ",e.jsx("span",{className:a.roma.connected?"text-green-500":"text-amber-500",children:a.roma.message})]})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"romaApiKey",children:"API Key"}),e.jsx(U,{id:"romaApiKey",name:"romaApiKey",placeholder:"Enter your Roma Moulding API key",value:r.romaApiKey,onChange:l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"romaApiSecret",children:"API Secret"}),e.jsx(U,{id:"romaApiSecret",name:"romaApiSecret",type:"password",placeholder:"Enter your Roma Moulding API secret",value:r.romaApiSecret,onChange:l})]})]}),e.jsxs(ht,{className:"flex justify-between",children:[e.jsx(P,{variant:"outline",onClick:()=>d("roma"),disabled:s,children:"Test Connection"}),e.jsx(P,{onClick:()=>c("roma"),disabled:s,children:"Save Settings"})]})]})}),e.jsx(Ae,{value:"bella",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center",children:["Bella Moulding API Connection",a.bella.connected?e.jsx(ls,{className:"ml-2 h-5 w-5 text-green-500"}):e.jsx(At,{className:"ml-2 h-5 w-5 text-amber-500"})]}),e.jsxs(te,{children:["Connect to Bella Moulding's API for real-time frame catalog data and pricing. Status: ",e.jsx("span",{className:a.bella.connected?"text-green-500":"text-amber-500",children:a.bella.message})]})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"bellaApiKey",children:"API Key"}),e.jsx(U,{id:"bellaApiKey",name:"bellaApiKey",placeholder:"Enter your Bella Moulding API key",value:r.bellaApiKey,onChange:l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"bellaApiSecret",children:"API Secret"}),e.jsx(U,{id:"bellaApiSecret",name:"bellaApiSecret",type:"password",placeholder:"Enter your Bella Moulding API secret",value:r.bellaApiSecret,onChange:l})]})]}),e.jsxs(ht,{className:"flex justify-between",children:[e.jsx(P,{variant:"outline",onClick:()=>d("bella"),disabled:s,children:"Test Connection"}),e.jsx(P,{onClick:()=>c("bella"),disabled:s,children:"Save Settings"})]})]})})]}),e.jsxs("div",{className:"mt-8 bg-slate-50 p-6 rounded-lg border border-slate-200",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Vendor API Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-md border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:"Larson-Juhl"}),e.jsx("span",{className:`${a.larson.connected?"bg-green-100 text-green-800":"bg-amber-100 text-amber-800"} px-2 py-1 rounded text-xs font-medium`,children:a.larson.connected?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:a.larson.message})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:"Roma Moulding"}),e.jsx("span",{className:`${a.roma.connected?"bg-green-100 text-green-800":"bg-amber-100 text-amber-800"} px-2 py-1 rounded text-xs font-medium`,children:a.roma.connected?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:a.roma.message})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:"Bella Moulding"}),e.jsx("span",{className:`${a.bella.connected?"bg-green-100 text-green-800":"bg-amber-100 text-amber-800"} px-2 py-1 rounded text-xs font-medium`,children:a.bella.connected?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:a.bella.message})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Note: To obtain API keys, please contact each vendor's account manager or visit their developer portal:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 text-sm text-gray-500",children:[e.jsx("li",{children:e.jsx("a",{href:"https://www.larsonjuhl.com/api",className:"text-blue-500 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Larson-Juhl Developer Portal"})}),e.jsx("li",{children:e.jsx("a",{href:"https://www.romamoulding.com/api",className:"text-blue-500 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Roma Moulding Developer Portal"})}),e.jsx("li",{children:e.jsx("a",{href:"https://www.bellamoulding.com/api",className:"text-blue-500 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Bella Moulding Developer Portal"})})]})]})]})]})}const mT={pending:e.jsx(vt,{className:"h-4 w-4"}),processed:e.jsx(Z2,{className:"h-4 w-4"}),ordered:e.jsx(Qs,{className:"h-4 w-4"}),arrived:e.jsx(Yr,{className:"h-4 w-4"}),frame_cut:e.jsx(pa,{className:"h-4 w-4"}),mat_cut:e.jsx(pa,{className:"h-4 w-4"}),prepped:e.jsx(Qs,{className:"h-4 w-4"}),completed:e.jsx(Gs,{className:"h-4 w-4"}),delayed:e.jsx(At,{className:"h-4 w-4"}),canceled:e.jsx(Bn,{className:"h-4 w-4"})},fl={pending:"bg-yellow-500",processed:"bg-blue-300",ordered:"bg-blue-500",arrived:"bg-purple-500",frame_cut:"bg-indigo-500",mat_cut:"bg-teal-500",prepped:"bg-cyan-500",completed:"bg-green-500",delayed:"bg-orange-500",canceled:"bg-red-500"};function b8({orderId:s,limit:t=10}){const{data:r,isLoading:n,error:a}=me({queryKey:[`/api/status-history/orders/${s}/status-history`],queryFn:()=>ce("GET",`/api/status-history/orders/${s}/status-history`).then(i=>i.json()).then(i=>i.slice(0,t)),enabled:!!s});return n?e.jsx(V,{className:"w-full",children:e.jsxs(G,{children:[e.jsx(Q,{children:"Status History"}),e.jsx(te,{children:"Loading status history..."})]})}):a||!r?e.jsx(V,{className:"w-full",children:e.jsxs(G,{children:[e.jsx(Q,{children:"Status History"}),e.jsx(te,{children:"Error loading status history"})]})}):e.jsxs(V,{className:"w-full",children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Order Status History"}),e.jsx(te,{children:"Status changes for this order"})]}),e.jsx(q,{children:r.length===0?e.jsx("p",{className:"text-muted-foreground",children:"No status changes recorded yet."}):e.jsx("div",{className:"space-y-4",children:r.map(i=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-md border",children:[e.jsx("div",{className:J("p-2 rounded-full",fl[i.new_status]||"bg-gray-500"),children:mT[i.new_status]||e.jsx(vt,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:fl[i.new_status]||"bg-gray-500",children:i.new_status.replace("_"," ")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:dr(new Date(i.changed_at),"MMM d, yyyy h:mm a")})]}),i.previous_status&&e.jsxs("p",{className:"text-sm mt-1",children:["Changed from ",e.jsx("span",{className:"font-medium",children:i.previous_status.replace("_"," ")})]}),i.notes&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:i.notes})]})]},i.id))})})]})}function pU({customerId:s,limit:t=20}){const{data:r,isLoading:n,error:a}=me({queryKey:[`/api/status-history/customers/${s}/status-history`],queryFn:()=>ce("GET",`/api/status-history/customers/${s}/status-history`).then(o=>o.json()).then(o=>o.slice(0,t)),enabled:!!s});if(n)return e.jsx(V,{className:"w-full",children:e.jsxs(G,{children:[e.jsx(Q,{children:"Your Orders Status History"}),e.jsx(te,{children:"Loading status history..."})]})});if(a||!r)return e.jsx(V,{className:"w-full",children:e.jsxs(G,{children:[e.jsx(Q,{children:"Your Orders Status History"}),e.jsx(te,{children:"Error loading status history"})]})});const i={};return r.forEach(o=>{i[o.order_id]||(i[o.order_id]=[]),i[o.order_id].push(o)}),e.jsxs(V,{className:"w-full",children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Your Orders Status History"}),e.jsx(te,{children:"Recent status changes for all your orders"})]}),e.jsx(q,{children:Object.keys(i).length===0?e.jsx("p",{className:"text-muted-foreground",children:"No status changes recorded for your orders yet."}):e.jsx("div",{className:"space-y-6",children:Object.entries(i).map(([o,l])=>e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsxs("h3",{className:"font-medium mb-2",children:["Order #",o," - ",l[0].frame_name||"Custom Frame"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:l[0].artwork_description||"Artwork"}),e.jsx("div",{className:"space-y-3",children:l.slice(0,5).map(c=>e.jsxs("div",{className:"flex items-start gap-3 p-2 bg-muted/50 rounded-md",children:[e.jsx("div",{className:J("p-1.5 rounded-full",fl[c.new_status]||"bg-gray-500"),children:mT[c.new_status]||e.jsx(vt,{className:"h-3 w-3"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:fl[c.new_status]||"bg-gray-500",children:c.new_status.replace("_"," ")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:dr(new Date(c.changed_at),"MMM d, yyyy h:mm a")})]})})]},c.id))})]},o))})})]})}const w8=({orderId:s,onFileUploaded:t})=>{const r=Be(),[n,a]=p.useState([]),[i,o]=p.useState("artwork"),[l,c]=p.useState(!1),[d,u]=p.useState("other"),[h,m]=p.useState(null),[x,g]=p.useState(null),[f,v]=p.useState(!0),y=async()=>{try{v(!0);const N=await ce("GET",`/api/orders/${s}/files`);if(N.ok){const _=await N.json();a(_)}else console.error("Error fetching files")}catch(N){console.error("Error fetching files:",N)}finally{v(!1)}};p.useEffect(()=>{s&&y()},[s]);const j=N=>{N.target.files&&N.target.files.length>0&&m(N.target.files[0])},b=N=>{N.target.files&&N.target.files.length>0&&g(N.target.files[0])},k=async()=>{if(!h){r({title:"Error",description:"Please select a file to upload",variant:"destructive"});return}c(!0);try{const N=new FormData;N.append("artwork",h);const _=await fetch(`/api/orders/${s}/artwork`,{method:"POST",body:N,credentials:"include"});if(_.ok)r({title:"Success",description:"Artwork uploaded successfully"}),m(null),y(),t&&t();else{const F=await _.json();r({title:"Upload Failed",description:F.message||"Failed to upload artwork",variant:"destructive"})}}catch(N){console.error("Error uploading artwork:",N),r({title:"Error",description:"An error occurred while uploading",variant:"destructive"})}finally{c(!1)}},S=async()=>{if(!x){r({title:"Error",description:"Please select a file to upload",variant:"destructive"});return}c(!0);try{const N=new FormData;N.append("file",x),N.append("fileType",d);const _=await fetch(`/api/orders/${s}/files`,{method:"POST",body:N,credentials:"include"});if(_.ok)r({title:"Success",description:"File uploaded successfully"}),g(null),y(),t&&t();else{const F=await _.json();r({title:"Upload Failed",description:F.message||"Failed to upload file",variant:"destructive"})}}catch(N){console.error("Error uploading file:",N),r({title:"Error",description:"An error occurred while uploading",variant:"destructive"})}finally{c(!1)}},A=async N=>{try{const _=await ce("DELETE",`/api/files/${N}`);if(_.ok)r({title:"Success",description:"File deleted successfully"}),a(n.filter(F=>F.id!==N));else{const F=await _.json();r({title:"Delete Failed",description:F.message||"Failed to delete file",variant:"destructive"})}}catch(_){console.error("Error deleting file:",_),r({title:"Error",description:"An error occurred while deleting the file",variant:"destructive"})}},T=N=>{const F=`${window.location.origin}/uploads/${N.file_path}`,W=document.createElement("a");W.href=F,W.download=N.file_name,document.body.appendChild(W),W.click(),document.body.removeChild(W)},C=(N,_)=>{switch(N){case"qr-code":return e.jsx(qs,{className:"h-5 w-5"});case"work-order":return e.jsx(Cl,{className:"h-5 w-5"});case"invoice":return e.jsx(X2,{className:"h-5 w-5"});case"virtual-frame":return e.jsx(fi,{className:"h-5 w-5"});default:return _.startsWith("image/")?e.jsx(fi,{className:"h-5 w-5"}):e.jsx(Y2,{className:"h-5 w-5"})}},E=N=>N<1024?N+" bytes":N<1048576?(N/1024).toFixed(1)+" KB":(N/1048576).toFixed(1)+" MB",D=N=>{const _=new Date(N);return _.toLocaleDateString()+" "+_.toLocaleTimeString()},w=()=>i==="artwork"?n.filter(N=>N.mime_type.startsWith("image/")&&N.file_type!=="qr-code"&&N.file_type!=="virtual-frame"):i==="qr-codes"?n.filter(N=>N.file_type==="qr-code"):i==="documents"?n.filter(N=>N.file_type==="work-order"||N.file_type==="invoice"||N.mime_type==="application/pdf"):n.filter(N=>N.file_type==="other"&&!N.mime_type.startsWith("image/")&&N.mime_type!=="application/pdf");return e.jsxs(V,{className:"w-full",children:[e.jsx(G,{children:e.jsx(Q,{children:"Order Files"})}),e.jsx(q,{children:e.jsxs(qt,{defaultValue:"artwork",value:i,onValueChange:o,children:[e.jsxs($t,{className:"mb-4",children:[e.jsx(ve,{value:"artwork",children:"Artwork"}),e.jsx(ve,{value:"qr-codes",children:"QR Codes"}),e.jsx(ve,{value:"documents",children:"Documents"}),e.jsx(ve,{value:"other",children:"Other Files"})]}),e.jsx(Ae,{value:"artwork",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-md",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Upload Artwork"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{type:"file",accept:"image/*",onChange:j,className:"flex-1"}),e.jsxs(P,{onClick:k,disabled:!h||l,children:[l?"Uploading...":"Upload"," ",e.jsx(Or,{className:"ml-2 h-4 w-4"})]})]}),h&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Selected: ",h.name," (",E(h.size),")"]})]}),e.jsx("div",{className:"file-list",children:f?e.jsx("div",{className:"text-center py-4",children:"Loading files..."}):w().length>0?e.jsx("div",{className:"grid gap-2",children:w().map(N=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[C(N.file_type,N.mime_type),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:N.file_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[E(N.file_size)," • ",D(N.upload_date)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>T(N),children:e.jsx(xn,{className:"h-4 w-4"})}),e.jsxs(aa,{children:[e.jsx(ia,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",children:e.jsx(lo,{className:"h-4 w-4 text-red-500"})})}),e.jsxs(jn,{children:[e.jsxs(bn,{children:[e.jsx(Nn,{children:"Delete File"}),e.jsxs(Sn,{children:['Are you sure you want to delete "',N.file_name,'"? This action cannot be undone.']})]}),e.jsxs(wn,{children:[e.jsx(kn,{children:"Cancel"}),e.jsx(Cn,{onClick:()=>A(N.id),className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})]})]})]},N.id))}):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No artwork files uploaded"})})]})}),e.jsx(Ae,{value:"qr-codes",children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"file-list",children:f?e.jsx("div",{className:"text-center py-4",children:"Loading files..."}):w().length>0?e.jsx("div",{className:"grid gap-2",children:w().map(N=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qs,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:N.file_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[E(N.file_size)," • ",D(N.upload_date)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>T(N),children:e.jsx(xn,{className:"h-4 w-4"})}),e.jsxs(aa,{children:[e.jsx(ia,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",children:e.jsx(lo,{className:"h-4 w-4 text-red-500"})})}),e.jsxs(jn,{children:[e.jsxs(bn,{children:[e.jsx(Nn,{children:"Delete File"}),e.jsxs(Sn,{children:['Are you sure you want to delete "',N.file_name,'"? This action cannot be undone.']})]}),e.jsxs(wn,{children:[e.jsx(kn,{children:"Cancel"}),e.jsx(Cn,{onClick:()=>A(N.id),className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})]})]})]},N.id))}):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No QR codes uploaded"})})})}),e.jsx(Ae,{value:"documents",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-md",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Upload Document"}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(We,{value:d,onValueChange:u,children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select file type"})}),e.jsxs(qe,{children:[e.jsx(se,{value:"work-order",children:"Work Order"}),e.jsx(se,{value:"invoice",children:"Invoice"}),e.jsx(se,{value:"other",children:"Other Document"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{type:"file",accept:".pdf,.doc,.docx,.xls,.xlsx,.txt",onChange:b,className:"flex-1"}),e.jsxs(P,{onClick:S,disabled:!x||l,children:[l?"Uploading...":"Upload"," ",e.jsx(Or,{className:"ml-2 h-4 w-4"})]})]})]}),x&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Selected: ",x.name," (",E(x.size),")"]})]}),e.jsx("div",{className:"file-list",children:f?e.jsx("div",{className:"text-center py-4",children:"Loading files..."}):w().length>0?e.jsx("div",{className:"grid gap-2",children:w().map(N=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[C(N.file_type,N.mime_type),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:N.file_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[E(N.file_size)," • ",D(N.upload_date)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>T(N),children:e.jsx(xn,{className:"h-4 w-4"})}),e.jsxs(aa,{children:[e.jsx(ia,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",children:e.jsx(lo,{className:"h-4 w-4 text-red-500"})})}),e.jsxs(jn,{children:[e.jsxs(bn,{children:[e.jsx(Nn,{children:"Delete File"}),e.jsxs(Sn,{children:['Are you sure you want to delete "',N.file_name,'"? This action cannot be undone.']})]}),e.jsxs(wn,{children:[e.jsx(kn,{children:"Cancel"}),e.jsx(Cn,{onClick:()=>A(N.id),className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})]})]})]},N.id))}):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No documents uploaded"})})]})}),e.jsx(Ae,{value:"other",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-md",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Upload Other File"}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(We,{value:d,onValueChange:u,children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select file type"})}),e.jsxs(qe,{children:[e.jsx(se,{value:"virtual-frame",children:"Virtual Frame Design"}),e.jsx(se,{value:"other",children:"Other File"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{type:"file",onChange:b,className:"flex-1"}),e.jsxs(P,{onClick:S,disabled:!x||l,children:[l?"Uploading...":"Upload"," ",e.jsx(Or,{className:"ml-2 h-4 w-4"})]})]})]}),x&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Selected: ",x.name," (",E(x.size),")"]})]}),e.jsx("div",{className:"file-list",children:f?e.jsx("div",{className:"text-center py-4",children:"Loading files..."}):w().length>0?e.jsx("div",{className:"grid gap-2",children:w().map(N=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[C(N.file_type,N.mime_type),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:N.file_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[E(N.file_size)," • ",D(N.upload_date)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>T(N),children:e.jsx(xn,{className:"h-4 w-4"})}),e.jsxs(aa,{children:[e.jsx(ia,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",children:e.jsx(lo,{className:"h-4 w-4 text-red-500"})})}),e.jsxs(jn,{children:[e.jsxs(bn,{children:[e.jsx(Nn,{children:"Delete File"}),e.jsxs(Sn,{children:['Are you sure you want to delete "',N.file_name,'"? This action cannot be undone.']})]}),e.jsxs(wn,{children:[e.jsx(kn,{children:"Cancel"}),e.jsx(Cn,{onClick:()=>A(N.id),className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})]})]})]},N.id))}):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No other files uploaded"})})]})})]})})]})};async function N8(s,t){try{const r=await ce("GET",`/api/qr-codes/search?type=${s}&entityId=${t}`);if(r.status===404)return null;if(!r.ok)throw new Error("Failed to fetch QR code");return await r.json()}catch(r){return console.error("Error fetching QR code:",r),null}}function S8(){var g,f;const{orderId:s}=Tl(),{toast:t}=Be(),r=Zt(),[n,a]=p.useState(!1),[i,o]=p.useState(null),{order:l,isLoadingOrder:c,orderError:d,orderNotifications:u,isLoadingOrderNotifications:h}=Qi({orderId:s?parseInt(s):void 0}),m=Ce({mutationFn:async({id:v,status:y})=>ce("PATCH",`/api/orders/${v}`,{status:y}),onSuccess:()=>{r.invalidateQueries({queryKey:["/api/orders"]}),r.invalidateQueries({queryKey:[`/api/production/orders/${s}`]}),t({title:"Status Updated",description:"Order status has been updated successfully"})},onError:v=>{t({title:"Update Failed",description:v.message||"Failed to update order status",variant:"destructive"})}});p.useEffect(()=>{d&&t({title:"Error",description:"Failed to load order details. Please try again.",variant:"destructive"})},[d,t]);const x=v=>{l&&m.mutate({id:l.id,status:v})};return p.useEffect(()=>{(async()=>{if(s&&l)try{const y=await N8("order",s);o((y==null?void 0:y.code)||null)}catch(y){console.error("Error loading QR code:",y)}})()},[s,l]),c?e.jsx("div",{className:"container mx-auto py-10 space-y-6",children:e.jsx("div",{className:"flex items-center justify-center py-32",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading order details..."})]})})}):l?e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Order #",l.id]}),e.jsxs("p",{className:"text-muted-foreground",children:["Customer: ",l.customerName||"Unknown"," | Created: ",new Date(l.createdAt||"").toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",asChild:!0,children:e.jsxs(Mt,{href:"/orders",children:[e.jsx(Zc,{className:"mr-2 h-4 w-4"}),"Back to Orders"]})}),e.jsxs(P,{onClick:()=>a(!0),children:[e.jsx(Aa,{className:"mr-2 h-4 w-4"}),"Edit Order"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Order Details"}),e.jsx(te,{children:"Specifications and pricing information"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"Frame"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.frameName||l.frameId||"None"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"Material"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.frameMaterial||"Standard"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"Mat"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.matColorName||l.matColorId||"None"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"Glass"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.glassOptionName||l.glassOptionId||"None"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"Image Size"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[l.artworkWidth,'" × ',l.artworkHeight,'"']})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"Mat Width"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[l.matWidth,'" all around']})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"Quantity"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.quantity||1})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.artworkDescription||"No description"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"Art Type"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.artworkType||"Not specified"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                    ${l.status==="pending"?"bg-yellow-100 text-yellow-800":l.status==="in_progress"?"bg-blue-100 text-blue-800":l.status==="completed"?"bg-green-100 text-green-800":l.status==="cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:((g=l.status)==null?void 0:g.charAt(0).toUpperCase())+((f=l.status)==null?void 0:f.slice(1).replace("_"," "))}),e.jsxs(We,{value:l.status||"pending",onValueChange:x,disabled:m.isPending,children:[e.jsx(He,{className:"w-[140px]",children:e.jsx(Ke,{placeholder:"Change status"})}),e.jsxs(qe,{children:[e.jsx(se,{value:"pending",children:"Pending"}),e.jsx(se,{value:"in_progress",children:"In Progress"}),e.jsx(se,{value:"completed",children:"Completed"}),e.jsx(se,{value:"cancelled",children:"Cancelled"})]})]})]})]}),i&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("h4",{className:"text-sm font-medium mb-1 text-foreground",children:"QR Code"}),e.jsx("div",{className:"bg-white p-2 rounded inline-block",children:e.jsx(Du,{value:i,size:128,level:"H"})})]})]}),e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Subtotal"}),e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["$",parseFloat(l.subtotal||"0").toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tax"}),e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["$",parseFloat(l.tax||"0").toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center font-medium mt-2",children:[e.jsx("p",{className:"text-foreground",children:"Total"}),e.jsxs("p",{className:"text-foreground",children:["$",parseFloat(l.total||"0").toFixed(2)]})]})]})]}),e.jsx(ht,{className:"border-t pt-6",children:e.jsx(P,{variant:"outline",className:"w-full",asChild:!0,children:e.jsxs(Mt,{href:`/order-progress/${l.id}`,children:[e.jsx(vt,{className:"mr-2 h-4 w-4"}),"Track Progress"]})})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(NC,{order:l,showHistory:!1}),e.jsxs("div",{className:"mt-6",children:[e.jsx(zC,{orderId:l.id}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Status History"}),e.jsx(b8,{orderId:l.id})]}),e.jsx("div",{className:"mt-6",children:e.jsx(w8,{orderId:l.id})})]})]})]}),e.jsx(j0,{isOpen:n,onClose:()=>a(!1),order:l})]}):e.jsx("div",{className:"container mx-auto py-10 space-y-6",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Order Not Found"}),e.jsx(te,{children:"We couldn't find the order you're looking for."})]}),e.jsxs(q,{className:"flex flex-col items-center justify-center py-10",children:[e.jsx(Ht,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-center mb-6",children:"The order you're looking for doesn't exist or you don't have permission to view it."}),e.jsx(P,{asChild:!0,children:e.jsxs(Mt,{href:"/orders",children:[e.jsx(Zc,{className:"mr-2 h-4 w-4"}),"Return to Orders"]})})]})]})})}function C8(){const[s,t]=p.useState("create"),{toast:r}=Be(),n=Zt(),[a,i]=p.useState(""),[o,l]=p.useState(""),[c,d]=p.useState(""),[u,h]=p.useState(""),[m,x]=p.useState("7"),[g,f]=p.useState(""),[v,y]=p.useState(""),[j,b]=p.useState(!1),{data:k}=me({queryKey:["/api/customers"]}),{data:S}=me({queryKey:["/api/orders"]}),[A,T]=p.useState(""),[C,E]=p.useState(""),[D,w]=p.useState(null),{data:N,isLoading:_}=me({queryKey:["/api/payment-links"],retry:1}),F=Ce({mutationFn:async O=>(await ce("POST","/api/payment-links",O)).json(),onSuccess:()=>{n.invalidateQueries({queryKey:["/api/payment-links"]}),r({title:"Payment link created",description:"The payment link has been created successfully."}),i(""),l(""),d(""),h(""),x("7"),f(""),y(""),b(!1),t("view")},onError:O=>{r({title:"Error creating payment link",description:O.message||"There was an error creating the payment link.",variant:"destructive"})}}),W=Ce({mutationFn:async({id:O,email:ne,phone:Pe})=>(await ce("POST",`/api/payment-links/${O}/notify`,{email:ne,phone:Pe,notificationType:ne&&Pe?"both":ne?"email":"sms"})).json(),onSuccess:O=>{r({title:"Notification sent",description:"The payment link notification has been sent."}),T(""),E(""),w(null)},onError:O=>{r({title:"Error sending notification",description:O.message||"There was an error sending the notification.",variant:"destructive"})}}),Z=O=>{if(O.preventDefault(),!a||isNaN(parseFloat(a))||parseFloat(a)<=0){r({title:"Invalid amount",description:"Please enter a valid payment amount.",variant:"destructive"});return}const ne={amount:parseFloat(a),expiresInDays:parseInt(m),sendNotification:j};o&&(ne.description=o),u&&!isNaN(parseInt(u))&&(ne.customerId=parseInt(u)),j&&(g&&(ne.email=g),v&&(ne.phone=v)),F.mutate(ne)},$=O=>{if(!A&&!C){r({title:"Missing contact information",description:"Please provide either an email address or phone number to send the notification.",variant:"destructive"});return}W.mutate({id:O,email:A||void 0,phone:C||void 0})},ae=O=>`${window.location.origin}/payment/${O}`;return e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Payment Links"}),e.jsxs(qt,{defaultValue:"create",value:s,onValueChange:t,children:[e.jsxs($t,{className:"mb-4",children:[e.jsx(ve,{value:"create",children:"Create Payment Link"}),e.jsx(ve,{value:"view",children:"View Payment Links"})]}),e.jsx(Ae,{value:"create",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Create New Payment Link"}),e.jsx(te,{children:"Generate a payment link for a custom amount that can be sent to customers."})]}),e.jsxs("form",{onSubmit:Z,children:[e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"amount",children:"Amount ($)"}),e.jsx(U,{id:"amount",type:"number",step:"0.01",min:"0.01",placeholder:"Amount",value:a,onChange:O=>i(O.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"expiresInDays",children:"Expires In (days)"}),e.jsx(U,{id:"expiresInDays",type:"number",min:"1",placeholder:"7",value:m,onChange:O=>x(O.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"description",children:"Description"}),e.jsx(Zs,{id:"description",placeholder:"Payment description",value:o,onChange:O=>l(O.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"customerName",children:"Customer Name"}),e.jsxs(We,{value:c,onValueChange:d,children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select customer"})}),e.jsx(qe,{children:Array.isArray(k)&&k.map(O=>e.jsx(se,{value:O.name,children:O.name},O.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"selectedOrderId",children:"Related Order (optional)"}),e.jsxs(We,{value:u,onValueChange:h,children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select order"})}),e.jsx(qe,{children:Array.isArray(S)&&S.map(O=>e.jsxs(se,{value:O.id.toString(),children:["Order #",O.id," - $",O.total]},O.id))})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(os,{id:"sendNotification",checked:j,onCheckedChange:O=>b(!!O)}),e.jsx(M,{htmlFor:"sendNotification",children:"Send notification immediately"})]}),j&&e.jsxs("div",{className:"pl-6 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"email",children:"Email"}),e.jsx(U,{id:"email",type:"email",placeholder:"customer@example.com",value:g,onChange:O=>f(O.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"phone",children:"Phone Number"}),e.jsx(U,{id:"phone",type:"tel",placeholder:"+1 (123) 456-7890",value:v,onChange:O=>y(O.target.value)})]})]})]})]}),e.jsx(ht,{children:e.jsx(P,{type:"submit",disabled:F.isPending,children:F.isPending?"Creating...":"Create Payment Link"})})]})]})}),e.jsx(Ae,{value:"view",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Payment Links"}),e.jsx(te,{children:"View and manage your existing payment links."})]}),e.jsx(q,{children:_?e.jsx("p",{children:"Loading payment links..."}):!N||N.length===0?e.jsx("p",{children:"No payment links found. Create one to get started."}):e.jsx("div",{className:"space-y-6",children:N.map(O=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Amount"}),e.jsx("p",{className:"text-lg",children:An(parseFloat(O.amount))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Status"}),e.jsx("p",{className:`font-medium ${O.used?"text-green-600":"text-amber-600"}`,children:O.used?`Used (${O.paymentStatus})`:"Pending"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold",children:"Description"}),e.jsx("p",{children:O.description||"No description"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Created"}),e.jsx("p",{children:new Date(O.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Expires"}),e.jsx("p",{children:new Date(O.expiresAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold",children:"Payment URL"}),e.jsxs("div",{className:"flex mt-1",children:[e.jsx(U,{value:ae(O.token),readOnly:!0,className:"mr-2"}),e.jsx(P,{variant:"outline",onClick:()=>{navigator.clipboard.writeText(ae(O.token)),r({title:"URL copied",description:"Payment link URL copied to clipboard"})},children:"Copy"})]})]}),!O.used&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Send Notification"}),D===O.id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:`notifyEmail-${O.id}`,children:"Email"}),e.jsx(U,{id:`notifyEmail-${O.id}`,type:"email",placeholder:"customer@example.com",value:A,onChange:ne=>T(ne.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:`notifyPhone-${O.id}`,children:"Phone Number"}),e.jsx(U,{id:`notifyPhone-${O.id}`,type:"tel",placeholder:"+1 (123) 456-7890",value:C,onChange:ne=>E(ne.target.value)})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(P,{onClick:()=>$(O.id),disabled:W.isPending,children:W.isPending?"Sending...":"Send"}),e.jsx(P,{variant:"outline",onClick:()=>{w(null),T(""),E("")},children:"Cancel"})]})]}):e.jsx(P,{variant:"outline",onClick:()=>w(O.id),children:"Send to Customer"})]})]},O.id))})})]})})]})]})}const k8=sN("pk_live_51QC3rtP1hEy5reEdyiTbL1JCiuLRsrZmHHk83DW17gkXCYfPTBJcxMHjV35TZcjlvOuXDqDxd4ckktLBtwAWtl4K00o0kkZ50c"),T8=({token:s,amount:t,description:r})=>{const n=dN(),a=lN(),{toast:i}=Be(),[o,l]=p.useState(!1),c=async d=>{if(d.preventDefault(),!(!n||!a)){l(!0);try{const{paymentIntent:u,error:h}=await n.confirmPayment({elements:a,confirmParams:{return_url:`${window.location.origin}/payment-status?token=${s}`},redirect:"if_required"});if(h){i({title:"Payment Failed",description:h.message||"An error occurred while processing your payment.",variant:"destructive"}),l(!1);return}if(u&&u.status==="succeeded")try{console.log("Payment succeeded, marking payment link as used");const m=await ce("POST",`/api/payment/${s}/complete`,{paymentIntentId:u.id,status:u.status});m.ok?console.log("Payment completion successful"):console.error("Error completing payment:",await m.text()),i({title:"Payment Successful",description:"Your payment has been processed successfully."}),window.location.href=`/payment-status?status=success&token=${s}`}catch(m){console.error("Error completing payment:",m),i({title:"Payment Status Update Failed",description:"Your payment processed, but we had trouble updating our records.",variant:"destructive"}),window.location.href=`/payment-status?status=success&token=${s}`}else window.location.href=`/payment-status?status=processing&token=${s}`}catch(u){i({title:"Error",description:u.message||"An unexpected error occurred.",variant:"destructive"}),l(!1)}}};return e.jsxs("form",{onSubmit:c,className:"mt-4",children:[e.jsx(uN,{className:"mb-6"}),e.jsx(P,{type:"submit",disabled:!n||o,className:"w-full",children:o?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):`Pay ${An(parseFloat(t))}`})]})},P8=()=>{const[,s]=BP("/payment/:token"),{toast:t}=Be(),r=(s==null?void 0:s.token)||"",[n,a]=p.useState(!0),[i,o]=p.useState(null),[l,c]=p.useState(null),[d,u]=p.useState(null);return p.useEffect(()=>{(async()=>{try{console.log(`Attempting to validate token: ${r}`);const m=await ce("GET",`/api/payment/${r}/validate`);if(!m.ok){const g=await m.text();console.error("Validation response not OK:",g),o("This payment link is invalid or has expired."),a(!1);return}const x=await m.json();if(console.log("Validation response:",x),!x.valid){o(x.message||"This payment link is invalid or has expired."),a(!1);return}if(!x.canProcess){o(x.message||"Unable to process this payment at the moment."),a(!1);return}c(x.clientSecret),u(x.paymentLink),a(!1)}catch(m){console.error("Error validating payment link:",m),o("Failed to validate payment link. Please try again later."),a(!1)}})()},[r,t]),n?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(Xe,{className:"h-8 w-8 animate-spin text-primary"})}):i?e.jsx("div",{className:"container mx-auto py-12 max-w-md",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{className:"text-destructive",children:"Payment Error"}),e.jsx(te,{children:"We couldn't process your payment."})]}),e.jsx(q,{children:e.jsx("p",{className:"text-destructive",children:i})}),e.jsx(ht,{children:e.jsx(P,{variant:"outline",onClick:()=>window.location.href="/",className:"w-full",children:"Return to Home"})})]})}):e.jsx("div",{className:"container mx-auto py-12 max-w-md",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Complete Your Payment"}),e.jsx(te,{children:"Please provide your payment details to complete the transaction."})]}),e.jsxs(q,{children:[d&&e.jsxs("div",{className:"mb-6 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Amount:"}),e.jsx("span",{className:"text-lg font-semibold",children:An(parseFloat(d.amount))})]}),d.description&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Description:"}),e.jsx("p",{className:"mt-1",children:d.description})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Expires:"}),e.jsx("p",{className:"mt-1",children:new Date(d.expiresAt).toLocaleDateString()})]})]}),l&&d&&e.jsx(Lu,{stripe:k8,options:{clientSecret:l,appearance:{theme:"stripe"}},children:e.jsx(T8,{token:r,amount:d.amount,description:d.description})})]})]})})};var hT=["PageUp","PageDown"],pT=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],fT={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Ua="Slider",[tu,E8,D8]=Vi(Ua),[xT,fU]=fs(Ua,[D8]),[A8,oc]=xT(Ua),gT=p.forwardRef((s,t)=>{const{name:r,min:n=0,max:a=100,step:i=1,orientation:o="horizontal",disabled:l=!1,minStepsBetweenThumbs:c=0,defaultValue:d=[n],value:u,onValueChange:h=()=>{},onValueCommit:m=()=>{},inverted:x=!1,form:g,...f}=s,v=p.useRef(new Set),y=p.useRef(0),b=o==="horizontal"?_8:I8,[k=[],S]=ms({prop:u,defaultProp:d,onChange:w=>{var _;(_=[...v.current][y.current])==null||_.focus(),h(w)}}),A=p.useRef(k);function T(w){const N=L8(k,w);D(w,N)}function C(w){D(w,y.current)}function E(){const w=A.current[y.current];k[y.current]!==w&&m(k)}function D(w,N,{commit:_}={commit:!1}){const F=U8(i),W=H8(Math.round((w-n)/i)*i+n,F),Z=ji(W,[n,a]);S(($=[])=>{const ae=O8($,Z,N);if(V8(ae,c*i)){y.current=ae.indexOf(Z);const O=String(ae)!==String($);return O&&_&&m(ae),O?ae:$}else return $})}return e.jsx(A8,{scope:s.__scopeSlider,name:r,disabled:l,min:n,max:a,valueIndexToChangeRef:y,thumbs:v.current,values:k,orientation:o,form:g,children:e.jsx(tu.Provider,{scope:s.__scopeSlider,children:e.jsx(tu.Slot,{scope:s.__scopeSlider,children:e.jsx(b,{"aria-disabled":l,"data-disabled":l?"":void 0,...f,ref:t,onPointerDown:ge(f.onPointerDown,()=>{l||(A.current=k)}),min:n,max:a,inverted:x,onSlideStart:l?void 0:T,onSlideMove:l?void 0:C,onSlideEnd:l?void 0:E,onHomeKeyDown:()=>!l&&D(n,0,{commit:!0}),onEndKeyDown:()=>!l&&D(a,k.length-1,{commit:!0}),onStepKeyDown:({event:w,direction:N})=>{if(!l){const W=hT.includes(w.key)||w.shiftKey&&pT.includes(w.key)?10:1,Z=y.current,$=k[Z],ae=i*W*N;D($+ae,Z,{commit:!0})}}})})})})});gT.displayName=Ua;var[vT,yT]=xT(Ua,{startEdge:"left",endEdge:"right",size:"width",direction:1}),_8=p.forwardRef((s,t)=>{const{min:r,max:n,dir:a,inverted:i,onSlideStart:o,onSlideMove:l,onSlideEnd:c,onStepKeyDown:d,...u}=s,[h,m]=p.useState(null),x=Ge(t,b=>m(b)),g=p.useRef(),f=Ln(a),v=f==="ltr",y=v&&!i||!v&&i;function j(b){const k=g.current||h.getBoundingClientRect(),S=[0,k.width],T=Ym(S,y?[r,n]:[n,r]);return g.current=k,T(b-k.left)}return e.jsx(vT,{scope:s.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:e.jsx(jT,{dir:f,"data-orientation":"horizontal",...u,ref:x,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:b=>{const k=j(b.clientX);o==null||o(k)},onSlideMove:b=>{const k=j(b.clientX);l==null||l(k)},onSlideEnd:()=>{g.current=void 0,c==null||c()},onStepKeyDown:b=>{const S=fT[y?"from-left":"from-right"].includes(b.key);d==null||d({event:b,direction:S?-1:1})}})})}),I8=p.forwardRef((s,t)=>{const{min:r,max:n,inverted:a,onSlideStart:i,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...d}=s,u=p.useRef(null),h=Ge(t,u),m=p.useRef(),x=!a;function g(f){const v=m.current||u.current.getBoundingClientRect(),y=[0,v.height],b=Ym(y,x?[n,r]:[r,n]);return m.current=v,b(f-v.top)}return e.jsx(vT,{scope:s.__scopeSlider,startEdge:x?"bottom":"top",endEdge:x?"top":"bottom",size:"height",direction:x?1:-1,children:e.jsx(jT,{"data-orientation":"vertical",...d,ref:h,style:{...d.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:f=>{const v=g(f.clientY);i==null||i(v)},onSlideMove:f=>{const v=g(f.clientY);o==null||o(v)},onSlideEnd:()=>{m.current=void 0,l==null||l()},onStepKeyDown:f=>{const y=fT[x?"from-bottom":"from-top"].includes(f.key);c==null||c({event:f,direction:y?-1:1})}})})}),jT=p.forwardRef((s,t)=>{const{__scopeSlider:r,onSlideStart:n,onSlideMove:a,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:l,onStepKeyDown:c,...d}=s,u=oc(Ua,r);return e.jsx(Se.span,{...d,ref:t,onKeyDown:ge(s.onKeyDown,h=>{h.key==="Home"?(o(h),h.preventDefault()):h.key==="End"?(l(h),h.preventDefault()):hT.concat(pT).includes(h.key)&&(c(h),h.preventDefault())}),onPointerDown:ge(s.onPointerDown,h=>{const m=h.target;m.setPointerCapture(h.pointerId),h.preventDefault(),u.thumbs.has(m)?m.focus():n(h)}),onPointerMove:ge(s.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&a(h)}),onPointerUp:ge(s.onPointerUp,h=>{const m=h.target;m.hasPointerCapture(h.pointerId)&&(m.releasePointerCapture(h.pointerId),i(h))})})}),bT="SliderTrack",wT=p.forwardRef((s,t)=>{const{__scopeSlider:r,...n}=s,a=oc(bT,r);return e.jsx(Se.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...n,ref:t})});wT.displayName=bT;var su="SliderRange",NT=p.forwardRef((s,t)=>{const{__scopeSlider:r,...n}=s,a=oc(su,r),i=yT(su,r),o=p.useRef(null),l=Ge(t,o),c=a.values.length,d=a.values.map(m=>CT(m,a.min,a.max)),u=c>1?Math.min(...d):0,h=100-Math.max(...d);return e.jsx(Se.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...n,ref:l,style:{...s.style,[i.startEdge]:u+"%",[i.endEdge]:h+"%"}})});NT.displayName=su;var ru="SliderThumb",ST=p.forwardRef((s,t)=>{const r=E8(s.__scopeSlider),[n,a]=p.useState(null),i=Ge(t,l=>a(l)),o=p.useMemo(()=>n?r().findIndex(l=>l.ref.current===n):-1,[r,n]);return e.jsx(R8,{...s,ref:i,index:o})}),R8=p.forwardRef((s,t)=>{const{__scopeSlider:r,index:n,name:a,...i}=s,o=oc(ru,r),l=yT(ru,r),[c,d]=p.useState(null),u=Ge(t,j=>d(j)),h=c?o.form||!!c.closest("form"):!0,m=yl(c),x=o.values[n],g=x===void 0?0:CT(x,o.min,o.max),f=F8(n,o.values.length),v=m==null?void 0:m[l.size],y=v?$8(v,g,l.direction):0;return p.useEffect(()=>{if(c)return o.thumbs.add(c),()=>{o.thumbs.delete(c)}},[c,o.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${g}% + ${y}px)`},children:[e.jsx(tu.ItemSlot,{scope:s.__scopeSlider,children:e.jsx(Se.span,{role:"slider","aria-label":s["aria-label"]||f,"aria-valuemin":o.min,"aria-valuenow":x,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...i,ref:u,style:x===void 0?{display:"none"}:s.style,onFocus:ge(s.onFocus,()=>{o.valueIndexToChangeRef.current=n})})}),h&&e.jsx(M8,{name:a??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:x},n)]})});ST.displayName=ru;var M8=s=>{const{value:t,...r}=s,n=p.useRef(null),a=Ia(t);return p.useEffect(()=>{const i=n.current,o=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(o,"value").set;if(a!==t&&c){const d=new Event("input",{bubbles:!0});c.call(i,t),i.dispatchEvent(d)}},[a,t]),e.jsx("input",{style:{display:"none"},...r,ref:n,defaultValue:t})};function O8(s=[],t,r){const n=[...s];return n[r]=t,n.sort((a,i)=>a-i)}function CT(s,t,r){const i=100/(r-t)*(s-t);return ji(i,[0,100])}function F8(s,t){return t>2?`Value ${s+1} of ${t}`:t===2?["Minimum","Maximum"][s]:void 0}function L8(s,t){if(s.length===1)return 0;const r=s.map(a=>Math.abs(a-t)),n=Math.min(...r);return r.indexOf(n)}function $8(s,t,r){const n=s/2,i=Ym([0,50],[0,n]);return(n-i(t)*r)*r}function B8(s){return s.slice(0,-1).map((t,r)=>s[r+1]-t)}function V8(s,t){if(t>0){const r=B8(s);return Math.min(...r)>=t}return!0}function Ym(s,t){return r=>{if(s[0]===s[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(s[1]-s[0]);return t[0]+n*(r-s[0])}}function U8(s){return(String(s).split(".")[1]||"").length}function H8(s,t){const r=Math.pow(10,t);return Math.round(s*r)/r}var kT=gT,q8=wT,z8=NT,W8=ST;const ni=p.forwardRef(({className:s,...t},r)=>e.jsxs(kT,{ref:r,className:J("relative flex w-full touch-none select-none items-center",s),...t,children:[e.jsx(q8,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(z8,{className:"absolute h-full bg-primary"})}),e.jsx(W8,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));ni.displayName=kT.displayName;const Ar=[{id:"mat-1",name:"White",color:"#FFFFFF",category:"Standard",manufacturer:"Crescent",price:"2.50",code:"WH123",description:"Pure white matboard"},{id:"mat-2",name:"Black",color:"#000000",category:"Standard",manufacturer:"Crescent",price:"2.50",code:"BK123",description:"Deep black matboard"},{id:"mat-3",name:"Soft Blue",color:"#A4C2F4",category:"Colors",manufacturer:"Crescent",price:"3.00",code:"BL123",description:"Gentle blue matboard"},{id:"mat-4",name:"Forest Green",color:"#38761D",category:"Colors",manufacturer:"Crescent",price:"3.00",code:"GR123",description:"Rich green matboard"},{id:"mat-5",name:"Burgundy",color:"#85200C",category:"Colors",manufacturer:"Crescent",price:"3.00",code:"BU123",description:"Deep red matboard"},{id:"mat-6",name:"Cream",color:"#F9F2E7",category:"Standard",manufacturer:"Crescent",price:"2.50",code:"CR123",description:"Subtle cream matboard"}],Za=[{id:"frame-1",name:"Classic Black",width:"1.25",depth:"0.75",color:"#000000",manufacturer:"Larson",material:"Wood",price:"12.50",catalogImage:"/images/frame-black.jpg",edgeTexture:null,corner:null},{id:"frame-2",name:"Gold Leaf",width:"1.5",depth:"0.75",color:"#D4AF37",manufacturer:"Larson",material:"Metal",price:"15.00",catalogImage:"/images/frame-gold.jpg",edgeTexture:null,corner:null},{id:"frame-3",name:"Walnut",width:"1.0",depth:"0.5",color:"#5C4033",manufacturer:"Roma",material:"Wood",price:"10.00",catalogImage:"/images/frame-walnut.jpg",edgeTexture:null,corner:null},{id:"frame-4",name:"Silver Modern",width:"0.75",depth:"0.5",color:"#C0C0C0",manufacturer:"Nielsen",material:"Metal",price:"9.50",catalogImage:"/images/frame-silver.jpg",edgeTexture:null,corner:null}],K8=()=>{const[s,t]=p.useState(16),[r,n]=p.useState(20),[a,i]=p.useState(!0),[o,l]=p.useState(!1),[c,d]=p.useState([{matboard:Ar[0],position:3,width:2,offset:0},{matboard:Ar[2],position:2,width:.5,offset:.25},{matboard:Ar[4],position:1,width:.25,offset:.25}]),[u,h]=p.useState([{frame:Za[0],position:1,distance:0},{frame:Za[1],position:2,distance:.5}]),m=(f,v)=>{const y=Ar.find(j=>j.id===v);if(y){const j=c.map(b=>b.position===f?{...b,matboard:y}:b);d(j)}},x=(f,v)=>{const y=c.map(j=>j.position===f?{...j,width:v}:j);d(y)},g=(f,v)=>{const y=Za.find(j=>j.id===v);if(y){const j=u.map(b=>b.position===f?{...b,frame:y}:b);h(j)}};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Mat Border Enhancement Demo"}),e.jsx("p",{className:"mb-8 text-muted-foreground",children:"This demo shows the new thin contrast lines along the inside edges of mats, making it easier to distinguish between different mats when using multiple mats."}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsx("div",{className:"lg:col-span-7",children:e.jsxs(V,{className:"shadow-md",children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Frame Preview"}),e.jsx(te,{children:"See how your artwork will look with the selected mats and frames"})]}),e.jsx(q,{className:"flex justify-center items-center",children:e.jsx(lw,{frames:o?u:[u[0]],mats:a?c:[c[0]],artworkWidth:s,artworkHeight:r,artworkImage:null,useMultipleMats:a,useMultipleFrames:o})})]})}),e.jsx("div",{className:"lg:col-span-5",children:e.jsxs(V,{className:"shadow-md",children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Configuration"}),e.jsx(te,{children:"Customize your framing options"})]}),e.jsxs(q,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Artwork Dimensions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"width",children:"Width (inches)"}),e.jsx(U,{id:"width",type:"number",value:s,onChange:f=>t(Number(f.target.value)),min:1,max:60})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"height",children:"Height (inches)"}),e.jsx(U,{id:"height",type:"number",value:r,onChange:f=>n(Number(f.target.value)),min:1,max:60})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(M,{htmlFor:"multiple-mats",children:"Use Multiple Mats"}),e.jsx(br,{id:"multiple-mats",checked:a,onCheckedChange:i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(M,{htmlFor:"multiple-frames",children:"Use Multiple Frames"}),e.jsx(br,{id:"multiple-frames",checked:o,onCheckedChange:l})]})]}),a?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Mat Configuration"}),e.jsxs("div",{className:"space-y-3 p-3 border rounded-md",children:[e.jsx("h4",{className:"font-medium",children:"Bottom Mat (closest to artwork)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"bottom-mat-color",children:"Color"}),e.jsxs(We,{value:c[0].matboard.id.toString(),onValueChange:f=>m(3,Number(f)),children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a color"})}),e.jsx(qe,{children:Ar.map(f=>e.jsx(se,{value:f.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border",style:{backgroundColor:f.color}}),e.jsx("span",{children:f.name})]})},f.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-between",children:e.jsxs(M,{htmlFor:"bottom-mat-width",children:["Width: ",c[0].width,'"']})}),e.jsx(ni,{id:"bottom-mat-width",min:1,max:4,step:.25,value:[c[0].width],onValueChange:f=>x(3,f[0])})]})]}),e.jsxs("div",{className:"space-y-3 p-3 border rounded-md",children:[e.jsx("h4",{className:"font-medium",children:"Middle Mat"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"middle-mat-color",children:"Color"}),e.jsxs(We,{value:c[1].matboard.id,onValueChange:f=>m(2,f),children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a color"})}),e.jsx(qe,{children:Ar.map(f=>e.jsx(se,{value:f.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border",style:{backgroundColor:f.color}}),e.jsx("span",{children:f.name})]})},f.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-between",children:e.jsxs(M,{htmlFor:"middle-mat-width",children:["Width: ",c[1].width,'"']})}),e.jsx(ni,{id:"middle-mat-width",min:.25,max:1,step:.25,value:[c[1].width],onValueChange:f=>x(2,f[0])})]})]}),e.jsxs("div",{className:"space-y-3 p-3 border rounded-md",children:[e.jsx("h4",{className:"font-medium",children:"Top Mat (furthest from artwork)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"top-mat-color",children:"Color"}),e.jsxs(We,{value:c[2].matboard.id,onValueChange:f=>m(1,f),children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a color"})}),e.jsx(qe,{children:Ar.map(f=>e.jsx(se,{value:f.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border",style:{backgroundColor:f.color}}),e.jsx("span",{children:f.name})]})},f.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-between",children:e.jsxs(M,{htmlFor:"top-mat-width",children:["Width: ",c[2].width,'"']})}),e.jsx(ni,{id:"top-mat-width",min:.25,max:1,step:.25,value:[c[2].width],onValueChange:f=>x(1,f[0])})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Single Mat Configuration"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"single-mat-color",children:"Color"}),e.jsxs(We,{value:c[0].matboard.id.toString(),onValueChange:f=>m(3,Number(f)),children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a color"})}),e.jsx(qe,{children:Ar.map(f=>e.jsx(se,{value:f.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border",style:{backgroundColor:f.color}}),e.jsx("span",{children:f.name})]})},f.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-between",children:e.jsxs(M,{htmlFor:"single-mat-width",children:["Width: ",c[0].width,'"']})}),e.jsx(ni,{id:"single-mat-width",min:1,max:4,step:.25,value:[c[0].width],onValueChange:f=>x(3,f[0])})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Frame Configuration"}),e.jsxs("div",{className:"space-y-3 p-3 border rounded-md",children:[e.jsx("h4",{className:"font-medium",children:"Inner Frame"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"inner-frame",children:"Style"}),e.jsxs(We,{value:u[0].frame.id,onValueChange:f=>g(1,f),children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a frame"})}),e.jsx(qe,{children:Za.map(f=>e.jsx(se,{value:f.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-sm border",style:{backgroundColor:f.color}}),e.jsx("span",{children:f.name})]})},f.id))})]})]})]}),o&&e.jsxs("div",{className:"space-y-3 p-3 border rounded-md",children:[e.jsx("h4",{className:"font-medium",children:"Outer Frame"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"outer-frame",children:"Style"}),e.jsxs(We,{value:u[1].frame.id,onValueChange:f=>g(2,f),children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a frame"})}),e.jsx(qe,{children:Za.map(f=>e.jsx(se,{value:f.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-sm border",style:{backgroundColor:f.color}}),e.jsx("span",{children:f.name})]})},f.id))})]})]})]})]})]}),e.jsx(ht,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notice the thin contrast lines along the inside edges of each mat, making it easier to distinguish the different mat layers."})})]})})]})]})};function G8(){const{toast:s}=Be(),[t,r]=p.useState([{name:"Database Connection",status:"checking",message:"Checking database connectivity...",lastChecked:new Date},{name:"Larson Catalog API",status:"checking",message:"Testing Larson wholesale catalog...",lastChecked:new Date},{name:"Nielsen Catalog API",status:"checking",message:"Testing Nielsen catalog...",lastChecked:new Date},{name:"Roma Catalog API",status:"checking",message:"Testing Roma catalog...",lastChecked:new Date},{name:"Frame Design Image System",status:"checking",message:"Testing frame design image saving...",lastChecked:new Date}]),[n,a]=p.useState(!1),[i,o]=p.useState(!0),l=async()=>{a(!0);const m=[];try{const f=performance.now(),v=await fetch("/api/auth/status"),y=performance.now();v.ok?m.push({name:"Database Connection",status:"healthy",message:"Database is connected and responding",lastChecked:new Date,responseTime:Math.round(y-f)}):m.push({name:"Database Connection",status:"error",message:"Database connection failed",lastChecked:new Date})}catch{m.push({name:"Database Connection",status:"error",message:"Unable to connect to database",lastChecked:new Date})}try{const f=performance.now(),v=await fetch("/api/vendor-catalog/larson"),y=performance.now();if(v.ok){const j=await v.json();j&&j.length>0?m.push({name:"Larson Catalog API",status:"healthy",message:`Larson catalog loaded: ${j.length} items`,lastChecked:new Date,responseTime:Math.round(y-f)}):m.push({name:"Larson Catalog API",status:"warning",message:"Larson catalog is empty",lastChecked:new Date,responseTime:Math.round(y-f)})}else m.push({name:"Larson Catalog API",status:"error",message:"Larson catalog API failed",lastChecked:new Date})}catch{m.push({name:"Larson Catalog API",status:"error",message:"Unable to reach Larson catalog",lastChecked:new Date})}try{const f=performance.now(),v=await fetch("/api/vendor-catalog/nielsen"),y=performance.now();if(v.ok){const j=await v.json();j&&j.length>0?m.push({name:"Nielsen Catalog API",status:"healthy",message:`Nielsen catalog loaded: ${j.length} items`,lastChecked:new Date,responseTime:Math.round(y-f)}):m.push({name:"Nielsen Catalog API",status:"warning",message:"Nielsen catalog is empty",lastChecked:new Date,responseTime:Math.round(y-f)})}else m.push({name:"Nielsen Catalog API",status:"error",message:"Nielsen catalog API failed",lastChecked:new Date})}catch{m.push({name:"Nielsen Catalog API",status:"error",message:"Unable to reach Nielsen catalog",lastChecked:new Date})}try{const f=performance.now(),v=await fetch("/api/vendor-catalog/roma"),y=performance.now();if(v.ok){const j=await v.json();j&&j.length>0?m.push({name:"Roma Catalog API",status:"healthy",message:`Roma catalog loaded: ${j.length} items`,lastChecked:new Date,responseTime:Math.round(y-f)}):m.push({name:"Roma Catalog API",status:"warning",message:"Roma catalog is empty",lastChecked:new Date,responseTime:Math.round(y-f)})}else m.push({name:"Roma Catalog API",status:"error",message:"Roma catalog API failed",lastChecked:new Date})}catch{m.push({name:"Roma Catalog API",status:"error",message:"Unable to reach Roma catalog",lastChecked:new Date})}try{const f=document.createElement("canvas"),v=f.getContext("2d");if(v){f.width=100,f.height=100,v.fillStyle="#000",v.fillRect(0,0,100,100);const y=f.toDataURL("image/jpeg",.85);y&&y.startsWith("data:image/")?m.push({name:"Frame Design Image System",status:"healthy",message:"Frame design image saving is working",lastChecked:new Date}):m.push({name:"Frame Design Image System",status:"error",message:"Frame design image generation failed",lastChecked:new Date})}else m.push({name:"Frame Design Image System",status:"error",message:"Canvas context not available",lastChecked:new Date})}catch{m.push({name:"Frame Design Image System",status:"error",message:"Frame design image system error",lastChecked:new Date})}r(m),a(!1);const x=m.filter(f=>f.status==="error").length,g=m.filter(f=>f.status==="warning").length;x>0?s({title:"System Health Alert",description:`${x} critical issue(s) detected`,variant:"destructive"}):g>0?s({title:"System Health Warning",description:`${g} warning(s) detected`,variant:"default"}):s({title:"System Health Good",description:"All systems are running smoothly",variant:"default"})};p.useEffect(()=>{if(i){l();const m=setInterval(l,3e4);return()=>clearInterval(m)}},[i]);const c=m=>{switch(m){case"healthy":return e.jsx(Gs,{className:"h-5 w-5 text-green-500"});case"warning":return e.jsx(Ht,{className:"h-5 w-5 text-yellow-500"});case"error":return e.jsx(Bn,{className:"h-5 w-5 text-red-500"});case"checking":return e.jsx(ir,{className:"h-5 w-5 text-blue-500 animate-spin"});default:return e.jsx(Ht,{className:"h-5 w-5 text-gray-500"})}},d=m=>{switch(m){case"healthy":return e.jsx(ue,{variant:"default",className:"bg-green-100 text-green-800",children:"Healthy"});case"warning":return e.jsx(ue,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Warning"});case"error":return e.jsx(ue,{variant:"destructive",children:"Error"});case"checking":return e.jsx(ue,{variant:"outline",children:"Checking..."});default:return e.jsx(ue,{variant:"outline",children:"Unknown"})}},u=m=>m.includes("Database")?e.jsx(Nl,{className:"h-4 w-4"}):m.includes("Image")?e.jsx(fi,{className:"h-4 w-4"}):e.jsx(pu,{className:"h-4 w-4"}),h=t.every(m=>m.status==="healthy")?"healthy":t.some(m=>m.status==="error")?"error":"warning";return e.jsxs(V,{className:"w-full",children:[e.jsx(G,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c(h),e.jsx(Q,{children:"System Health Monitor"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>o(!i),children:i?"Auto: ON":"Auto: OFF"}),e.jsxs(P,{variant:"outline",size:"sm",onClick:l,disabled:n,children:[n?e.jsx(ir,{className:"h-4 w-4 animate-spin"}):e.jsx(ir,{className:"h-4 w-4"}),"Refresh"]})]})]})}),e.jsxs(q,{children:[e.jsx("div",{className:"space-y-4",children:t.map((m,x)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[u(m.name),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:m.name}),d(m.status)]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.message}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Last checked: ",m.lastChecked.toLocaleTimeString(),m.responseTime&&` (${m.responseTime}ms)`]})]})]}),c(m.status)]},x))}),e.jsx("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"This monitor continuously checks your framing business's critical systems to ensure smooth operation when serving customers. Auto-refresh checks every 30 seconds, or click Refresh for immediate updates."})})]})]})}function Q8(){return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"System Health Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Real-time monitoring of your framing business's critical systems"})]}),e.jsx(G8,{})]})}const Z8=({orderId:s,customerId:t,defaultMessage:r})=>{const[n,a]=p.useState(r||""),[i,o]=p.useState("order_update"),[l,c]=p.useState(""),[d,u]=p.useState(""),[h,m]=p.useState(!1),[x,g]=p.useState(null),f={order_update:"Hi! Your custom frame order has been updated. We're currently working on your piece and making great progress!",completion_notice:"Great news! Your custom frame is ready for pickup. Please come by the shop at your convenience.",estimate_update:"We wanted to update you on the timeline for your custom frame. Your piece is progressing nicely!",custom:""},v=async()=>{if(!n.trim()){js({title:"Message Required",description:"Please enter a message to send",variant:"destructive"});return}m(!0);try{if((await fetch("/api/test/test-customer-notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:t||1,orderId:s||Math.floor(Math.random()*1e3),type:i,email:l||"customer@jaysframes.com",discordUsername:d,message:n})})).ok)js({title:"Notification Sent!",description:"Customer has been notified via Discord and email"}),g(new Date().toLocaleTimeString()),a("");else throw new Error("Failed to send notification")}catch{js({title:"Failed to Send",description:"There was an error sending the notification",variant:"destructive"})}finally{m(!1)}},y=j=>{o(j),a(f[j])};return e.jsxs(V,{className:"w-full max-w-2xl mx-auto",children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(xj,{className:"w-5 h-5"}),"Quick Customer Notification"]}),x&&e.jsxs(ue,{variant:"outline",className:"w-fit",children:[e.jsx(Gs,{className:"w-3 h-3 mr-1"}),"Last sent: ",x]})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{className:"text-sm font-medium mb-2 block",children:"Quick Templates"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(f).map(([j,b])=>e.jsx(P,{variant:"outline",size:"sm",onClick:()=>y(j),className:"text-xs",children:j.replace("_"," ").replace(/\b\w/g,k=>k.toUpperCase())},j))})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"messageType",children:"Notification Type"}),e.jsxs(We,{value:i,onValueChange:j=>o(j),children:[e.jsx(He,{children:e.jsx(Ke,{})}),e.jsxs(qe,{children:[e.jsx(se,{value:"order_update",children:"Order Progress Update"}),e.jsx(se,{value:"completion_notice",children:"Ready for Pickup"}),e.jsx(se,{value:"estimate_update",children:"Timeline Update"}),e.jsx(se,{value:"custom",children:"Custom Message"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"customerEmail",children:"Customer Email"}),e.jsx(U,{id:"customerEmail",value:l,onChange:j=>c(j.target.value),placeholder:"customer@example.com"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"discordUsername",children:"Discord Username (Optional)"}),e.jsx(U,{id:"discordUsername",value:d,onChange:j=>u(j.target.value),placeholder:"@username"})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"message",children:"Message"}),e.jsx(Zs,{id:"message",value:n,onChange:j=>a(j.target.value),placeholder:"Enter your message to the customer...",rows:4})]}),e.jsx(P,{onClick:v,disabled:h,className:"w-full",size:"lg",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Sr,{className:"w-4 h-4 mr-2"}),"Send Notification"]})}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-start gap-2",children:[e.jsx(Ht,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"This will send notifications via Discord (if username provided), email, and in-app notifications. SMS will be available once Twilio approval is complete."})]})]})]})};function Y8(){const[s,t]=p.useState(!1),[r,n]=p.useState({customerId:"",orderId:"",type:"order_update",email:"",phone:"",discordUserId:"",message:"",title:"",channels:{email:!0,discord:!1,inApp:!0,sms:!1}}),a=[{value:"order_update",label:"Order Status Update"},{value:"completion",label:"Order Completion Notice"},{value:"estimate",label:"Estimate Update"},{value:"custom",label:"Custom Message"}],i=(d,u)=>{n(h=>({...h,[d]:u}))},o=(d,u)=>{n(h=>({...h,channels:{...h.channels,[d]:u}}))},l=async(d=!1)=>{t(!0);try{const u=d?"/api/test-notifications/test-customer-notification":"/api/notifications/send-customer-notification",h={customerId:parseInt(r.customerId)||1,orderId:parseInt(r.orderId)||123,type:r.type,email:r.email,phone:r.phone,discordUserId:r.discordUserId,message:r.message,title:r.title,channels:r.channels},m=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)}),x=await m.json();if(m.ok)js({title:d?"Test Notification Sent!":"Notification Sent!",description:`Successfully sent ${r.type} notification`,variant:"default"});else throw new Error(x.error||"Failed to send notification")}catch(u){js({title:"Error",description:u instanceof Error?u.message:"Failed to send notification",variant:"destructive"})}finally{t(!1)}},c=()=>{n({customerId:"1",orderId:"123",type:"order_update",email:"test@jaysframes.com",phone:"",discordUserId:"",message:"Your custom frame is now being crafted by our artisans.",title:"Frame Production Update",channels:{email:!0,discord:!1,inApp:!0,sms:!1}})};return e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Fr,{className:"h-6 w-6"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Notification Center"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Send Customer Notification"}),e.jsx(CardDescription,{children:"Send notifications to customers via email, Discord, SMS, or in-app alerts"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"customerId",children:"Customer ID"}),e.jsx(U,{id:"customerId",value:r.customerId,onChange:d=>i("customerId",d.target.value),placeholder:"1"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"orderId",children:"Order ID"}),e.jsx(U,{id:"orderId",value:r.orderId,onChange:d=>i("orderId",d.target.value),placeholder:"123"})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"type",children:"Notification Type"}),e.jsxs(We,{value:r.type,onValueChange:d=>i("type",d),children:[e.jsx(He,{children:e.jsx(Ke,{})}),e.jsx(qe,{children:a.map(d=>e.jsx(se,{value:d.value,children:d.label},d.value))})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"email",children:"Email"}),e.jsx(U,{id:"email",type:"email",value:r.email,onChange:d=>i("email",d.target.value),placeholder:"customer@example.com"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"phone",children:"Phone (for SMS)"}),e.jsx(U,{id:"phone",value:r.phone,onChange:d=>i("phone",d.target.value),placeholder:"+1234567890"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"discordUserId",children:"Discord User ID"}),e.jsx(U,{id:"discordUserId",value:r.discordUserId,onChange:d=>i("discordUserId",d.target.value),placeholder:"123456789012345678"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"title",children:"Title"}),e.jsx(U,{id:"title",value:r.title,onChange:d=>i("title",d.target.value),placeholder:"Order Update"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"message",children:"Message"}),e.jsx(Zs,{id:"message",value:r.message,onChange:d=>i("message",d.target.value),placeholder:"Your frame is being processed...",rows:4})]}),e.jsxs("div",{children:[e.jsx(M,{className:"text-base font-medium",children:"Notification Channels"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(os,{id:"email-channel",checked:r.channels.email,onCheckedChange:d=>o("email",!!d)}),e.jsx(M,{htmlFor:"email-channel",children:"Email"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(os,{id:"discord-channel",checked:r.channels.discord,onCheckedChange:d=>o("discord",!!d)}),e.jsx(M,{htmlFor:"discord-channel",children:"Discord"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(os,{id:"inapp-channel",checked:r.channels.inApp,onCheckedChange:d=>o("inApp",!!d)}),e.jsx(M,{htmlFor:"inapp-channel",children:"In-App"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(os,{id:"sms-channel",checked:r.channels.sms,onCheckedChange:d=>o("sms",!!d)}),e.jsx(M,{htmlFor:"sms-channel",children:"SMS"})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(P,{onClick:c,variant:"outline",className:"flex-1",children:[e.jsx(Yc,{className:"h-4 w-4 mr-2"}),"Fill Test Data"]}),e.jsxs(P,{onClick:()=>l(!0),disabled:s,variant:"outline",className:"flex-1",children:[e.jsx(Sr,{className:"h-4 w-4 mr-2"}),"Test Send"]}),e.jsxs(P,{onClick:()=>l(!1),disabled:s,className:"flex-1",children:[e.jsx(Sr,{className:"h-4 w-4 mr-2"}),"Send Live"]})]})]})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Quick Actions"}),e.jsx(CardDescription,{children:"Common notification templates and actions"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsx(P,{className:"w-full justify-start",variant:"outline",onClick:()=>{n(d=>({...d,type:"order_update",title:"Production Update",message:"Your frame is now in production and being carefully crafted by our artisans."}))},children:"📦 Production Started"}),e.jsx(P,{className:"w-full justify-start",variant:"outline",onClick:()=>{n(d=>({...d,type:"completion",title:"Order Complete",message:"Great news! Your custom frame is ready for pickup at our studio."}))},children:"✅ Order Complete"}),e.jsx(P,{className:"w-full justify-start",variant:"outline",onClick:()=>{n(d=>({...d,type:"estimate",title:"Timeline Update",message:"We wanted to update you on your frame timeline."}))},children:"⏰ Timeline Update"}),e.jsx(P,{className:"w-full justify-start",variant:"outline",onClick:()=>{n(d=>({...d,type:"custom",title:"Quality Check",message:"Your frame has passed our rigorous quality inspection and looks amazing!"}))},children:"🔍 Quality Check"})]})]}),e.jsx(Z8,{})]})]})}function X8(){var f;const{toast:s}=Be(),[t,r]=p.useState(null),[n,a]=p.useState([]),[i,o]=p.useState(""),[l,c]=p.useState(""),[d,u]=p.useState(!1);p.useEffect(()=>{h(),m()},[]);const h=async()=>{try{const y=await(await fetch("/api/kanban/status")).json();y.success&&r(y.status)}catch(v){console.error("Error fetching Kanban status:",v)}},m=async()=>{try{const y=await(await fetch("/api/orders")).json();y.success&&a(y.orders||[])}catch(v){console.error("Error fetching orders:",v)}},x=async()=>{if(!i){s({title:"Order Required",description:"Please select an order to test synchronization.",variant:"destructive"});return}u(!0),c("");try{const y=await(await fetch(`/api/orders/${i}/test-kanban-sync`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();y.success?(c("success"),s({title:"Sync Successful",description:`Order ${i} synced to Kanban successfully`})):(c("error"),s({title:"Sync Failed",description:y.error||"Failed to sync order to Kanban",variant:"destructive"}))}catch{c("error"),s({title:"Sync Error",description:"Network error occurred during sync test",variant:"destructive"})}finally{u(!1)}},g=async(v,y)=>{try{const b=await(await fetch(`/api/orders/${v}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:y,notes:`Status updated via Kanban test interface to ${y}`})})).json();b.success?(s({title:"Status Updated",description:`Order ${v} status updated to ${y} and synced to Kanban`}),m()):s({title:"Update Failed",description:b.error||"Failed to update order status",variant:"destructive"})}catch{s({title:"Update Error",description:"Failed to update order status",variant:"destructive"})}};return e.jsxs("div",{className:"container mx-auto py-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J2,{className:"h-6 w-6"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Kanban Integration Test"})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(yi,{className:"h-5 w-5"}),"Kanban Connection Status"]}),e.jsx(te,{children:"Current status of the Kanban app integration"})]}),e.jsx(q,{className:"space-y-4",children:t?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Connection Status"}),e.jsx(ue,{variant:t.configured?"default":"destructive",children:t.configured?"Configured":"Not Configured"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"API Key Status"}),e.jsx(ue,{variant:t.hasApiKey?"default":"destructive",children:t.hasApiKey?"Present":"Missing"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"API URL"}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:t.apiUrl||"Not configured"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Orders Endpoint"}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:((f=t.endpoints)==null?void 0:f.orders)||"Not available"})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ir,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Loading Kanban status..."})]})})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(Yc,{className:"h-5 w-5"}),"Test Order Synchronization"]}),e.jsx(te,{children:"Test syncing a specific order to the Kanban app"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"order-select",children:"Select Order to Test"}),e.jsxs("select",{id:"order-select",value:i,onChange:v=>o(v.target.value),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Choose an order..."}),n.map(v=>e.jsxs("option",{value:v.id,children:["Order #",v.id," - ",v.artworkDescription," (",v.productionStatus,")"]},v.id))]})]}),e.jsx(P,{onClick:x,disabled:!i||d,className:"w-full",children:d?e.jsxs(e.Fragment,{children:[e.jsx(ir,{className:"h-4 w-4 mr-2 animate-spin"}),"Testing Sync..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Yc,{className:"h-4 w-4 mr-2"}),"Test Order Sync"]})}),l&&e.jsxs(hs,{children:[l==="success"?e.jsx(Gs,{className:"h-4 w-4"}):e.jsx(Bn,{className:"h-4 w-4"}),e.jsx(Ys,{children:l==="success"?"Sync Successful":"Sync Failed"}),e.jsx(ps,{children:l==="success"?"Order has been successfully synced to the Kanban app.":"Failed to sync order to Kanban app. Check the connection settings."})]})]})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Test Status Updates"}),e.jsx(te,{children:"Update order status and test Kanban synchronization"})]}),e.jsx(q,{children:e.jsx("div",{className:"grid gap-4",children:n.slice(0,3).map(v=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Order #",v.id]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[v.artworkDescription," - ",v.artworkWidth,"x",v.artworkHeight]}),e.jsx(ue,{variant:"outline",className:"mt-1",children:v.productionStatus})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>g(v.id.toString(),"in_production"),children:"Set In Production"}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>g(v.id.toString(),"completed"),children:"Set Completed"})]})]},v.id))})})]})]})}function J8(){const[s,t]=p.useState(""),[r,n]=p.useState(""),[a,i]=p.useState("alice"),[o,l]=p.useState(""),[c,d]=p.useState(""),[u,h]=p.useState(""),[m,x]=p.useState(""),[g,f]=p.useState([]),{toast:v}=Be();Zt();const{data:y,isLoading:j}=me({queryKey:["/api/voice-calls/configuration"],queryFn:async()=>{const $=await fetch("/api/voice-calls/configuration");if(!$.ok)throw new Error("Failed to fetch configuration");return $.json()}}),b=Ce({mutationFn:async $=>{const ae=await fetch("/api/voice-calls/make-call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!ae.ok)throw new Error("Failed to make call");return ae.json()},onSuccess:$=>{v({title:"Call Initiated",description:`Voice call to ${s} started successfully`}),C("custom",s,$.callSid,"initiated"),t(""),n("")},onError:$=>{v({title:"Call Failed",description:$.message||"Failed to initiate voice call",variant:"destructive"})}}),k=Ce({mutationFn:async $=>{const ae=await fetch("/api/voice-calls/order-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!ae.ok)throw new Error("Failed to make order status call");return ae.json()},onSuccess:$=>{v({title:"Order Status Call Initiated",description:`Called customer about order ${o}`}),C("order-status",s,$.callSid,"initiated")},onError:$=>{v({title:"Call Failed",description:$.message||"Failed to make order status call",variant:"destructive"})}}),S=Ce({mutationFn:async $=>{const ae=await fetch("/api/voice-calls/payment-reminder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!ae.ok)throw new Error("Failed to make payment reminder call");return ae.json()},onSuccess:$=>{v({title:"Payment Reminder Call Initiated",description:`Called ${c} about payment`}),C("payment-reminder",s,$.callSid,"initiated")},onError:$=>{v({title:"Call Failed",description:$.message||"Failed to make payment reminder call",variant:"destructive"})}}),A=Ce({mutationFn:async $=>{const ae=await fetch("/api/voice-calls/pickup-reminder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!ae.ok)throw new Error("Failed to make pickup reminder call");return ae.json()},onSuccess:$=>{v({title:"Pickup Reminder Call Initiated",description:`Called ${c} about pickup`}),C("pickup-reminder",s,$.callSid,"initiated")},onError:$=>{v({title:"Call Failed",description:$.message||"Failed to make pickup reminder call",variant:"destructive"})}}),T=Ce({mutationFn:async $=>{const ae=await fetch("/api/voice-calls/order-complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!ae.ok)throw new Error("Failed to make order complete call");return ae.json()},onSuccess:$=>{v({title:"Order Complete Call Initiated",description:`Called ${c} about order completion`}),C("order-complete",s,$.callSid,"initiated")},onError:$=>{v({title:"Call Failed",description:$.message||"Failed to make order complete call",variant:"destructive"})}}),C=($,ae,O,ne)=>{const Pe={id:Date.now().toString(),to:ae,callSid:O,type:$,status:ne,timestamp:new Date().toISOString()};f(st=>[Pe,...st.slice(0,9)])},E=$=>{const ae=$.replace(/\D/g,"");return ae.length===10?`+1${ae}`:$.startsWith("+")?$:`+${ae}`},D=()=>{if(!s||!r){v({title:"Missing Information",description:"Please enter both phone number and message",variant:"destructive"});return}b.mutate({to:E(s),message:r,voice:a})},w=()=>{if(!s||!o){v({title:"Missing Information",description:"Please enter phone number and order number",variant:"destructive"});return}k.mutate({to:E(s),orderNumber:o,status:"ready for pickup"})},N=()=>{if(!s||!c||!u||!o){v({title:"Missing Information",description:"Please fill in all payment reminder fields",variant:"destructive"});return}S.mutate({to:E(s),customerName:c,amount:parseFloat(u),orderNumber:o})},_=()=>{if(!s||!c||!o||!m){v({title:"Missing Information",description:"Please fill in all pickup reminder fields",variant:"destructive"});return}A.mutate({to:E(s),customerName:c,orderNumber:o,daysWaiting:parseInt(m)})},F=()=>{if(!s||!c||!o){v({title:"Missing Information",description:"Please fill in all order complete fields",variant:"destructive"});return}T.mutate({to:E(s),customerName:c,orderNumber:o})},W=$=>{switch($){case"initiated":case"queued":case"ringing":return e.jsx(vt,{className:"h-4 w-4 text-yellow-500"});case"in-progress":return e.jsx(eP,{className:"h-4 w-4 text-blue-500"});case"completed":return e.jsx(Gs,{className:"h-4 w-4 text-green-500"});case"failed":case"busy":case"no-answer":return e.jsx(Bn,{className:"h-4 w-4 text-red-500"});default:return e.jsx(Ht,{className:"h-4 w-4 text-gray-500"})}},Z=$=>{switch($){case"completed":return"default";case"failed":case"busy":case"no-answer":return"destructive";case"initiated":case"queued":case"ringing":case"in-progress":return"secondary";default:return"outline"}};return j?e.jsx("div",{className:"p-4",children:"Loading voice call configuration..."}):y!=null&&y.configured?e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Voice Call Manager"}),e.jsx("p",{className:"text-gray-600",children:"Make automated voice calls to customers"})]}),e.jsxs(ue,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(Hs,{className:"h-3 w-3 mr-1"}),"Twilio Connected"]})]}),e.jsxs(qt,{defaultValue:"custom",className:"space-y-4",children:[e.jsxs($t,{className:"grid w-full grid-cols-5",children:[e.jsx(ve,{value:"custom",children:"Custom Call"}),e.jsx(ve,{value:"order-status",children:"Order Status"}),e.jsx(ve,{value:"payment",children:"Payment"}),e.jsx(ve,{value:"pickup",children:"Pickup"}),e.jsx(ve,{value:"complete",children:"Order Complete"})]}),e.jsx(Ae,{value:"custom",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Custom Voice Call"}),e.jsx(te,{children:"Make a personalized voice call with your own message"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"phone",children:"Phone Number"}),e.jsx(U,{id:"phone",placeholder:"+1234567890",value:s,onChange:$=>t($.target.value)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"voice",children:"Voice"}),e.jsxs(We,{value:a,onValueChange:i,children:[e.jsx(He,{children:e.jsx(Ke,{})}),e.jsxs(qe,{children:[e.jsx(se,{value:"alice",children:"Alice (Default)"}),e.jsx(se,{value:"man",children:"Man"}),e.jsx(se,{value:"woman",children:"Woman"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"message",children:"Message"}),e.jsx(Zs,{id:"message",placeholder:"Enter your custom message here...",value:r,onChange:$=>n($.target.value),rows:4})]}),e.jsxs(P,{onClick:D,disabled:b.isPending,className:"w-full",children:[e.jsx(Hs,{className:"h-4 w-4 mr-2"}),b.isPending?"Making Call...":"Make Voice Call"]})]})]})}),e.jsx(Ae,{value:"order-status",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Order Status Update Call"}),e.jsx(te,{children:"Call customer with order status update"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"phone-order",children:"Phone Number"}),e.jsx(U,{id:"phone-order",placeholder:"+1234567890",value:s,onChange:$=>t($.target.value)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"order-number",children:"Order Number"}),e.jsx(U,{id:"order-number",placeholder:"ORD-001",value:o,onChange:$=>l($.target.value)})]})]}),e.jsxs(P,{onClick:w,disabled:k.isPending,className:"w-full",children:[e.jsx(Hs,{className:"h-4 w-4 mr-2"}),k.isPending?"Making Call...":"Call Order Status"]})]})]})}),e.jsx(Ae,{value:"payment",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Payment Reminder Call"}),e.jsx(te,{children:"Call customer about outstanding payment"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"phone-payment",children:"Phone Number"}),e.jsx(U,{id:"phone-payment",placeholder:"+1234567890",value:s,onChange:$=>t($.target.value)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"customer-name",children:"Customer Name"}),e.jsx(U,{id:"customer-name",placeholder:"John Doe",value:c,onChange:$=>d($.target.value)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"amount",children:"Amount Due"}),e.jsx(U,{id:"amount",placeholder:"125.00",type:"number",step:"0.01",value:u,onChange:$=>h($.target.value)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"order-number-payment",children:"Order Number"}),e.jsx(U,{id:"order-number-payment",placeholder:"ORD-001",value:o,onChange:$=>l($.target.value)})]})]}),e.jsxs(P,{onClick:N,disabled:S.isPending,className:"w-full",children:[e.jsx(Hs,{className:"h-4 w-4 mr-2"}),S.isPending?"Making Call...":"Call Payment Reminder"]})]})]})}),e.jsx(Ae,{value:"pickup",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Pickup Reminder Call"}),e.jsx(te,{children:"Call customer about ready order pickup"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"phone-pickup",children:"Phone Number"}),e.jsx(U,{id:"phone-pickup",placeholder:"+1234567890",value:s,onChange:$=>t($.target.value)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"customer-name-pickup",children:"Customer Name"}),e.jsx(U,{id:"customer-name-pickup",placeholder:"John Doe",value:c,onChange:$=>d($.target.value)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"order-number-pickup",children:"Order Number"}),e.jsx(U,{id:"order-number-pickup",placeholder:"ORD-001",value:o,onChange:$=>l($.target.value)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"days-waiting",children:"Days Waiting"}),e.jsx(U,{id:"days-waiting",placeholder:"3",type:"number",value:m,onChange:$=>x($.target.value)})]})]}),e.jsxs(P,{onClick:_,disabled:A.isPending,className:"w-full",children:[e.jsx(Hs,{className:"h-4 w-4 mr-2"}),A.isPending?"Making Call...":"Call Pickup Reminder"]})]})]})}),e.jsx(Ae,{value:"complete",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Order Complete Call"}),e.jsx(te,{children:"Call customer when order is ready for pickup"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"phone-complete",children:"Phone Number"}),e.jsx(U,{id:"phone-complete",placeholder:"+1234567890",value:s,onChange:$=>t($.target.value)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"customer-name-complete",children:"Customer Name"}),e.jsx(U,{id:"customer-name-complete",placeholder:"John Doe",value:c,onChange:$=>d($.target.value)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"order-number-complete",children:"Order Number"}),e.jsx(U,{id:"order-number-complete",placeholder:"ORD-001",value:o,onChange:$=>l($.target.value)})]})]}),e.jsxs(P,{onClick:F,disabled:T.isPending,className:"w-full",children:[e.jsx(Hs,{className:"h-4 w-4 mr-2"}),T.isPending?"Making Call...":"Call Order Complete"]})]})]})})]}),g.length>0&&e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Recent Call Log"}),e.jsx(te,{children:"Last 10 voice calls made"})]}),e.jsx(q,{children:e.jsx("div",{className:"space-y-2",children:g.map($=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[W($.status),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.to}),e.jsx("p",{className:"text-sm text-gray-600 capitalize",children:$.type.replace("-"," ")})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(ue,{variant:Z($.status),children:$.status}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date($.timestamp).toLocaleString()})]})]},$.id))})})]})]}):e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"h-5 w-5"}),"Voice Call System"]}),e.jsx(te,{children:"Twilio voice calling is not configured"})]}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 border rounded-lg bg-yellow-50",children:e.jsx("p",{className:"text-sm text-yellow-800",children:(y==null?void 0:y.message)||"Voice calling requires Twilio credentials to be configured."})}),e.jsx("p",{className:"text-sm text-gray-600",children:"Contact your administrator to set up Twilio credentials for voice calling functionality."})]})})]})})}function eV(){var D,w,N,_;const[s,t]=p.useState(""),[r,n]=p.useState(""),[a,i]=p.useState("Test Customer"),[o,l]=p.useState("AUTO-001"),[c,d]=p.useState("125.50"),[u,h]=p.useState("3"),[m,x]=p.useState(""),{toast:g}=Be();Zt();const{data:f,isLoading:v}=me({queryKey:["/api/order-notifications/status"],queryFn:async()=>{const F=await fetch("/api/order-notifications/status");if(!F.ok)throw new Error("Failed to fetch notification status");return F.json()}}),y=Ce({mutationFn:async F=>{const W=await fetch("/api/order-notifications/trigger",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(!W.ok)throw new Error("Failed to trigger notification");return W.json()},onSuccess:F=>{g({title:"Notification Sent",description:F.message})},onError:F=>{g({title:"Notification Failed",description:F.message||"Failed to send notification",variant:"destructive"})}}),j=Ce({mutationFn:async F=>{const W=await fetch("/api/order-notifications/schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(!W.ok)throw new Error("Failed to schedule notification");return W.json()},onSuccess:F=>{g({title:"Notification Scheduled",description:F.message})},onError:F=>{g({title:"Scheduling Failed",description:F.message||"Failed to schedule notification",variant:"destructive"})}}),b=Ce({mutationFn:async F=>{const W=await fetch("/api/order-notifications/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(!W.ok)throw new Error("Failed to send test notification");return W.json()},onSuccess:F=>{g({title:"Test Notification Sent",description:F.message})},onError:F=>{g({title:"Test Failed",description:F.message||"Failed to send test notification",variant:"destructive"})}}),k=()=>{if(!s||!r){g({title:"Missing Information",description:"Please fill in phone number and select event type",variant:"destructive"});return}const F={orderId:"AUTO-001",orderNumber:o,customerName:a,customerPhone:s,eventType:r,metadata:{amount:parseFloat(c),daysWaiting:parseInt(u),dueDate:"Friday",estimatedCompletion:"2-3 business days"}};y.mutate(F)},S=()=>{if(!s||!r||!m){g({title:"Missing Information",description:"Please fill in all fields for scheduling",variant:"destructive"});return}const F={orderId:"AUTO-001",orderNumber:o,customerName:a,customerPhone:s,eventType:r,delayMinutes:parseInt(m),metadata:{amount:parseFloat(c),daysWaiting:parseInt(u),dueDate:"Friday",estimatedCompletion:"2-3 business days"}};j.mutate(F)},A=()=>{if(!s){g({title:"Missing Phone Number",description:"Please enter a phone number for testing",variant:"destructive"});return}b.mutate({phone:s,eventType:r||"ready_for_pickup"})},T=F=>{const W=F.replace(/\D/g,"");return W.length===10?`+1${W}`:F.startsWith("+")?F:`+${W}`},C=()=>v?e.jsx(vt,{className:"h-5 w-5 text-yellow-500"}):f!=null&&f.configured?e.jsx(Gs,{className:"h-5 w-5 text-green-500"}):e.jsx(Bn,{className:"h-5 w-5 text-red-500"}),E=()=>v?"Checking status...":f!=null&&f.configured?"System Ready":"Configuration Required";return v?e.jsx("div",{className:"p-4",children:"Loading automated notification system..."}):e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(Fr,{className:"h-8 w-8"}),"Automated Order Notifications"]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Set up voice calls for order events like completion, payment reminders, and pickup notifications"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[C(),e.jsx("span",{className:"font-medium",children:E()})]})]}),e.jsxs(qt,{defaultValue:"trigger",className:"space-y-6",children:[e.jsxs($t,{className:"grid w-full grid-cols-4",children:[e.jsx(ve,{value:"trigger",children:"Trigger Now"}),e.jsx(ve,{value:"schedule",children:"Schedule Later"}),e.jsx(ve,{value:"events",children:"Event Types"}),e.jsx(ve,{value:"integration",children:"Integration"})]}),e.jsx(Ae,{value:"trigger",className:"space-y-6",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"h-5 w-5"}),"Trigger Immediate Notification"]}),e.jsx(te,{children:"Send a voice call notification immediately for testing or urgent notifications"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"phone",children:"Phone Number"}),e.jsx(U,{id:"phone",placeholder:"+1234567890",value:s,onChange:F=>t(F.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"eventType",children:"Event Type"}),e.jsxs(We,{value:r,onValueChange:n,children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select event type"})}),e.jsx(qe,{children:(D=f==null?void 0:f.supportedEventTypes)==null?void 0:D.map(F=>e.jsx(se,{value:F.type,children:F.description},F.type))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"customerName",children:"Customer Name"}),e.jsx(U,{id:"customerName",value:a,onChange:F=>i(F.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"orderNumber",children:"Order Number"}),e.jsx(U,{id:"orderNumber",value:o,onChange:F=>l(F.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"amount",children:"Amount (for payment reminders)"}),e.jsx(U,{id:"amount",type:"number",step:"0.01",value:c,onChange:F=>d(F.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"daysWaiting",children:"Days Waiting (for pickup reminders)"}),e.jsx(U,{id:"daysWaiting",type:"number",value:u,onChange:F=>h(F.target.value)})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(P,{onClick:k,disabled:y.isPending,className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"h-4 w-4"}),y.isPending?"Sending...":"Send Notification"]}),e.jsx(P,{variant:"outline",onClick:A,disabled:b.isPending,children:b.isPending?"Testing...":"Quick Test"})]})]})]})}),e.jsx(Ae,{value:"schedule",className:"space-y-6",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-5 w-5"}),"Schedule Delayed Notification"]}),e.jsx(te,{children:"Schedule notifications for future delivery (useful for pickup reminders, follow-ups)"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"delayMinutes",children:"Delay (minutes)"}),e.jsx(U,{id:"delayMinutes",type:"number",placeholder:"5",value:m,onChange:F=>x(F.target.value)})]}),e.jsxs(P,{onClick:S,disabled:j.isPending,className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4"}),j.isPending?"Scheduling...":"Schedule Notification"]})]})]})}),e.jsx(Ae,{value:"events",className:"space-y-6",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Supported Event Types"}),e.jsx(te,{children:"These events can trigger automated voice notifications to customers"})]}),e.jsx(q,{children:e.jsx("div",{className:"grid gap-4",children:(w=f==null?void 0:f.supportedEventTypes)==null?void 0:w.map(F=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:F.description}),e.jsx("p",{className:"text-sm text-muted-foreground",children:F.example})]}),e.jsx(ue,{variant:"outline",children:F.type})]},F.type))})})]})}),e.jsx(Ae,{value:"integration",className:"space-y-6",children:e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(gi,{className:"h-5 w-5"}),"Integration Guide"]}),e.jsx(te,{children:"How to integrate automated notifications into your order workflow"})]}),e.jsx(q,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"API Endpoints"}),e.jsxs("div",{className:"bg-gray-100 p-3 rounded-md font-mono text-sm",children:[e.jsx("div",{children:"POST /api/order-notifications/trigger"}),e.jsx("div",{children:"POST /api/order-notifications/schedule"}),e.jsx("div",{children:"POST /api/order-notifications/bulk"}),e.jsx("div",{children:"GET /api/order-notifications/status"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Example Integration"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Add this to your order status update functions:"}),e.jsx("div",{className:"bg-gray-100 p-3 rounded-md font-mono text-sm",children:`// When order status changes to "ready_for_pickup"
await fetch('/api/order-notifications/trigger', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    orderId: order.id,
    orderNumber: order.orderNumber,
    customerName: order.customerName,
    customerPhone: order.customerPhone,
    eventType: 'ready_for_pickup'
  })
});`})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Automated Workflows"}),e.jsxs("ul",{className:"text-sm space-y-1 ml-4",children:[e.jsx("li",{children:"• Order confirmation calls when orders are placed"}),e.jsx("li",{children:"• Payment confirmation when payments are received"}),e.jsx("li",{children:"• Progress updates during production phases"}),e.jsx("li",{children:"• Pickup notifications when orders are complete"}),e.jsx("li",{children:"• Payment reminders for outstanding balances"}),e.jsx("li",{children:"• Pickup reminders for completed orders"})]})]})]})})]})})]}),s&&e.jsxs(V,{children:[e.jsx(G,{children:e.jsx(Q,{children:"Preview"})}),e.jsxs(q,{children:[e.jsxs("p",{className:"text-sm",children:["Phone number: ",e.jsx(ue,{variant:"outline",children:T(s)})]}),r&&e.jsxs("p",{className:"text-sm mt-2",children:["Selected event: ",e.jsx(ue,{children:(_=(N=f==null?void 0:f.supportedEventTypes)==null?void 0:N.find(F=>F.type===r))==null?void 0:_.description})]})]})]})]})}var[lc,xU]=fs("Tooltip",[Ea]),cc=Ea(),TT="TooltipProvider",tV=700,nu="tooltip.open",[sV,Xm]=lc(TT),PT=s=>{const{__scopeTooltip:t,delayDuration:r=tV,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:i}=s,[o,l]=p.useState(!0),c=p.useRef(!1),d=p.useRef(0);return p.useEffect(()=>{const u=d.current;return()=>window.clearTimeout(u)},[]),e.jsx(sV,{scope:t,isOpenDelayed:o,delayDuration:r,onOpen:p.useCallback(()=>{window.clearTimeout(d.current),l(!1)},[]),onClose:p.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>l(!0),n)},[n]),isPointerInTransitRef:c,onPointerInTransitChange:p.useCallback(u=>{c.current=u},[]),disableHoverableContent:a,children:i})};PT.displayName=TT;var dc="Tooltip",[rV,uc]=lc(dc),ET=s=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a=!1,onOpenChange:i,disableHoverableContent:o,delayDuration:l}=s,c=Xm(dc,s.__scopeTooltip),d=cc(t),[u,h]=p.useState(null),m=hr(),x=p.useRef(0),g=o??c.disableHoverableContent,f=l??c.delayDuration,v=p.useRef(!1),[y=!1,j]=ms({prop:n,defaultProp:a,onChange:T=>{T?(c.onOpen(),document.dispatchEvent(new CustomEvent(nu))):c.onClose(),i==null||i(T)}}),b=p.useMemo(()=>y?v.current?"delayed-open":"instant-open":"closed",[y]),k=p.useCallback(()=>{window.clearTimeout(x.current),v.current=!1,j(!0)},[j]),S=p.useCallback(()=>{window.clearTimeout(x.current),j(!1)},[j]),A=p.useCallback(()=>{window.clearTimeout(x.current),x.current=window.setTimeout(()=>{v.current=!0,j(!0)},f)},[f,j]);return p.useEffect(()=>()=>window.clearTimeout(x.current),[]),e.jsx(lu,{...d,children:e.jsx(rV,{scope:t,contentId:m,open:y,stateAttribute:b,trigger:u,onTriggerChange:h,onTriggerEnter:p.useCallback(()=>{c.isOpenDelayed?A():k()},[c.isOpenDelayed,A,k]),onTriggerLeave:p.useCallback(()=>{g?S():window.clearTimeout(x.current)},[S,g]),onOpen:k,onClose:S,disableHoverableContent:g,children:r})})};ET.displayName=dc;var au="TooltipTrigger",DT=p.forwardRef((s,t)=>{const{__scopeTooltip:r,...n}=s,a=uc(au,r),i=Xm(au,r),o=cc(r),l=p.useRef(null),c=Ge(t,l,a.onTriggerChange),d=p.useRef(!1),u=p.useRef(!1),h=p.useCallback(()=>d.current=!1,[]);return p.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),e.jsx(bl,{asChild:!0,...o,children:e.jsx(Se.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:c,onPointerMove:ge(s.onPointerMove,m=>{m.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:ge(s.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:ge(s.onPointerDown,()=>{d.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:ge(s.onFocus,()=>{d.current||a.onOpen()}),onBlur:ge(s.onBlur,a.onClose),onClick:ge(s.onClick,a.onClose)})})});DT.displayName=au;var nV="TooltipPortal",[gU,aV]=lc(nV,{forceMount:void 0}),Pa="TooltipContent",AT=p.forwardRef((s,t)=>{const r=aV(Pa,s.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...i}=s,o=uc(Pa,s.__scopeTooltip);return e.jsx(ds,{present:n||o.open,children:o.disableHoverableContent?e.jsx(_T,{side:a,...i,ref:t}):e.jsx(iV,{side:a,...i,ref:t})})}),iV=p.forwardRef((s,t)=>{const r=uc(Pa,s.__scopeTooltip),n=Xm(Pa,s.__scopeTooltip),a=p.useRef(null),i=Ge(t,a),[o,l]=p.useState(null),{trigger:c,onClose:d}=r,u=a.current,{onPointerInTransitChange:h}=n,m=p.useCallback(()=>{l(null),h(!1)},[h]),x=p.useCallback((g,f)=>{const v=g.currentTarget,y={x:g.clientX,y:g.clientY},j=dV(y,v.getBoundingClientRect()),b=uV(y,j),k=mV(f.getBoundingClientRect()),S=pV([...b,...k]);l(S),h(!0)},[h]);return p.useEffect(()=>()=>m(),[m]),p.useEffect(()=>{if(c&&u){const g=v=>x(v,u),f=v=>x(v,c);return c.addEventListener("pointerleave",g),u.addEventListener("pointerleave",f),()=>{c.removeEventListener("pointerleave",g),u.removeEventListener("pointerleave",f)}}},[c,u,x,m]),p.useEffect(()=>{if(o){const g=f=>{const v=f.target,y={x:f.clientX,y:f.clientY},j=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),b=!hV(y,o);j?m():b&&(m(),d())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[c,u,o,d,m]),e.jsx(_T,{...s,ref:i})}),[oV,lV]=lc(dc,{isInside:!1}),_T=p.forwardRef((s,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=s,c=uc(Pa,r),d=cc(r),{onClose:u}=c;return p.useEffect(()=>(document.addEventListener(nu,u),()=>document.removeEventListener(nu,u)),[u]),p.useEffect(()=>{if(c.trigger){const h=m=>{const x=m.target;x!=null&&x.contains(c.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[c.trigger,u]),e.jsx(vl,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:e.jsxs(iu,{"data-state":c.stateAttribute,...d,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(nj,{children:n}),e.jsx(oV,{scope:r,isInside:!0,children:e.jsx(By,{id:c.contentId,role:"tooltip",children:a||n})})]})})});AT.displayName=Pa;var IT="TooltipArrow",cV=p.forwardRef((s,t)=>{const{__scopeTooltip:r,...n}=s,a=cc(r);return lV(IT,r).isInside?null:e.jsx(ou,{...a,...n,ref:t})});cV.displayName=IT;function dV(s,t){const r=Math.abs(t.top-s.y),n=Math.abs(t.bottom-s.y),a=Math.abs(t.right-s.x),i=Math.abs(t.left-s.x);switch(Math.min(r,n,a,i)){case i:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function uV(s,t,r=5){const n=[];switch(t){case"top":n.push({x:s.x-r,y:s.y+r},{x:s.x+r,y:s.y+r});break;case"bottom":n.push({x:s.x-r,y:s.y-r},{x:s.x+r,y:s.y-r});break;case"left":n.push({x:s.x+r,y:s.y-r},{x:s.x+r,y:s.y+r});break;case"right":n.push({x:s.x-r,y:s.y-r},{x:s.x-r,y:s.y+r});break}return n}function mV(s){const{top:t,right:r,bottom:n,left:a}=s;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function hV(s,t){const{x:r,y:n}=s;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i].x,c=t[i].y,d=t[o].x,u=t[o].y;c>n!=u>n&&r<(d-l)*(n-c)/(u-c)+l&&(a=!a)}return a}function pV(s){const t=s.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),fV(t)}function fV(s){if(s.length<=1)return s.slice();const t=[];for(let n=0;n<s.length;n++){const a=s[n];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=s.length-1;n>=0;n--){const a=s[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var xV=PT,gV=ET,vV=DT,RT=AT;const MT=xV,yV=gV,jV=vV,OT=p.forwardRef(({className:s,sideOffset:t=4,...r},n)=>e.jsx(RT,{ref:n,sideOffset:t,className:J("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r}));OT.displayName=RT.displayName;const FT=du,bV=uu,wV=Da,NV=cu,LT=p.forwardRef(({className:s,...t},r)=>e.jsx(Ui,{className:J("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:r}));LT.displayName=Ui.displayName;const SV=Vn("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Jm=p.forwardRef(({side:s="right",className:t,children:r,...n},a)=>e.jsxs(NV,{children:[e.jsx(LT,{}),e.jsxs(Hi,{ref:a,className:J(SV({side:s}),t),...n,children:[r,e.jsxs(Da,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx($n,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Jm.displayName=Hi.displayName;const $T=({className:s,...t})=>e.jsx("div",{className:J("flex flex-col space-y-2 text-center sm:text-left",s),...t});$T.displayName="SheetHeader";const BT=({className:s,...t})=>e.jsx("div",{className:J("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});BT.displayName="SheetFooter";const VT=p.forwardRef(({className:s,...t},r)=>e.jsx(qi,{ref:r,className:J("text-lg font-semibold text-foreground",s),...t}));VT.displayName=qi.displayName;const CV=p.forwardRef(({className:s,...t},r)=>e.jsx(zi,{ref:r,className:J("text-sm text-muted-foreground",s),...t}));CV.displayName=zi.displayName;const kV=()=>{const[s,t]=p.useState(!1),[r,n]=p.useState([]),[a,i]=p.useState(""),[o,l]=p.useState(!1),c=p.useRef(null),d=p.useRef(null),{toast:u}=Be(),[h,m]=p.useState([]),[x,g]=p.useState(!1);p.useEffect(()=>{s&&r.length===0&&n([{id:"greeting",content:"Hello! I can help you find frames, matboards, and navigate through the system. What are you looking for today?",sender:"system",timestamp:new Date}])},[s,r.length]),p.useEffect(()=>{c.current&&(c.current.scrollTop=c.current.scrollHeight)},[r]),p.useEffect(()=>{s&&d.current&&d.current.focus()},[s]);const f=()=>{t(!s)},v=S=>{i(S.target.value)},y=async()=>{if(!a.trim())return;const S={id:`user-${Date.now()}`,content:a,sender:"user",timestamp:new Date};n(A=>[...A,S]),i(""),l(!0),g(!0);try{const A=await ce("POST","/api/chat",{message:S.content});if(!A.ok)throw new Error("Failed to get response from assistant");const T=await A.json(),C={id:`system-${Date.now()}`,content:T.response,sender:"system",timestamp:new Date};n(E=>[...E,C]),T.searchResults&&T.searchResults.length>0?m(T.searchResults):m([])}catch(A){console.error("Chat search error:",A);const T={id:`msg-${Date.now()}`,type:"bot",content:"I apologize, but I'm having trouble searching right now. Please try again in a moment, or try searching with different keywords.",timestamp:new Date,searchResults:[]};n(C=>[...C,T]),u({title:"Search Temporarily Unavailable",description:"Search is experiencing issues. Please try again shortly.",variant:"destructive"})}finally{l(!1),g(!1),m([])}},j=S=>{S.key==="Enter"&&y()},b=S=>{S&&(window.location.href=S,t(!1))},k=S=>S.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.jsxs(e.Fragment,{children:[e.jsx(MT,{children:e.jsxs(yV,{children:[e.jsx(jV,{asChild:!0,children:e.jsx(P,{onClick:f,className:"rounded-full h-12 w-12 fixed bottom-6 right-6 shadow-lg",size:"icon",variant:"default",children:e.jsx(tP,{className:"h-6 w-6"})})}),e.jsx(OT,{side:"left",children:e.jsx("p",{children:"Chat Assistant"})})]})}),e.jsx(FT,{open:s,onOpenChange:t,children:e.jsxs(Jm,{className:"sm:max-w-md p-0",children:[e.jsxs($T,{className:"px-4 py-3 border-b",children:[e.jsx(VT,{className:"text-lg",children:"Chat Assistant"}),e.jsxs(wV,{className:"absolute right-4 top-4",children:[e.jsx($n,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsxs("div",{ref:c,className:"px-4 py-2 overflow-y-auto flex-1",style:{height:"calc(100vh - 140px)"},children:[r.map(S=>e.jsx("div",{className:`mb-4 ${S.sender==="user"?"ml-auto":"mr-auto"}`,children:e.jsx(V,{className:`max-w-[80%] ${S.sender==="user"?"ml-auto bg-primary text-primary-foreground":"mr-auto"}`,children:e.jsxs(q,{className:"p-3",children:[e.jsx("div",{children:S.content}),e.jsx("div",{className:"text-xs mt-1 opacity-70 text-right",children:k(S.timestamp)})]})})},S.id)),o&&e.jsx("div",{className:"mb-4",children:e.jsx(V,{className:"max-w-[80%] mr-auto",children:e.jsx(q,{className:"p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Xe,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{children:"Typing..."})]})})})}),h.length>0&&!x&&e.jsxs("div",{className:"mt-4 mb-2",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Search Results:"}),e.jsx("div",{className:"space-y-2",children:h.map(S=>e.jsx(V,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>S.route&&b(S.route),children:e.jsxs(q,{className:"p-3 flex items-center",children:[S.thumbnail?e.jsx("img",{src:S.thumbnail,alt:S.name,className:"w-10 h-10 object-cover mr-3 rounded-sm"}):e.jsx("div",{className:"w-10 h-10 bg-muted flex items-center justify-center mr-3 rounded-sm",children:e.jsx(Zr,{className:"h-5 w-5 text-muted-foreground/70"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:S.name}),S.description&&e.jsx("div",{className:"text-xs text-muted-foreground line-clamp-1",children:S.description}),e.jsx("div",{className:"text-xs text-primary/70",children:S.type.charAt(0).toUpperCase()+S.type.slice(1)})]})]})},S.id))})]})]}),e.jsx(BT,{className:"px-4 py-3 border-t",children:e.jsxs("div",{className:"flex w-full",children:[e.jsx(U,{ref:d,value:a,onChange:v,onKeyDown:j,placeholder:"Type your question...",className:"mr-2",disabled:o}),e.jsx(P,{onClick:y,size:"icon",disabled:!a.trim()||o,children:e.jsx(Sr,{className:"h-4 w-4"})})]})})]})})]})};function TV(){const[s,t]=p.useState("styles"),[r,n]=p.useState(0),a=[{id:"styles",title:"Frame Styles",sections:[{title:"Modern",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Modern frames feature clean lines, minimalist designs, and often come in metal finishes or simple wood styles with neutral tones."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsx("li",{children:"Perfect for contemporary artwork or photography"}),e.jsx("li",{children:"Creates a sleek, unobtrusive presentation"}),e.jsx("li",{children:"Popular choices include simple black, white, or metal profiles"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx(un,{className:"text-primary h-24 w-24",strokeWidth:1}),e.jsx(un,{className:"text-primary/30 h-28 w-28 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",strokeWidth:1})]})})},{title:"Traditional",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Traditional frames offer classic styling with ornate details, carved designs, and rich finishes like gold, silver, or dark wood tones."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsx("li",{children:"Ideal for classic artwork, portraits, or oil paintings"}),e.jsx("li",{children:"Adds a sense of elegance and formality"}),e.jsx("li",{children:"Often features decorative corners and intricate patterns"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx(un,{className:"text-primary h-24 w-24",strokeWidth:1}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center",children:e.jsx(Bo,{className:"text-primary/30 h-16 w-16"})})]})})},{title:"Rustic",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Rustic frames feature natural wood textures, distressed finishes, and a handcrafted appearance, celebrating the beauty of imperfection."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsx("li",{children:"Great for nature photography, landscapes, or casual art"}),e.jsx("li",{children:"Creates a warm, organic, and relaxed aesthetic"}),e.jsx("li",{children:"Often showcases natural wood grain patterns"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"border-4 border-primary/70 h-24 w-24 border-dashed rounded-sm"}),e.jsx(sP,{className:"text-primary/30 h-16 w-16 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})]})})},{title:"Floating",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Floating frames create the illusion that artwork is suspended within the frame, with space between the art and frame edge."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsx("li",{children:"Ideal for canvas art, contemporary pieces, or gallery displays"}),e.jsx("li",{children:"Creates a three-dimensional, modern presentation"}),e.jsx("li",{children:"Allows all edges of artwork to remain visible"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx(un,{className:"text-primary/30 h-28 w-28",strokeWidth:1}),e.jsx(un,{className:"text-primary h-20 w-20 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",strokeWidth:2})]})})}]},{id:"materials",title:"Frame Materials",sections:[{title:"Wood",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Wood frames are timeless classics that come in countless styles, finishes, and profiles to suit any decor or artwork."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Hardwoods:"})," Oak, maple, walnut (durable, refined grain patterns)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Softwoods:"})," Pine, cedar (more economical, casual appearance)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Finishes:"})," Natural, stained, painted, distressed, or gilded"]}),e.jsx("li",{children:"Provides warmth and a natural aesthetic"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-24 w-24 bg-gradient-to-r from-amber-700 to-amber-500 rounded-sm"}),e.jsx("div",{className:"absolute inset-0 opacity-30",children:[...Array(6)].map((d,u)=>e.jsx("div",{className:"w-full h-4 border-b border-amber-900/30"},u))})]})})},{title:"Metal",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Metal frames offer a sleek, contemporary look with excellent durability and precise, clean lines."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Aluminum:"})," Lightweight, doesn't rust, available in many colors"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Steel:"})," Very strong, often with a powder-coated finish"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Finishes:"})," Matte, glossy, brushed, antiqued, or anodized"]}),e.jsx("li",{children:"Ideal for modern art, photography, and diplomas"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-24 w-24 bg-gradient-to-r from-gray-400 to-gray-300 rounded-sm"}),e.jsx("div",{className:"absolute inset-0 flex justify-center items-center",children:e.jsx("div",{className:"w-[90%] h-[90%] border-2 border-gray-500"})})]})})},{title:"Composite",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Composite frames blend materials like polystyrene and resin to mimic the look of wood or metal at a more affordable price point."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsx("li",{children:"Highly resistant to warping, moisture damage, and fading"}),e.jsx("li",{children:"Available in a wide variety of styles and finishes"}),e.jsx("li",{children:"Lighter weight than solid wood frames"}),e.jsx("li",{children:"Good option for larger frames where weight is a concern"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-24 w-24 bg-gradient-to-r from-neutral-300 to-stone-200 rounded-sm"}),e.jsx("div",{className:"absolute inset-0 flex justify-center items-center",children:e.jsx(vj,{className:"text-primary/30 h-14 w-14"})})]})})},{title:"Acrylic",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Acrylic frames provide a modern, minimalist look with excellent durability and lightweight properties."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsx("li",{children:"Shatter-resistant alternative to glass"}),e.jsx("li",{children:"Available in clear, colored, or frosted finishes"}),e.jsx("li",{children:"Creates an open, floating appearance"}),e.jsx("li",{children:"Ideal for contemporary spaces and gallery walls"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-24 w-24 border-2 border-primary/30 bg-primary/5 rounded-sm"}),e.jsx("div",{className:"absolute inset-0 flex justify-center items-center",children:e.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-sm"})})]})})}]},{id:"preservation",title:"Preservation Benefits",sections:[{title:"UV Protection",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"UV-protective glass and acrylic block harmful ultraviolet rays that cause artwork fading and deterioration."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsx("li",{children:"Blocks 97-99% of UV rays, depending on the quality"}),e.jsx("li",{children:"Prevents paper yellowing and ink fading"}),e.jsx("li",{children:"Critical for valuable art, historical documents, and photographs"}),e.jsx("li",{children:"Higher quality UV glass is virtually invisible to the viewer"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx(Kc,{className:"text-amber-500 h-20 w-20"}),e.jsx("div",{className:"absolute inset-0 flex justify-center items-center",children:e.jsx(Bo,{className:"text-primary/50 h-24 w-24"})})]})})},{title:"Acid-Free Materials",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Acid-free mat boards and backing materials prevent chemical damage and discoloration of artwork over time."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsx("li",{children:'Prevents "mat burn" - the brown line that forms where mat meets artwork'}),e.jsx("li",{children:"Conservation-grade mats have neutral pH (6.5-7.5)"}),e.jsx("li",{children:"Museum-grade mats are alkaline-buffered for extra protection"}),e.jsx("li",{children:"Essential for preserving valuable art and photographs"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-24 w-24 border-2 border-primary rounded-sm bg-white"}),e.jsx("div",{className:"h-16 w-16 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-neutral-100 border border-primary"}),e.jsx("div",{className:"absolute inset-0 flex justify-center items-center",children:e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-green-100 text-green-800 font-bold text-xs",children:"pH 7"})})]})})},{title:"Archival Mounting",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Archival mounting techniques secure artwork without damaging it, using reversible methods that won't compromise value."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Hinging:"})," Attaching art with acid-free paper strips and wheat paste"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Corners:"})," Using archival photo corners that don't touch the artwork"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Conservation Mounting:"})," Methods that are completely reversible"]}),e.jsx("li",{children:"Prevents buckling, rippling, and movement within the frame"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"relative",children:[e.jsx(un,{className:"text-primary h-24 w-24",strokeWidth:1}),e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute top-0 left-0 w-4 h-4 border-t-2 border-l-2 border-primary/70"}),e.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 border-t-2 border-r-2 border-primary/70"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-4 h-4 border-b-2 border-l-2 border-primary/70"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 border-b-2 border-r-2 border-primary/70"})]})]})})},{title:"Climate Control",content:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Proper framing creates a microenvironment that helps protect artwork from humidity fluctuations and airborne pollutants."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[e.jsx("li",{children:"Sealed frames provide a barrier against dust and pollutants"}),e.jsx("li",{children:"Spacers prevent artwork from touching glass (important to prevent mold)"}),e.jsx("li",{children:"Backing boards with vapor barriers protect against humidity"}),e.jsx("li",{children:"Museum-quality packages may include silica gel for humidity control"})]})]}),illustration:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"h-24 w-24 border-2 border-primary rounded-sm relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(Kc,{className:"text-amber-400 h-8 w-8"}),e.jsx(aj,{className:"text-blue-400 h-8 w-8"})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-4 bg-gradient-to-t from-blue-100 to-transparent"})]})})})}]}],i=a.find(d=>d.id===s)||a[0],o=i.sections[r],l=()=>{if(r<i.sections.length-1)n(r+1);else{const d=a.findIndex(u=>u.id===s);d<a.length-1&&(t(a[d+1].id),n(0))}},c=()=>{if(r>0)n(r-1);else{const d=a.findIndex(u=>u.id===s);d>0&&(t(a[d-1].id),n(a[d-1].sections.length-1))}};return e.jsxs(V,{className:"w-full",children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Frame Education Guide"}),e.jsx(te,{children:"Learn about different frame styles, materials, and preservation benefits"})]}),e.jsx(q,{children:e.jsxs(qt,{value:s,onValueChange:t,className:"w-full",children:[e.jsx($t,{className:"grid grid-cols-3 mb-4",children:a.map(d=>e.jsx(ve,{value:d.id,onClick:()=>n(0),children:d.title},d.id))}),a.map(d=>e.jsx(Ae,{value:d.id,className:"mt-0",children:e.jsxs("div",{className:"border rounded-lg",children:[e.jsx("div",{className:"bg-muted/50 p-3 border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:o.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[r+1," of ",i.sections.length]})]})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx("div",{children:o.content}),e.jsx("div",{className:"flex justify-center md:border-l md:pl-6",children:o.illustration})]})}),e.jsxs("div",{className:"flex justify-between p-4 border-t",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:c,disabled:r===0&&a.findIndex(u=>u.id===s)===0,children:[e.jsx(yj,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:l,disabled:r===i.sections.length-1&&a.findIndex(u=>u.id===s)===a.length-1,children:["Next",e.jsx(kl,{className:"h-4 w-4 ml-1"})]})]})]})},d.id))]})}),e.jsx(ht,{className:"flex justify-between",children:e.jsxs(P,{variant:"link",size:"sm",className:"text-sm text-muted-foreground",children:[e.jsx(gj,{className:"h-3 w-3 mr-1"}),"Learn More About Framing"]})})]})}function PV(){return e.jsxs("div",{className:"container mx-auto py-6 max-w-5xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Frame Education Center"}),e.jsx("p",{className:"text-muted-foreground",children:"Everything you need to know about custom framing to make informed decisions"})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsx(TV,{}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-muted/30 p-6 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Framing Glossary"}),e.jsx("p",{className:"mb-3",children:"Essential framing terms to know:"}),e.jsxs("dl",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"font-medium",children:"United Inches"}),e.jsx("dd",{className:"text-sm text-muted-foreground",children:"The sum of the width and height of your framed piece, used for pricing."})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"font-medium",children:"Mat Board"}),e.jsx("dd",{className:"text-sm text-muted-foreground",children:"The paper-based border between artwork and frame that adds visual space."})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"font-medium",children:"Conservation Framing"}),e.jsx("dd",{className:"text-sm text-muted-foreground",children:"Techniques that protect artwork from environmental damage and deterioration."})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"font-medium",children:"Rabbet"}),e.jsx("dd",{className:"text-sm text-muted-foreground",children:"The groove in a frame where the glass, mat, artwork, and backing fit."})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"font-medium",children:"Fillet"}),e.jsx("dd",{className:"text-sm text-muted-foreground",children:"A small decorative molding inside the main frame or between artwork and mat."})]})]})]}),e.jsxs("div",{className:"bg-muted/30 p-6 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Framing FAQ"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"How do I choose the right frame color?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select a color from your artwork, match your decor, or choose a neutral that complements the artwork's tones."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Is UV glass worth the extra cost?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Yes, especially for valuable artwork, photographs, or pieces displayed in bright areas where fading is a concern."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Should I frame without a mat?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mats provide visual space around artwork and prevent it from touching the glass. Frameless mounting works best for canvas and modern art."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"How often should I reframe artwork?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Every 10-15 years for valuable pieces, or when you notice yellowing, warping, or other signs of deterioration."})]})]})]})]})]})]})}function EV({className:s=""}){const[t,r]=p.useState(!1),n=[{to:"/",label:"Home",icon:rP},{to:"/pos-system",label:"POS System",icon:wl},{to:"/orders",label:"Orders",icon:Qs},{to:"/customers",label:"Customers",icon:nP},{to:"/inventory",label:"Inventory",icon:hu},{to:"/production",label:"Production",icon:gi}];return e.jsx("div",{className:`md:hidden ${s}`,children:e.jsxs(FT,{open:t,onOpenChange:r,children:[e.jsx(bV,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"icon",className:"text-gray-700 dark:text-gray-200",children:[e.jsx(ij,{className:"h-6 w-6"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsx(Jm,{side:"left",className:"w-64 p-0",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex items-center justify-between p-4 border-b",children:e.jsxs(Mt,{to:"/",onClick:()=>r(!1),className:"flex items-center space-x-2",children:[e.jsx("img",{src:"/images/toolman-jay-avatar.png",alt:"Jay's Frames",className:"w-8 h-8 rounded-full",onError:a=>{a.currentTarget.style.display="none"}}),e.jsx("span",{className:"text-lg font-bold",children:"Jay's Frames"})]})}),e.jsx("nav",{className:"flex-1 py-4",children:e.jsx("ul",{className:"space-y-2 px-4",children:n.map(a=>{const i=a.icon;return e.jsx("li",{children:e.jsx(Mt,{to:a.to,onClick:()=>r(!1),children:e.jsxs("div",{className:"flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[e.jsx(i,{className:"h-5 w-5"}),e.jsx("span",{children:a.label})]})})},a.to)})})})]})})]})})}function DV(){const{toast:s}=yu(),t=Zt(),[r,n]=p.useState(!1),{data:a,isLoading:i,error:o}=me({queryKey:["/api/pricing-monitor/status"],refetchInterval:3e5}),l=Ce({mutationFn:async()=>{const h=await fetch("/api/pricing-monitor/check",{method:"POST",headers:{"Content-Type":"application/json"}});if(!h.ok)throw new Error("Failed to trigger pricing check");return h.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["/api/pricing-monitor/status"]}),s({title:"Pricing Check Complete",description:"Latest pricing alignment has been analyzed"})},onError:h=>{s({title:"Check Failed",description:h.message,variant:"destructive"})}}),c=async()=>{try{const h=await fetch("/api/pricing-monitor/report");if(!h.ok)throw new Error("Failed to generate report");const m=await h.blob(),x=window.URL.createObjectURL(m),g=document.createElement("a");g.href=x,g.download=`pricing-report-${new Date().toISOString().split("T")[0]}.md`,document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(x),document.body.removeChild(g),s({title:"Report Downloaded",description:"Pricing alignment report has been downloaded"})}catch{s({title:"Download Failed",description:"Could not download the pricing report",variant:"destructive"})}},d=async()=>{n(!0);try{await l.mutateAsync()}finally{n(!1)}};if(i)return e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(ir,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading pricing status..."})]});if(o||!(a!=null&&a.success))return e.jsxs(hs,{variant:"destructive",children:[e.jsx(At,{className:"h-4 w-4"}),e.jsx(ps,{children:"Failed to load pricing status. Please try again later."})]});const{data:u}=a;return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Pricing Monitor"}),e.jsx("p",{className:"text-muted-foreground",children:"Automated monitoring of pricing alignment with industry standards"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{variant:"outline",onClick:c,className:"flex items-center gap-2",children:[e.jsx(xn,{className:"h-4 w-4"}),"Download Report"]}),e.jsxs(P,{onClick:d,disabled:r,className:"flex items-center gap-2",children:[e.jsx(ir,{className:`h-4 w-4 ${r?"animate-spin":""}`}),r?"Checking...":"Check Now"]})]})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[u.adjustmentsNeeded?e.jsx(At,{className:"h-5 w-5 text-orange-500"}):e.jsx(Gs,{className:"h-5 w-5 text-green-500"}),"Pricing Alignment Status"]}),e.jsxs(te,{children:["Last checked: ",new Date(a.timestamp).toLocaleString()]})]}),e.jsx(q,{children:e.jsx(hs,{variant:u.adjustmentsNeeded?"destructive":"default",children:e.jsx(ps,{className:"text-base",children:u.summary})})})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Current Pricing Analysis"}),e.jsx(te,{children:"Comparison of current prices against industry benchmarks"})]}),e.jsx(q,{children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:u.currentPrices.map((h,m)=>e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:h.scenario}),e.jsxs(ue,{variant:"outline",children:["$",h.totalPrice.toFixed(2)]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Frame:"}),e.jsxs("span",{children:["$",h.breakdown.frame.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Mat:"}),e.jsxs("span",{children:["$",h.breakdown.mat.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Glass:"}),e.jsxs("span",{children:["$",h.breakdown.glass.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Labor:"}),e.jsxs("span",{children:["$",h.breakdown.labor.toFixed(2)]})]})]})]},m))})})]}),u.recommendations.length>0&&e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx($o,{className:"h-5 w-5"}),"Pricing Adjustment Recommendations"]}),e.jsx(te,{children:"Suggested changes to align with industry standards"})]}),e.jsx(q,{children:e.jsx("div",{className:"space-y-4",children:u.recommendations.map((h,m)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-semibold capitalize",children:[h.component," Adjustment"]}),e.jsxs(ue,{variant:h.adjustment>0?"destructive":"secondary",children:[h.adjustment>0?"+":"",Math.round(h.adjustment*100),"%"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:h.reason}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:["Current Factor: ",h.currentFactor.toFixed(3)]}),e.jsxs("div",{children:["Recommended Factor: ",h.recommendedFactor.toFixed(3)]})]})]},m))})})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Automated Monitoring"}),e.jsx(te,{children:"This system runs automatically every 6 hours to ensure pricing stays competitive"})]}),e.jsx(q,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold",children:"Next Check"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheduled for 6 hours from last run"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold",children:"Tolerance"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"±15% from industry targets"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold",children:"Action Required"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u.adjustmentsNeeded?"Yes - Review recommendations":"No - All aligned"})]})]})})]})]})}function AV(){const[s,t]=p.useState(""),[r,n]=p.useState("16"),[a,i]=p.useState("20"),[o,l]=p.useState("3"),[c,d]=p.useState(""),[u,h]=p.useState("frame"),[m,x]=p.useState(null),[g,f]=p.useState(!1),v=async()=>{if(s){f(!0);try{const k=u==="frame"?"/api/larson-optimizer/optimize/frame":"/api/larson-optimizer/optimize/footage",S=u==="frame"?{itemNumber:s,artworkWidth:parseFloat(r),artworkHeight:parseFloat(a),matWidth:parseFloat(o)}:{itemNumber:s,footageNeeded:parseFloat(c)},A=await fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)});if(A.ok){const T=await A.json();x(T)}else console.error("Failed to calculate optimization")}catch(k){console.error("Error calculating optimization:",k)}finally{f(!1)}}},y=k=>`$${k.toFixed(2)}`,j=k=>{switch(k){case"length":return e.jsx(Qs,{className:"h-4 w-4"});case"chop":return e.jsx(pa,{className:"h-4 w-4"});case"mixed":return e.jsx(gn,{className:"h-4 w-4"});default:return e.jsx(gn,{className:"h-4 w-4"})}},b=k=>{switch(k){case"length":return"bg-blue-500";case"chop":return"bg-green-500";case"mixed":return"bg-purple-500";default:return"bg-gray-500"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(gn,{className:"h-5 w-5"}),"Larson-Juhl Order Optimizer"]}),e.jsx(te,{children:"Determine the most cost-effective way to purchase frame moulding: full length sticks vs. chop pricing vs. mixed approach"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"itemNumber",children:"Larson-Juhl Item Number"}),e.jsx(U,{id:"itemNumber",value:s,onChange:k=>t(k.target.value),placeholder:"e.g., 10-036M, 100750, etc."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Calculation Mode"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:u==="frame"?"default":"outline",onClick:()=>h("frame"),size:"sm",children:"Frame Dimensions"}),e.jsx(P,{variant:u==="footage"?"default":"outline",onClick:()=>h("footage"),size:"sm",children:"Custom Footage"})]})]}),u==="frame"&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"artworkWidth",children:"Artwork Width (in)"}),e.jsx(U,{id:"artworkWidth",type:"number",value:r,onChange:k=>n(k.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"artworkHeight",children:"Artwork Height (in)"}),e.jsx(U,{id:"artworkHeight",type:"number",value:a,onChange:k=>i(k.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"matWidth",children:"Mat Width (in)"}),e.jsx(U,{id:"matWidth",type:"number",value:o,onChange:k=>l(k.target.value)})]})]}),u==="footage"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"customFootage",children:"Footage Needed (ft)"}),e.jsx(U,{id:"customFootage",type:"number",step:"0.1",value:c,onChange:k=>d(k.target.value),placeholder:"Enter exact footage needed"})]}),e.jsx(P,{onClick:v,disabled:g||!s||u==="footage"&&!c,className:"w-full",children:g?"Calculating...":"Optimize Order"})]})]}),m&&e.jsxs("div",{className:"space-y-4",children:[m.recommendation.alert&&e.jsxs(hs,{children:[e.jsx(At,{className:"h-4 w-4"}),e.jsx(ps,{children:m.recommendation.alert})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[j(m.recommendation.method),"Recommendation: ",m.recommendation.method.toUpperCase()]}),e.jsx(te,{children:m.recommendation.reason})]}),e.jsx(q,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ue,{className:b(m.recommendation.method),children:["Save ",y(m.recommendation.savings)]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[m.footageNeeded," ft needed"]})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(V,{className:m.recommendation.method==="length"?"ring-2 ring-blue-500":"",children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2 text-base",children:[e.jsx(Qs,{className:"h-4 w-4"}),"Length Pricing"]}),e.jsx(te,{children:"Full 9.5' sticks"})]}),e.jsxs(q,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:y(m.lengthOption.totalCost)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:m.lengthOption.description})]}),e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total footage:"}),e.jsxs("span",{children:[m.lengthOption.totalFootage,"'"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Waste:"}),e.jsxs("span",{className:"text-red-600",children:[m.lengthOption.wasteFootage.toFixed(1),"'"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cost per foot:"}),e.jsx("span",{children:y(m.lengthOption.costPerFoot)})]})]})]})]}),e.jsxs(V,{className:m.recommendation.method==="chop"?"ring-2 ring-green-500":"",children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2 text-base",children:[e.jsx(pa,{className:"h-4 w-4"}),"Chop Pricing"]}),e.jsx(te,{children:"Cut to exact length"})]}),e.jsxs(q,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:y(m.chopOption.totalCost)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:m.chopOption.description})]}),e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Exact footage:"}),e.jsxs("span",{children:[m.chopOption.footageNeeded,"'"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Waste:"}),e.jsx("span",{className:"text-green-600",children:"0'"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cost per foot:"}),e.jsx("span",{children:y(m.chopOption.costPerFoot)})]})]})]})]}),m.mixedOption&&e.jsxs(V,{className:m.recommendation.method==="mixed"?"ring-2 ring-purple-500":"",children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2 text-base",children:[e.jsx(gn,{className:"h-4 w-4"}),"Mixed Approach"]}),e.jsx(te,{children:"Combination of full sticks + chop"})]}),e.jsxs(q,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:y(m.mixedOption.totalCost)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:m.mixedOption.description})]}),e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Full sticks:"}),e.jsx("span",{children:m.mixedOption.fullSticks})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Chop footage:"}),e.jsxs("span",{children:[m.mixedOption.chopFootage.toFixed(1),"'"]})]})]})]})]})]})]})]})}function _V(){return e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Larson-Juhl Order Optimizer"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Optimize your frame moulding orders by comparing length vs. chop pricing to minimize costs and waste."})]}),e.jsx(AV,{})]})}const IV=()=>{const[s,t]=p.useState(16),[r,n]=p.useState(20),[a,i]=p.useState(2),[o,l]=p.useState(""),[c,d]=p.useState(""),[u,h]=p.useState(""),[m,x]=p.useState(1),[g,f]=p.useState(null),[v,y]=p.useState(!1),[j,b]=p.useState(!0),{data:k=[]}=me({queryKey:["/api/frames"]}),{data:S=[]}=me({queryKey:["/api/mat-colors"]}),{data:A=[]}=me({queryKey:["/api/glass-options"]}),T=async()=>{if(!(!o||!c||!u||s<=0||r<=0)){y(!0);try{const N=await(await ce("POST","/api/pricing/calculate",{frameId:o,matColorId:c,glassOptionId:u,artworkWidth:s,artworkHeight:r,matWidth:a,quantity:m,includeWholesalePrices:!1})).json(),_=s+r,F=s+a*2,W=r+a*2,Z={...N,unitedInches:_,finishedDimensions:{width:F,height:W},breakdown:{materials:N.materialCost||N.framePrice+N.matPrice+N.glassPrice,labor:N.laborCost||0,markup:N.totalPrice-(N.materialCost||0)-(N.laborCost||0)}};f(Z)}catch(w){console.error("Error calculating estimate:",w)}finally{y(!1)}}};p.useEffect(()=>{if(j){const w=setTimeout(()=>{T()},500);return()=>clearTimeout(w)}},[o,c,u,s,r,a,m,j]);const C=k.find(w=>w.id===o),E=S.find(w=>w.id===c),D=A.find(w=>w.id===u);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{children:e.jsx(G,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(gn,{className:"h-5 w-5"}),"Automated Cost Estimator",e.jsxs(ue,{variant:"secondary",className:"ml-2",children:[e.jsx(Fo,{className:"h-3 w-3 mr-1"}),"Real-time"]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(V,{children:[e.jsx(G,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(cj,{className:"h-4 w-4"}),"Project Specifications"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"artwork-width",children:"Artwork Width (inches)"}),e.jsx(U,{id:"artwork-width",type:"number",value:s,onChange:w=>t(Number(w.target.value)),min:"1",max:"200"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"artwork-height",children:"Artwork Height (inches)"}),e.jsx(U,{id:"artwork-height",type:"number",value:r,onChange:w=>n(Number(w.target.value)),min:"1",max:"200"})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"mat-width",children:"Mat Width (inches)"}),e.jsx(U,{id:"mat-width",type:"number",value:a,onChange:w=>i(Number(w.target.value)),min:"0",max:"10",step:"0.25"})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Frame Selection"}),e.jsxs(We,{value:o,onValueChange:l,children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select a frame"})}),e.jsx(qe,{children:k.map(w=>e.jsx(se,{value:w.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(yh,{className:"h-4 w-4"}),w.name," - ",w.material,e.jsxs(ue,{variant:"outline",children:["$",w.price,"/ft"]})]})},w.id))})]})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Mat Color"}),e.jsxs(We,{value:c,onValueChange:d,children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select mat color"})}),e.jsx(qe,{children:S.map(w=>e.jsx(se,{value:w.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded border",style:{backgroundColor:w.color}}),w.name,w.category&&e.jsx(ue,{variant:"outline",children:w.category})]})},w.id))})]})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Glass Type"}),e.jsxs(We,{value:u,onValueChange:h,children:[e.jsx(He,{children:e.jsx(Ke,{placeholder:"Select glass type"})}),e.jsx(qe,{children:A.map(w=>e.jsx(se,{value:w.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bo,{className:"h-4 w-4"}),w.name,e.jsxs(ue,{variant:"outline",children:["$",w.price,"/sq.in"]})]})},w.id))})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"quantity",children:"Quantity"}),e.jsx(U,{id:"quantity",type:"number",value:m,onChange:w=>x(Number(w.target.value)),min:"1",max:"100"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{onClick:T,disabled:v||!o||!c||!u,className:"flex-1",children:v?"Calculating...":"Calculate Cost"}),e.jsxs(P,{variant:"outline",onClick:()=>b(!j),className:j?"bg-green-50":"",children:[e.jsx(Fo,{className:"h-4 w-4"}),"Auto"]})]})]})]}),e.jsxs(V,{children:[e.jsx(G,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(Dn,{className:"h-4 w-4"}),"Cost Estimate"]})}),e.jsx(q,{children:g?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:["$",g.totalPrice.toFixed(2)]}),e.jsx("div",{className:"text-sm text-blue-500",children:"Total Estimated Cost"}),m>1&&e.jsxs("div",{className:"text-sm text-gray-500",children:["$",(g.totalPrice/m).toFixed(2)," per unit"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx(M,{children:"Artwork Size"}),e.jsxs("div",{className:"font-medium",children:[s,'" × ',r,'"']})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Finished Size"}),e.jsxs("div",{className:"font-medium",children:[g.finishedDimensions.width,'" × ',g.finishedDimensions.height,'"']})]}),e.jsxs("div",{children:[e.jsx(M,{children:"United Inches"}),e.jsxs("div",{className:"font-medium",children:[g.unitedInches,'"']})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Mat Border"}),e.jsxs("div",{className:"font-medium",children:[a,'" all around']})]})]}),e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Cost Breakdown"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(yh,{className:"h-4 w-4"}),e.jsx("span",{children:"Frame"}),C&&e.jsx(ue,{variant:"outline",className:"text-xs",children:C.material})]}),e.jsxs("span",{className:"font-medium",children:["$",g.framePrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(un,{className:"h-4 w-4"}),e.jsx("span",{children:"Mat"}),E&&e.jsx("div",{className:"w-3 h-3 rounded border",style:{backgroundColor:E.color}})]}),e.jsxs("span",{className:"font-medium",children:["$",g.matPrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bo,{className:"h-4 w-4"}),e.jsx("span",{children:"Glass"}),D&&e.jsx(ue,{variant:"outline",className:"text-xs",children:D.name})]}),e.jsxs("span",{className:"font-medium",children:["$",g.glassPrice.toFixed(2)]})]}),g.laborCost>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(aP,{className:"h-4 w-4"}),e.jsx("span",{children:"Labor & Assembly"})]}),e.jsxs("span",{className:"font-medium",children:["$",g.laborCost.toFixed(2)]})]}),e.jsx(Ot,{}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:"Materials"}),e.jsxs("span",{children:["$",g.breakdown.materials.toFixed(2)]})]}),g.breakdown.labor>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:"Labor"}),e.jsxs("span",{children:["$",g.breakdown.labor.toFixed(2)]})]}),g.breakdown.markup>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:"Markup & Services"}),e.jsxs("span",{children:["$",g.breakdown.markup.toFixed(2)]})]})]}),(C||E||D)&&e.jsxs(e.Fragment,{children:[e.jsx(Ot,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Selected Materials"}),C&&e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Frame:"})," ",C.name," (",C.manufacturer,")"]}),E&&e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Mat:"})," ",E.name]}),D&&e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Glass:"})," ",D.name]})]})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(gn,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Select frame, mat, and glass options to see cost estimate"}),e.jsx("p",{className:"text-sm mt-2",children:j?"Estimates will update automatically":"Click Calculate to get estimate"})]})})]})]})]})},RV=()=>e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Cost Estimator"}),e.jsx("p",{className:"text-muted-foreground",children:"Get instant pricing estimates for custom framing projects"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ue,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(Fo,{className:"h-3 w-3"}),"Real-time"]}),e.jsxs(ue,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx($o,{className:"h-3 w-3"}),"Professional"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(V,{children:[e.jsx(G,{className:"pb-3",children:e.jsxs(Q,{className:"text-sm flex items-center gap-2",children:[e.jsx(gn,{className:"h-4 w-4"}),"Instant Calculations"]})}),e.jsx(q,{children:e.jsx(te,{children:"Get real-time pricing as you adjust dimensions and select materials"})})]}),e.jsxs(V,{children:[e.jsx(G,{className:"pb-3",children:e.jsxs(Q,{className:"text-sm flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4"}),"Time Saving"]})}),e.jsx(q,{children:e.jsx(te,{children:"No more manual calculations or waiting for quotes"})})]}),e.jsxs(V,{children:[e.jsx(G,{className:"pb-3",children:e.jsxs(Q,{className:"text-sm flex items-center gap-2",children:[e.jsx($o,{className:"h-4 w-4"}),"Professional Accuracy"]})}),e.jsx(q,{children:e.jsx(te,{children:"Based on actual wholesale pricing and industry standards"})})]})]})]}),e.jsx(IV,{}),e.jsxs(V,{children:[e.jsx(G,{children:e.jsx(Q,{className:"text-lg",children:"Tips for Accurate Estimates"})}),e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Dimension Guidelines"}),e.jsxs("ul",{className:"space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• Enter artwork dimensions in inches"}),e.jsx("li",{children:"• Mat width is border around all sides"}),e.jsx("li",{children:'• Standard mat widths: 2", 2.5", 3", 4"'}),e.jsx("li",{children:"• Consider proportion to artwork size"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Material Selection"}),e.jsxs("ul",{className:"space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• Frame prices are per linear foot"}),e.jsx("li",{children:"• Glass pricing varies by type and size"}),e.jsx("li",{children:"• Mat colors affect final pricing"}),e.jsx("li",{children:"• Premium materials cost more but last longer"})]})]})]})})]})]});class MV{constructor(){this.initialized=!1,this.appId="jays-frames-pos",this.unsubscribe=null}init(){if(!(typeof window>"u"||this.initialized))try{if(!window.jfNotifications){console.log("Unified notification system not available - continuing without external notifications"),this.initialized=!0;return}window.jfNotifications.init(this.appId,{onConnect:()=>{console.log("Connected to unified notification system")},onDisconnect:()=>{console.log("Disconnected from unified notification system")}}),this.unsubscribe=window.jfNotifications.onNotification(t=>{this.displayNotification(t)}),window.addEventListener("jf-notification",t=>{this.displayNotification(t.detail)}),this.initialized=!0,console.log("Notification service initialized")}catch(t){console.warn("Failed to initialize notification service:",t),this.initialized=!0}}async sendNotification(t,r,n="info",a={}){if(typeof window>"u"||!window.jfNotifications)return console.warn("Unified notification system not available"),!1;try{return!!await window.jfNotifications.sendNotification(t,r,n,{sourceId:a.sourceId||"",actionable:a.actionable||!1,link:a.link||"",smsEnabled:a.smsEnabled||!1,smsRecipient:a.smsRecipient||""})}catch(i){return console.error("Failed to send notification:",i),js({title:"Send Notification Error",description:`Failed to send notification: ${i.message||"Unknown error"}`,variant:"destructive"}),!1}}displayNotification(t){let r="default";t.type==="error"&&(r="destructive"),js({title:t.title,description:t.description,variant:r}),t.actionable&&t.link&&console.log("Actionable notification with link:",t.link)}cleanup(){this.unsubscribe&&this.unsubscribe(),typeof window<"u"&&window.removeEventListener("jf-notification",()=>{})}}const Gf=new MV;function OV(){return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:e.jsx(V,{className:"w-full max-w-md mx-4",children:e.jsxs(q,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx(Ht,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function FV(){return console.log("AppHealthCheck component rendered"),e.jsx("div",{style:{position:"fixed",top:"10px",right:"10px",background:"green",color:"white",padding:"5px 10px",borderRadius:"4px",fontSize:"12px",zIndex:9999},children:"App Loading ✓"})}function LV(s,t){var r;return s.name==="AxiosError"&&!s.response?{type:"network",message:"Unable to connect to the server. Please check your internet connection.",code:"NETWORK_ERROR",originalError:s}:s.response&&s.response.status>=500?{type:"server",message:"The server encountered an error. Please try again later.",code:`SERVER_${s.response.status}`,originalError:s}:s.response&&s.response.status===401?{type:"authentication",message:"You need to be logged in to perform this action.",code:"UNAUTHENTICATED",originalError:s}:s.response&&s.response.status===403?{type:"authorization",message:"You do not have permission to perform this action.",code:"UNAUTHORIZED",originalError:s}:s.response&&s.response.status===404?{type:"not_found",message:"The requested resource was not found.",code:"NOT_FOUND",originalError:s}:s.response&&(s.response.status===400||s.response.status===422)?{type:"validation",message:((r=s.response.data)==null?void 0:r.message)||"The submitted data is invalid.",code:"VALIDATION_ERROR",originalError:s}:s.code==="ECONNABORTED"||s.code==="ETIMEDOUT"||s.message&&(s.message.includes("timeout")||s.message.includes("Network Error"))?{type:"timeout",message:"The request took too long to complete. Please try again.",code:"REQUEST_TIMEOUT",originalError:s}:s.message&&(s.message.includes("image")||s.message.includes("file")||s.message.includes("upload"))?{type:"image_processing",message:"There was a problem processing your image. Please try again with a different file.",code:"IMAGE_PROCESSING_ERROR",originalError:s}:{type:"unknown",message:s.message||"An unexpected error occurred.",originalError:s}}function $V(s,t){const r=LV(s);return console.error(`Error ${`in ${t}`}:`,r),r}function Qf(s,t){console.error("Error logged to server:",{error:s,componentStack:t})}function BV(){window.addEventListener("error",s=>{console.error("Global error:",s.error),Qf(s.error,"Global Error")}),window.addEventListener("unhandledrejection",s=>{s.preventDefault();const t=s.reason instanceof Error?s.reason:new Error(String(s.reason));Qf(t,"Unhandled Promise Rejection"),t.message&&!t.message.includes("AbortError")&&$V(t,"Unhandled Promise Rejection")})}class UT extends p.Component{constructor(t){super(t),this.handleReload=()=>{window.location.reload()},this.handleReset=()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})},this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Error caught by boundary:",t,r),console.error("Production error:",{message:t.message,stack:t.stack,componentStack:r.componentStack}),this.setState({error:t,errorInfo:r})}render(){var t;return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-8 w-8 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.962-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Something went wrong"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"The application encountered an unexpected error. You can try reloading the page or reset the error state."}),this.state.error&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-sm text-gray-500 cursor-pointer",children:"Technical Details"}),e.jsxs("pre",{className:"mt-2 text-xs bg-gray-100 p-2 rounded overflow-auto max-h-32",children:[this.state.error.toString(),(t=this.state.errorInfo)==null?void 0:t.componentStack]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:this.handleReset,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Try Again"}),e.jsx("button",{onClick:this.handleReload,className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Reload Page"})]})]})}):this.props.children}}function VV(){const[s,t]=p.useState(!1);console.log("App component is rendering...",new Date().toISOString()),p.useEffect(()=>((async()=>{try{Gf.init()}catch(a){console.error("Error initializing app:",a)}})(),()=>{try{Gf.cleanup()}catch(a){console.error("Error during cleanup:",a)}}),[]),p.useEffect(()=>{const n=localStorage.getItem("theme"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;n==="dark"||!n&&a?(t(!0),document.documentElement.classList.add("dark")):(t(!1),document.documentElement.classList.remove("dark"))},[]),p.useEffect(()=>{BV();const n=a=>{console.error("Unhandled promise rejection caught:",a.reason),a.preventDefault()};return window.addEventListener("unhandledrejection",n),()=>{window.removeEventListener("unhandledrejection",n)}},[]);const r=()=>{const n=!s;t(n),n?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))};return e.jsx(w2,{client:ut,children:e.jsx(SE,{children:e.jsxs(MT,{children:[e.jsx("div",{className:`min-h-screen ${s?"dark":""}`,children:e.jsxs(UT,{children:[e.jsx(FV,{}),e.jsx(EV,{}),e.jsx(PE,{darkMode:s,toggleTheme:r}),e.jsx("main",{className:"container pt-16 lg:pt-24 pb-10 px-3 lg:px-4",children:e.jsxs(HP,{children:[e.jsx(Ye,{path:"/",component:hA}),e.jsx(Ye,{path:"/orders",component:WA}),e.jsx(Ye,{path:"/dashboard",component:GA}),e.jsx(Ye,{path:"/production",component:VM}),e.jsx(Ye,{path:"/orders/:orderId",component:S8}),e.jsx(Ye,{path:"/orders/progress/:orderId",component:Ep}),e.jsx(Ye,{path:"/customer-portal",component:p.lazy(()=>wh(()=>import("./CustomerPortal-gtXnmLuJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])))}),e.jsx(Ye,{path:"/customer-dashboard",component:p.lazy(()=>wh(()=>import("./CustomerDashboardPage-Dw3GG0jh.js"),__vite__mapDeps([8,1,2,3,4,5,6,7])))}),e.jsx(Ye,{path:"/materials",component:N5}),e.jsx(Ye,{path:"/materials-pick-list",component:E5}),e.jsx(Ye,{path:"/inventory",component:f8}),e.jsx(Ye,{path:"/inventory-tracking",component:g8}),e.jsx(Ye,{path:"/hub",component:r6}),e.jsx(Ye,{path:"/pricing",component:y8}),e.jsx(Ye,{path:"/cost-estimator",component:RV}),e.jsx(Ye,{path:"/vendor-settings",component:j8}),e.jsx(Ye,{path:"/mat-test",component:k6}),e.jsx(Ye,{path:"/checkout/:orderGroupId",component:O4}),e.jsx(Ye,{path:"/payment-status",component:F4}),e.jsx(Ye,{path:"/order-progress/:orderId",component:Ep}),e.jsx(Ye,{path:"/customers/:id",component:Q4}),e.jsx(Ye,{path:"/customers",component:Z4}),e.jsx(Ye,{path:"/payment-links",component:C8}),e.jsx(Ye,{path:"/payment/:token",component:P8}),e.jsx(Ye,{path:"/frame-education",component:PV}),e.jsx(Ye,{path:"/webhook-integration",component:C6}),e.jsx(Ye,{path:"/mat-border-demo",component:K8}),e.jsx(Ye,{path:"/system-health",component:Q8}),e.jsx(Ye,{path:"/pricing-monitor",component:DV}),e.jsx(Ye,{path:"/larson-optimizer",component:_V}),e.jsx(Ye,{path:"/notifications",component:Y8}),e.jsx(Ye,{path:"/kanban-test",component:X8}),e.jsx(Ye,{path:"/voice-calls",component:J8}),e.jsx(Ye,{path:"/automated-notifications",component:eV}),e.jsx(Ye,{component:OV})]})}),e.jsx(kV,{}),e.jsx(_l,{updateInterval:5e3,compact:!0})]})}),e.jsx(tE,{})]})})})}window.addEventListener("error",s=>{console.error("Global error caught:",s.error),console.error("Error details:",{message:s.message,filename:s.filename,lineno:s.lineno,colno:s.colno,error:s.error})});window.addEventListener("unhandledrejection",s=>{var t,r,n,a;console.error("Unhandled promise rejection:",s.reason),!((r=(t=s.reason)==null?void 0:t.message)!=null&&r.includes("vite"))&&!((a=(n=s.reason)==null?void 0:n.message)!=null&&a.includes("WebSocket"))&&s.preventDefault()});setTimeout(()=>{const s=document.querySelector(".loading-fallback");s&&s.style.display!=="none"&&(console.error("App failed to load within 10 seconds - likely JavaScript error"),s.innerHTML=`
      <div style="text-align: center; padding: 20px; font-family: Arial, sans-serif;">
        <h2 style="color: #dc3545;">App Loading Failed</h2>
        <p>The application failed to load. This could be due to:</p>
        <ul style="text-align: left; max-width: 400px; margin: 0 auto;">
          <li>JavaScript execution error</li>
          <li>Network connectivity issue</li>
          <li>Browser compatibility problem</li>
        </ul>
        <button onclick="window.location.reload()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 10px;">
          Reload Page
        </button>
        <br>
        <small>Check the browser console for error details</small>
      </div>
    `)},1e4);const UV=document.getElementById("root");if(UV)console.log("Root element found successfully");else{console.error("Root element not found");const s=document.createElement("div");s.id="root",document.body.appendChild(s),console.log("Created new root element")}try{const s=document.getElementById("root");if(!s)throw new Error("Could not find or create root element");sd.createRoot(s).render(e.jsx(De.StrictMode,{children:e.jsx(UT,{children:e.jsx(VV,{})})})),console.log("App initialized successfully")}catch(s){console.error("Failed to initialize app:",s);const t=document.getElementById("root")||document.body;t.innerHTML=`
    <div style="padding: 20px; text-align: center; font-family: Arial, sans-serif;">
      <h1>Application Error</h1>
      <p>Failed to load the application. Please refresh the page.</p>
      <button onclick="window.location.reload()" style="padding: 10px 20px; margin-top: 10px;">Refresh Page</button>
      <div style="margin-top: 20px; padding: 10px; background: #f0f0f0; border-radius: 4px;">
        <strong>Debug Info:</strong><br>
        Error: ${s instanceof Error?s.message:"Unknown error"}<br>
        Timestamp: ${new Date().toISOString()}
      </div>
    </div>
  `}export{P as B,V as C,U as I,qt as T,Cs as a,G as b,Q as c,te as d,q as e,ht as f,ce as g,$t as h,ve as i,Ae as j,$4 as k,pU as l,Be as u};
