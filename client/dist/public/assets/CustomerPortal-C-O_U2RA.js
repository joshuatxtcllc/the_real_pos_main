import{j as e}from"./ui-O3Y4hNsB.js";import{r as l}from"./vendor--0RGCJ5T.js";import{u as h,a as g,C as j,b as N,c as I,d as v,e as y,I as d,B as w,f as S,g as C}from"./index-CUUP49I_.js";import{a7 as E,aS as b}from"./icons-DNNJj53b.js";import"./query-DSGfYlti.js";import"./utils-CJ8RBMVN.js";import"./charts-zhNjaY9P.js";import"./forms-BphQ7k6W.js";function R(){const[a,m]=l.useState(""),[o,u]=l.useState(""),[r,n]=l.useState(!1),{toast:c}=h(),[,p]=g(),x=async s=>{s.preventDefault(),n(!0);try{if(!a.trim())throw new Error("Email is required");if(!o.trim())throw new Error("Order ID is required");const t=await C("POST","/api/customer-portal/login",{email:a,orderId:parseInt(o,10)});if(!t.ok){const f=await t.json();throw new Error(f.message||"Invalid login details")}const i=await t.json();localStorage.setItem("customerAuthToken",i.token),localStorage.setItem("customerEmail",a),localStorage.setItem("customerName",i.customerName||""),localStorage.setItem("customerId",i.customerId.toString()),c({title:"Login successful",description:"Welcome to your customer portal"}),p("/customer-dashboard")}catch(t){c({title:"Login failed",description:t instanceof Error?t.message:"Invalid credentials",variant:"destructive"})}finally{n(!1)}};return e.jsx("div",{className:"container flex items-center justify-center min-h-screen py-12",children:e.jsxs(j,{className:"w-full max-w-md",children:[e.jsxs(N,{className:"space-y-1",children:[e.jsx(I,{className:"text-2xl text-center",children:"Customer Portal"}),e.jsx(v,{className:"text-center",children:"Sign in to track your framing orders"})]}),e.jsx(y,{children:e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(d,{type:"email",placeholder:"Email address",value:a,onChange:s=>m(s.target.value),className:"pl-10",disabled:r})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(b,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(d,{type:"text",placeholder:"Order ID",value:o,onChange:s=>u(s.target.value),className:"pl-10",disabled:r})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter the order ID provided in your confirmation email"})]}),e.jsx(w,{type:"submit",className:"w-full",disabled:r,children:r?"Signing in...":"Sign In"})]})}),e.jsx(S,{className:"flex flex-col",children:e.jsx("p",{className:"text-sm text-center text-muted-foreground mt-2",children:"Need help? Contact us at support@jaysframes.com"})})]})})}export{R as default};
